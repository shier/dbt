

============================== 2022-09-16 15:42:28.975359 | 56068c2b-d65d-4a7b-b469-31dfd861eae3 ==============================
15:42:28.975359 [info ] [MainThread]: Running with dbt=1.0.0
15:42:28.979004 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step2_Incr'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:42:28.979360 [debug] [MainThread]: Tracking: tracking
15:42:28.979776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e5471f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e5471fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e5471ca0>]}
15:42:29.014485 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
15:42:29.023016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e5425310>]}
15:42:29.178118 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:42:29.184423 [debug] [MainThread]: Parsing macros/materializations/seeds/str_replace.sql
15:42:29.185586 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:42:29.191152 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:42:29.192840 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:42:29.195702 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:42:29.196542 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:42:29.198608 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:42:29.203226 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:42:29.206211 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:42:29.212382 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:42:29.213408 [debug] [MainThread]: Parsing macros/adapters.sql
15:42:29.213665 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:42:29.218559 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:42:29.219869 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:42:29.226983 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:42:29.228976 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:42:29.229797 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:42:29.231345 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:42:29.235717 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:42:29.238342 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:42:29.239902 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:42:29.240438 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:42:29.240688 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:42:29.245333 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:42:29.249960 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:42:29.255377 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:42:29.264411 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:42:29.267823 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:42:29.272057 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:42:29.276055 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:42:29.278358 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:42:29.283206 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:42:29.285219 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:42:29.291639 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:42:29.310789 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:42:29.324862 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:42:29.327078 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:42:29.344390 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:42:29.358028 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:42:29.363037 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:42:29.375859 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:42:29.387129 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:42:29.389128 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:42:29.407142 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:42:29.415122 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:42:29.418492 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:42:29.421202 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:42:29.425079 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:42:29.432898 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:42:29.434619 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:42:29.435527 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:42:29.436999 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:42:29.437675 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:42:29.438671 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:42:29.441660 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:42:29.446152 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:42:29.455559 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:42:29.465689 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:42:29.478014 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:42:29.481469 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:42:29.484017 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:42:29.492749 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:42:29.497470 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:42:29.499389 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:42:29.503935 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:42:29.506126 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:42:29.732599 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
15:42:29.745616 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Categories.sql
15:42:29.748126 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Events.sql
15:42:29.750278 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Locations.sql
15:42:29.752580 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingsReserveHistory.sql
15:42:29.754637 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingPaymentCharge.sql
15:42:29.756694 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserMessages.sql
15:42:29.758880 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ReListHistory.sql
15:42:29.760967 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeproperties.sql
15:42:29.763288 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UnProcessedQueueMessages.sql
15:42:29.765327 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCustomFields.sql
15:42:29.767382 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeschedules.sql
15:42:29.769431 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListings.sql
15:42:29.771538 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LogentriesBuffer.sql
15:42:29.773806 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
15:42:29.775847 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Languages.sql
15:42:29.777897 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Reports.sql
15:42:29.779979 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserAlerts.sql
15:42:29.782066 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Propertybags.sql
15:42:29.784967 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingQuestions.sql
15:42:29.787067 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingMedias.sql
15:42:29.789169 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feedbacks.sql
15:42:29.791294 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ExternalUserIDs.sql
15:42:29.793422 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listings.sql
15:42:29.796387 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaassetMetaData.sql
15:42:29.798568 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingOptions.sql
15:42:29.800675 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingLocations.sql
15:42:29.802796 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Siteproperties.sql
15:42:29.804855 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplates.sql
15:42:29.807159 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedCategoryMap.sql
15:42:29.809221 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentprovIDErs.sql
15:42:29.811307 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_States.sql
15:42:29.813342 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Increments.sql
15:42:29.815431 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ThReadTracking.sql
15:42:29.817699 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserOptOut.sql
15:42:29.819778 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Attributes.sql
15:42:29.821833 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingEnddttmAudit.sql
15:42:29.823892 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingMethods.sql
15:42:29.825997 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActions.sql
15:42:29.828345 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannerCategories.sql
15:42:29.830424 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logentries.sql
15:42:29.832512 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Properties.sql
15:42:29.834627 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BiddingTransactions.sql
15:42:29.836710 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Banners.sql
15:42:29.839063 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contents.sql
15:42:29.841114 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedUserMap.sql
15:42:29.843182 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SalesTaxRates.sql
15:42:29.845266 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Notifications.sql
15:42:29.847365 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeproperties.sql
15:42:29.849677 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
15:42:29.851762 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEventMedias.sql
15:42:29.853827 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEvents.sql
15:42:29.855920 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplates.sql
15:42:29.857985 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SubmittedListingPayment.sql
15:42:29.860315 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SysDiagrams.sql
15:42:29.862369 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Lots.sql
15:42:29.864436 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardTypes.sql
15:42:29.866494 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingdecorations.sql
15:42:29.868589 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_KeyTable.sql
15:42:29.870923 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Watches.sql
15:42:29.872958 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_StripeCustomers.sql
15:42:29.875049 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PropertybagItems.sql
15:42:29.877117 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Version.sql
15:42:29.879401 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserLogins.sql
15:42:29.881861 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userclaims.sql
15:42:29.883960 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logstats.sql
15:42:29.886029 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Customcurrencies.sql
15:42:29.888152 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActionproperties.sql
15:42:29.890208 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCount.sql
15:42:29.892525 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedregionMap.sql
15:42:29.894581 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_NewSalestoInvoice.sql
15:42:29.896664 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Offers.sql
15:42:29.898749 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Currencies.sql
15:42:29.900829 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListingTypes.sql
15:42:29.903145 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeMedia.sql
15:42:29.905186 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplatecontents.sql
15:42:29.907282 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentResponses.sql
15:42:29.909384 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFieldenums.sql
15:42:29.911501 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Decorations.sql
15:42:29.913831 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypes.sql
15:42:29.916084 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplatecontents.sql
15:42:29.918175 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
15:42:29.920325 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingComments.sql
15:42:29.922420 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contactus.sql
15:42:29.925085 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Model.sql
15:42:29.927171 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentConfigurationTable.sql
15:42:29.929230 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedListingsMap.sql
15:42:29.931292 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Eventproperties.sql
15:42:29.933338 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardsExtraInFormation.sql
15:42:29.935657 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannedUsers.sql
15:42:29.937745 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Invoice.sql
15:42:29.939822 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Media.sql
15:42:29.941895 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_MediaAssetMetaData.sql
15:42:29.944036 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Customer.sql
15:42:29.946337 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Car.sql
15:42:29.948690 [debug] [MainThread]: 1603: static parser failed on tmp/SZ_AH_Properties_Pivot_Full.sql
15:42:29.965264 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/SZ_AH_Properties_Pivot_Full.sql
15:42:29.967082 [debug] [MainThread]: 1699: static parser successfully parsed step8_4_FT/AH_Listings_FT.sql
15:42:29.969518 [debug] [MainThread]: 1603: static parser failed on step7_3/SZ_AH_AllProperties_One_Column.sql
15:42:29.976467 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_3/SZ_AH_AllProperties_One_Column.sql
15:42:29.977787 [debug] [MainThread]: 1699: static parser successfully parsed step7_3/SZ_AH_Properties_CustomFields_Lookup.sql
15:42:29.980271 [debug] [MainThread]: 1699: static parser successfully parsed step8_2_FT_stg/AH_Listings_FT_stg.sql
15:42:29.982571 [debug] [MainThread]: 1603: static parser failed on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
15:42:29.988000 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
15:42:29.989221 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldType.sql
15:42:29.991371 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldIDs.sql
15:42:29.993493 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UserLogins_Incr.sql
15:42:30.001241 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UserLogins_Incr.sql
15:42:30.002498 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_CreditCards_Incr.sql
15:42:30.006365 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_CreditCards_Incr.sql
15:42:30.007584 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_Logstats_Incr.sql
15:42:30.011435 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_Logstats_Incr.sql
15:42:30.012663 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
15:42:30.016506 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
15:42:30.017803 [debug] [MainThread]: 1603: static parser failed on step7_4/SZ_AH_Properties_Pivot.sql
15:42:30.025903 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_4/SZ_AH_Properties_Pivot.sql
15:42:30.027398 [debug] [MainThread]: 1699: static parser successfully parsed step8_1_DM/AH_Cars_DM.sql
15:42:30.031070 [debug] [MainThread]: 1699: static parser successfully parsed step8_3_FT_tmp/AH_Listings_FT_tmp.sql
15:42:30.033215 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingActions_FT_stg.sql
15:42:30.035323 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Watches_FT_stg.sql
15:42:30.037391 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Invoices_FT_stg.sql
15:42:30.039484 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_LineItems_FT_stg.sql
15:42:30.041730 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingPaymentCharge_FT_stg.sql
15:42:30.043788 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_SubmittedListingPayment_FT_stg.sql
15:42:30.045820 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_LineItems_FT_tmp.sql
15:42:30.047864 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_SubmittedListingPayment_FT_tmp.sql
15:42:30.049903 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Invoices_FT_tmp.sql
15:42:30.052159 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Watches_FT_tmp.sql
15:42:30.054211 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingActions_FT_tmp.sql
15:42:30.056312 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingPaymentCharge_FT_tmp.sql
15:42:30.058395 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Users_InterView.sql
15:42:30.060462 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannerCategories_InterView.sql
15:42:30.062741 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Events_InterView.sql
15:42:30.064777 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logstats_InterView.sql
15:42:30.066852 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Attributes_InterView.sql
15:42:30.068919 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserRoles_InterView.sql
15:42:30.071013 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Locations_InterView.sql
15:42:30.073317 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediavariations_InterView.sql
15:42:30.075399 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SalesTaxRates_InterView.sql
15:42:30.077445 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFieldenums_InterView.sql
15:42:30.079704 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedUserMap_InterView.sql
15:42:30.081901 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Increments_InterView.sql
15:42:30.084196 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Customcurrencies_InterView.sql
15:42:30.086232 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Lots_InterView.sql
15:42:30.088317 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contactus_InterView.sql
15:42:30.090350 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplates_InterView.sql
15:42:30.092417 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannedUsers_InterView.sql
15:42:30.094780 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userproperties_InterView.sql
15:42:30.096812 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCards_InterView.sql
15:42:30.098907 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Offers_InterView.sql
15:42:30.100950 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PropertybagItems_InterView.sql
15:42:30.103010 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActionproperties_InterView.sql
15:42:30.105278 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_States_InterView.sql
15:42:30.107352 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCustomFields_InterView.sql
15:42:30.109410 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingComments_InterView.sql
15:42:30.111496 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFields_InterView.sql
15:42:30.113541 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Version_InterView.sql
15:42:30.115978 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Categories_InterView.sql
15:42:30.118063 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaMetaData_InterView.sql
15:42:30.120157 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingsReserveHistory_InterView.sql
15:42:30.122205 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypes_InterView.sql
15:42:30.124284 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeFeeprovIDErs_InterView.sql
15:42:30.126584 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardsExtraInFormation_InterView.sql
15:42:30.128638 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentprovIDErs_InterView.sql
15:42:30.130712 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingLocations_InterView.sql
15:42:30.132763 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Banners_InterView.sql
15:42:30.134849 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Eventproperties_InterView.sql
15:42:30.137160 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingCommentsMedias_InterView.sql
15:42:30.139273 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Languages_InterView.sql
15:42:30.141330 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplatecontents_InterView.sql
15:42:30.143407 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feedbacks_InterView.sql
15:42:30.145460 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEvents_InterView.sql
15:42:30.147771 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SubmittedListingPayment_InterView.sql
15:42:30.149844 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEventMedias_InterView.sql
15:42:30.151920 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingQuestions_InterView.sql
15:42:30.153967 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingOptions_InterView.sql
15:42:30.156032 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contents_InterView.sql
15:42:30.158523 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedListingsMap_InterView.sql
15:42:30.160594 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Properties_InterView.sql
15:42:30.162688 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingdecorations_InterView.sql
15:42:30.164847 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeschedules_InterView.sql
15:42:30.166940 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedCategoryMap_InterView.sql
15:42:30.169317 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplates_InterView.sql
15:42:30.171465 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Reports_InterView.sql
15:42:30.173569 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardTypes_InterView.sql
15:42:30.175681 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserAlerts_InterView.sql
15:42:30.177731 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeMedia_InterView.sql
15:42:30.180076 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ExternalUserIDs_InterView.sql
15:42:30.182135 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ThReadTracking_InterView.sql
15:42:30.184255 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingMethods_InterView.sql
15:42:30.186352 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Invoices_InterView.sql
15:42:30.188424 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaassetMetaData_InterView.sql
15:42:30.190770 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Propertybags_InterView.sql
15:42:30.192815 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingPaymentCharge_InterView.sql
15:42:30.194912 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeproperties_InterView.sql
15:42:30.196971 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logentries_InterView.sql
15:42:30.199076 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listings_InterView.sql
15:42:30.201366 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Notifications_InterView.sql
15:42:30.203447 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActions_InterView.sql
15:42:30.205482 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_KeyTable_InterView.sql
15:42:30.207567 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Watches_InterView.sql
15:42:30.209603 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Siteproperties_InterView.sql
15:42:30.211896 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserOptOut_InterView.sql
15:42:30.213946 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BiddingTransactions_InterView.sql
15:42:30.216027 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SysDiagrams_InterView.sql
15:42:30.218076 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Tiers_InterView.sql
15:42:30.220141 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentConfigurationTable_InterView.sql
15:42:30.222386 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userclaims_InterView.sql
15:42:30.224451 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserLogins_InterView.sql
15:42:30.226506 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedregionMap_InterView.sql
15:42:30.228616 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Countries_InterView.sql
15:42:30.230724 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LineItems_InterView.sql
15:42:30.233051 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UnProcessedQueueMessages_InterView.sql
15:42:30.235119 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCount_InterView.sql
15:42:30.237170 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_StripeCustomers_InterView.sql
15:42:30.239280 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserMessages_InterView.sql
15:42:30.241362 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Decorations_InterView.sql
15:42:30.243719 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Model_InterView.sql
15:42:30.245804 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Addresses_InterView.sql
15:42:30.247901 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediaassets_InterView.sql
15:42:30.249980 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Roles_InterView.sql
15:42:30.252079 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_NewSalestoInvoice_InterView.sql
15:42:30.254375 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListingTypes_InterView.sql
15:42:30.256473 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ReListHistory_InterView.sql
15:42:30.258591 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingproperties_InterView.sql
15:42:30.260630 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeproperties_InterView.sql
15:42:30.262724 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Currencies_InterView.sql
15:42:30.265016 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingMedias_InterView.sql
15:42:30.267106 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Media_InterView.sql
15:42:30.269168 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingEnddttmAudit_InterView.sql
15:42:30.271294 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentResponses_InterView.sql
15:42:30.273357 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListings_InterView.sql
15:42:30.275651 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LogentriesBuffer_InterView.sql
15:42:30.277701 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_DailyhuntEmailSubscribers_InterView.sql
15:42:30.279955 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplatecontents_InterView.sql
15:42:30.282163 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Siteproperties_FinalView.sql
15:42:30.284255 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeschedules_FinalView.sql
15:42:30.286802 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Properties_FinalView.sql
15:42:30.288866 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logentries_FinalView.sql
15:42:30.290953 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userclaims_FinalView.sql
15:42:30.293025 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserOptOut_FinalView.sql
15:42:30.295147 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardTypes_FinalView.sql
15:42:30.297484 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_KeyTable_FinalView.sql
15:42:30.299580 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Invoices_FinalView.sql
15:42:30.301652 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LineItems_FinalView.sql
15:42:30.303806 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Propertybags_FinalView.sql
15:42:30.305865 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contactus_FinalView.sql
15:42:30.308220 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Currencies_FinalView.sql
15:42:30.310282 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Users_FinalView.sql
15:42:30.312371 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserMessages_FinalView.sql
15:42:30.314437 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Addresses_FinalView.sql
15:42:30.316529 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingdecorations_FinalView.sql
15:42:30.318854 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Roles_FinalView.sql
15:42:30.320895 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Watches_FinalView.sql
15:42:30.322995 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeMedia_FinalView.sql
15:42:30.325046 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentResponses_FinalView.sql
15:42:30.327136 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SubmittedListingPayment_FinalView.sql
15:42:30.329420 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ExternalUserIDs_FinalView.sql
15:42:30.331514 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SalesTaxRates_FinalView.sql
15:42:30.333564 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserLogins_FinalView.sql
15:42:30.335659 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFields_FinalView.sql
15:42:30.337716 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BiddingTransactions_FinalView.sql
15:42:30.340027 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplates_FinalView.sql
15:42:30.342053 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedregionMap_FinalView.sql
15:42:30.344165 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannerCategories_FinalView.sql
15:42:30.346218 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActions_FinalView.sql
15:42:30.348364 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingOptions_FinalView.sql
15:42:30.350643 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contents_FinalView.sql
15:42:30.352701 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActionproperties_FinalView.sql
15:42:30.354817 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ReListHistory_FinalView.sql
15:42:30.356905 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingMethods_FinalView.sql
15:42:30.359021 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Offers_FinalView.sql
15:42:30.361303 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFieldenums_FinalView.sql
15:42:30.363363 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplatecontents_FinalView.sql
15:42:30.365434 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediavariations_FinalView.sql
15:42:30.367525 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListingTypes_FinalView.sql
15:42:30.369596 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCustomFields_FinalView.sql
15:42:30.371918 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingPaymentCharge_FinalView.sql
15:42:30.373957 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userproperties_FinalView.sql
15:42:30.376008 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeproperties_FinalView.sql
15:42:30.378038 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedCategoryMap_FinalView.sql
15:42:30.380114 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeFeeprovIDErs_FinalView.sql
15:42:30.382345 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingEnddttmAudit_FinalView.sql
15:42:30.384381 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaassetMetaData_FinalView.sql
15:42:30.386411 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listings_FinalView.sql
15:42:30.388464 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediaassets_FinalView.sql
15:42:30.390508 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Media_FinalView.sql
15:42:30.392798 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEvents_FinalView.sql
15:42:30.394892 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Locations_FinalView.sql
15:42:30.396913 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCount_FinalView.sql
15:42:30.398972 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingLocations_FinalView.sql
15:42:30.401022 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplatecontents_FinalView.sql
15:42:30.403279 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingQuestions_FinalView.sql
15:42:30.405293 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListings_FinalView.sql
15:42:30.407358 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feedbacks_FinalView.sql
15:42:30.409401 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Lots_FinalView.sql
15:42:30.412348 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplates_FinalView.sql
15:42:30.416417 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Reports_FinalView.sql
15:42:30.418468 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Countries_FinalView.sql
15:42:30.420529 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Eventproperties_FinalView.sql
15:42:30.425861 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingCommentsMedias_FinalView.sql
15:42:30.428040 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_States_FinalView.sql
15:42:30.430353 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentConfigurationTable_FinalView.sql
15:42:30.432424 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SysDiagrams_FinalView.sql
15:42:30.434458 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserRoles_FinalView.sql
15:42:30.436522 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEventMedias_FinalView.sql
15:42:30.438580 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingproperties_FinalView.sql
15:42:30.440824 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserAlerts_FinalView.sql
15:42:30.442873 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeproperties_FinalView.sql
15:42:30.444887 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardsExtraInFormation_FinalView.sql
15:42:30.446958 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_NewSalestoInvoice_FinalView.sql
15:42:30.449036 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Customcurrencies_FinalView.sql
15:42:30.451294 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_DailyhuntEmailSubscribers_FinalView.sql
15:42:30.453308 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Events_FinalView.sql
15:42:30.455351 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedListingsMap_FinalView.sql
15:42:30.457378 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannedUsers_FinalView.sql
15:42:30.459478 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaMetaData_FinalView.sql
15:42:30.461726 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Notifications_FinalView.sql
15:42:30.463811 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingsReserveHistory_FinalView.sql
15:42:30.465900 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Decorations_FinalView.sql
15:42:30.468089 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Attributes_FinalView.sql
15:42:30.470465 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Tiers_FinalView.sql
15:42:30.472777 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Model_FinalView.sql
15:42:30.474847 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentprovIDErs_FinalView.sql
15:42:30.476896 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingMedias_FinalView.sql
15:42:30.479116 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedUserMap_FinalView.sql
15:42:30.481359 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingComments_FinalView.sql
15:42:30.483686 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logstats_FinalView.sql
15:42:30.485729 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UnProcessedQueueMessages_FinalView.sql
15:42:30.487803 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ThReadTracking_FinalView.sql
15:42:30.489852 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PropertybagItems_FinalView.sql
15:42:30.491954 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCards_FinalView.sql
15:42:30.494178 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Version_FinalView.sql
15:42:30.496236 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LogentriesBuffer_FinalView.sql
15:42:30.498294 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypes_FinalView.sql
15:42:30.500339 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Increments_FinalView.sql
15:42:30.502382 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Categories_FinalView.sql
15:42:30.504638 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Banners_FinalView.sql
15:42:30.506678 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Languages_FinalView.sql
15:42:30.508713 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_StripeCustomers_FinalView.sql
15:42:30.510771 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingPaymentCharge_FT.sql
15:42:30.512837 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Watches_FT.sql
15:42:30.515153 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_LineItems_FT.sql
15:42:30.517266 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Invoice_FT.sql
15:42:30.519360 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingActions_FT.sql
15:42:30.521402 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_SubmittedListingPayment_FT.sql
15:42:30.523477 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Currencies_DM.sql
15:42:30.525731 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_ShippingOptions_DM.sql
15:42:30.527889 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Buyers_DM.sql
15:42:30.529943 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Categories_DM.sql
15:42:30.532046 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Consignors_DM.sql
15:42:31.126891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4f70d90>]}
15:42:31.176278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5e4f703d0>]}
15:42:31.176808 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:42:31.185066 [info ] [MainThread]: 
15:42:31.185883 [debug] [MainThread]: Acquiring new synapse connection "master"
15:42:31.187240 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:42:31.192733 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:42:31.193024 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:42:31.193199 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:42:31.193389 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:31.492943 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:31.530771 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:42:31.532649 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:42:31.563583 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:42:31.569718 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:42:31.570146 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:42:31.572224 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:42:31.572460 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:42:31.572621 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:42:31.572799 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:31.570612 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:42:31.574432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:42:31.574687 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:31.576081 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:42:31.577969 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:42:31.578185 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:42:31.578341 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:42:31.578509 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:31.669604 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:31.671054 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:31.697734 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:31.734236 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:42:31.736364 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:42:31.736669 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:42:31.743192 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:42:31.745327 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:42:31.745594 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:42:31.778141 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:42:31.869286 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:42:31.869780 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:42:41.359147 [debug] [MainThread]: On master: COMMIT
15:42:41.359876 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:42:41.360259 [info ] [MainThread]: 
15:42:41.363408 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCards_Incr
15:42:41.364077 [info ] [Thread-1  ]: 1 of 4 START incremental model dbo_stg.AH_CreditCards_Incr...................... [RUN]
15:42:41.364589 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards_Incr"
15:42:41.364788 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCards_Incr
15:42:41.364970 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCards_Incr
15:42:41.363726 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages_Incr
15:42:41.370499 [info ] [Thread-3  ]: 3 of 4 START incremental model dbo_stg.AH_UnProcessedQueueMessages_Incr......... [RUN]
15:42:41.371200 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr"
15:42:41.363805 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserLogins_Incr
15:42:41.371670 [info ] [Thread-4  ]: 4 of 4 START incremental model dbo_stg.AH_UserLogins_Incr....................... [RUN]
15:42:41.372119 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins_Incr"
15:42:41.372306 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserLogins_Incr
15:42:41.372468 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserLogins_Incr
15:42:41.363631 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logstats_Incr
15:42:41.375915 [info ] [Thread-2  ]: 2 of 4 START incremental model dbo_stg.AH_Logstats_Incr......................... [RUN]
15:42:41.376372 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats_Incr"
15:42:41.376556 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logstats_Incr
15:42:41.376713 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logstats_Incr
15:42:41.371412 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages_Incr
15:42:41.379720 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages_Incr
15:42:41.385054 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards_Incr"
15:42:41.392386 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logstats_Incr"
15:42:41.393181 [debug] [Thread-1  ]: finished collecting timing info
15:42:41.393504 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCards_Incr
15:42:41.387740 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins_Incr"
15:42:41.390193 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
15:42:41.400428 [debug] [Thread-3  ]: finished collecting timing info
15:42:41.400741 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages_Incr
15:42:41.399876 [debug] [Thread-2  ]: finished collecting timing info
15:42:41.427806 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logstats_Incr
15:42:41.400617 [debug] [Thread-4  ]: finished collecting timing info
15:42:41.440215 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserLogins_Incr
15:42:41.512736 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:41.515188 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  
  if object_id ('"dbo_stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."#AH_UserLogins_Incr__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."#AH_UserLogins_Incr__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_UserLogins_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([LoginprovIDEr], [ProvIDErKey], Cast([UserID] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UserLogins_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."dbo_stg"."AH_UserLogins_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "dbo_stg"."#AH_UserLogins_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_UserLogins_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end



  
15:42:41.515373 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:42:41.515551 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:41.514871 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:41.517141 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  
  if object_id ('"dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([QueueName], [QueueData], Cast([QueueOrder] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UnProcessedQueueMessages_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."dbo_stg"."AH_UnProcessedQueueMessages_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "dbo_stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end



  
15:42:41.517360 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:42:41.519041 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:41.513984 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:41.520306 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  
  if object_id ('"dbo_stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."#AH_Logstats_Incr__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."#AH_Logstats_Incr__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Logstats_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([FromDate] as varchar), Cast([RangeMinutes] as varchar), Cast([EntryCount] as varchar), Cast([IsArchived] as varchar), [Severity])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_Logstats_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."dbo_stg"."AH_Logstats_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "dbo_stg"."#AH_Logstats_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Logstats_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end



  
15:42:41.520486 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:42:41.520655 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:41.522433 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:42:41.522678 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  
  if object_id ('"dbo_stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."#AH_CreditCards_Incr__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."#AH_CreditCards_Incr__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_CreditCards_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([ID] as varchar), [ExpirationMonth], [ExpirationYear], Cast([CreditCardTypeID] as varchar), Cast([UserID] as varchar), Cast([AddressID] as varchar), Cast([CreatedOn] as varchar), Cast([UpdatedOn] as varchar), Cast([DeletedOn] as varchar), [CardNumber], [LastUpdatedUser], [LastFourdigits], [Description])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at,
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_CreditCards_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."dbo_stg"."AH_CreditCards_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "dbo_stg"."#AH_CreditCards_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_CreditCards_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end



  
15:42:41.522854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:42:41.523029 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:42:41.637586 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:41.648047 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:41.648540 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:41.649099 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:42:47.238133 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.72 seconds
15:42:47.253439 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:47.253874 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:42:47.271134 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.76 seconds
15:42:47.275046 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:47.275389 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"dbo_stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:42:47.307784 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:42:47.309476 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:47.309792 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."dbo_stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    
15:42:47.316989 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:42:47.318479 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:47.318770 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."dbo_stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."dbo_stg"."#AH_UserLogins_Incr__dbt_tmp"
    
15:42:48.189752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.67 seconds
15:42:48.193593 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:48.193829 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"dbo_stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:42:48.242143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:42:48.243892 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:48.244186 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."dbo_stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."dbo_stg"."#AH_Logstats_Incr__dbt_tmp"
    
15:42:49.203046 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
15:42:49.204701 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:49.204892 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'dbo_stg'
  
15:42:49.232712 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
15:42:49.234734 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:49.234951 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'dbo_stg'
  
15:42:49.321652 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:42:49.323388 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:42:49.327851 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:49.328663 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:49.329118 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"dbo_stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:42:49.328939 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:42:49.512143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
15:42:49.513840 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:49.514044 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'dbo_stg'
  
15:42:49.603039 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:42:49.606029 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:49.606250 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'dbo_stg'
  
15:42:49.625064 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:42:49.627600 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:49.627915 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"dbo_stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:42:49.682611 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:42:49.691631 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:49.692018 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'dbo_stg'
  
15:42:49.706722 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:42:49.711132 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:49.711803 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'dbo_stg'
  
15:42:49.742644 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:42:49.756163 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
15:42:49.757236 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
15:42:49.757474 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
      
      
      delete from "BJAC_DW_PROD"."dbo_stg"."AH_UnProcessedQueueMessages_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."dbo_stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."dbo_stg"."AH_UnProcessedQueueMessages_Incr" ("QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."dbo_stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          )


  
15:42:49.789910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:42:49.793460 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:49.793784 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'dbo_stg'
  
15:42:49.832516 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:42:49.835596 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins_Incr"
15:42:49.836292 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
15:42:49.836516 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
      
      
      delete from "BJAC_DW_PROD"."dbo_stg"."AH_UserLogins_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."dbo_stg"."#AH_UserLogins_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."dbo_stg"."AH_UserLogins_Incr" ("LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."dbo_stg"."#AH_UserLogins_Incr__dbt_tmp"
          )


  
15:42:49.880878 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:42:49.883937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:49.884258 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'dbo_stg'
  
15:42:49.963094 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:42:49.967022 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:49.967331 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'dbo_stg'
  
15:42:50.000564 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:42:50.003777 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats_Incr"
15:42:50.004414 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
15:42:50.004619 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
      
      
      delete from "BJAC_DW_PROD"."dbo_stg"."AH_Logstats_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."dbo_stg"."#AH_Logstats_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."dbo_stg"."AH_Logstats_Incr" ("FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."dbo_stg"."#AH_Logstats_Incr__dbt_tmp"
          )


  
15:42:51.651025 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
15:42:51.658949 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: COMMIT
15:42:51.667328 [debug] [Thread-3  ]: finished collecting timing info
15:42:51.667750 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: Close
15:42:51.668521 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dc7c31c0>]}
15:42:51.669045 [info ] [Thread-3  ]: 3 of 4 OK created incremental model dbo_stg.AH_UnProcessedQueueMessages_Incr.... [[32mOK[0m in 10.30s]
15:42:51.669483 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages_Incr
15:42:52.136437 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.30 seconds
15:42:52.137792 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
15:42:52.139201 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: COMMIT
15:42:52.148442 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: COMMIT
15:42:52.149674 [debug] [Thread-2  ]: finished collecting timing info
15:42:52.157048 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: Close
15:42:52.157825 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de818fa0>]}
15:42:52.158329 [info ] [Thread-2  ]: 2 of 4 OK created incremental model dbo_stg.AH_Logstats_Incr.................... [[32mOK[0m in 10.78s]
15:42:52.158781 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logstats_Incr
15:42:52.156640 [debug] [Thread-4  ]: finished collecting timing info
15:42:52.159195 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: Close
15:42:52.159822 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dc6b9520>]}
15:42:52.160239 [info ] [Thread-4  ]: 4 of 4 OK created incremental model dbo_stg.AH_UserLogins_Incr.................. [[32mOK[0m in 10.79s]
15:42:52.160607 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserLogins_Incr
15:43:00.816716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 19.29 seconds
15:43:00.820296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:00.820491 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"dbo_stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:00.861144 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:00.863113 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:00.863407 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."dbo_stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."dbo_stg"."#AH_CreditCards_Incr__dbt_tmp"
    
15:43:01.779406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:43:01.781138 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:01.781337 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'dbo_stg'
  
15:43:01.861753 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:01.864293 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:01.864477 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"dbo_stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "dbo_stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:02.141699 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:43:02.144647 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:02.144848 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'dbo_stg'
  
15:43:02.215332 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:02.219035 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:02.219258 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'dbo_stg'
  
15:43:02.260618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:02.264066 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards_Incr"
15:43:02.264593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
15:43:02.264750 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
      
      
      delete from "BJAC_DW_PROD"."dbo_stg"."AH_CreditCards_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."dbo_stg"."#AH_CreditCards_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."dbo_stg"."AH_CreditCards_Incr" ("ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."dbo_stg"."#AH_CreditCards_Incr__dbt_tmp"
          )


  
15:43:03.824324 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
15:43:03.826178 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: COMMIT
15:43:03.834331 [debug] [Thread-1  ]: finished collecting timing info
15:43:03.834652 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: Close
15:43:03.835362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56068c2b-d65d-4a7b-b469-31dfd861eae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dc6c0f70>]}
15:43:03.835821 [info ] [Thread-1  ]: 1 of 4 OK created incremental model dbo_stg.AH_CreditCards_Incr................. [[32mOK[0m in 22.47s]
15:43:03.836230 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCards_Incr
15:43:03.837689 [debug] [MainThread]: Acquiring new synapse connection "master"
15:43:03.838028 [debug] [MainThread]: On master: COMMIT
15:43:03.838414 [info ] [MainThread]: 
15:43:03.838753 [info ] [MainThread]: Finished running 4 incremental models in 32.65s.
15:43:03.838999 [debug] [MainThread]: Connection 'master' was properly closed.
15:43:03.839142 [debug] [MainThread]: Connection 'model.Shawn.AH_UnProcessedQueueMessages_Incr' was properly closed.
15:43:03.839277 [debug] [MainThread]: Connection 'model.Shawn.AH_Logstats_Incr' was properly closed.
15:43:03.839406 [debug] [MainThread]: Connection 'model.Shawn.AH_CreditCards_Incr' was properly closed.
15:43:03.839535 [debug] [MainThread]: Connection 'model.Shawn.AH_UserLogins_Incr' was properly closed.
15:43:03.869472 [info ] [MainThread]: 
15:43:03.869893 [info ] [MainThread]: [32mCompleted successfully[0m
15:43:03.870238 [info ] [MainThread]: 
15:43:03.870474 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
15:43:03.870863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de818df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5de818b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dc7140d0>]}


============================== 2022-09-16 15:43:06.223408 | 9c9f1217-2476-4c86-99fa-8da9670fcab7 ==============================
15:43:06.223408 [info ] [MainThread]: Running with dbt=1.0.0
15:43:06.226891 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='snapshot', write_json=None)
15:43:06.227210 [debug] [MainThread]: Tracking: tracking
15:43:06.227584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3778b3cf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3778b3cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3778b3cbb0>]}
15:43:06.433293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:43:06.433775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:43:06.460311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3778a68ca0>]}
15:43:06.509781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377849cb50>]}
15:43:06.510399 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:43:06.523387 [info ] [MainThread]: 
15:43:06.524177 [debug] [MainThread]: Acquiring new synapse connection "master"
15:43:06.529785 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:43:06.544738 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:43:06.545108 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:43:06.545297 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:43:06.545489 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:06.805644 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:06.839043 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:43:06.840873 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:43:06.861860 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:43:06.867806 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:43:06.868187 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:43:06.870078 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:43:06.870297 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:43:06.870473 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:43:06.870669 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:06.868584 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:43:06.872800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:43:06.873006 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:06.874250 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:43:06.876112 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:43:06.876331 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:43:06.876488 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:43:06.876651 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:06.969484 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:06.982902 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:06.985089 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:07.031097 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:43:07.033425 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:43:07.033738 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:43:07.042764 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:43:07.043540 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:43:07.045135 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:43:07.045356 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:43:07.179375 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:43:07.179930 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:43:16.423438 [debug] [MainThread]: On master: COMMIT
15:43:16.424203 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:43:16.424608 [info ] [MainThread]: 
15:43:16.429647 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Addresses_Incr
15:43:16.430331 [info ] [Thread-1  ]: 1 of 101 START snapshot stg.AH_Addresses_Incr................................... [RUN]
15:43:16.429970 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_AuctionEventMedias_Incr
15:43:16.431213 [info ] [Thread-3  ]: 3 of 101 START snapshot stg.AH_AuctionEventMedias_Incr.......................... [RUN]
15:43:16.431660 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr"
15:43:16.431858 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_AuctionEventMedias_Incr
15:43:16.432045 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_AuctionEventMedias_Incr
15:43:16.429874 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Attributes_Incr
15:43:16.435557 [info ] [Thread-2  ]: 2 of 101 START snapshot stg.AH_Attributes_Incr.................................. [RUN]
15:43:16.436008 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Attributes_Incr"
15:43:16.436197 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Attributes_Incr
15:43:16.436361 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Attributes_Incr
15:43:16.430052 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_AuctionEvents_Incr
15:43:16.439491 [info ] [Thread-4  ]: 4 of 101 START snapshot stg.AH_AuctionEvents_Incr............................... [RUN]
15:43:16.439961 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr"
15:43:16.440154 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_AuctionEvents_Incr
15:43:16.440316 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_AuctionEvents_Incr
15:43:16.430900 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Addresses_Incr"
15:43:16.443206 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Addresses_Incr
15:43:16.443377 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Addresses_Incr
15:43:16.445798 [debug] [Thread-1  ]: finished collecting timing info
15:43:16.446032 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Addresses_Incr
15:43:16.439172 [debug] [Thread-2  ]: finished collecting timing info
15:43:16.451809 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Attributes_Incr
15:43:16.442975 [debug] [Thread-4  ]: finished collecting timing info
15:43:16.480928 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_AuctionEvents_Incr
15:43:16.435238 [debug] [Thread-3  ]: finished collecting timing info
15:43:16.493952 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_AuctionEventMedias_Incr
15:43:16.497186 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:16.493659 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:16.497598 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:16.497753 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:43:16.497922 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:16.492256 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:16.499431 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:16.499614 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:43:16.499806 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:16.489589 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:16.500754 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:16.500930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:43:16.501099 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:16.497428 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:16.502185 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:43:16.502406 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:16.602860 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:16.603513 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:16.607033 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:16.623987 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:16.634332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:43:16.634807 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:43:16.643938 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:43:16.654439 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:43:16.774637 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:16.790444 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:16.779970 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:16.790920 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:16.777076 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:16.791270 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:16.789725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:16.791590 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:16.819874 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:43:16.820296 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:43:16.820463 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:43:16.845491 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:16.845785 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Attributes_InterView]
        ) as __dbt_sbq
    
15:43:16.827705 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:16.847363 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:16.847589 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]
        ) as __dbt_sbq
    
15:43:16.843777 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:16.847940 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Addresses_InterView]
        ) as __dbt_sbq
    
15:43:16.842242 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:16.848299 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEvents_InterView]
        ) as __dbt_sbq
    
15:43:16.919375 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:16.927831 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:16.928208 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:16.928396 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:16.958442 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:16.998318 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        ) as __dbt_sbq
    
15:43:16.975507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:16.998771 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        ) as __dbt_sbq
    
15:43:16.997963 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:16.999131 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        ) as __dbt_sbq
    
15:43:17.010591 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:17.010975 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        ) as __dbt_sbq
    
15:43:17.046997 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:17.047955 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:17.066840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:17.068050 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:17.068600 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
15:43:17.068400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
15:43:17.125953 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:43:17.129665 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:17.129982 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
15:43:17.143571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:17.159480 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:17.182535 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:17.187077 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEvents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834''), CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end



    
15:43:17.186669 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:17.187757 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834''), CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end



    
15:43:17.201922 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:17.205385 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:17.205759 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Attributes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Attributes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834''), CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Attributes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Attributes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end



    
15:43:17.271987 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:43:17.275986 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:17.276349 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
15:43:17.346912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:17.351054 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:17.351392 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Addresses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Addresses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834''), CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:16.809834'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Addresses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Addresses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end



    
15:43:23.969769 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.78 seconds
15:43:23.977294 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:23.977679 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:24.015261 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:24.016987 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:24.017286 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
15:43:25.601234 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.40 seconds
15:43:25.604755 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:25.605020 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:25.642475 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:25.644203 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:25.644502 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
15:43:25.674048 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
15:43:25.675886 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:25.676196 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:25.751603 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:25.754375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:25.754750 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:26.270025 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
15:43:26.273090 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:26.273288 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
15:43:26.502671 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:43:26.507434 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:26.507779 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:26.548526 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:26.550313 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:26.550664 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
15:43:26.623286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
15:43:26.624916 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:26.625206 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:26.708143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:26.710962 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:26.711198 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:27.152815 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
15:43:27.155796 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:27.156030 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
15:43:27.299806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:43:27.304344 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:27.304688 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:27.494216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:43:27.496003 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:27.496239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
15:43:27.902847 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
15:43:27.904381 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:27.904569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:27.990865 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:27.993811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:27.994038 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:28.235429 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:43:28.238709 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:28.238953 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
15:43:28.311835 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:28.322007 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:28.322410 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:28.373948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:28.376332 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:28.376640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
15:43:28.469168 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:43:28.470869 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:28.471075 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:28.582715 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:43:28.585551 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:28.585772 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:29.446664 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
15:43:29.449869 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:29.450162 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
15:43:29.538253 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:29.544138 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:29.544465 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:29.581988 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:29.583954 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:29.584261 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
15:43:29.755586 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:43:29.757200 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:29.757404 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:30.049318 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:43:30.051933 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:30.052179 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:30.690931 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
15:43:30.696983 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEventMedias_Incr"
15:43:30.697863 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:30.698111 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:43:31.324004 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
15:43:31.325672 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:31.325876 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:31.428411 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:43:31.431437 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:31.431648 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:31.824889 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:43:31.827114 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Attributes_Incr"
15:43:31.827543 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:31.827681 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Attributes_Incr" (
                  "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:43:32.249343 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
15:43:32.256591 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: COMMIT
15:43:32.259623 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
15:43:32.259880 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end

15:43:32.345769 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:32.355683 [debug] [Thread-3  ]: finished collecting timing info
15:43:32.356086 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: Close
15:43:32.356844 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774740e80>]}
15:43:32.357390 [info ] [Thread-3  ]: 3 of 101 OK snapshotted stg.AH_AuctionEventMedias_Incr.......................... [[32mOK[0m in 15.93s]
15:43:32.357831 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_AuctionEventMedias_Incr
15:43:32.358059 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_BannedUsers_Incr
15:43:32.358525 [info ] [Thread-3  ]: 5 of 101 START snapshot stg.AH_BannedUsers_Incr................................. [RUN]
15:43:32.359045 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannedUsers_Incr"
15:43:32.359233 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_BannedUsers_Incr
15:43:32.359403 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_BannedUsers_Incr
15:43:32.362165 [debug] [Thread-3  ]: finished collecting timing info
15:43:32.362397 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_BannedUsers_Incr
15:43:32.365084 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:32.365302 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:32.365463 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:43:32.365633 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:32.497714 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:32.538604 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:43:32.561537 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:32.561998 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:32.609023 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:32.611668 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:32.611956 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannedUsers_InterView]
        ) as __dbt_sbq
    
15:43:32.748942 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:43:32.771111 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:32.771569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        ) as __dbt_sbq
    
15:43:33.167929 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:43:33.171556 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:33.171784 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
15:43:33.260820 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:33.264914 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:33.265148 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannedUsers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannedUsers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339''), CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:32.591339'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannedUsers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end



    
15:43:33.466560 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.64 seconds
15:43:33.468351 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: COMMIT
15:43:33.469172 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
15:43:33.469336 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end

15:43:33.506693 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:33.586911 [debug] [Thread-2  ]: finished collecting timing info
15:43:33.587669 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: Close
15:43:33.588461 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603eb80>]}
15:43:33.588978 [info ] [Thread-2  ]: 2 of 101 OK snapshotted stg.AH_Attributes_Incr.................................. [[32mOK[0m in 17.15s]
15:43:33.589428 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Attributes_Incr
15:43:33.589645 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BannerCategories_Incr
15:43:33.590080 [info ] [Thread-2  ]: 6 of 101 START snapshot stg.AH_BannerCategories_Incr............................ [RUN]
15:43:33.590595 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannerCategories_Incr"
15:43:33.590793 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BannerCategories_Incr
15:43:33.590965 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BannerCategories_Incr
15:43:33.593854 [debug] [Thread-2  ]: finished collecting timing info
15:43:33.594085 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BannerCategories_Incr
15:43:33.597836 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:33.598060 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:33.598227 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:43:33.598401 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:33.714213 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:33.759839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:43:33.782819 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:33.783301 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:33.835974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:33.838371 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:33.838838 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannerCategories_InterView]
        ) as __dbt_sbq
    
15:43:34.024430 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:43:34.046154 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:34.046658 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        ) as __dbt_sbq
    
15:43:34.098256 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:34.102634 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:34.102917 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
15:43:34.224511 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:43:34.228276 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:34.228532 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannerCategories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannerCategories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738''), CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:33.825738'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannerCategories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end



    
15:43:37.591380 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 20.24 seconds
15:43:37.595135 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:37.595381 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:37.642912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:37.645590 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:37.645931 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
15:43:38.863033 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
15:43:38.864654 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:38.864858 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:38.973157 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:43:38.975765 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:38.975963 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:39.243299 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:43:39.246484 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:39.247004 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
15:43:39.350993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:43:39.355978 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:39.356428 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:39.394682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:39.396453 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:39.396826 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
15:43:40.686766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.42 seconds
15:43:40.690314 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:40.690777 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:40.734213 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:40.735679 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.51 seconds
15:43:40.738898 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:40.739621 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:40.739452 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:40.740005 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
15:43:40.780290 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:40.781996 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:40.782299 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
15:43:41.331653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.93 seconds
15:43:41.333311 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:41.333520 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:41.418255 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:41.420846 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:41.421050 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:42.325933 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
15:43:42.329097 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:42.329343 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
15:43:42.402602 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:42.408027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:42.408404 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:42.445906 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:42.447687 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:42.448013 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
15:43:42.652332 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.91 seconds
15:43:42.654263 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:42.654490 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:42.751282 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:43:42.753701 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:42.753927 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:42.932984 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.15 seconds
15:43:42.934996 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:42.935194 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:42.991437 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:43:42.994339 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:42.994837 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
15:43:43.028510 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:43.031161 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:43.031429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:43.086770 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:43.091125 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:43.091485 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:43.128750 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:43.130373 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:43.130683 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
15:43:43.284924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:43:43.288021 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:43.288313 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
15:43:43.383468 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:43.388008 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:43.388360 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:43.439835 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:43.441369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:43.441584 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
15:43:44.135943 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
15:43:44.137605 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:44.137830 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:44.173771 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:44.176662 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:44.176907 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:44.764893 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
15:43:44.767420 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Addresses_Incr"
15:43:44.768135 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:44.768305 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Addresses_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:43:44.866615 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
15:43:44.868134 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:44.868333 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:44.903588 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:44.906050 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:44.906241 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:45.112380 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
15:43:45.116412 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:45.116689 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:45.160847 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:45.163788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:45.164251 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:45.235820 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:43:45.240077 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:45.240529 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
15:43:45.280727 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:45.285298 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:45.285702 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:45.325188 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:45.326988 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:45.327344 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
15:43:45.432358 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 28.24 seconds
15:43:45.435986 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:45.436272 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:45.451276 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:43:45.454214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:45.454638 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
15:43:45.478252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:45.480067 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:45.480448 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
15:43:45.495867 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:45.500264 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:45.500686 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:45.560615 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:43:45.562500 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:45.562892 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
15:43:46.721543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
15:43:46.723246 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: COMMIT
15:43:46.723996 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
15:43:46.724140 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end

15:43:46.762942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:46.773834 [debug] [Thread-1  ]: finished collecting timing info
15:43:46.774321 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: Close
15:43:46.775154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774681880>]}
15:43:46.775730 [info ] [Thread-1  ]: 1 of 101 OK snapshotted stg.AH_Addresses_Incr................................... [[32mOK[0m in 30.34s]
15:43:46.776197 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Addresses_Incr
15:43:46.776427 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Banners_Incr
15:43:46.776885 [info ] [Thread-1  ]: 7 of 101 START snapshot stg.AH_Banners_Incr..................................... [RUN]
15:43:46.777375 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Banners_Incr"
15:43:46.777567 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Banners_Incr
15:43:46.777758 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Banners_Incr
15:43:46.780689 [debug] [Thread-1  ]: finished collecting timing info
15:43:46.780987 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Banners_Incr
15:43:46.783949 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:46.784178 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:46.784339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:43:46.784514 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:46.871457 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
15:43:46.873432 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:46.873833 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:46.877716 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
15:43:46.879248 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:46.879516 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:46.903152 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:46.913367 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:46.916210 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:46.916634 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:46.920873 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:46.924277 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:46.925139 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:46.934197 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:43:46.935889 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
15:43:46.937150 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:46.937383 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:46.958409 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:46.958904 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:46.987214 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:43:46.989774 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:46.990146 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Banners_InterView]
        ) as __dbt_sbq
    
15:43:47.018315 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:47.022041 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:47.022444 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:47.056007 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:47.078033 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:47.078522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        ) as __dbt_sbq
    
15:43:47.149895 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:47.154982 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:47.155733 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
15:43:47.241848 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:43:47.243941 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannedUsers_Incr"
15:43:47.244611 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:47.244761 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr" (
                  "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:43:47.249762 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:47.251576 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:43:47.253342 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannerCategories_Incr"
15:43:47.253939 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:47.254146 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:43:47.256118 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:47.256351 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Banners_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Banners_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211''), CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:46.982211'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Banners_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Banners_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end



    
15:43:47.294291 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:43:47.298117 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:47.298590 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
15:43:47.368585 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:47.373762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:47.374201 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:47.410770 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:47.412353 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:47.412562 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
15:43:48.916779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
15:43:48.918510 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannedUsers_Incr: COMMIT
15:43:48.919353 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
15:43:48.919511 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end

15:43:48.967007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:48.980425 [debug] [Thread-3  ]: finished collecting timing info
15:43:48.980950 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannedUsers_Incr: Close
15:43:48.981799 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377472a670>]}
15:43:48.982394 [info ] [Thread-3  ]: 5 of 101 OK snapshotted stg.AH_BannedUsers_Incr................................. [[32mOK[0m in 16.62s]
15:43:48.982891 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_BannedUsers_Incr
15:43:48.983120 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_BiddingTransactions_Incr
15:43:48.983593 [info ] [Thread-3  ]: 8 of 101 START snapshot stg.AH_BiddingTransactions_Incr......................... [RUN]
15:43:48.984138 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr"
15:43:48.984336 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_BiddingTransactions_Incr
15:43:48.984513 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_BiddingTransactions_Incr
15:43:48.987631 [debug] [Thread-3  ]: finished collecting timing info
15:43:48.987884 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_BiddingTransactions_Incr
15:43:48.991072 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:48.991321 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:48.991488 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:43:48.991672 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:49.109011 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:49.150170 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:43:49.165403 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.75 seconds
15:43:49.167083 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:49.167421 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:49.176356 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:49.176793 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:49.207473 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:43:49.210198 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:49.210599 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]
        ) as __dbt_sbq
    
15:43:49.214347 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:49.217395 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:49.217687 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:49.276752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
15:43:49.278638 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannerCategories_Incr: COMMIT
15:43:49.279596 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
15:43:49.279830 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end

15:43:49.287530 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:49.312455 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:49.312912 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        ) as __dbt_sbq
    
15:43:49.330191 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:49.342873 [debug] [Thread-2  ]: finished collecting timing info
15:43:49.343375 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannerCategories_Incr: Close
15:43:49.344208 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdf6d0>]}
15:43:49.344795 [info ] [Thread-2  ]: 6 of 101 OK snapshotted stg.AH_BannerCategories_Incr............................ [[32mOK[0m in 15.75s]
15:43:49.345258 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BannerCategories_Incr
15:43:49.345490 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Categories_Incr
15:43:49.345966 [info ] [Thread-2  ]: 9 of 101 START snapshot stg.AH_Categories_Incr.................................. [RUN]
15:43:49.346502 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Categories_Incr"
15:43:49.346743 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Categories_Incr
15:43:49.346925 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Categories_Incr
15:43:49.350017 [debug] [Thread-2  ]: finished collecting timing info
15:43:49.350265 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Categories_Incr
15:43:49.353438 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:43:49.353736 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:49.353908 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:43:49.354085 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:49.416652 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:43:49.420457 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:49.421089 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
15:43:49.458055 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:49.493996 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:43:49.517101 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:43:49.517427 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:43:49.521145 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:49.521518 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992''), CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.200992'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end



    
15:43:49.517754 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:49.577933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:43:49.580007 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:43:49.580233 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Categories_InterView]
        ) as __dbt_sbq
    
15:43:49.614805 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:43:49.617546 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:49.617785 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
15:43:49.647750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:49.670714 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:43:49.671202 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        ) as __dbt_sbq
    
15:43:49.692983 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:49.698436 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:49.698893 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:49.737119 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:49.738865 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:49.739172 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
15:43:49.772111 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:43:49.776405 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:43:49.776846 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
15:43:49.846906 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:43:49.850927 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:43:49.851335 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Categories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Categories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749''), CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:49.544749'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Categories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Categories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end



    
15:43:50.796344 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:43:50.797993 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:50.798202 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:50.834343 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:50.837818 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:50.838062 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:51.114692 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:43:51.117527 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEvents_Incr"
15:43:51.117970 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:51.118105 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr" (
                  "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:43:53.299843 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.18 seconds
15:43:53.301678 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: COMMIT
15:43:53.302586 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
15:43:53.302764 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end

15:43:53.362191 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:43:53.373053 [debug] [Thread-4  ]: finished collecting timing info
15:43:53.373531 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: Close
15:43:53.374373 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37746910d0>]}
15:43:53.374970 [info ] [Thread-4  ]: 4 of 101 OK snapshotted stg.AH_AuctionEvents_Incr............................... [[32mOK[0m in 36.93s]
15:43:53.375408 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_AuctionEvents_Incr
15:43:53.375628 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryCount_Incr
15:43:53.376080 [info ] [Thread-4  ]: 10 of 101 START snapshot stg.AH_CategoryCount_Incr.............................. [RUN]
15:43:53.376570 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCount_Incr"
15:43:53.376762 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryCount_Incr
15:43:53.376934 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryCount_Incr
15:43:53.381107 [debug] [Thread-4  ]: finished collecting timing info
15:43:53.381351 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryCount_Incr
15:43:53.384225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:53.384451 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:43:53.384613 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:43:53.384786 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:43:53.491957 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:43:53.580136 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:43:53.601887 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:53.602352 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:43:53.662918 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:43:53.664952 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:53.665185 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCount_InterView]
        ) as __dbt_sbq
    
15:43:53.744885 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:53.767329 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:53.767782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        ) as __dbt_sbq
    
15:43:53.940735 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:43:53.944216 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:53.944459 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
15:43:54.025648 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.77 seconds
15:43:54.028991 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:54.029241 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:54.029679 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:43:54.032795 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:54.033089 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCount_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCount_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937''), CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:43:53.622937'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCount_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end



    
15:43:54.066029 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:54.067803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:54.068128 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
15:43:55.093981 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
15:43:55.095672 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:55.095874 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:55.173479 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:55.175984 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:55.176224 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:55.417826 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:43:55.420990 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:55.421225 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
15:43:55.568660 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:43:55.572938 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:55.573223 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:55.615574 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:55.617213 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:55.617424 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
15:43:56.112337 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.59 seconds
15:43:56.115891 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:56.116167 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:56.195180 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:56.196699 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:56.196912 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
15:43:56.668996 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
15:43:56.670748 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:56.670983 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:56.785812 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:43:56.788304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:56.788521 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:57.037616 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:43:57.042030 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:57.042313 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
15:43:57.079466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:57.084079 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:57.084451 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:57.169463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:57.170999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:57.171210 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
15:43:57.246197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
15:43:57.247934 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:57.248137 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:57.363205 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:43:57.365825 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:57.366045 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:57.711287 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:43:57.714467 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:57.714890 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
15:43:57.794829 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:57.800087 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:57.800457 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:57.851596 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:43:57.853348 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:43:57.853660 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
15:43:58.503223 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.47 seconds
15:43:58.506900 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:58.507130 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:43:58.547025 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:43:58.548727 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:43:58.549023 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
15:43:58.695877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
15:43:58.697576 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:58.697780 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:43:58.775137 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:43:58.777690 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:43:58.777912 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:00.550419 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:44:00.552664 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Banners_Incr"
15:44:00.553185 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:44:00.553338 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Banners_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:01.405998 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.55 seconds
15:44:01.407678 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:01.407896 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:01.412172 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
15:44:01.414016 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:01.414226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:01.538731 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:44:01.541407 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:01.541678 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:01.582051 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:44:01.584743 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:01.585096 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:01.935056 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:44:01.938260 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:01.938491 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
15:44:01.990491 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
15:44:01.993403 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:01.993864 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
15:44:02.019686 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
15:44:02.022849 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: COMMIT
15:44:02.023265 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:02.024633 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
15:44:02.028880 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end

15:44:02.028570 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:02.030053 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:02.070811 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:02.079449 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:02.079850 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:02.084792 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:02.085077 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
15:44:02.089061 [debug] [Thread-1  ]: finished collecting timing info
15:44:02.083445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:02.089657 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:02.089445 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: Close
15:44:02.090628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdf550>]}
15:44:02.091177 [info ] [Thread-1  ]: 7 of 101 OK snapshotted stg.AH_Banners_Incr..................................... [[32mOK[0m in 15.31s]
15:44:02.091611 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Banners_Incr
15:44:02.091841 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CategoryCustomFields_Incr
15:44:02.092301 [info ] [Thread-1  ]: 11 of 101 START snapshot stg.AH_CategoryCustomFields_Incr....................... [RUN]
15:44:02.092811 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr"
15:44:02.093006 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CategoryCustomFields_Incr
15:44:02.093180 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CategoryCustomFields_Incr
15:44:02.096329 [debug] [Thread-1  ]: finished collecting timing info
15:44:02.096596 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CategoryCustomFields_Incr
15:44:02.099785 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:02.100049 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:02.100216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:44:02.100393 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:02.126447 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:02.128196 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:02.128607 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
15:44:02.235305 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:02.280696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:44:02.303276 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:02.303739 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:02.362870 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:02.365374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:02.365720 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]
        ) as __dbt_sbq
    
15:44:02.421953 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:02.444739 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:02.445200 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        ) as __dbt_sbq
    
15:44:02.700692 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:44:02.704255 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:02.704506 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
15:44:02.792250 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:02.796148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:02.796413 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203''), CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:02.326203'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end



    
15:44:03.443993 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:44:03.445572 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:03.445746 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:03.461915 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
15:44:03.463595 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:03.463869 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:03.509018 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:03.511874 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:03.512280 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:03.542232 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:03.545087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:03.545449 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:03.856495 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:44:03.858798 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BiddingTransactions_Incr"
15:44:03.859006 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:44:03.861524 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:03.861720 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
15:44:03.862389 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:03.862623 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr" (
                  "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:03.939077 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:03.945074 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:03.945813 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:03.991998 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:03.993722 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:03.994037 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
15:44:05.171149 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
15:44:05.172846 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:05.173087 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:05.266829 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:05.269613 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:05.269893 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:05.561973 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:44:05.563911 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCount_Incr"
15:44:05.564321 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:05.564446 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr" (
                  "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:05.871752 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.01 seconds
15:44:05.873453 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: COMMIT
15:44:05.874269 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
15:44:05.874428 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end

15:44:05.943497 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:05.957067 [debug] [Thread-3  ]: finished collecting timing info
15:44:05.957542 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: Close
15:44:05.958345 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdfac0>]}
15:44:05.958929 [info ] [Thread-3  ]: 8 of 101 OK snapshotted stg.AH_BiddingTransactions_Incr......................... [[32mOK[0m in 16.97s]
15:44:05.959372 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_BiddingTransactions_Incr
15:44:05.959594 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_CategoryListingTypes_Incr
15:44:05.960034 [info ] [Thread-3  ]: 12 of 101 START snapshot stg.AH_CategoryListingTypes_Incr....................... [RUN]
15:44:05.960517 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr"
15:44:05.960708 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_CategoryListingTypes_Incr
15:44:05.960881 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_CategoryListingTypes_Incr
15:44:05.963733 [debug] [Thread-3  ]: finished collecting timing info
15:44:05.963970 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_CategoryListingTypes_Incr
15:44:05.966777 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:05.967001 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:05.967165 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:44:05.967340 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:06.080953 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:06.169681 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:44:06.191535 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:06.192002 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:06.226267 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:06.228773 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:06.229120 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]
        ) as __dbt_sbq
    
15:44:06.297448 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:06.322176 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:06.322668 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        ) as __dbt_sbq
    
15:44:06.381801 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:06.385294 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:06.385669 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
15:44:06.484754 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:06.488345 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:06.488591 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887''), CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:06.216887'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end



    
15:44:07.714618 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.15 seconds
15:44:07.716323 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: COMMIT
15:44:07.717090 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
15:44:07.717229 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end

15:44:07.795391 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:07.807432 [debug] [Thread-4  ]: finished collecting timing info
15:44:07.807911 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: Close
15:44:07.808691 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdf970>]}
15:44:07.809238 [info ] [Thread-4  ]: 10 of 101 OK snapshotted stg.AH_CategoryCount_Incr.............................. [[32mOK[0m in 14.43s]
15:44:07.809665 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryCount_Incr
15:44:07.809888 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryListings_Incr
15:44:07.810328 [info ] [Thread-4  ]: 13 of 101 START snapshot stg.AH_CategoryListings_Incr........................... [RUN]
15:44:07.810859 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListings_Incr"
15:44:07.811057 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryListings_Incr
15:44:07.811233 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryListings_Incr
15:44:07.815466 [debug] [Thread-4  ]: finished collecting timing info
15:44:07.815708 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryListings_Incr
15:44:07.819513 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:07.819744 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:07.819909 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:44:07.820088 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:07.921537 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:07.953031 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:44:07.975928 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:07.976420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:08.030585 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:08.033070 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:08.033389 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListings_InterView]
        ) as __dbt_sbq
    
15:44:08.085795 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:08.109023 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:08.109518 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        ) as __dbt_sbq
    
15:44:08.215252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:08.219043 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:08.219377 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
15:44:08.299574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:08.304354 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:08.305139 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797''), CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:08.013797'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end



    
15:44:11.139469 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 21.29 seconds
15:44:11.143304 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:11.143516 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:11.257548 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:11.259146 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:11.259330 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
15:44:13.911841 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.65 seconds
15:44:13.913529 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:13.913725 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:14.027139 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:14.029985 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:14.030187 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:14.327726 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:44:14.331075 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:14.331312 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
15:44:14.427978 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:14.433450 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:14.433700 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:14.505645 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:14.507372 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:14.507677 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
15:44:16.554523 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
15:44:16.556171 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:16.556362 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:16.598948 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:16.601780 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:16.602007 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:16.908617 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:44:16.911491 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:16.911730 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
15:44:16.993955 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:16.998358 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:16.999483 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 10.51 seconds
15:44:17.002928 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:17.003197 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:16.999764 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:17.055703 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:17.057923 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:17.058291 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
15:44:17.085799 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:17.087409 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:17.087696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
15:44:18.190642 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
15:44:18.192259 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:18.192452 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:18.292330 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:18.295024 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:18.295251 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:18.397985 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 15.60 seconds
15:44:18.401640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:18.401874 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:18.445876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:18.447644 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:18.447952 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
15:44:18.535538 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
15:44:18.537050 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:18.537235 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:18.575419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:18.578799 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:18.579149 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:19.098612 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.80 seconds
15:44:19.101516 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:19.101726 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
15:44:19.206772 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:19.211402 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:19.211747 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:19.258079 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:19.259933 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:19.260193 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.68 seconds
15:44:19.262262 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Categories_Incr"
15:44:19.262854 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:19.263050 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Categories_Incr" (
                  "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:19.260426 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
15:44:19.996497 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
15:44:19.998159 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:19.998354 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:20.067256 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:20.069920 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:20.070162 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:20.294930 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:44:20.298294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:20.298518 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
15:44:20.299962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:20.300112 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:20.298878 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
15:44:20.335182 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:20.337828 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:20.338163 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:20.384817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:20.389403 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:20.389834 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:20.461154 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:20.462935 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:20.463254 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
15:44:20.574343 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:44:20.577493 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:20.577793 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
15:44:20.619090 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:20.623999 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:20.624410 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:20.665017 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:20.666870 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:20.667222 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
15:44:20.979187 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
15:44:20.980986 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Categories_Incr: COMMIT
15:44:20.981795 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
15:44:20.981953 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end

15:44:21.060495 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:21.072735 [debug] [Thread-2  ]: finished collecting timing info
15:44:21.073230 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Categories_Incr: Close
15:44:21.074057 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdfc10>]}
15:44:21.074723 [info ] [Thread-2  ]: 9 of 101 OK snapshotted stg.AH_Categories_Incr.................................. [[32mOK[0m in 31.73s]
15:44:21.075180 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Categories_Incr
15:44:21.075405 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Contactus_Incr
15:44:21.075860 [info ] [Thread-2  ]: 14 of 101 START snapshot stg.AH_Contactus_Incr.................................. [RUN]
15:44:21.076376 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contactus_Incr"
15:44:21.076568 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Contactus_Incr
15:44:21.076744 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Contactus_Incr
15:44:21.079720 [debug] [Thread-2  ]: finished collecting timing info
15:44:21.079972 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Contactus_Incr
15:44:21.082983 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:21.083229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:21.083391 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:44:21.083567 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:21.233245 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 12.93 seconds
15:44:21.236641 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:21.236992 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:21.248105 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:21.282442 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:44:21.289969 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:21.291458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:21.291768 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
15:44:21.306851 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:21.307284 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:21.336297 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:21.339009 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:21.339331 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contactus_InterView]
        ) as __dbt_sbq
    
15:44:21.339743 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
15:44:21.340877 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:21.341089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:21.373367 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:21.376165 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:21.376485 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:21.394415 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:21.416307 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:21.416779 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        ) as __dbt_sbq
    
15:44:21.571384 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
15:44:21.572986 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:21.573182 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:21.627597 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:21.629983 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:21.630196 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:21.639857 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:44:21.642997 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:21.643332 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
15:44:21.683966 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:21.689129 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:21.689529 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:21.699012 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:44:21.702750 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:21.703142 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
15:44:21.732466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:21.734168 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:21.734479 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
15:44:21.804294 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:21.808107 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:21.808567 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contactus_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contactus_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493''), CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:21.326493'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contactus_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contactus_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end



    
15:44:21.890647 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:44:21.892830 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListingTypes_Incr"
15:44:21.893299 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:21.893445 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr" (
                  "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:22.258828 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:44:22.260484 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:22.260687 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:22.343222 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:22.346049 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:22.346284 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:22.594173 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:44:22.597132 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:22.597378 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
15:44:22.690267 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:22.694191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:22.694434 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:22.733268 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:22.734935 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:22.735225 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
15:44:23.557852 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
15:44:23.559534 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:23.559738 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:23.610450 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:23.613330 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:23.613548 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:23.777974 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
15:44:23.779779 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: COMMIT
15:44:23.780569 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
15:44:23.780723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end

15:44:23.861377 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:23.871671 [debug] [Thread-3  ]: finished collecting timing info
15:44:23.872150 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: Close
15:44:23.872980 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdfeb0>]}
15:44:23.873584 [info ] [Thread-3  ]: 12 of 101 OK snapshotted stg.AH_CategoryListingTypes_Incr....................... [[32mOK[0m in 17.91s]
15:44:23.874032 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_CategoryListingTypes_Incr
15:44:23.874256 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Contents_Incr
15:44:23.874733 [info ] [Thread-3  ]: 15 of 101 START snapshot stg.AH_Contents_Incr................................... [RUN]
15:44:23.875244 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contents_Incr"
15:44:23.875438 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Contents_Incr
15:44:23.875610 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Contents_Incr
15:44:23.878518 [debug] [Thread-3  ]: finished collecting timing info
15:44:23.878785 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Contents_Incr
15:44:23.965061 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:44:23.967132 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCustomFields_Incr"
15:44:23.967782 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:23.967993 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:23.969349 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:23.969585 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:23.969747 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:44:23.969926 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:24.057791 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
15:44:24.060100 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:24.060426 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:24.094049 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:24.097071 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:24.097420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:24.107182 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:24.135425 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:44:24.158339 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:24.158823 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:24.216115 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:24.218305 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:24.218631 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contents_InterView]
        ) as __dbt_sbq
    
15:44:24.294493 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:24.294978 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:44:24.297698 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:24.297918 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
15:44:24.321375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:24.321809 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        ) as __dbt_sbq
    
15:44:24.338349 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:24.342602 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:24.342933 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:24.394573 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:24.399044 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:24.399412 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
15:44:24.401811 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:24.403065 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:24.403302 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
15:44:24.471610 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:24.475941 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:24.476300 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902''), CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:24.185902'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end



    
15:44:25.506211 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
15:44:25.507864 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:25.508085 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:25.551690 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:25.553595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
15:44:25.554966 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: COMMIT
15:44:25.555755 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
15:44:25.555967 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end

15:44:25.556931 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:25.557142 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:25.619619 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:25.629688 [debug] [Thread-1  ]: finished collecting timing info
15:44:25.630183 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: Close
15:44:25.631032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fdfd60>]}
15:44:25.631597 [info ] [Thread-1  ]: 11 of 101 OK snapshotted stg.AH_CategoryCustomFields_Incr....................... [[32mOK[0m in 23.54s]
15:44:25.632029 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CategoryCustomFields_Incr
15:44:25.632252 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Countries_Incr
15:44:25.632695 [info ] [Thread-1  ]: 16 of 101 START snapshot stg.AH_Countries_Incr.................................. [RUN]
15:44:25.633184 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Countries_Incr"
15:44:25.633373 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Countries_Incr
15:44:25.633544 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Countries_Incr
15:44:25.637367 [debug] [Thread-1  ]: finished collecting timing info
15:44:25.637612 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Countries_Incr
15:44:25.640948 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:25.641185 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:25.641350 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:44:25.641526 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:25.740405 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:25.770128 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:44:25.793243 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:25.793723 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:25.815876 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:44:25.818038 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListings_Incr"
15:44:25.818785 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:25.819007 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr" (
                  "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:25.826749 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:25.829037 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:25.829754 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Countries_InterView]
        ) as __dbt_sbq
    
15:44:25.891816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:25.914300 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:25.914795 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        ) as __dbt_sbq
    
15:44:26.090943 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:44:26.094240 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:26.094490 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
15:44:26.198361 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:26.202354 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:26.202858 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Countries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Countries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930''), CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:25.810930'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Countries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Countries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end



    
15:44:27.361541 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.55 seconds
15:44:27.365158 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:27.365391 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:27.404402 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:27.406096 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:27.406394 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
15:44:27.562208 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
15:44:27.563964 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: COMMIT
15:44:27.564752 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
15:44:27.564904 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end

15:44:27.614249 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:27.624366 [debug] [Thread-4  ]: finished collecting timing info
15:44:27.624840 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: Close
15:44:27.625605 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f190>]}
15:44:27.626143 [info ] [Thread-4  ]: 13 of 101 OK snapshotted stg.AH_CategoryListings_Incr........................... [[32mOK[0m in 19.81s]
15:44:27.626629 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryListings_Incr
15:44:27.626857 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CreditCardTypes_Incr
15:44:27.627300 [info ] [Thread-4  ]: 17 of 101 START snapshot stg.AH_CreditCardTypes_Incr............................ [RUN]
15:44:27.627775 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr"
15:44:27.627971 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CreditCardTypes_Incr
15:44:27.628145 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CreditCardTypes_Incr
15:44:27.631030 [debug] [Thread-4  ]: finished collecting timing info
15:44:27.631261 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CreditCardTypes_Incr
15:44:27.634159 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:27.634384 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:27.634563 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:44:27.634750 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:27.749339 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:27.784573 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:44:27.807191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:27.807667 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:27.837105 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:27.839340 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:27.839692 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]
        ) as __dbt_sbq
    
15:44:27.906070 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:27.929538 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:27.929986 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        ) as __dbt_sbq
    
15:44:28.028467 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:28.031762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:28.031975 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
15:44:28.113642 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:28.117108 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:28.117325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579''), CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:27.826579'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end



    
15:44:28.467674 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:44:28.469267 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:28.469446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:28.557994 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:28.560348 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:28.560547 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:28.968650 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
15:44:28.971730 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:28.971915 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
15:44:29.054702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:29.059092 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:29.059467 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:29.117928 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:29.119428 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:29.119610 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
15:44:30.239794 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
15:44:30.241453 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:30.241653 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:30.335444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:30.338066 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:30.338300 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:30.618732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:44:30.621802 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:30.622017 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
15:44:30.704337 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:30.708301 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:30.708520 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:30.779686 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:30.781239 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:30.781439 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
15:44:31.677108 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
15:44:31.678763 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:31.678973 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:31.724821 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:31.727369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:31.727577 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:32.021509 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:44:32.023657 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contactus_Incr"
15:44:32.024110 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:32.024254 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contactus_Incr" (
                  "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:33.837353 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
15:44:33.839292 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contactus_Incr: COMMIT
15:44:33.840016 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
15:44:33.840157 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end

15:44:33.885902 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:33.898436 [debug] [Thread-2  ]: finished collecting timing info
15:44:33.898896 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contactus_Incr: Close
15:44:33.899668 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f040>]}
15:44:33.900200 [info ] [Thread-2  ]: 14 of 101 OK snapshotted stg.AH_Contactus_Incr.................................. [[32mOK[0m in 12.82s]
15:44:33.900627 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Contactus_Incr
15:44:33.900846 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
15:44:33.901284 [info ] [Thread-2  ]: 18 of 101 START snapshot stg.AH_CreditCardsExtraInFormation_Incr................ [RUN]
15:44:33.901741 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
15:44:33.901929 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
15:44:33.902100 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
15:44:33.904896 [debug] [Thread-2  ]: finished collecting timing info
15:44:33.905125 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
15:44:33.907925 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:33.908144 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:33.908300 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:44:33.908471 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:34.050262 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.85 seconds
15:44:34.053946 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:34.054263 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:34.055015 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:34.102709 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:44:34.118783 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:34.120297 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:34.120588 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
15:44:34.127423 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:34.127692 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:34.155227 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:34.158027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:34.158366 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]
        ) as __dbt_sbq
    
15:44:34.216232 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:34.238518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:34.238937 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        ) as __dbt_sbq
    
15:44:34.326560 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:34.329992 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:34.330222 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
15:44:34.485007 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:44:34.488599 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:34.488786 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183''), CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:34.139183'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end



    
15:44:34.565314 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.45 seconds
15:44:34.568918 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:34.569139 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:34.616398 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:34.618117 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:34.618405 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
15:44:35.406874 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
15:44:35.408508 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:35.408698 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:35.483046 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:35.485564 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:35.485766 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:35.525653 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 11.05 seconds
15:44:35.529213 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:35.529420 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:35.581042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:35.583300 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:35.583587 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
15:44:35.589767 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:44:35.591056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:35.591274 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:35.668006 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:35.670480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:35.670717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:35.692204 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:44:35.696489 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:35.696815 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
15:44:35.776683 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:35.781173 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:35.781522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:35.824214 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:35.826449 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:35.826800 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
15:44:35.903775 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:44:35.906670 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:35.906949 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
15:44:36.003170 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:36.007337 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:36.007626 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:36.047596 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:36.049282 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:36.049580 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
15:44:36.739875 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
15:44:36.741505 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:36.741706 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:36.816922 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:36.819681 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:36.819896 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:37.161120 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:44:37.164126 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:37.164333 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
15:44:37.210726 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
15:44:37.212673 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:37.211192 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:44:37.214224 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:37.214462 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:37.212979 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:37.244415 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:37.249068 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:37.249445 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:37.286023 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:37.288010 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:37.288298 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
15:44:37.324471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:37.327409 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:37.327734 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:37.328183 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:37.330326 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:37.330579 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:37.607333 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:44:37.610745 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:37.611081 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
15:44:37.639987 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:44:37.643266 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:37.643636 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
15:44:37.699244 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:37.703538 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:37.703926 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:37.715272 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:37.720893 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:37.721273 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:37.775394 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:37.777125 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:37.777432 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
15:44:37.785789 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:37.787304 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:37.787578 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
15:44:38.582266 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
15:44:38.583925 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:38.584097 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:38.629798 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:38.632463 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:38.632666 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:38.834645 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:44:38.836104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:38.836279 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:38.878015 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:38.880594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
15:44:38.881826 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:38.882042 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:38.883050 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:38.883261 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:38.917759 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:38.920490 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:38.920811 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:38.923710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.43 seconds
15:44:38.928184 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:38.928405 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:38.939562 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:44:38.942000 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:38.942251 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
15:44:38.965313 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:38.966791 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:38.967065 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
15:44:38.973936 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:38.977927 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:38.978205 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:39.038663 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:39.040232 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:39.040505 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
15:44:39.195952 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:44:39.198062 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardTypes_Incr"
15:44:39.198480 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:39.198651 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:39.613748 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.73 seconds
15:44:39.615968 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Countries_Incr"
15:44:39.616374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:39.616502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Countries_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:40.442101 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
15:44:40.443768 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:40.443940 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:40.542689 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:44:40.545017 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:40.545217 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:40.833206 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:44:40.836245 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:40.836436 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
15:44:40.916534 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:40.920448 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:40.920680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:40.942692 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.90 seconds
15:44:40.944279 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:40.944600 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:40.957881 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:40.959504 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:40.959772 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
15:44:40.983868 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:40.986575 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:40.986908 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:41.307987 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:44:41.310260 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contents_Incr"
15:44:41.310725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:41.310864 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contents_Incr" (
                  "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:41.577123 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.38 seconds
15:44:41.578796 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: COMMIT
15:44:41.579833 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
15:44:41.579978 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end

15:44:41.632872 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:41.642978 [debug] [Thread-4  ]: finished collecting timing info
15:44:41.643506 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: Close
15:44:41.644378 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f580>]}
15:44:41.644970 [info ] [Thread-4  ]: 17 of 101 OK snapshotted stg.AH_CreditCardTypes_Incr............................ [[32mOK[0m in 14.02s]
15:44:41.645452 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CreditCardTypes_Incr
15:44:41.645689 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Currencies_Incr
15:44:41.646155 [info ] [Thread-4  ]: 19 of 101 START snapshot stg.AH_Currencies_Incr................................. [RUN]
15:44:41.646717 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Currencies_Incr"
15:44:41.646920 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Currencies_Incr
15:44:41.647100 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Currencies_Incr
15:44:41.650139 [debug] [Thread-4  ]: finished collecting timing info
15:44:41.650396 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Currencies_Incr
15:44:41.654587 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:41.654901 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:41.655071 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:44:41.655250 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:41.744905 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
15:44:41.747354 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Countries_Incr: COMMIT
15:44:41.748545 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
15:44:41.748785 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end

15:44:41.783449 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:41.791787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:41.800555 [debug] [Thread-1  ]: finished collecting timing info
15:44:41.800964 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Countries_Incr: Close
15:44:41.801726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f2e0>]}
15:44:41.802280 [info ] [Thread-1  ]: 16 of 101 OK snapshotted stg.AH_Countries_Incr.................................. [[32mOK[0m in 16.17s]
15:44:41.802740 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Countries_Incr
15:44:41.802962 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CustomFieldenums_Incr
15:44:41.803385 [info ] [Thread-1  ]: 20 of 101 START snapshot stg.AH_CustomFieldenums_Incr........................... [RUN]
15:44:41.803852 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr"
15:44:41.804039 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CustomFieldenums_Incr
15:44:41.804210 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CustomFieldenums_Incr
15:44:41.807091 [debug] [Thread-1  ]: finished collecting timing info
15:44:41.807324 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CustomFieldenums_Incr
15:44:41.810053 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:41.810265 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:41.810421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:44:41.810615 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:41.815402 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:44:41.840410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:41.840801 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:41.867974 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:41.870226 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:41.870584 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Currencies_InterView]
        ) as __dbt_sbq
    
15:44:41.923911 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:41.935764 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:41.947030 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:41.947783 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        ) as __dbt_sbq
    
15:44:41.949216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
15:44:41.950601 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:41.950844 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:41.970371 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:44:41.992288 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:41.992752 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:42.034494 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:42.039147 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:42.039515 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
15:44:42.048755 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:42.050945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:42.051259 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]
        ) as __dbt_sbq
    
15:44:42.069972 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:44:42.072730 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:42.073092 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:42.121536 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:42.143397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:42.143864 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        ) as __dbt_sbq
    
15:44:42.148301 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:42.151844 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:42.152107 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Currencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Currencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042''), CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:41.858042'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Currencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Currencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end



    
15:44:42.262682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:44:42.266698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:42.266996 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
15:44:42.344394 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:42.347946 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:42.348167 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921''), CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:42.029921'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end



    
15:44:42.369924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:44:42.372773 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:42.373044 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
15:44:42.480336 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:42.485237 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:42.485555 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:42.558496 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:42.560208 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:42.560499 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
15:44:43.101975 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
15:44:43.103756 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contents_Incr: COMMIT
15:44:43.104559 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
15:44:43.104711 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end

15:44:43.152817 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:43.162594 [debug] [Thread-3  ]: finished collecting timing info
15:44:43.163016 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contents_Incr: Close
15:44:43.163774 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f430>]}
15:44:43.164296 [info ] [Thread-3  ]: 15 of 101 OK snapshotted stg.AH_Contents_Incr................................... [[32mOK[0m in 19.29s]
15:44:43.164716 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Contents_Incr
15:44:43.164935 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_CustomFields_Incr
15:44:43.165363 [info ] [Thread-3  ]: 21 of 101 START snapshot stg.AH_CustomFields_Incr............................... [RUN]
15:44:43.165832 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFields_Incr"
15:44:43.166021 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_CustomFields_Incr
15:44:43.166195 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_CustomFields_Incr
15:44:43.169157 [debug] [Thread-3  ]: finished collecting timing info
15:44:43.169419 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_CustomFields_Incr
15:44:43.173296 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:44:43.173525 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:43.173689 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:44:43.173861 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:43.273565 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:43.342906 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:44:43.367295 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:44:43.367723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:43.394924 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:43.397280 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:44:43.397566 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFields_InterView]
        ) as __dbt_sbq
    
15:44:43.548470 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:44:43.569702 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:44:43.570087 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        ) as __dbt_sbq
    
15:44:43.657201 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
15:44:43.658820 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:43.659011 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:43.697060 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:43.699760 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:43.700101 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:43.713828 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:44:43.717946 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:44:43.718273 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
15:44:43.791284 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:43.795251 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:44:43.795553 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324''), CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:43.389324'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end



    
15:44:44.168532 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
15:44:44.170628 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
15:44:44.171077 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:44.171214 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr" (
                  "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:45.540097 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
15:44:45.541810 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: COMMIT
15:44:45.542684 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
15:44:45.542842 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end

15:44:45.606105 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:45.615556 [debug] [Thread-2  ]: finished collecting timing info
15:44:45.615967 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: Close
15:44:45.616725 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f6d0>]}
15:44:45.617256 [info ] [Thread-2  ]: 18 of 101 OK snapshotted stg.AH_CreditCardsExtraInFormation_Incr................ [[32mOK[0m in 11.72s]
15:44:45.617684 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
15:44:45.618648 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Customcurrencies_Incr
15:44:45.619139 [info ] [Thread-2  ]: 22 of 101 START snapshot stg.AH_Customcurrencies_Incr........................... [RUN]
15:44:45.619958 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr"
15:44:45.620179 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Customcurrencies_Incr
15:44:45.620357 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Customcurrencies_Incr
15:44:45.623230 [debug] [Thread-2  ]: finished collecting timing info
15:44:45.623512 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Customcurrencies_Incr
15:44:45.626895 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:45.627110 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:45.627266 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:44:45.627436 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:45.774211 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:45.805458 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:44:45.829054 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:45.829451 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:45.858373 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:45.860936 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:45.861295 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Customcurrencies_InterView]
        ) as __dbt_sbq
    
15:44:45.918691 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:45.941494 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:45.941890 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        ) as __dbt_sbq
    
15:44:46.008497 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:46.012117 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:46.012343 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
15:44:46.288014 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:44:46.292676 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:46.293051 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Customcurrencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482''), CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:45.842482'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end



    
15:44:48.626261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.47 seconds
15:44:48.629948 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:48.630211 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:48.685497 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:48.687090 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:48.687311 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
15:44:49.701137 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
15:44:49.702891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:49.703098 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:49.958576 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:44:49.961039 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:49.961229 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:50.169768 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.82 seconds
15:44:50.173377 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:50.173635 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:50.213541 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:50.215287 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:50.215580 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
15:44:50.229443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:44:50.232481 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:50.232803 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
15:44:50.338305 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:50.342707 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:50.343029 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:50.419756 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:50.421168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:50.421368 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
15:44:51.811466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
15:44:51.813134 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:51.813333 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:51.926782 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:51.929202 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:51.929416 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:52.048706 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
15:44:52.050296 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:52.050483 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:52.093100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:52.096084 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:52.096388 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:52.236531 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:44:52.239292 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:52.239529 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
15:44:52.346304 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:52.350469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:52.350986 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:52.373563 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:44:52.376945 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:52.377341 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
15:44:52.397095 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:52.398886 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:52.399207 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
15:44:52.410317 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:52.416373 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:52.416792 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:52.468422 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:52.470831 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:52.471147 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
15:44:53.325162 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
15:44:53.326880 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:53.327097 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:53.360925 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:53.363691 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:53.363967 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:53.441091 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.15 seconds
15:44:53.446783 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:53.447220 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:53.488046 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:53.489515 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:53.489716 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
15:44:53.538173 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
15:44:53.539873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:53.540059 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:53.574242 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:53.576911 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:53.577130 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:53.634144 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:44:53.637467 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:53.637722 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
15:44:53.719501 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:53.723785 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:53.724107 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:53.775117 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:53.776678 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:53.776875 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
15:44:53.820690 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:44:53.822993 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Currencies_Incr"
15:44:53.823678 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:53.823890 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Currencies_Incr" (
                  "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:54.405289 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:44:54.407032 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:54.407251 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:54.478053 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:54.480528 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:54.480759 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:55.203294 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:44:55.204981 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Currencies_Incr: COMMIT
15:44:55.206133 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
15:44:55.206285 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end

15:44:55.247902 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:55.258326 [debug] [Thread-4  ]: finished collecting timing info
15:44:55.258838 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Currencies_Incr: Close
15:44:55.259702 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603fac0>]}
15:44:55.260254 [info ] [Thread-4  ]: 19 of 101 OK snapshotted stg.AH_Currencies_Incr................................. [[32mOK[0m in 13.61s]
15:44:55.260706 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Currencies_Incr
15:44:55.260937 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
15:44:55.261429 [info ] [Thread-4  ]: 23 of 101 START snapshot stg.AH_DailyhuntEmailSubscribers_Incr.................. [RUN]
15:44:55.261973 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
15:44:55.262166 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
15:44:55.262341 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
15:44:55.265391 [debug] [Thread-4  ]: finished collecting timing info
15:44:55.265638 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
15:44:55.268648 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:44:55.268879 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:55.269038 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:44:55.269210 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:55.371879 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:55.401036 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:44:55.424011 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:44:55.424488 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:55.453885 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:44:55.456047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:44:55.456340 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]
        ) as __dbt_sbq
    
15:44:55.541926 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:55.565411 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:44:55.565878 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        ) as __dbt_sbq
    
15:44:56.038152 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
15:44:56.041887 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:44:56.042176 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
15:44:56.118152 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:56.122138 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:44:56.122434 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448''), CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:55.436448'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end



    
15:44:57.018927 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.54 seconds
15:44:57.021816 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:57.022035 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
15:44:57.104232 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:44:57.108308 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:57.108599 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:57.156345 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:57.158341 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:57.158689 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
15:44:57.547953 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.77 seconds
15:44:57.549599 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:57.549796 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:57.657118 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:44:57.659802 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:57.660028 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:57.976552 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:44:57.978850 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFieldenums_Incr"
15:44:57.979329 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:57.979474 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:44:58.222220 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:44:58.223899 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:58.224101 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:44:58.309360 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:44:58.311902 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:58.312111 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:58.604013 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:44:58.607427 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:58.607715 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
15:44:58.676731 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:58.681226 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:58.681514 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:44:58.718945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:44:58.720815 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:44:58.721175 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
15:44:59.349538 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
15:44:59.351352 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: COMMIT
15:44:59.352216 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
15:44:59.352387 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end

15:44:59.408587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:44:59.419329 [debug] [Thread-1  ]: finished collecting timing info
15:44:59.419809 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: Close
15:44:59.420610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603f970>]}
15:44:59.421150 [info ] [Thread-1  ]: 20 of 101 OK snapshotted stg.AH_CustomFieldenums_Incr........................... [[32mOK[0m in 17.62s]
15:44:59.421582 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CustomFieldenums_Incr
15:44:59.421808 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Decorations_Incr
15:44:59.422251 [info ] [Thread-1  ]: 24 of 101 START snapshot stg.AH_Decorations_Incr................................ [RUN]
15:44:59.422794 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Decorations_Incr"
15:44:59.422989 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Decorations_Incr
15:44:59.423163 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Decorations_Incr
15:44:59.426113 [debug] [Thread-1  ]: finished collecting timing info
15:44:59.426351 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Decorations_Incr
15:44:59.430659 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:44:59.430923 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:44:59.431089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:44:59.431266 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:44:59.562733 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:44:59.591168 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:44:59.614053 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:44:59.614571 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:44:59.663544 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:44:59.665911 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:44:59.666249 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Decorations_InterView]
        ) as __dbt_sbq
    
15:44:59.736522 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:44:59.761637 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:44:59.762097 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        ) as __dbt_sbq
    
15:45:00.035593 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:45:00.039248 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:00.039489 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
15:45:00.108028 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
15:45:00.109850 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:45:00.110038 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:00.134209 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:00.137814 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:00.138136 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Decorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Decorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968''), CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:44:59.623968'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Decorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Decorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end



    
15:45:00.202905 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:00.205645 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:45:00.205936 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:00.495662 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:45:00.497849 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Customcurrencies_Incr"
15:45:00.498304 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:45:00.498453 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:02.224558 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
15:45:02.226121 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: COMMIT
15:45:02.226867 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
15:45:02.227008 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end

15:45:02.276017 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:02.287871 [debug] [Thread-2  ]: finished collecting timing info
15:45:02.288332 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: Close
15:45:02.289122 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603fc10>]}
15:45:02.289668 [info ] [Thread-2  ]: 22 of 101 OK snapshotted stg.AH_Customcurrencies_Incr........................... [[32mOK[0m in 16.67s]
15:45:02.290105 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Customcurrencies_Incr
15:45:02.290328 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
15:45:02.290821 [info ] [Thread-2  ]: 25 of 101 START snapshot stg.AH_Emailtemplatecontents_Incr...................... [RUN]
15:45:02.291334 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
15:45:02.291527 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Emailtemplatecontents_Incr
15:45:02.291714 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Emailtemplatecontents_Incr
15:45:02.294715 [debug] [Thread-2  ]: finished collecting timing info
15:45:02.294963 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Emailtemplatecontents_Incr
15:45:02.298584 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:02.298818 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:02.298978 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:45:02.299154 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:02.419976 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:02.468700 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:45:02.491245 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 18.70 seconds
15:45:02.494391 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:02.494948 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:02.494732 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:02.495325 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:02.525873 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:02.528083 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:02.528357 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]
        ) as __dbt_sbq
    
15:45:02.539652 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:02.541129 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:02.541394 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
15:45:02.595487 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:02.617237 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:02.618401 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        ) as __dbt_sbq
    
15:45:03.236758 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
15:45:03.240290 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:03.240513 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
15:45:03.335933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:03.339565 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:03.339837 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634''), CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:02.514634'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
15:45:03.633356 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.51 seconds
15:45:03.636692 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:03.636891 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:03.704859 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:03.706348 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:03.706532 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
15:45:03.824632 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
15:45:03.826277 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:03.826480 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:04.108864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:45:04.111829 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:04.112049 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:04.431914 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:45:04.435071 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:04.435303 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
15:45:04.518768 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:04.524010 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:04.524324 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:04.572577 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:04.574332 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:04.574663 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
15:45:04.817897 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
15:45:04.819555 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:04.819760 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:04.895246 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:04.897658 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:04.897861 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:05.202754 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:45:05.205957 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:05.206210 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
15:45:05.300585 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:05.304700 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:05.304933 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:05.365018 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:05.366460 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:05.366659 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
15:45:05.780442 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
15:45:05.782106 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:05.782296 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:05.834311 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:05.837443 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:05.837684 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:06.149734 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:45:06.152593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:06.152808 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
15:45:06.189424 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:06.196047 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:06.196364 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:06.248248 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:06.250593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:06.250897 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
15:45:06.286147 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:45:06.288105 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:06.288385 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:06.330060 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:06.332800 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:06.333086 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:06.607283 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:45:06.698985 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:06.699761 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
15:45:06.755778 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:06.760379 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:06.760759 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:06.802004 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:06.803750 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:06.804061 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
15:45:07.421601 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
15:45:07.423408 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:07.423720 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:07.470782 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:07.474064 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:07.474402 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:07.843938 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
15:45:07.846390 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFields_Incr"
15:45:07.846912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:07.847067 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr" (
                  "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:07.928773 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
15:45:07.930295 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:07.930494 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:07.981327 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:07.983960 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:07.984191 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:08.463594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
15:45:08.465779 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
15:45:08.466227 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:08.466369 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr" (
                  "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:08.654922 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.52 seconds
15:45:08.658485 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:08.658913 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:08.701783 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:08.703545 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:08.703851 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
15:45:09.360350 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
15:45:09.362093 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CustomFields_Incr: COMMIT
15:45:09.362903 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
15:45:09.363059 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end

15:45:09.408859 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:09.420486 [debug] [Thread-3  ]: finished collecting timing info
15:45:09.420979 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CustomFields_Incr: Close
15:45:09.421803 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37746ce610>]}
15:45:09.422374 [info ] [Thread-3  ]: 21 of 101 OK snapshotted stg.AH_CustomFields_Incr............................... [[32mOK[0m in 26.26s]
15:45:09.422844 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_CustomFields_Incr
15:45:09.423073 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Emailtemplates_Incr
15:45:09.423523 [info ] [Thread-3  ]: 26 of 101 START snapshot stg.AH_Emailtemplates_Incr............................. [RUN]
15:45:09.424044 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr"
15:45:09.424237 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Emailtemplates_Incr
15:45:09.424414 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Emailtemplates_Incr
15:45:09.427418 [debug] [Thread-3  ]: finished collecting timing info
15:45:09.427665 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Emailtemplates_Incr
15:45:09.431146 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:09.431384 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:09.431544 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:45:09.431720 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:09.567258 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:09.600551 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:45:09.622868 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:09.623327 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:09.655205 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:09.657557 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:09.657887 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplates_InterView]
        ) as __dbt_sbq
    
15:45:09.730779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:09.755783 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:09.756235 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        ) as __dbt_sbq
    
15:45:09.853626 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:09.856912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:09.857131 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
15:45:09.932666 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:09.937847 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:09.938228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765''), CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:09.639765'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end



    
15:45:10.251871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
15:45:10.253503 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:10.253704 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:10.285790 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
15:45:10.287660 [debug] [Thread-4  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: COMMIT
15:45:10.288568 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
15:45:10.288745 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end

15:45:10.342641 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:10.345548 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:10.345861 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:10.386448 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:10.395465 [debug] [Thread-4  ]: finished collecting timing info
15:45:10.395922 [debug] [Thread-4  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: Close
15:45:10.396758 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37744de7c0>]}
15:45:10.397356 [info ] [Thread-4  ]: 23 of 101 OK snapshotted stg.AH_DailyhuntEmailSubscribers_Incr.................. [[32mOK[0m in 15.13s]
15:45:10.397885 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
15:45:10.398118 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Eventproperties_Incr
15:45:10.398625 [info ] [Thread-4  ]: 27 of 101 START snapshot stg.AH_Eventproperties_Incr............................ [RUN]
15:45:10.399183 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Eventproperties_Incr"
15:45:10.399383 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Eventproperties_Incr
15:45:10.399557 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Eventproperties_Incr
15:45:10.402583 [debug] [Thread-4  ]: finished collecting timing info
15:45:10.402876 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Eventproperties_Incr
15:45:10.406192 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:10.406408 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:10.406585 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:45:10.406770 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:10.531323 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:10.560874 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:45:10.583475 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:10.583956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:10.595463 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:45:10.598597 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:10.598931 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
15:45:10.616585 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:10.619138 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:10.619569 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Eventproperties_InterView]
        ) as __dbt_sbq
    
15:45:10.678329 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:10.682698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:10.682936 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:10.683204 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:10.706395 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:10.706852 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        ) as __dbt_sbq
    
15:45:10.740578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:10.743312 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:10.743627 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
15:45:10.759304 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:10.763432 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:10.763839 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
15:45:10.847892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:10.852573 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:10.853239 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Eventproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Eventproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904''), CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:10.592904'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Eventproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end



    
15:45:11.749738 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
15:45:11.751313 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:11.751494 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:11.798096 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:11.800824 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:11.801024 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:12.357524 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.02 seconds
15:45:12.361160 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:12.361421 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:12.402658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:12.404347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:12.404651 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
15:45:12.703396 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
15:45:12.706484 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:12.706929 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
15:45:12.751877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:12.756232 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:12.756570 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:12.803709 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:12.805421 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:12.805717 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
15:45:13.764100 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:45:13.765745 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:13.765948 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:13.842111 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:13.844693 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:13.844897 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:13.999571 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
15:45:14.001198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:14.001387 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:14.040274 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:14.043148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:14.043349 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:14.148214 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:45:14.150873 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:14.151057 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
15:45:14.204843 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:14.208904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:14.209103 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:14.255300 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:14.257070 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:14.257345 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
15:45:14.353557 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:45:14.355637 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Decorations_Incr"
15:45:14.356059 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:14.356189 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Decorations_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:15.584985 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
15:45:15.586711 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:15.586896 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:15.672407 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:15.674826 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:15.675019 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:15.934588 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:45:15.937487 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:15.937685 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
15:45:15.971903 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:15.978201 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:15.978448 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:16.088476 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:45:16.089949 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:16.090137 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
15:45:16.233493 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
15:45:16.235228 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Decorations_Incr: COMMIT
15:45:16.236013 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
15:45:16.236166 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end

15:45:16.296657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:16.305575 [debug] [Thread-1  ]: finished collecting timing info
15:45:16.305947 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Decorations_Incr: Close
15:45:16.306741 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377445ce20>]}
15:45:16.307272 [info ] [Thread-1  ]: 24 of 101 OK snapshotted stg.AH_Decorations_Incr................................ [[32mOK[0m in 16.88s]
15:45:16.307711 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Decorations_Incr
15:45:16.307938 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Events_Incr
15:45:16.308371 [info ] [Thread-1  ]: 28 of 101 START snapshot stg.AH_Events_Incr..................................... [RUN]
15:45:16.308837 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Events_Incr"
15:45:16.309024 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Events_Incr
15:45:16.309195 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Events_Incr
15:45:16.312813 [debug] [Thread-1  ]: finished collecting timing info
15:45:16.313045 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Events_Incr
15:45:16.316154 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:16.316371 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:16.316529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:45:16.316704 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:16.333053 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.39 seconds
15:45:16.336215 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:16.336588 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:16.377613 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:16.379233 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:16.379574 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
15:45:16.428136 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:16.473909 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:45:16.496780 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:16.497221 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:16.546507 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:16.548745 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:16.549379 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Events_InterView]
        ) as __dbt_sbq
    
15:45:16.617635 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:16.641987 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:16.642416 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        ) as __dbt_sbq
    
15:45:16.692292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:16.697729 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:16.698072 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
15:45:16.781384 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:16.785931 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:16.786210 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Events_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Events_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494''), CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:16.530494'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Events_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Events_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end



    
15:45:17.033527 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
15:45:17.035238 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:17.035433 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:17.070978 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:17.073638 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:17.073875 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:17.245332 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
15:45:17.247039 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:17.247237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:17.327327 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:17.330375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:17.330825 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:17.861163 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.79 seconds
15:45:17.863430 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
15:45:17.863900 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:17.864047 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr" (
                  "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:18.090586 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.76 seconds
15:45:18.093502 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:18.093732 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
15:45:18.183923 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:18.187968 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:18.188234 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:18.249237 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:18.250735 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:18.250906 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
15:45:19.382341 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
15:45:19.384139 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:19.384429 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:19.490983 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:45:19.493630 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:19.493842 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:19.500513 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.64 seconds
15:45:19.502259 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: COMMIT
15:45:19.503161 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
15:45:19.503392 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end

15:45:19.542529 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:19.552486 [debug] [Thread-2  ]: finished collecting timing info
15:45:19.552982 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: Close
15:45:19.553840 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776054190>]}
15:45:19.554415 [info ] [Thread-2  ]: 25 of 101 OK snapshotted stg.AH_Emailtemplatecontents_Incr...................... [[32mOK[0m in 17.26s]
15:45:19.554895 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
15:45:19.555123 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ExternalUserIDs_Incr
15:45:19.555566 [info ] [Thread-2  ]: 29 of 101 START snapshot stg.AH_ExternalUserIDs_Incr............................ [RUN]
15:45:19.556099 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr"
15:45:19.556293 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ExternalUserIDs_Incr
15:45:19.556470 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ExternalUserIDs_Incr
15:45:19.559466 [debug] [Thread-2  ]: finished collecting timing info
15:45:19.559708 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ExternalUserIDs_Incr
15:45:19.563211 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:19.563457 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:19.563625 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:45:19.563807 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:19.664775 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:19.695286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:45:19.717411 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:19.717869 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:19.749627 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:19.751782 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:19.752074 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]
        ) as __dbt_sbq
    
15:45:19.803653 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:45:19.807805 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:19.808158 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
15:45:19.822740 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:19.847481 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:19.847880 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        ) as __dbt_sbq
    
15:45:19.884147 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:19.888970 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:19.889395 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:19.928976 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:19.932981 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:19.933353 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
15:45:19.940524 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:19.941921 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:19.942185 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
15:45:20.004962 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:20.008692 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:20.009052 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671''), CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:19.733671'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end



    
15:45:20.823648 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 9.97 seconds
15:45:20.827213 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:20.827516 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:20.850308 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
15:45:20.852156 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:20.852346 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:20.868500 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:20.870083 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:20.870351 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
15:45:20.936315 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:20.938921 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:20.939270 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:21.205525 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:45:21.207754 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplates_Incr"
15:45:21.208252 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:21.208396 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr" (
                  "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:21.837999 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:45:21.839578 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:21.839777 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:21.936327 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:21.938876 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:21.939130 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:22.084617 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.30 seconds
15:45:22.088280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:22.088532 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:22.129263 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:22.130997 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:22.131301 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
15:45:22.292108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:45:22.295292 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:22.295539 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
15:45:22.377064 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:22.382326 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:22.382996 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:22.419392 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:22.421114 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:22.421430 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
15:45:22.951522 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
15:45:22.953254 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: COMMIT
15:45:22.954062 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
15:45:22.954218 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end

15:45:23.005728 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:23.018322 [debug] [Thread-3  ]: finished collecting timing info
15:45:23.018865 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: Close
15:45:23.019706 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774525670>]}
15:45:23.020286 [info ] [Thread-3  ]: 26 of 101 OK snapshotted stg.AH_Emailtemplates_Incr............................. [[32mOK[0m in 13.60s]
15:45:23.020742 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Emailtemplates_Incr
15:45:23.020970 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Feedbacks_Incr
15:45:23.021431 [info ] [Thread-3  ]: 30 of 101 START snapshot stg.AH_Feedbacks_Incr.................................. [RUN]
15:45:23.021936 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feedbacks_Incr"
15:45:23.022129 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Feedbacks_Incr
15:45:23.022310 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Feedbacks_Incr
15:45:23.025280 [debug] [Thread-3  ]: finished collecting timing info
15:45:23.025525 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Feedbacks_Incr
15:45:23.028498 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:23.028727 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:23.028886 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:45:23.029061 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:23.184153 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:23.205242 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
15:45:23.207137 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:23.207452 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:23.237754 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:45:23.259956 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:23.260432 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:23.287834 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:23.290934 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:23.291282 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:23.293105 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:23.294915 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:23.295153 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feedbacks_InterView]
        ) as __dbt_sbq
    
15:45:23.375890 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:23.398300 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:23.398780 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        ) as __dbt_sbq
    
15:45:23.402341 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
15:45:23.403785 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:23.404023 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:23.440996 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:23.443951 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:23.444292 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:23.465820 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:23.469994 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:23.470372 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
15:45:23.544478 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:23.549872 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:23.550275 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feedbacks_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feedbacks_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605''), CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:23.280605'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feedbacks_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end



    
15:45:23.569236 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:45:23.572131 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:23.572478 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
15:45:23.660573 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:23.664700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:23.664962 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:23.675712 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:45:23.678821 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:23.679175 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
15:45:23.699204 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:23.700925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:23.701243 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
15:45:23.710704 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:23.715056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:23.715419 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:23.765450 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:23.768711 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:23.769095 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
15:45:24.769648 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
15:45:24.771265 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:24.771459 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:24.772215 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
15:45:24.773330 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:24.773479 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:24.833990 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:24.836371 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:24.836583 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:24.836998 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:24.839137 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:24.839370 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:25.123501 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:45:25.125973 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Eventproperties_Incr"
15:45:25.126665 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:25.126885 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:25.167574 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:45:25.171223 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:25.171603 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
15:45:25.218522 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:25.223099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:25.223441 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:25.261108 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:25.262970 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:25.263363 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
15:45:26.667926 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.66 seconds
15:45:26.671717 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:26.672298 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:26.714993 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:26.716694 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:26.716987 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
15:45:26.726602 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
15:45:26.728169 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:26.728419 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:26.761685 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:26.764214 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:26.764546 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:26.802581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
15:45:26.804501 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Eventproperties_Incr: COMMIT
15:45:26.805773 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
15:45:26.806025 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end

15:45:26.843207 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:26.853181 [debug] [Thread-4  ]: finished collecting timing info
15:45:26.853588 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Eventproperties_Incr: Close
15:45:26.854386 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760542e0>]}
15:45:26.991034 [info ] [Thread-4  ]: 27 of 101 OK snapshotted stg.AH_Eventproperties_Incr............................ [[32mOK[0m in 16.46s]
15:45:26.992057 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Eventproperties_Incr
15:45:26.992305 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Feeproperties_Incr
15:45:26.992740 [info ] [Thread-4  ]: 31 of 101 START snapshot stg.AH_Feeproperties_Incr.............................. [RUN]
15:45:26.993292 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeproperties_Incr"
15:45:26.993491 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Feeproperties_Incr
15:45:26.993671 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Feeproperties_Incr
15:45:26.996616 [debug] [Thread-4  ]: finished collecting timing info
15:45:26.996858 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Feeproperties_Incr
15:45:27.000402 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:27.000627 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:27.000786 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:45:27.000962 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:27.001518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:45:27.003292 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Events_Incr"
15:45:27.003831 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:27.004012 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Events_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Events_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:27.119499 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:27.163384 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:45:27.185724 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:27.186176 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:27.215135 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:27.217804 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:27.218138 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeproperties_InterView]
        ) as __dbt_sbq
    
15:45:27.281608 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:27.306998 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:27.307442 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        ) as __dbt_sbq
    
15:45:27.358553 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:27.361836 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:27.362081 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
15:45:27.433754 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:27.437672 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:27.437924 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541''), CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:27.202541'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end



    
15:45:27.564712 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
15:45:27.566337 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:27.566523 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:27.651667 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:27.654265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:27.654475 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:27.872622 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:45:27.875932 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:27.876178 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
15:45:28.008005 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:45:28.012412 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:28.012705 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:28.071799 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:28.073291 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:28.073470 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
15:45:28.816254 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
15:45:28.817923 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Events_Incr: COMMIT
15:45:28.818761 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
15:45:28.818927 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end

15:45:28.860757 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:28.870921 [debug] [Thread-1  ]: finished collecting timing info
15:45:28.871381 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Events_Incr: Close
15:45:28.872168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776054430>]}
15:45:28.872702 [info ] [Thread-1  ]: 28 of 101 OK snapshotted stg.AH_Events_Incr..................................... [[32mOK[0m in 12.56s]
15:45:28.873130 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Events_Incr
15:45:28.873352 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Feeschedules_Incr
15:45:28.873775 [info ] [Thread-1  ]: 32 of 101 START snapshot stg.AH_Feeschedules_Incr............................... [RUN]
15:45:28.874236 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeschedules_Incr"
15:45:28.874426 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Feeschedules_Incr
15:45:28.874622 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Feeschedules_Incr
15:45:28.877473 [debug] [Thread-1  ]: finished collecting timing info
15:45:28.877698 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Feeschedules_Incr
15:45:28.880565 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:28.880781 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:28.880939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:45:28.881111 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:28.982907 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:29.013438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:45:29.036841 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:29.037320 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:29.062910 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
15:45:29.064611 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:29.064929 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:29.065257 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:29.067317 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:29.067568 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeschedules_InterView]
        ) as __dbt_sbq
    
15:45:29.102904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:29.105659 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:29.105969 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:29.127004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:29.149316 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:29.149799 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        ) as __dbt_sbq
    
15:45:29.210610 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:29.214355 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:29.214740 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
15:45:29.298947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:29.302282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:29.302515 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeschedules_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeschedules_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373''), CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:29.046373'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeschedules_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end



    
15:45:29.459049 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:45:29.462287 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:29.462724 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
15:45:29.498004 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:29.502683 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:29.503078 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:29.538319 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:29.540010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:29.540276 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
15:45:30.565861 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
15:45:30.567562 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:30.567793 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:30.609443 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:30.612092 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:30.612315 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:30.935412 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:45:30.937374 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ExternalUserIDs_Incr"
15:45:30.937784 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:30.937914 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr" (
                  "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:32.345747 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
15:45:32.347406 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: COMMIT
15:45:32.348387 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
15:45:32.348526 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end

15:45:32.357136 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.81 seconds
15:45:32.359964 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:32.360118 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:32.384731 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:32.395265 [debug] [Thread-2  ]: finished collecting timing info
15:45:32.395709 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: Close
15:45:32.396488 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37746292b0>]}
15:45:32.397046 [info ] [Thread-2  ]: 29 of 101 OK snapshotted stg.AH_ExternalUserIDs_Incr............................ [[32mOK[0m in 12.84s]
15:45:32.397473 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ExternalUserIDs_Incr
15:45:32.397691 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
15:45:32.398111 [info ] [Thread-2  ]: 33 of 101 START snapshot stg.AH_ImportedCategoryMap_Incr........................ [RUN]
15:45:32.398611 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
15:45:32.398809 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ImportedCategoryMap_Incr
15:45:32.398983 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ImportedCategoryMap_Incr
15:45:32.401751 [debug] [Thread-2  ]: finished collecting timing info
15:45:32.401977 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ImportedCategoryMap_Incr
15:45:32.404743 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:32.404962 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:32.405120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:45:32.405290 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:32.406407 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:32.407510 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:32.407718 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
15:45:32.512243 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:32.548069 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:45:32.569987 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:32.570429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:32.615665 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:32.618010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:32.618320 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]
        ) as __dbt_sbq
    
15:45:32.700286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:32.722988 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:32.723422 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        ) as __dbt_sbq
    
15:45:32.800157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:32.804570 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:32.804884 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
15:45:32.944057 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:45:32.947401 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:32.947614 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalCategoryID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247''), CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalCategoryID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:32.593247'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end



    
15:45:33.661832 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:45:33.663422 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:33.663613 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:33.758952 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:33.761474 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:33.761675 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:34.250802 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
15:45:34.253955 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:34.254150 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
15:45:34.351873 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:34.355926 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:34.356130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:34.433283 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:34.434844 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:34.435067 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
15:45:35.597650 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.16 seconds
15:45:35.601142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:35.601349 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:35.604550 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
15:45:35.605720 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:35.605935 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:35.648773 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:35.650438 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:35.650732 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
15:45:35.691086 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:35.693915 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:35.694228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:35.962570 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:45:35.965645 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:35.965860 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
15:45:36.062033 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:36.067647 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:36.068003 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:36.110458 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:36.112160 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:36.112470 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
15:45:36.860832 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.91 seconds
15:45:36.864087 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:36.864269 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:36.906417 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:36.908134 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:36.908433 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
15:45:36.975577 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
15:45:36.977524 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:36.977828 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:37.054270 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:37.056725 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:37.056984 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:37.420652 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
15:45:37.422333 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:37.422602 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:37.498892 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:37.501924 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:37.502161 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:37.614076 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
15:45:37.617027 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:37.617229 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
15:45:37.701296 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:37.705400 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:37.706420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:37.751489 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.45 seconds
15:45:37.755389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:37.755611 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:37.757088 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:37.757363 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
15:45:37.755896 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:37.776672 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:45:37.778798 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feedbacks_Incr"
15:45:37.779536 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:37.779876 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr" (
                  "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:37.798601 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:37.800141 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:37.800434 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
15:45:37.898034 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
15:45:37.899563 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:37.899737 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:37.978108 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:37.980583 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:37.980788 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:38.537247 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
15:45:38.540417 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:38.540664 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
15:45:38.641926 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:38.645773 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:38.645975 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:38.703839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:38.705292 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:38.705464 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
15:45:38.972694 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
15:45:38.974304 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:38.974504 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:39.029536 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:39.032158 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:39.032358 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:39.474938 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
15:45:39.477756 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:39.477952 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
15:45:39.525319 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:39.532041 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:39.532376 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:39.571315 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:45:39.573409 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:39.573706 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:39.593688 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:39.595203 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:39.595456 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
15:45:39.611102 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
15:45:39.612800 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Feedbacks_Incr: COMMIT
15:45:39.613719 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
15:45:39.613960 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end

15:45:39.652548 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:39.655745 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:39.656094 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:39.694064 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:39.705339 [debug] [Thread-3  ]: finished collecting timing info
15:45:39.705771 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Feedbacks_Incr: Close
15:45:39.706571 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760546d0>]}
15:45:39.707104 [info ] [Thread-3  ]: 30 of 101 OK snapshotted stg.AH_Feedbacks_Incr.................................. [[32mOK[0m in 16.68s]
15:45:39.707544 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Feedbacks_Incr
15:45:39.707773 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ImportedListingsMap_Incr
15:45:39.708199 [info ] [Thread-3  ]: 34 of 101 START snapshot stg.AH_ImportedListingsMap_Incr........................ [RUN]
15:45:39.708667 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr"
15:45:39.708856 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ImportedListingsMap_Incr
15:45:39.709026 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ImportedListingsMap_Incr
15:45:39.711856 [debug] [Thread-3  ]: finished collecting timing info
15:45:39.712085 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ImportedListingsMap_Incr
15:45:39.714841 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:39.715059 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:39.715217 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:45:39.715389 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:39.845658 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:39.881814 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:45:39.904612 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:39.905054 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:39.934931 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:39.937161 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:39.937452 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]
        ) as __dbt_sbq
    
15:45:39.937780 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
15:45:39.939337 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:39.939572 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:39.965259 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:45:39.967966 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:39.968248 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
15:45:39.973145 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:39.975302 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:39.975518 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:39.990118 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:40.011177 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:40.011618 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        ) as __dbt_sbq
    
15:45:40.063242 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:40.068385 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:40.068731 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:40.088845 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:40.092376 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:40.092682 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
15:45:40.126625 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:40.128538 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:40.128831 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
15:45:40.170773 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:40.174296 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:40.174758 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LoCallistingID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491''), CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LoCallistingID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:39.921491'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end



    
15:45:40.243755 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:45:40.247673 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:40.247876 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
15:45:40.309125 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:40.395758 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:40.396195 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:40.454273 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:40.455832 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:40.456011 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
15:45:40.529542 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
15:45:40.531230 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:40.531462 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:40.748923 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:45:40.751574 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:40.751766 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:41.513498 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:45:41.515215 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:41.515439 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:41.555379 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
15:45:41.557295 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:41.557503 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:41.565799 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:41.568389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:41.568730 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:41.596613 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:41.599237 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:41.599535 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:41.636865 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
15:45:41.639327 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeproperties_Incr"
15:45:41.639973 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:41.640176 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr" (
                  "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:41.827002 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:45:41.829086 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
15:45:41.829528 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:41.829675 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr" (
                  "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:42.214324 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
15:45:42.217517 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:42.217722 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
15:45:42.275659 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:42.279931 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:42.280226 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:42.326819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:42.328575 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:42.328889 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
15:45:43.745899 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.11 seconds
15:45:43.747688 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeproperties_Incr: COMMIT
15:45:43.748471 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
15:45:43.748627 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end

15:45:43.800387 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:43.809739 [debug] [Thread-4  ]: finished collecting timing info
15:45:43.810187 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeproperties_Incr: Close
15:45:43.811031 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37743734f0>]}
15:45:43.811571 [info ] [Thread-4  ]: 31 of 101 OK snapshotted stg.AH_Feeproperties_Incr.............................. [[32mOK[0m in 16.82s]
15:45:43.812008 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Feeproperties_Incr
15:45:43.812227 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ImportedUserMap_Incr
15:45:43.812654 [info ] [Thread-4  ]: 35 of 101 START snapshot stg.AH_ImportedUserMap_Incr............................ [RUN]
15:45:43.813129 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr"
15:45:43.813316 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ImportedUserMap_Incr
15:45:43.813488 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ImportedUserMap_Incr
15:45:43.816398 [debug] [Thread-4  ]: finished collecting timing info
15:45:43.816642 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ImportedUserMap_Incr
15:45:43.819989 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:43.820210 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:43.820369 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:45:43.820545 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:43.862138 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
15:45:43.863924 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: COMMIT
15:45:43.864761 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
15:45:43.864973 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end

15:45:43.928423 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:43.937687 [debug] [Thread-2  ]: finished collecting timing info
15:45:43.938179 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: Close
15:45:43.939049 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776054ac0>]}
15:45:43.939618 [info ] [Thread-2  ]: 33 of 101 OK snapshotted stg.AH_ImportedCategoryMap_Incr........................ [[32mOK[0m in 11.54s]
15:45:43.940065 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
15:45:43.940288 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ImportedregionMap_Incr
15:45:43.940729 [info ] [Thread-2  ]: 36 of 101 START snapshot stg.AH_ImportedregionMap_Incr.......................... [RUN]
15:45:43.941217 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr"
15:45:43.941408 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ImportedregionMap_Incr
15:45:43.943190 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:43.943417 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ImportedregionMap_Incr
15:45:43.947109 [debug] [Thread-2  ]: finished collecting timing info
15:45:43.947352 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ImportedregionMap_Incr
15:45:43.950218 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:43.950442 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:43.950623 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:45:43.950805 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:43.973100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:45:43.998633 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:43.999148 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:44.052026 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:44.054531 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:44.054909 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]
        ) as __dbt_sbq
    
15:45:44.077953 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:44.106207 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:45:44.120670 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:44.139447 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:44.149847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:44.149472 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:44.150217 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        ) as __dbt_sbq
    
15:45:44.181151 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:44.183394 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:44.183684 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]
        ) as __dbt_sbq
    
15:45:44.202707 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:44.206591 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:44.206886 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
15:45:44.241584 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.91 seconds
15:45:44.243561 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:44.242149 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:44.243842 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:44.265083 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:44.265358 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        ) as __dbt_sbq
    
15:45:44.290564 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:44.294265 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:44.294453 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:44.297327 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:44.297563 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalUserID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310''), CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalUserID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.015310'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end



    
15:45:44.294698 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:44.310992 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:44.315252 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:44.315584 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
15:45:44.383847 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:44.387168 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:44.387467 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalregionID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555''), CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalregionID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:44.171555'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end



    
15:45:44.538222 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.36 seconds
15:45:44.541523 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:44.541737 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:44.577374 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:44.579101 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:44.579432 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
15:45:44.838788 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
15:45:44.840854 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeschedules_Incr"
15:45:44.841276 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:44.841403 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:45.602143 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
15:45:45.603806 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:45.603996 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:45.693773 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:45.696289 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:45.696530 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:45.927254 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:45:45.930165 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:45.930341 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
15:45:46.005863 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:46.009854 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:46.010067 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:46.049864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:46.051437 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:46.051629 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
15:45:46.274902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
15:45:46.276646 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Feeschedules_Incr: COMMIT
15:45:46.277418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
15:45:46.277571 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end

15:45:46.318168 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:46.328397 [debug] [Thread-1  ]: finished collecting timing info
15:45:46.328927 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Feeschedules_Incr: Close
15:45:46.329766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37744a4490>]}
15:45:46.330327 [info ] [Thread-1  ]: 32 of 101 OK snapshotted stg.AH_Feeschedules_Incr............................... [[32mOK[0m in 17.46s]
15:45:46.330804 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Feeschedules_Incr
15:45:46.331036 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Increments_Incr
15:45:46.331475 [info ] [Thread-1  ]: 37 of 101 START snapshot stg.AH_Increments_Incr................................. [RUN]
15:45:46.331980 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Increments_Incr"
15:45:46.332173 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Increments_Incr
15:45:46.332348 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Increments_Incr
15:45:46.335367 [debug] [Thread-1  ]: finished collecting timing info
15:45:46.335606 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Increments_Incr
15:45:46.339432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:46.339679 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:46.339843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:45:46.340021 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:46.447987 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:46.476149 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:45:46.498702 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:46.499145 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:46.543996 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:46.546351 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:46.546712 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Increments_InterView]
        ) as __dbt_sbq
    
15:45:46.612376 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:46.636055 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:46.636483 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        ) as __dbt_sbq
    
15:45:46.698424 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:46.702046 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:46.702413 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
15:45:46.798911 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:46.802847 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:46.803095 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Increments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Increments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968''), CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:46.530968'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Increments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Increments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end



    
15:45:46.987637 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
15:45:46.989309 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:46.989508 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:47.088875 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:47.091239 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:47.091432 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:47.472270 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:45:47.475578 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:47.475836 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
15:45:47.576348 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:47.580553 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:47.580835 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:47.633582 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:47.635134 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:47.635346 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
15:45:48.401488 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.10 seconds
15:45:48.405011 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:48.405231 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:48.456856 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:48.458387 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:48.459538 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
15:45:48.509996 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.12 seconds
15:45:48.513224 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:48.513446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:48.551303 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:48.552738 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:48.552923 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
15:45:48.585033 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
15:45:48.586734 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:48.586940 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:48.630937 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:48.633615 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:48.633956 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:49.050501 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
15:45:49.052614 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedListingsMap_Incr"
15:45:49.053059 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:49.053191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr" (
                  "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:49.457513 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
15:45:49.459198 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:49.459397 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:49.556619 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:49.559539 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:49.559773 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:49.797162 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:45:49.799909 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:49.800124 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
15:45:49.859389 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
15:45:49.861217 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:49.861417 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:49.885955 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:49.891191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:49.891566 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:49.936319 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:49.938820 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:49.939120 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:49.959042 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:49.960749 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:49.961051 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
15:45:50.188943 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:45:50.192221 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:50.194706 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
15:45:50.275327 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:50.282252 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:50.282672 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:50.329590 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:50.331373 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:50.331682 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
15:45:50.542472 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
15:45:50.544425 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: COMMIT
15:45:50.545373 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
15:45:50.545616 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end

15:45:50.584853 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:50.594139 [debug] [Thread-3  ]: finished collecting timing info
15:45:50.598797 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: Close
15:45:50.599824 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776054c10>]}
15:45:50.600410 [info ] [Thread-3  ]: 34 of 101 OK snapshotted stg.AH_ImportedListingsMap_Incr........................ [[32mOK[0m in 10.89s]
15:45:50.600861 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ImportedListingsMap_Incr
15:45:50.601257 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Invoices_Incr
15:45:50.601721 [info ] [Thread-3  ]: 38 of 101 START snapshot stg.AH_Invoices_Incr................................... [RUN]
15:45:50.602237 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Invoices_Incr"
15:45:50.602432 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Invoices_Incr
15:45:50.602636 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Invoices_Incr
15:45:50.605587 [debug] [Thread-3  ]: finished collecting timing info
15:45:50.605832 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Invoices_Incr
15:45:50.608868 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:45:50.609103 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:50.609266 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:45:50.609444 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:50.739754 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:50.774352 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:45:50.802230 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:45:50.802716 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:50.838278 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:50.840581 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:45:50.840870 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Invoices_InterView]
        ) as __dbt_sbq
    
15:45:50.951712 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:45:50.973283 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:45:50.973749 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        ) as __dbt_sbq
    
15:45:51.042635 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:51.046753 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:45:51.047130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
15:45:51.148864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:45:51.153508 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:45:51.153800 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Invoices_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914''), CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:50.827914'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Invoices_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end



    
15:45:51.165824 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
15:45:51.167571 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:51.167881 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:51.202241 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:51.204660 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:51.204956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:51.322771 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
15:45:51.324564 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:51.324889 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:51.368332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:51.371910 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:51.372245 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:51.568782 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
15:45:51.571888 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:51.572260 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
15:45:51.617154 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:51.621764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:51.622110 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:51.659804 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:51.661837 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:51.662156 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
15:45:51.674931 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:45:51.677966 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:51.678311 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
15:45:51.716805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:51.721399 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:51.721755 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:51.760407 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:51.762069 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:51.762372 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
15:45:53.239288 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
15:45:53.241134 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:53.241453 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:53.244836 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
15:45:53.246658 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:53.246927 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:53.276045 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:53.278814 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:53.279182 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:53.287162 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:53.289659 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:53.290058 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:53.564499 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:45:53.566839 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedUserMap_Incr"
15:45:53.567519 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:53.567739 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr" (
                  "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:53.619294 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:45:53.622269 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedregionMap_Incr"
15:45:53.623014 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:53.623244 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr" (
                  "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:45:55.086652 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.28 seconds
15:45:55.090341 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:55.090726 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:55.137912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:55.139479 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:55.139773 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
15:45:55.485316 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
15:45:55.487232 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: COMMIT
15:45:55.488088 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
15:45:55.488313 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end

15:45:55.489172 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
15:45:55.490351 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: COMMIT
15:45:55.491461 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
15:45:55.494655 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end

15:45:55.546329 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:55.548468 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:55.558211 [debug] [Thread-2  ]: finished collecting timing info
15:45:55.566072 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: Close
15:45:55.566911 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37743f6130>]}
15:45:55.567489 [info ] [Thread-2  ]: 36 of 101 OK snapshotted stg.AH_ImportedregionMap_Incr.......................... [[32mOK[0m in 11.63s]
15:45:55.567927 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ImportedregionMap_Incr
15:45:55.568156 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_KeyTable_Incr
15:45:55.568594 [info ] [Thread-2  ]: 39 of 101 START snapshot stg.AH_KeyTable_Incr................................... [RUN]
15:45:55.569080 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_KeyTable_Incr"
15:45:55.569270 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_KeyTable_Incr
15:45:55.569441 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_KeyTable_Incr
15:45:55.565581 [debug] [Thread-4  ]: finished collecting timing info
15:45:55.573989 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: Close
15:45:55.574678 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776054d60>]}
15:45:55.575131 [info ] [Thread-4  ]: 35 of 101 OK snapshotted stg.AH_ImportedUserMap_Incr............................ [[32mOK[0m in 11.76s]
15:45:55.575526 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ImportedUserMap_Incr
15:45:55.575743 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Languages_Incr
15:45:55.576139 [info ] [Thread-4  ]: 40 of 101 START snapshot stg.AH_Languages_Incr.................................. [RUN]
15:45:55.576592 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Languages_Incr"
15:45:55.576780 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Languages_Incr
15:45:55.576946 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Languages_Incr
15:45:55.573692 [debug] [Thread-2  ]: finished collecting timing info
15:45:55.580185 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_KeyTable_Incr
15:45:55.583112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:55.583349 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:55.583507 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:45:55.583678 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:55.579923 [debug] [Thread-4  ]: finished collecting timing info
15:45:55.584856 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Languages_Incr
15:45:55.588142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:45:55.589364 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:45:55.589563 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:45:55.589755 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:45:55.690859 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:55.695021 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:45:55.730622 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:45:55.752561 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:45:55.752984 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:45:55.753288 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:55.775809 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:55.778283 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:45:55.789491 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:55.791570 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:45:55.798731 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Languages_InterView]
        ) as __dbt_sbq
    
15:45:55.806285 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:45:55.809913 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:55.810238 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_KeyTable_InterView]
        ) as __dbt_sbq
    
15:45:55.858901 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:55.880718 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:55.895448 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:45:55.895880 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        ) as __dbt_sbq
    
15:45:55.906589 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:55.906998 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        ) as __dbt_sbq
    
15:45:55.955418 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:55.959234 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:45:55.959654 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
15:45:55.973894 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:55.977489 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:55.977858 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
15:45:56.042509 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:56.045931 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:45:56.046314 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Languages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Languages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113''), CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.781113'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Languages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Languages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end



    
15:45:56.062321 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:45:56.065937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:56.066308 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_KeyTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_KeyTable_InterView]

    ),

    snapshotted_data as (

        select *,
            NextID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743''), CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(NextID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:45:55.796743'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_KeyTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_KeyTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end



    
15:45:56.658575 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
15:45:56.660373 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:56.660680 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:56.751866 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:56.754794 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:56.755020 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:57.090916 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:45:57.093788 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:57.098768 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
15:45:57.186696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:45:57.193428 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:57.194717 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:57.265907 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:45:57.267972 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:57.268283 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
15:45:58.406690 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
15:45:58.408551 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:58.409063 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:45:58.450106 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:58.452969 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:58.453346 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:59.069319 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
15:45:59.072622 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:59.072990 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
15:45:59.098030 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.03 seconds
15:45:59.101435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:59.101835 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:59.125677 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:45:59.130258 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:59.130753 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:45:59.146909 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:45:59.148694 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:45:59.149001 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
15:45:59.194744 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:45:59.196348 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:45:59.196719 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
15:46:00.516179 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
15:46:00.517974 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:46:00.518286 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:00.560755 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:00.563690 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:46:00.564112 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:00.589548 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
15:46:00.591466 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:00.594768 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:00.686703 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:00.689392 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:00.689664 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:00.954212 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:46:00.956357 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Increments_Incr"
15:46:00.956861 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:46:00.957007 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Increments_Incr" (
                  "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:00.957250 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:46:00.959727 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:00.959987 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
15:46:01.049437 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:01.053463 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:01.053715 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:01.101467 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:01.103308 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:01.103603 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
15:46:02.316366 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
15:46:02.318226 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:02.318605 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:02.392063 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:02.397129 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:02.398694 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:02.716086 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:46:02.721347 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:02.721732 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
15:46:02.811750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:02.816771 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:02.817165 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:02.859813 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:02.862014 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:02.862344 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
15:46:02.995764 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.95 seconds
15:46:02.999231 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:02.999632 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:03.046909 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.09 seconds
15:46:03.048873 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Increments_Incr: COMMIT
15:46:03.049817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
15:46:03.050058 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end

15:46:03.062979 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:03.064630 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:03.064940 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
15:46:03.099601 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:03.108737 [debug] [Thread-1  ]: finished collecting timing info
15:46:03.109269 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Increments_Incr: Close
15:46:03.110131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776054eb0>]}
15:46:03.110734 [info ] [Thread-1  ]: 37 of 101 OK snapshotted stg.AH_Increments_Incr................................. [[32mOK[0m in 16.78s]
15:46:03.111189 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Increments_Incr
15:46:03.111433 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_LineItems_Incr
15:46:03.111875 [info ] [Thread-1  ]: 41 of 101 START snapshot stg.AH_LineItems_Incr.................................. [RUN]
15:46:03.112384 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LineItems_Incr"
15:46:03.112582 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_LineItems_Incr
15:46:03.112758 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_LineItems_Incr
15:46:03.115715 [debug] [Thread-1  ]: finished collecting timing info
15:46:03.115950 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_LineItems_Incr
15:46:03.118866 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:03.119090 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:03.119251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:46:03.119425 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:03.226090 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:03.274580 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:46:03.301270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:03.301727 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:03.333076 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:03.335515 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:03.335876 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LineItems_InterView]
        ) as __dbt_sbq
    
15:46:03.403501 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:03.431036 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:03.431464 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        ) as __dbt_sbq
    
15:46:03.624393 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:46:03.628418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:03.628766 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
15:46:03.718577 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:03.722406 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:03.722856 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LineItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484''), CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:03.312484'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LineItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end



    
15:46:03.802060 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
15:46:03.803970 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:03.804328 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:03.859485 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:03.862798 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:03.863162 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:04.172990 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:46:04.175059 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_KeyTable_Incr"
15:46:04.175505 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:04.175643 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr" (
                  "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:04.283083 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
15:46:04.284615 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:04.284809 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:04.374528 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:04.377331 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:04.378083 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:04.958796 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
15:46:04.961585 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:04.961776 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
15:46:05.041718 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:05.045599 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:05.045834 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:05.088381 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:05.090235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:05.090533 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
15:46:05.901475 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
15:46:05.903239 [debug] [Thread-2  ]: On snapshot.Shawn.AH_KeyTable_Incr: COMMIT
15:46:05.904295 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
15:46:05.904454 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end

15:46:05.961610 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:05.970321 [debug] [Thread-2  ]: finished collecting timing info
15:46:05.970696 [debug] [Thread-2  ]: On snapshot.Shawn.AH_KeyTable_Incr: Close
15:46:05.971457 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37745eb070>]}
15:46:05.971966 [info ] [Thread-2  ]: 39 of 101 OK snapshotted stg.AH_KeyTable_Incr................................... [[32mOK[0m in 10.40s]
15:46:05.972393 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_KeyTable_Incr
15:46:05.972614 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingActionproperties_Incr
15:46:05.973041 [info ] [Thread-2  ]: 42 of 101 START snapshot stg.AH_ListingActionproperties_Incr.................... [RUN]
15:46:05.973518 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr"
15:46:05.973707 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingActionproperties_Incr
15:46:05.973876 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingActionproperties_Incr
15:46:05.976770 [debug] [Thread-2  ]: finished collecting timing info
15:46:05.976996 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingActionproperties_Incr
15:46:05.981192 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:05.981709 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:05.981873 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:46:05.982046 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:06.018904 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
15:46:06.020671 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:06.020951 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:06.083198 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:06.103819 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:06.106662 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:06.106956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:06.122352 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:46:06.143783 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:06.144198 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:06.169946 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:06.172306 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:06.172616 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]
        ) as __dbt_sbq
    
15:46:06.248683 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:06.272437 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:06.272876 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        ) as __dbt_sbq
    
15:46:06.431285 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:46:06.434484 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:06.434972 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
15:46:06.462838 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:46:06.466625 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:06.466977 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
15:46:06.505228 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:06.509928 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:06.510252 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:06.534450 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:06.538557 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:06.538915 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280''), CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:06.156280'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end



    
15:46:06.548076 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:06.549441 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:06.549702 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
15:46:07.477833 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
15:46:07.479628 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:07.479963 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:07.517003 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:07.519702 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:07.520013 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:08.246567 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.73 seconds
15:46:08.248711 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Languages_Incr"
15:46:08.249176 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:08.249317 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Languages_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:09.914511 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
15:46:09.916112 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Languages_Incr: COMMIT
15:46:09.917268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
15:46:09.917429 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end

15:46:09.969881 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:09.980153 [debug] [Thread-4  ]: finished collecting timing info
15:46:09.980554 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Languages_Incr: Close
15:46:09.981308 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760322e0>]}
15:46:09.981816 [info ] [Thread-4  ]: 40 of 101 OK snapshotted stg.AH_Languages_Incr.................................. [[32mOK[0m in 14.40s]
15:46:09.982230 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Languages_Incr
15:46:09.982452 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingActions_Incr
15:46:09.982909 [info ] [Thread-4  ]: 43 of 101 START snapshot stg.AH_ListingActions_Incr............................. [RUN]
15:46:09.983387 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActions_Incr"
15:46:09.983636 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingActions_Incr
15:46:09.983822 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingActions_Incr
15:46:09.986844 [debug] [Thread-4  ]: finished collecting timing info
15:46:09.987075 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingActions_Incr
15:46:09.990842 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:09.991062 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:09.991221 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:46:09.991390 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:10.176358 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:10.206127 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:46:10.228400 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:10.228773 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:10.273429 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:10.275826 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:10.276145 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActions_InterView]
        ) as __dbt_sbq
    
15:46:10.340367 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:10.363003 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:10.363404 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        ) as __dbt_sbq
    
15:46:10.782596 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
15:46:10.785908 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:10.786102 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
15:46:10.864325 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:10.868179 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:10.868386 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090''), CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:10.250090'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end



    
15:46:25.770592 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 19.23 seconds
15:46:25.775108 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:25.775446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:25.827440 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:25.829795 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:25.830111 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
15:46:27.440072 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
15:46:27.441757 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:27.441942 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:27.539073 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:46:27.541778 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:27.541982 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:27.840410 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:46:27.843376 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:27.843623 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
15:46:27.934489 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:27.939128 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:27.939473 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:28.006192 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:28.007797 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:28.007981 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
15:46:29.159519 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
15:46:29.161186 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:29.161391 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:29.162701 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 25.44 seconds
15:46:29.165631 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:29.165794 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:29.217475 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:29.221120 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:29.221495 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:29.236018 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:29.237662 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:29.237965 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
15:46:29.490598 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:46:29.493643 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:29.493867 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
15:46:29.532234 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:29.536890 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:29.537232 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:29.573963 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:29.575652 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:29.575938 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
15:46:31.006667 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:46:31.008296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:31.008510 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:31.192585 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:46:31.195774 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:31.196035 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:31.546594 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:46:31.549746 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:31.550064 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
15:46:31.619256 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.04 seconds
15:46:31.620931 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:31.621201 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:31.694588 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:31.698952 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:31.699291 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:31.713597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:46:31.719586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:31.719896 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:31.797987 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:31.799548 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:31.799762 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
15:46:32.051490 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:46:32.053816 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActionproperties_Incr"
15:46:32.054280 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:32.054422 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr" (
                  "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:32.328612 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 21.46 seconds
15:46:32.332218 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:32.332445 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:32.403401 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:32.404951 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:32.405171 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
15:46:33.119904 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
15:46:33.121589 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:33.121801 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:33.213871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:33.216591 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:33.216802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:33.492148 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:46:33.495352 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:33.495587 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
15:46:33.572152 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:33.577011 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:33.577282 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:33.626250 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:33.627965 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:33.628257 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
15:46:33.650050 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
15:46:33.652337 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:33.652643 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:33.725506 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:33.729668 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:33.730002 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:33.867601 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 42.71 seconds
15:46:33.871847 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:33.872079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:33.923779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:33.925318 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:33.925522 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
15:46:33.946982 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
15:46:33.949632 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: COMMIT
15:46:33.950956 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
15:46:33.951199 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end

15:46:34.040933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:34.050621 [debug] [Thread-2  ]: finished collecting timing info
15:46:34.051065 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: Close
15:46:34.051845 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37744335b0>]}
15:46:34.052379 [info ] [Thread-2  ]: 42 of 101 OK snapshotted stg.AH_ListingActionproperties_Incr.................... [[32mOK[0m in 28.08s]
15:46:34.052803 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingActionproperties_Incr
15:46:34.053030 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
15:46:34.053444 [info ] [Thread-2  ]: 44 of 101 START snapshot stg.AH_ListingCommentsMedias_Incr...................... [RUN]
15:46:34.053908 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
15:46:34.054098 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingCommentsMedias_Incr
15:46:34.054270 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingCommentsMedias_Incr
15:46:34.057183 [debug] [Thread-2  ]: finished collecting timing info
15:46:34.057424 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingCommentsMedias_Incr
15:46:34.061202 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:34.061440 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:34.061653 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:46:34.061833 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:34.187318 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:34.198214 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
15:46:34.201168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:34.201447 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
15:46:34.227098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:46:34.249021 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:34.249459 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:34.284711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:34.287117 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:34.287465 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]
        ) as __dbt_sbq
    
15:46:34.302666 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:46:34.307247 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:34.307584 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:34.340442 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:34.363270 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:34.363530 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:34.364975 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:34.365206 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
15:46:34.363833 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        ) as __dbt_sbq
    
15:46:34.459075 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:34.463365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:34.463696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
15:46:34.549379 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:34.554248 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:34.554671 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084''), CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:34.266084'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end



    
15:46:35.687890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
15:46:35.689442 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:35.689625 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:35.699267 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:46:35.700758 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:35.700955 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:35.701205 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.07 seconds
15:46:35.703437 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:35.703619 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:35.777877 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:35.781521 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:35.781729 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:35.782820 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:35.785825 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:35.786051 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:35.793370 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:35.795934 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:35.796216 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:36.123416 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:46:36.126078 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LineItems_Incr"
15:46:36.126512 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:36.126876 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LineItems_Incr" (
                  "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:36.177269 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:46:36.178783 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:46:36.183169 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:36.184921 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
15:46:36.184682 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:36.185252 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
15:46:36.228370 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:36.232947 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:36.233329 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:36.256292 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:36.261405 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:36.261691 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:36.285660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:36.287282 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:36.287560 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
15:46:36.301770 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:36.304233 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:36.304542 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
15:46:37.640426 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
15:46:37.642239 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:37.642522 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:37.690488 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:37.693484 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:37.693829 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:37.973468 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:46:37.975851 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActions_Incr"
15:46:37.976339 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:37.976498 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr" (
                  "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:38.100911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
15:46:38.102837 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:38.103053 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:38.138053 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:38.141972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:38.142212 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:38.165870 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.04 seconds
15:46:38.167621 [debug] [Thread-1  ]: On snapshot.Shawn.AH_LineItems_Incr: COMMIT
15:46:38.168536 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
15:46:38.168770 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end

15:46:38.258169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:38.269059 [debug] [Thread-1  ]: finished collecting timing info
15:46:38.269530 [debug] [Thread-1  ]: On snapshot.Shawn.AH_LineItems_Incr: Close
15:46:38.270323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776032580>]}
15:46:38.270929 [info ] [Thread-1  ]: 41 of 101 OK snapshotted stg.AH_LineItems_Incr.................................. [[32mOK[0m in 35.16s]
15:46:38.271370 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_LineItems_Incr
15:46:38.271593 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingComments_Incr
15:46:38.272011 [info ] [Thread-1  ]: 45 of 101 START snapshot stg.AH_ListingComments_Incr............................ [RUN]
15:46:38.272490 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingComments_Incr"
15:46:38.272679 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingComments_Incr
15:46:38.273010 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingComments_Incr
15:46:38.276128 [debug] [Thread-1  ]: finished collecting timing info
15:46:38.276361 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingComments_Incr
15:46:38.279204 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:38.279426 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:38.279584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:46:38.279756 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:38.377675 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:38.408576 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:46:38.430390 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:38.430832 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:38.462951 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:38.465262 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:38.465575 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingComments_InterView]
        ) as __dbt_sbq
    
15:46:38.538273 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:38.562125 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:38.562535 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        ) as __dbt_sbq
    
15:46:38.743511 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.60 seconds
15:46:38.746384 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:38.746783 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
15:46:38.798496 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:38.804260 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:38.804639 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:38.905653 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:46:38.907430 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:38.907608 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
15:46:39.317113 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.75 seconds
15:46:39.320438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:39.320646 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
15:46:39.403257 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:39.407693 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:39.407996 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingComments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingComments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033''), CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:38.438033'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingComments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingComments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end



    
15:46:39.526776 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
15:46:39.528535 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActions_Incr: COMMIT
15:46:39.529357 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
15:46:39.529509 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end

15:46:39.579460 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:39.590839 [debug] [Thread-4  ]: finished collecting timing info
15:46:39.591251 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActions_Incr: Close
15:46:39.592047 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377435a7f0>]}
15:46:39.592574 [info ] [Thread-4  ]: 43 of 101 OK snapshotted stg.AH_ListingActions_Incr............................. [[32mOK[0m in 29.61s]
15:46:39.593015 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingActions_Incr
15:46:39.593240 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
15:46:39.593662 [info ] [Thread-4  ]: 46 of 101 START snapshot stg.AH_ListingEnddttmAudit_Incr........................ [RUN]
15:46:39.594140 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
15:46:39.594332 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
15:46:39.594502 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingEnddttmAudit_Incr
15:46:39.597406 [debug] [Thread-4  ]: finished collecting timing info
15:46:39.597634 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
15:46:39.600538 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:39.600757 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:39.600926 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:46:39.601102 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:39.712122 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:39.740960 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:46:39.763319 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:39.763802 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:39.790425 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:39.792607 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:39.792876 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]
        ) as __dbt_sbq
    
15:46:39.911555 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:46:39.934145 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:39.934612 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        ) as __dbt_sbq
    
15:46:39.996385 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:39.999865 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:40.000218 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
15:46:40.090126 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:40.095137 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:40.095466 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797''), CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:39.781797'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end



    
15:46:40.292206 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:46:40.293865 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:40.294060 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:40.333651 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:40.337336 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:40.337644 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:41.190048 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
15:46:41.192997 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Invoices_Incr"
15:46:41.193391 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:41.193514 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Invoices_Incr" (
                  "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:43.751709 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.56 seconds
15:46:43.753390 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Invoices_Incr: COMMIT
15:46:43.755343 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
15:46:43.755582 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end

15:46:43.795340 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:43.804963 [debug] [Thread-3  ]: finished collecting timing info
15:46:43.805386 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Invoices_Incr: Close
15:46:43.806176 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776032190>]}
15:46:43.806763 [info ] [Thread-3  ]: 38 of 101 OK snapshotted stg.AH_Invoices_Incr................................... [[32mOK[0m in 53.20s]
15:46:43.807192 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Invoices_Incr
15:46:43.807430 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingLocations_Incr
15:46:43.807858 [info ] [Thread-3  ]: 47 of 101 START snapshot stg.AH_ListingLocations_Incr........................... [RUN]
15:46:43.808345 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingLocations_Incr"
15:46:43.808533 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingLocations_Incr
15:46:43.808701 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingLocations_Incr
15:46:43.811597 [debug] [Thread-3  ]: finished collecting timing info
15:46:43.811826 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingLocations_Incr
15:46:43.814659 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:43.814875 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:43.815034 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:46:43.815220 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:43.912542 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:43.945689 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:46:43.969004 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:43.969447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:44.000322 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:44.002700 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:44.003023 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingLocations_InterView]
        ) as __dbt_sbq
    
15:46:44.091144 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:44.112585 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:44.113019 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        ) as __dbt_sbq
    
15:46:44.163107 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:44.168551 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:44.168852 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
15:46:44.307927 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:46:44.311772 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:44.311995 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingLocations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingLocations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990''), CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:43.984990'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingLocations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end



    
15:46:44.908632 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 10.35 seconds
15:46:44.912177 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:44.912383 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:44.952773 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:44.954488 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:44.954807 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
15:46:46.657239 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
15:46:46.658967 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:46.659208 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:46.822620 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:46:46.825209 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:46.825437 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:47.090591 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:46:47.094127 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:47.094366 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
15:46:47.166635 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:47.172087 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:47.172494 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:47.214766 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:47.216458 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:47.216766 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
15:46:48.095265 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.00 seconds
15:46:48.098992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:48.099237 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:48.164147 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:48.165729 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:48.165920 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
15:46:48.398041 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
15:46:48.399751 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:48.399948 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:48.437076 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:48.439706 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:48.439935 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:48.709166 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:46:48.712351 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:48.712653 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
15:46:48.795140 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:48.800804 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:48.801613 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:48.840624 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:48.842417 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:48.842817 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
15:46:49.090356 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:46:49.092050 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:49.092249 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:49.175890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:49.178362 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:49.178634 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:49.578202 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:46:49.581647 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:49.582074 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
15:46:49.656259 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:49.661889 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:49.662312 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:49.696211 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
15:46:49.698055 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:49.698365 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:49.708336 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:49.709970 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:49.710262 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
15:46:49.733529 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:49.736275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:49.736603 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:50.061532 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:46:50.063768 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
15:46:50.064248 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:50.064391 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:50.817336 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
15:46:50.819018 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:50.819212 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:50.892975 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:50.896036 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:50.896295 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:51.165625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.85 seconds
15:46:51.169283 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:51.169525 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:51.208592 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:51.210374 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:51.210743 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
15:46:51.226973 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:46:51.229862 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:51.230221 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
15:46:51.297490 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:51.302721 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:51.303184 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:51.830527 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:46:51.832335 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: COMMIT
15:46:51.833166 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
15:46:51.833318 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end

15:46:51.839138 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
15:46:51.840445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:51.840618 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
15:46:51.895571 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:51.999982 [debug] [Thread-2  ]: finished collecting timing info
15:46:52.000512 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: Close
15:46:52.001382 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776032c10>]}
15:46:52.001944 [info ] [Thread-2  ]: 44 of 101 OK snapshotted stg.AH_ListingCommentsMedias_Incr...................... [[32mOK[0m in 17.95s]
15:46:52.002389 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
15:46:52.002683 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingMedias_Incr
15:46:52.003134 [info ] [Thread-2  ]: 48 of 101 START snapshot stg.AH_ListingMedias_Incr.............................. [RUN]
15:46:52.003645 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingMedias_Incr"
15:46:52.003836 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingMedias_Incr
15:46:52.004009 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingMedias_Incr
15:46:52.007132 [debug] [Thread-2  ]: finished collecting timing info
15:46:52.007372 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingMedias_Incr
15:46:52.010119 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:46:52.010355 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:52.010516 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:46:52.010732 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:52.161016 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:52.213060 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:46:52.236094 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:46:52.236589 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:52.274911 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:52.277081 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:46:52.277397 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingMedias_InterView]
        ) as __dbt_sbq
    
15:46:52.368387 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:52.389698 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:46:52.390178 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        ) as __dbt_sbq
    
15:46:52.499044 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:46:52.502946 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:46:52.503280 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
15:46:52.584252 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:52.587990 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:46:52.588264 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750''), CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:52.250750'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end



    
15:46:52.936508 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
15:46:52.938077 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:52.938257 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:53.036925 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:46:53.039594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:53.039820 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:53.110890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
15:46:53.112582 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:53.112787 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:53.196890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:53.200505 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:53.201374 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:53.280472 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:46:53.283470 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:53.283692 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
15:46:53.375220 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:53.379943 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:53.380318 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:53.421375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:53.423119 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:53.423422 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
15:46:53.450296 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:46:53.452661 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
15:46:53.453400 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:53.453634 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr" (
                  "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:54.846470 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
15:46:54.848039 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:54.848212 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:54.893517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:46:54.896139 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:54.896358 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:54.942178 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 15.53 seconds
15:46:54.947049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:54.947394 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:55.011557 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:55.013510 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:55.013811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
15:46:55.139029 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:46:55.142008 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:55.142248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
15:46:55.211656 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:55.216108 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:55.216468 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:55.294129 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:55.295783 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:55.296026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
15:46:55.417062 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.96 seconds
15:46:55.418843 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: COMMIT
15:46:55.419891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
15:46:55.420052 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end

15:46:55.711586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:46:55.720938 [debug] [Thread-4  ]: finished collecting timing info
15:46:55.721420 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: Close
15:46:55.722242 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377421fdf0>]}
15:46:55.722820 [info ] [Thread-4  ]: 46 of 101 OK snapshotted stg.AH_ListingEnddttmAudit_Incr........................ [[32mOK[0m in 16.13s]
15:46:55.723270 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
15:46:55.723497 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
15:46:55.723928 [info ] [Thread-4  ]: 49 of 101 START snapshot stg.AH_ListingPaymentCharge_Incr....................... [RUN]
15:46:55.724424 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
15:46:55.724626 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingPaymentCharge_Incr
15:46:55.724800 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingPaymentCharge_Incr
15:46:55.727752 [debug] [Thread-4  ]: finished collecting timing info
15:46:55.727996 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingPaymentCharge_Incr
15:46:55.730899 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:46:55.731127 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:55.731288 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:46:55.731544 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:55.830293 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:55.862518 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:46:55.887011 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:46:55.887452 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:55.914910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:55.918104 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:46:55.918570 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]
        ) as __dbt_sbq
    
15:46:56.193445 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:46:56.214974 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:46:56.215437 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        ) as __dbt_sbq
    
15:46:56.363231 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
15:46:56.364906 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:56.365122 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:56.392076 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:46:56.393672 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:56.393882 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:56.410469 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:46:56.414310 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:46:56.414769 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
15:46:56.440722 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:56.443540 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:56.443914 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:56.500689 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:46:56.503937 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:56.504354 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:56.508702 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:46:56.512351 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:46:56.512703 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062''), CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:55.907062'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end



    
15:46:56.689912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:46:56.692171 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingLocations_Incr"
15:46:56.692669 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:56.692819 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr" (
                  "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:46:56.865947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
15:46:56.868700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:56.868899 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
15:46:56.940385 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:56.944568 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:56.944814 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:57.047514 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:46:57.049395 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:57.049606 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
15:46:58.877293 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
15:46:58.878994 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:58.879192 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:46:58.918691 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
15:46:58.920435 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingLocations_Incr: COMMIT
15:46:58.921241 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
15:46:58.921393 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end

15:46:58.958871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:46:58.961586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:58.961801 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:58.979199 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:58.989180 [debug] [Thread-3  ]: finished collecting timing info
15:46:58.989665 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingLocations_Incr: Close
15:46:58.990501 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37747561f0>]}
15:46:58.991119 [info ] [Thread-3  ]: 47 of 101 OK snapshotted stg.AH_ListingLocations_Incr........................... [[32mOK[0m in 15.18s]
15:46:58.991565 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingLocations_Incr
15:46:58.991791 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingQuestions_Incr
15:46:58.992311 [info ] [Thread-3  ]: 50 of 101 START snapshot stg.AH_ListingQuestions_Incr........................... [RUN]
15:46:58.992831 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr"
15:46:58.993027 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingQuestions_Incr
15:46:58.993200 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingQuestions_Incr
15:46:58.996197 [debug] [Thread-3  ]: finished collecting timing info
15:46:58.996431 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingQuestions_Incr
15:46:59.000191 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:46:59.000428 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:46:59.000592 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:46:59.000767 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:46:59.112757 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:46:59.147387 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:46:59.169595 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:46:59.170078 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:46:59.200060 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:46:59.202419 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:46:59.202775 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingQuestions_InterView]
        ) as __dbt_sbq
    
15:46:59.258195 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:46:59.281656 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:46:59.282102 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        ) as __dbt_sbq
    
15:46:59.298488 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:46:59.301426 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:59.301768 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
15:46:59.376476 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:59.384184 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:59.384617 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:46:59.422774 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:46:59.424828 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:46:59.425187 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
15:46:59.734828 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
15:46:59.738505 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:46:59.739082 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
15:46:59.813375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:46:59.817269 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:46:59.817636 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingQuestions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362''), CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:46:59.188362'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end



    
15:47:00.674613 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:47:00.676088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:47:00.676287 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:00.751028 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:00.753735 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:47:00.753923 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:01.359809 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.61 seconds
15:47:01.361994 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingComments_Incr"
15:47:01.362760 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:47:01.362975 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr" (
                  "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:03.025308 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
15:47:03.027028 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingComments_Incr: COMMIT
15:47:03.028131 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
15:47:03.028274 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end

15:47:03.104325 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:03.114939 [debug] [Thread-1  ]: finished collecting timing info
15:47:03.115367 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingComments_Incr: Close
15:47:03.116282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776032ac0>]}
15:47:03.116825 [info ] [Thread-1  ]: 45 of 101 OK snapshotted stg.AH_ListingComments_Incr............................ [[32mOK[0m in 24.84s]
15:47:03.117257 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingComments_Incr
15:47:03.117480 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
15:47:03.117908 [info ] [Thread-1  ]: 51 of 101 START snapshot stg.AH_ListingTypeFeeprovIDErs_Incr.................... [RUN]
15:47:03.118384 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
15:47:03.118598 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
15:47:03.118780 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
15:47:03.122226 [debug] [Thread-1  ]: finished collecting timing info
15:47:03.122456 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
15:47:03.125596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:03.125814 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:03.125976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:47:03.126149 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:03.269341 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:03.303934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:47:03.327132 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:03.327561 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:03.358849 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:03.361191 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:03.361495 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]
        ) as __dbt_sbq
    
15:47:03.424680 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:03.449454 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:03.450213 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        ) as __dbt_sbq
    
15:47:03.514297 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:03.517957 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:03.518291 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
15:47:03.589376 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:03.593283 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:03.593517 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673''), CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:03.344673'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
15:47:05.985774 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 9.47 seconds
15:47:05.989428 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:05.989659 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:06.034462 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:06.036192 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:06.036497 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
15:47:06.382134 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 13.79 seconds
15:47:06.385695 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:06.385927 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:06.454293 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:06.455991 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:06.456290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
15:47:07.092026 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:47:07.093708 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:07.093913 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:07.211799 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:47:07.214458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:07.214870 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:07.525432 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:47:07.528735 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:07.529023 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
15:47:07.602470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
15:47:07.604332 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:07.605452 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:07.624990 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:07.629468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:07.629827 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:07.671353 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:07.673106 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:07.673416 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
15:47:07.691519 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:07.694066 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:07.694374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:08.579350 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
15:47:08.582338 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:08.582532 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
15:47:08.662798 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:08.666789 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:08.667090 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:08.704641 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:08.706375 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:08.706685 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
15:47:08.909461 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.09 seconds
15:47:08.912964 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:08.913180 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:08.951386 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:08.953067 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:08.953382 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
15:47:09.040483 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
15:47:09.042024 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:09.042205 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:09.134909 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:09.137309 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:09.137493 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:09.438488 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:47:09.443546 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:09.443855 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
15:47:09.477554 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:09.482122 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:09.482454 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:09.535337 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:09.536938 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:09.537233 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
15:47:09.947025 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
15:47:09.948541 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:09.948726 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:10.031464 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:10.034085 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:10.034268 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:10.298671 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
15:47:10.300290 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:10.300478 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:10.301615 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:47:10.304016 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:10.304413 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
15:47:10.374599 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:10.377338 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:10.377589 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:10.378015 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:10.383095 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:10.383426 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:10.421020 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:10.422799 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:10.423124 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
15:47:10.496659 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
15:47:10.499351 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:10.499991 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:10.535858 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:10.538665 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:10.538983 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:10.587225 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.99 seconds
15:47:10.591045 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:10.591375 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:10.630910 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:10.632599 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:10.632895 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
15:47:10.642251 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:47:10.645050 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:10.645315 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
15:47:10.724369 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:10.728618 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:10.728953 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:10.758489 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:47:10.760745 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
15:47:10.761425 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:10.761634 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr" (
                  "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:10.767261 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:10.768559 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:10.768786 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
15:47:11.489493 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
15:47:11.491190 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:11.491394 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:11.529821 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:11.532353 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:11.532531 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:11.804513 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:47:11.806513 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingMedias_Incr"
15:47:11.806958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:11.807086 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:12.050977 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
15:47:12.052586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:12.052793 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:12.128960 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:12.131305 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:47:12.132514 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:12.132677 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:12.134698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:12.135216 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:12.182755 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:12.185313 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:12.186625 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:12.317573 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
15:47:12.319314 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: COMMIT
15:47:12.320093 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
15:47:12.320243 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end

15:47:12.425039 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:12.436055 [debug] [Thread-4  ]: finished collecting timing info
15:47:12.436283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:47:12.438778 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:12.439014 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
15:47:12.436567 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: Close
15:47:12.439882 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377444dca0>]}
15:47:12.440383 [info ] [Thread-4  ]: 49 of 101 OK snapshotted stg.AH_ListingPaymentCharge_Incr....................... [[32mOK[0m in 16.72s]
15:47:12.440804 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
15:47:12.441025 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingTypeMedia_Incr
15:47:12.441445 [info ] [Thread-4  ]: 52 of 101 START snapshot stg.AH_ListingTypeMedia_Incr........................... [RUN]
15:47:12.441902 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr"
15:47:12.442096 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingTypeMedia_Incr
15:47:12.442269 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingTypeMedia_Incr
15:47:12.445102 [debug] [Thread-4  ]: finished collecting timing info
15:47:12.445329 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingTypeMedia_Incr
15:47:12.447896 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:12.448107 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:12.448264 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:47:12.448433 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:12.505857 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:47:12.508723 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:12.509102 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
15:47:12.511950 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:12.515282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:12.515638 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:12.542606 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:12.546831 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:12.547119 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:12.554638 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:12.555737 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:12.555947 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
15:47:12.564739 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:12.599735 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:12.621992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:12.622411 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:12.628612 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:12.629864 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:12.630083 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
15:47:12.654525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:12.656803 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:12.657081 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]
        ) as __dbt_sbq
    
15:47:12.717367 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:12.740401 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:12.740829 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        ) as __dbt_sbq
    
15:47:12.819038 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:12.822432 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:12.822751 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
15:47:12.936044 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:47:12.939873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:12.940107 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720''), CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:12.641720'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end



    
15:47:13.566853 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.76 seconds
15:47:13.568703 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingMedias_Incr: COMMIT
15:47:13.569544 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
15:47:13.569757 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end

15:47:13.610685 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:13.621621 [debug] [Thread-2  ]: finished collecting timing info
15:47:13.622041 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingMedias_Incr: Close
15:47:13.622835 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776032eb0>]}
15:47:13.623359 [info ] [Thread-2  ]: 48 of 101 OK snapshotted stg.AH_ListingMedias_Incr.............................. [[32mOK[0m in 21.62s]
15:47:13.623788 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingMedias_Incr
15:47:13.624010 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingTypeproperties_Incr
15:47:13.624420 [info ] [Thread-2  ]: 53 of 101 START snapshot stg.AH_ListingTypeproperties_Incr...................... [RUN]
15:47:13.624905 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr"
15:47:13.625100 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingTypeproperties_Incr
15:47:13.625273 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingTypeproperties_Incr
15:47:13.628050 [debug] [Thread-2  ]: finished collecting timing info
15:47:13.628283 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingTypeproperties_Incr
15:47:13.631028 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:13.631247 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:13.631410 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:47:13.631582 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:13.667387 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
15:47:13.669099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:13.669389 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:13.697379 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
15:47:13.699175 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:13.699490 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:13.702820 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:13.704938 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:13.705161 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:13.736487 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:13.739658 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:13.740014 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:13.743669 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:13.771199 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:47:13.794029 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:13.794399 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:13.825279 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:13.827593 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:13.827938 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]
        ) as __dbt_sbq
    
15:47:13.908410 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:13.931663 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:13.932092 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        ) as __dbt_sbq
    
15:47:13.979735 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:47:13.983340 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:13.983690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
15:47:14.024730 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:47:14.027112 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingQuestions_Incr"
15:47:14.027774 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:14.028001 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr" (
                  "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:14.031089 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:14.035087 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:14.035335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:14.041119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:47:14.044730 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:14.044948 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
15:47:14.072538 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:14.074225 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:14.074608 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
15:47:14.118141 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:14.121881 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:14.122181 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664''), CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:13.813664'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end



    
15:47:15.099146 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
15:47:15.100955 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:15.101146 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:15.144174 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:15.147211 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:15.147414 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:15.384990 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:47:15.387402 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
15:47:15.388057 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:15.388284 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr" (
                  "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:15.389369 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:47:15.390662 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: COMMIT
15:47:15.391451 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
15:47:15.391657 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end

15:47:15.431395 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:15.441080 [debug] [Thread-3  ]: finished collecting timing info
15:47:15.441527 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: Close
15:47:15.442320 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760442e0>]}
15:47:15.442890 [info ] [Thread-3  ]: 50 of 101 OK snapshotted stg.AH_ListingQuestions_Incr........................... [[32mOK[0m in 16.45s]
15:47:15.443365 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingQuestions_Incr
15:47:15.443595 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingTypes_Incr
15:47:15.444032 [info ] [Thread-3  ]: 54 of 101 START snapshot stg.AH_ListingTypes_Incr............................... [RUN]
15:47:15.444518 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypes_Incr"
15:47:15.444708 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingTypes_Incr
15:47:15.444878 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingTypes_Incr
15:47:15.447782 [debug] [Thread-3  ]: finished collecting timing info
15:47:15.448015 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingTypes_Incr
15:47:15.450962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:15.451186 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:15.451350 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:47:15.451529 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:15.556011 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:15.584172 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:47:15.606863 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:15.607310 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:15.662955 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:15.665058 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:15.665338 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypes_InterView]
        ) as __dbt_sbq
    
15:47:15.720237 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:15.743088 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:15.743527 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        ) as __dbt_sbq
    
15:47:15.801071 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:15.804472 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:15.804767 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
15:47:15.879128 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:15.886522 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:15.886903 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746''), CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:15.641746'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end



    
15:47:16.668765 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
15:47:16.670510 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: COMMIT
15:47:16.671299 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
15:47:16.671439 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end

15:47:16.720812 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:16.732248 [debug] [Thread-1  ]: finished collecting timing info
15:47:16.732672 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: Close
15:47:16.733600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044040>]}
15:47:16.734153 [info ] [Thread-1  ]: 51 of 101 OK snapshotted stg.AH_ListingTypeFeeprovIDErs_Incr.................... [[32mOK[0m in 13.62s]
15:47:16.734616 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
15:47:16.734855 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Listingdecorations_Incr
15:47:16.735281 [info ] [Thread-1  ]: 55 of 101 START snapshot stg.AH_Listingdecorations_Incr......................... [RUN]
15:47:16.735905 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr"
15:47:16.736115 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Listingdecorations_Incr
15:47:16.736290 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Listingdecorations_Incr
15:47:16.739196 [debug] [Thread-1  ]: finished collecting timing info
15:47:16.739427 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Listingdecorations_Incr
15:47:16.742213 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:16.742427 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:16.742627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:47:16.742811 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:16.862657 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:16.893400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:16.915497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:16.915966 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:16.942372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:16.944966 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:16.945340 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingdecorations_InterView]
        ) as __dbt_sbq
    
15:47:17.005913 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:17.028857 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:17.029332 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        ) as __dbt_sbq
    
15:47:17.076540 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:17.080149 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:17.080555 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
15:47:17.158761 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:17.162254 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:17.162473 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingdecorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012''), CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:16.923012'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end



    
15:47:19.434808 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.49 seconds
15:47:19.439248 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:19.439633 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:19.479963 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:19.481667 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:19.481986 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
15:47:20.454408 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:47:20.456170 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:20.456407 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:20.552954 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:20.555477 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:20.555718 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:20.778704 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:47:20.781761 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:20.781990 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
15:47:20.863858 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:20.868151 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:20.868396 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:20.941854 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:20.943433 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:20.943641 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
15:47:22.194368 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:47:22.196038 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:22.196234 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:22.247614 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:22.250169 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:22.250402 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:22.350464 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.46 seconds
15:47:22.353767 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:22.353999 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:22.419884 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:22.421507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:22.421748 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
15:47:22.504055 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:47:22.507149 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:22.507375 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
15:47:22.539937 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:22.544614 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:22.544945 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:22.594440 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:22.596180 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:22.596488 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
15:47:22.902023 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.74 seconds
15:47:22.905234 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:22.905434 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:22.951618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:22.953179 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:22.953389 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
15:47:23.564593 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
15:47:23.566335 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:23.566621 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:23.641189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:23.643804 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:23.644027 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:23.927222 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
15:47:23.929202 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:23.929389 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:23.968186 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:23.970792 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:23.971000 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:23.983794 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:47:23.986859 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:23.987202 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
15:47:24.056738 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:24.061087 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:24.061489 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:24.163310 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:24.164792 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:24.164985 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
15:47:24.185795 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:47:24.188011 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeMedia_Incr"
15:47:24.188489 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:24.188628 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr" (
                  "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:24.930016 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.98 seconds
15:47:24.931700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:24.931886 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:25.015170 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:25.017480 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:25.017706 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:25.070315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 10.95 seconds
15:47:25.073621 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:25.073847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:25.122267 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:25.123753 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:25.123928 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
15:47:25.363745 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:47:25.367061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:25.367308 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
15:47:25.521130 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:25.527260 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:25.527660 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:25.564799 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
15:47:25.566515 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:25.566826 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:25.574722 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:25.576202 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:25.576472 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
15:47:25.648579 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:25.652198 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:25.652872 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:25.935336 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.75 seconds
15:47:25.937080 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: COMMIT
15:47:25.937868 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
15:47:25.938025 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end

15:47:25.946840 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:47:25.950140 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:25.950420 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
15:47:25.995279 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:26.005286 [debug] [Thread-4  ]: finished collecting timing info
15:47:26.005804 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: Close
15:47:26.006671 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377458ea90>]}
15:47:26.007224 [info ] [Thread-4  ]: 52 of 101 OK snapshotted stg.AH_ListingTypeMedia_Incr........................... [[32mOK[0m in 13.56s]
15:47:26.007650 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingTypeMedia_Incr
15:47:26.007874 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Listingproperties_Incr
15:47:26.008294 [info ] [Thread-4  ]: 56 of 101 START snapshot stg.AH_Listingproperties_Incr.......................... [RUN]
15:47:26.008782 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingproperties_Incr"
15:47:26.008975 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Listingproperties_Incr
15:47:26.009148 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Listingproperties_Incr
15:47:26.012090 [debug] [Thread-4  ]: finished collecting timing info
15:47:26.012331 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Listingproperties_Incr
15:47:26.015323 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:47:26.015556 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:26.015718 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:47:26.015894 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:26.036838 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:26.041138 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:26.044462 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:26.117662 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:26.119315 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:26.119598 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
15:47:26.140606 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:26.168443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:26.192765 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:47:26.193226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:26.222461 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:26.225873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:47:26.226232 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingproperties_InterView]
        ) as __dbt_sbq
    
15:47:26.292843 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:26.317220 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:47:26.317670 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        ) as __dbt_sbq
    
15:47:26.421592 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:26.425057 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:47:26.425294 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
15:47:26.503503 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:26.507529 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:47:26.507851 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409''), CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:26.204409'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end



    
15:47:26.616376 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
15:47:26.618035 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:26.618231 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:26.623465 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
15:47:26.624813 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:26.624977 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:26.689089 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:26.691882 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:26.692114 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:26.694908 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:26.697695 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:26.697970 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:26.921120 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.80 seconds
15:47:26.922853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:26.923054 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:26.961252 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:47:26.964380 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:26.964733 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
15:47:27.017842 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:27.020762 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:27.021170 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:47:27.023748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:27.024009 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
15:47:27.021345 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:27.036484 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:27.042294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:27.042667 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:27.080275 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:27.082045 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:27.082401 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
15:47:27.097608 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:27.102435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:27.102869 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:27.139519 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:27.141284 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:27.141634 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
15:47:27.303923 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:47:27.306064 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypes_Incr"
15:47:27.306531 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:27.306958 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:28.336577 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:47:28.338260 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:28.338459 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:28.338756 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
15:47:28.339887 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:28.340045 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:28.385820 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:28.388402 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:28.388612 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:28.427577 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:28.430503 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:28.430875 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:28.597094 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:47:28.599438 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingdecorations_Incr"
15:47:28.599952 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:28.600098 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:28.687104 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:47:28.690187 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:28.690447 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
15:47:28.800267 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:47:28.805021 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:28.805321 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:29.020772 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:47:29.022644 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:29.022860 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
15:47:29.418371 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.11 seconds
15:47:29.420142 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypes_Incr: COMMIT
15:47:29.420930 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
15:47:29.421081 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end

15:47:29.632168 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:47:29.644711 [debug] [Thread-3  ]: finished collecting timing info
15:47:29.645204 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypes_Incr: Close
15:47:29.646033 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37745bf9d0>]}
15:47:29.646630 [info ] [Thread-3  ]: 54 of 101 OK snapshotted stg.AH_ListingTypes_Incr............................... [[32mOK[0m in 14.20s]
15:47:29.647077 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingTypes_Incr
15:47:29.647304 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
15:47:29.647733 [info ] [Thread-3  ]: 57 of 101 START snapshot stg.AH_ListingsReserveHistory_Incr..................... [RUN]
15:47:29.648223 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
15:47:29.648413 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingsReserveHistory_Incr
15:47:29.648585 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingsReserveHistory_Incr
15:47:29.651551 [debug] [Thread-3  ]: finished collecting timing info
15:47:29.651791 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingsReserveHistory_Incr
15:47:29.654769 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:29.654992 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:29.655151 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:47:29.655322 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:29.763406 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:29.798684 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:47:29.820716 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:29.821184 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:29.860843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:29.863240 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:29.863589 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]
        ) as __dbt_sbq
    
15:47:29.916573 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:29.939367 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:29.939846 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        ) as __dbt_sbq
    
15:47:30.366448 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:47:30.369985 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:30.370185 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
15:47:30.451894 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:30.455550 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:30.455786 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092''), CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:29.845092'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end



    
15:47:30.777369 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.75 seconds
15:47:30.779031 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:30.779227 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:30.882719 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:30.885199 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:30.885388 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:31.104595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.50 seconds
15:47:31.106308 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: COMMIT
15:47:31.107114 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
15:47:31.107268 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end

15:47:31.164718 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:31.174950 [debug] [Thread-1  ]: finished collecting timing info
15:47:31.175394 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: Close
15:47:31.176164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044820>]}
15:47:31.176697 [info ] [Thread-1  ]: 55 of 101 OK snapshotted stg.AH_Listingdecorations_Incr......................... [[32mOK[0m in 14.44s]
15:47:31.177118 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Listingdecorations_Incr
15:47:31.177346 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Listings_Incr
15:47:31.177770 [info ] [Thread-1  ]: 58 of 101 START snapshot stg.AH_Listings_Incr................................... [RUN]
15:47:31.178254 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listings_Incr"
15:47:31.178443 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Listings_Incr
15:47:31.178642 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Listings_Incr
15:47:31.181509 [debug] [Thread-1  ]: finished collecting timing info
15:47:31.181736 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Listings_Incr
15:47:31.184607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:47:31.184835 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:31.184998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:47:31.185172 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:31.234771 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:47:31.237088 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeproperties_Incr"
15:47:31.237719 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:31.237914 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:31.298466 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:31.347930 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:47:31.372514 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:47:31.372941 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:31.402521 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:47:31.404680 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:47:31.404970 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listings_InterView]
        ) as __dbt_sbq
    
15:47:31.465510 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:31.490797 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:47:31.491210 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        ) as __dbt_sbq
    
15:47:32.421010 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
15:47:32.424948 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:47:32.425169 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
15:47:32.612902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:47:32.617148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:47:32.617396 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996''), CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:31.391996'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end



    
15:47:33.229068 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.99 seconds
15:47:33.230827 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: COMMIT
15:47:33.231594 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
15:47:33.231743 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end

15:47:33.271414 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:47:33.365010 [debug] [Thread-2  ]: finished collecting timing info
15:47:33.365466 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: Close
15:47:33.366222 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044430>]}
15:47:33.366773 [info ] [Thread-2  ]: 53 of 101 OK snapshotted stg.AH_ListingTypeproperties_Incr...................... [[32mOK[0m in 19.74s]
15:47:33.367203 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingTypeproperties_Incr
15:47:33.367424 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Locations_Incr
15:47:33.367834 [info ] [Thread-2  ]: 59 of 101 START snapshot stg.AH_Locations_Incr.................................. [RUN]
15:47:33.368299 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Locations_Incr"
15:47:33.368491 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Locations_Incr
15:47:33.368659 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Locations_Incr
15:47:33.371532 [debug] [Thread-2  ]: finished collecting timing info
15:47:33.371758 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Locations_Incr
15:47:33.374235 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:33.374446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:33.374638 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:47:33.374821 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:33.494559 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:33.523202 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:33.546130 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:33.546612 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:33.598163 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:33.601222 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:33.601555 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Locations_InterView]
        ) as __dbt_sbq
    
15:47:33.658772 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:47:33.681599 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:33.682069 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        ) as __dbt_sbq
    
15:47:33.761039 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:33.764968 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:33.765248 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
15:47:33.848385 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:33.851864 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:33.852089 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Locations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Locations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526''), CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:33.579526'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Locations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Locations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end



    
15:47:41.870750 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 11.41 seconds
15:47:41.874289 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:41.874507 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:41.972607 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:41.974006 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:41.974205 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
15:47:43.214313 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
15:47:43.216001 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:43.216195 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:43.471350 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:47:43.473928 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:43.474142 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:43.722786 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:47:43.725819 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:43.726016 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
15:47:43.815007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:43.818952 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:43.819217 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:43.893994 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:47:43.895659 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:43.896592 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
15:47:44.524132 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 10.67 seconds
15:47:44.527644 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:44.527862 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:44.664648 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:47:44.666209 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:44.666421 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
15:47:46.575702 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.68 seconds
15:47:46.577393 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:46.577601 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:46.712154 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:47:46.714827 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:46.715043 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:47.335994 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.67 seconds
15:47:47.337651 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:47.337849 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:47.487594 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:47.490814 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:47.491086 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:47.942096 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
15:47:47.945075 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:47.945309 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
15:47:48.010171 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
15:47:48.014862 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:48.015168 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
15:47:48.099683 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:47:48.104008 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:48.104360 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:48.158786 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:47:48.162977 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:48.163283 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:48.235782 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:47:48.237389 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:48.237589 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
15:47:48.284105 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:47:48.285659 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:48.285839 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
15:47:50.691561 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.41 seconds
15:47:50.693123 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:50.693303 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:50.810826 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:47:50.813527 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:50.813732 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:51.018999 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
15:47:51.020665 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:51.020874 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:51.119874 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:47:51.122251 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:51.122447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:51.195711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:47:51.199904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:51.200186 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
15:47:51.295334 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:51.299885 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:51.300246 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:51.381520 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:47:51.383132 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:51.383345 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
15:47:52.039489 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:47:52.041731 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
15:47:52.042258 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:52.042411 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr" (
                  "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:53.209562 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
15:47:53.211230 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:53.211423 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:47:53.382454 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:47:53.385056 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:53.385278 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:47:54.009383 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
15:47:54.011678 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Locations_Incr"
15:47:54.012166 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:54.012320 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Locations_Incr" (
                  "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:47:54.881073 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.84 seconds
15:47:54.882806 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: COMMIT
15:47:54.883630 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
15:47:54.883785 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end

15:47:54.974569 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:47:54.988130 [debug] [Thread-3  ]: finished collecting timing info
15:47:54.988686 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: Close
15:47:54.989543 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044c10>]}
15:47:54.990106 [info ] [Thread-3  ]: 57 of 101 OK snapshotted stg.AH_ListingsReserveHistory_Incr..................... [[32mOK[0m in 25.34s]
15:47:54.990569 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
15:47:54.990815 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_LogentriesBuffer_Incr
15:47:54.991245 [info ] [Thread-3  ]: 60 of 101 START snapshot stg.AH_LogentriesBuffer_Incr........................... [RUN]
15:47:54.991760 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr"
15:47:54.991955 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_LogentriesBuffer_Incr
15:47:54.992131 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_LogentriesBuffer_Incr
15:47:54.995209 [debug] [Thread-3  ]: finished collecting timing info
15:47:54.995486 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_LogentriesBuffer_Incr
15:47:54.998846 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:47:54.999111 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:54.999279 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:47:54.999455 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:55.189786 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:55.328309 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:47:55.350766 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:47:55.351234 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:55.476816 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:47:55.479129 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:47:55.479385 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]
        ) as __dbt_sbq
    
15:47:55.667739 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:47:55.689732 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:47:55.690228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        ) as __dbt_sbq
    
15:47:55.882782 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:47:55.886332 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:47:55.886754 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
15:47:56.062927 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:47:56.067358 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:47:56.067757 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978''), CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:55.407978'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end



    
15:47:56.950964 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.94 seconds
15:47:56.952612 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Locations_Incr: COMMIT
15:47:56.953389 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
15:47:56.953540 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end

15:47:57.071923 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:47:57.081743 [debug] [Thread-2  ]: finished collecting timing info
15:47:57.082300 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Locations_Incr: Close
15:47:57.083196 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044ac0>]}
15:47:57.206596 [info ] [Thread-2  ]: 59 of 101 OK snapshotted stg.AH_Locations_Incr.................................. [[32mOK[0m in 23.71s]
15:47:57.207347 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Locations_Incr
15:47:57.207599 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Logentries_Incr
15:47:57.208067 [info ] [Thread-2  ]: 61 of 101 START snapshot stg.AH_Logentries_Incr................................. [RUN]
15:47:57.208651 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Logentries_Incr"
15:47:57.208859 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Logentries_Incr
15:47:57.209035 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Logentries_Incr
15:47:57.212156 [debug] [Thread-2  ]: finished collecting timing info
15:47:57.212428 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Logentries_Incr
15:47:57.216254 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:47:57.216541 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:47:57.216709 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:47:57.217019 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:47:57.347025 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:47:57.465653 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:47:57.488453 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:47:57.488953 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:47:57.540590 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:47:57.543599 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:47:57.543983 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Logentries_InterView]
        ) as __dbt_sbq
    
15:47:57.660783 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:47:57.683066 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:47:57.683568 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        ) as __dbt_sbq
    
15:47:58.516919 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
15:47:58.520752 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:47:58.521046 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
15:47:58.627888 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:47:58.632083 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:47:58.632370 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logentries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Logentries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384''), CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:47:57.517384'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Logentries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logentries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end



    
15:48:01.023154 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 34.52 seconds
15:48:01.026777 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:01.027041 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:01.065738 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:01.067499 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:01.067828 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
15:48:02.984478 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
15:48:02.986128 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:02.986340 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:03.055174 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:48:03.057704 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:03.057934 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:03.452729 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:48:03.455978 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:03.456245 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
15:48:03.537973 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:48:03.543391 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:03.544081 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:03.582825 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:03.584601 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:03.584928 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
15:48:05.103908 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
15:48:05.105533 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:05.105728 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:05.226303 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:48:05.229092 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:05.229315 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:05.483637 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:48:05.487047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:05.487317 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
15:48:05.569738 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:48:05.574026 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:05.574261 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:05.616240 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:05.618384 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:05.618736 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
15:48:06.867301 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:48:06.868880 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:06.869076 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:06.941371 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:48:06.944212 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:06.944447 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:07.221327 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:48:07.223703 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingproperties_Incr"
15:48:07.224201 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:07.224358 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr" (
                  "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:48:10.257166 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.03 seconds
15:48:10.259222 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Listingproperties_Incr: COMMIT
15:48:10.259965 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
15:48:10.260106 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end

15:48:10.299104 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:10.310977 [debug] [Thread-4  ]: finished collecting timing info
15:48:10.311544 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Listingproperties_Incr: Close
15:48:10.312433 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044970>]}
15:48:10.313040 [info ] [Thread-4  ]: 56 of 101 OK snapshotted stg.AH_Listingproperties_Incr.......................... [[32mOK[0m in 44.30s]
15:48:10.313511 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Listingproperties_Incr
15:48:10.313743 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Lots_Incr
15:48:10.314203 [info ] [Thread-4  ]: 62 of 101 START snapshot stg.AH_Lots_Incr....................................... [RUN]
15:48:10.314739 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Lots_Incr"
15:48:10.314940 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Lots_Incr
15:48:10.315114 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Lots_Incr
15:48:10.318098 [debug] [Thread-4  ]: finished collecting timing info
15:48:10.318337 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Lots_Incr
15:48:10.321373 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:10.321595 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:48:10.321757 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:48:10.321933 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:48:10.460217 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:48:10.768454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
15:48:10.790553 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:10.790992 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:48:10.865783 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:48:10.868621 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:10.868895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Lots_InterView]
        ) as __dbt_sbq
    
15:48:10.936910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:48:10.959446 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:10.959908 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        ) as __dbt_sbq
    
15:48:11.014607 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:48:11.018161 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:11.018498 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
15:48:11.095572 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:48:11.100314 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:11.100657 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Lots_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Lots_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900''), CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:48:10.798900'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Lots_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Lots_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end



    
15:48:11.143189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 15.08 seconds
15:48:11.147030 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:11.147419 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:11.194471 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:48:11.196314 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:11.196609 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
15:48:12.742217 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
15:48:12.743907 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:12.744123 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:12.839620 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:48:12.842118 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:12.842304 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:13.182717 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:48:13.185792 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:13.186000 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
15:48:13.275293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:13.279458 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:13.279739 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:13.319420 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:13.321088 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:13.321378 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
15:48:15.168375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.85 seconds
15:48:15.169995 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:15.170197 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:15.257963 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:15.260692 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:15.260894 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:15.610188 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:48:15.614460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:15.614896 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
15:48:15.715913 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:48:15.720803 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:15.721118 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:15.839573 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:48:15.841114 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:15.841308 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
15:48:17.030061 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
15:48:17.031886 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:17.032099 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:17.133282 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:48:17.136040 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:17.136257 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:17.557855 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
15:48:17.560205 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LogentriesBuffer_Incr"
15:48:17.560667 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:17.560797 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr" (
                  "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:48:18.240099 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 45.62 seconds
15:48:18.243879 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:18.244134 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:18.306503 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:48:18.308044 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:18.308238 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
15:48:20.088302 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
15:48:20.090052 [debug] [Thread-3  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: COMMIT
15:48:20.090815 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
15:48:20.090963 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end

15:48:20.135671 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:20.145217 [debug] [Thread-3  ]: finished collecting timing info
15:48:20.145671 [debug] [Thread-3  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: Close
15:48:20.146473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034040>]}
15:48:20.147059 [info ] [Thread-3  ]: 60 of 101 OK snapshotted stg.AH_LogentriesBuffer_Incr........................... [[32mOK[0m in 25.15s]
15:48:20.147500 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_LogentriesBuffer_Incr
15:48:20.147725 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_MediaMetaData_Incr
15:48:20.148163 [info ] [Thread-3  ]: 63 of 101 START snapshot stg.AH_MediaMetaData_Incr.............................. [RUN]
15:48:20.148641 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr"
15:48:20.148833 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_MediaMetaData_Incr
15:48:20.149005 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_MediaMetaData_Incr
15:48:20.151895 [debug] [Thread-3  ]: finished collecting timing info
15:48:20.152126 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_MediaMetaData_Incr
15:48:20.154966 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:48:20.155185 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:48:20.155361 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:48:20.155533 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:48:20.287833 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:48:20.321226 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:48:20.343566 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:48:20.344760 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:48:20.379486 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:48:20.381853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:48:20.382194 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaMetaData_InterView]
        ) as __dbt_sbq
    
15:48:20.444604 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:48:20.468619 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:48:20.469058 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        ) as __dbt_sbq
    
15:48:20.781254 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:48:20.784822 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:48:20.785052 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
15:48:20.947008 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:48:20.951082 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:48:20.951400 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506''), CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:48:20.361506'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end



    
15:48:22.822343 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.51 seconds
15:48:22.823943 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:22.824138 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:22.978298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:48:22.981575 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:22.981813 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:23.416428 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:48:23.419731 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:23.419967 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
15:48:23.521361 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:48:23.526308 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:23.526736 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:23.649967 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:48:23.651636 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:23.651849 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
15:48:23.656877 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 12.56 seconds
15:48:23.660468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:23.660783 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:23.765568 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:48:23.767192 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:23.767395 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
15:48:26.174913 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.41 seconds
15:48:26.176537 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:26.176723 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:26.300925 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:48:26.303645 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:26.303884 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:26.708412 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:48:26.711631 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:26.711873 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
15:48:26.819957 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.17 seconds
15:48:26.821651 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:26.821865 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:26.824541 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:48:26.828947 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:26.829280 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:26.898783 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:48:26.902281 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:26.902656 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:26.919048 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:26.921762 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:26.922144 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
15:48:27.138707 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:48:27.141635 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:27.141886 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
15:48:27.219014 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:48:27.225074 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:27.225502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:27.273864 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:48:27.275627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:27.275916 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
15:48:29.284074 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.36 seconds
15:48:29.285744 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:29.285940 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:29.405498 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:48:29.408259 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:29.408488 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:29.812718 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:48:29.815965 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:29.816250 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
15:48:29.903489 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:29.907838 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:29.908171 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:29.947710 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:29.949408 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:29.949717 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
15:48:31.466896 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.19 seconds
15:48:31.468551 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:31.468739 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:31.554818 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:31.557828 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:31.558029 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:31.992519 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:48:31.995264 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listings_Incr"
15:48:31.995730 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:31.995876 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listings_Incr" (
                  "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:48:32.736501 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.79 seconds
15:48:32.740475 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:32.740827 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:48:33.016103 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:48:33.018599 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:33.018808 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:48:33.281382 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:48:33.283676 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Lots_Incr"
15:48:33.284115 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:33.284247 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Lots_Incr" (
                  "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:48:37.162789 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.88 seconds
15:48:37.164441 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Lots_Incr: COMMIT
15:48:37.165165 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
15:48:37.165305 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end

15:48:37.236398 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.24 seconds
15:48:37.238140 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listings_Incr: COMMIT
15:48:37.238968 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
15:48:37.239123 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end

15:48:37.257237 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:37.266161 [debug] [Thread-4  ]: finished collecting timing info
15:48:37.266575 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Lots_Incr: Close
15:48:37.267350 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044eb0>]}
15:48:37.267896 [info ] [Thread-4  ]: 62 of 101 OK snapshotted stg.AH_Lots_Incr....................................... [[32mOK[0m in 26.95s]
15:48:37.268327 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Lots_Incr
15:48:37.268553 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Media_Incr
15:48:37.268982 [info ] [Thread-4  ]: 64 of 101 START snapshot stg.AH_Media_Incr...................................... [RUN]
15:48:37.269501 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Media_Incr"
15:48:37.269688 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Media_Incr
15:48:37.269865 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Media_Incr
15:48:37.272816 [debug] [Thread-4  ]: finished collecting timing info
15:48:37.273050 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Media_Incr
15:48:37.275942 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:48:37.276162 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:48:37.276325 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:48:37.276502 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:48:37.279468 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:48:37.288930 [debug] [Thread-1  ]: finished collecting timing info
15:48:37.289269 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Listings_Incr: Close
15:48:37.289970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776044d60>]}
15:48:37.290453 [info ] [Thread-1  ]: 58 of 101 OK snapshotted stg.AH_Listings_Incr................................... [[32mOK[0m in 66.11s]
15:48:37.290900 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Listings_Incr
15:48:37.291125 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_MediaassetMetaData_Incr
15:48:37.291528 [info ] [Thread-1  ]: 65 of 101 START snapshot stg.AH_MediaassetMetaData_Incr......................... [RUN]
15:48:37.291978 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr"
15:48:37.292165 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_MediaassetMetaData_Incr
15:48:37.292334 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_MediaassetMetaData_Incr
15:48:37.295351 [debug] [Thread-1  ]: finished collecting timing info
15:48:37.295586 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_MediaassetMetaData_Incr
15:48:37.298274 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:48:37.298489 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:48:37.298678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:48:37.298852 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:48:37.408701 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:48:37.414932 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:48:37.443518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:48:37.465436 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:48:37.465866 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:48:37.476849 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:48:37.499215 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:48:37.499493 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:48:37.501416 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:48:37.501655 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]
        ) as __dbt_sbq
    
15:48:37.499797 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:48:37.551183 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:48:37.553541 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:48:37.553861 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Media_InterView]
        ) as __dbt_sbq
    
15:48:37.557618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:48:37.578710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:48:37.579059 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        ) as __dbt_sbq
    
15:48:37.635587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:48:37.639503 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:48:37.639717 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:48:37.639935 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
15:48:37.660944 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:48:37.661290 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        ) as __dbt_sbq
    
15:48:37.816036 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:48:37.819601 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:48:37.819846 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837''), CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.486837'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end



    
15:48:38.254890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
15:48:38.259010 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:48:38.259300 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
15:48:38.477156 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:48:38.481164 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:48:38.481436 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Media_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Media_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657''), CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:48:37.533657'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Media_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Media_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end



    
15:49:23.082276 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 44.60 seconds
15:49:23.085948 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:23.086247 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:23.242329 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:49:23.243980 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:23.244164 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
15:49:25.268250 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 86.64 seconds
15:49:25.273079 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:25.273436 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:25.438710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:49:25.440260 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:25.440458 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
15:49:26.677816 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.43 seconds
15:49:26.679557 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:26.679795 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:26.806647 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:49:26.809257 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:26.809504 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:27.354304 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
15:49:27.357495 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:27.357748 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
15:49:27.527589 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:49:27.532247 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:27.532604 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:27.686696 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:49:27.688273 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:27.688473 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
15:49:31.236151 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.55 seconds
15:49:31.237888 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:31.238109 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:31.364856 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:49:31.367557 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:31.367775 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:31.799471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:49:31.802870 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:31.803138 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
15:49:31.957023 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:49:31.961670 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:31.961937 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:32.065990 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:49:32.067538 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:32.067725 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
15:49:34.324100 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.88 seconds
15:49:34.325732 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:34.325942 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:34.334242 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.27 seconds
15:49:34.335685 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:34.335855 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:34.409889 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:49:34.412687 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:34.412909 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:34.467545 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:49:34.470475 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:34.470921 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:34.865179 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
15:49:34.867546 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Media_Incr"
15:49:34.868036 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:34.868185 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Media_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Media_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:49:34.996633 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
15:49:34.999634 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:34.999873 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
15:49:35.124041 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:49:35.128627 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:35.128869 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:35.273413 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:49:35.275025 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:35.275225 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
15:49:37.866387 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.00 seconds
15:49:37.868136 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Media_Incr: COMMIT
15:49:37.869114 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
15:49:37.869264 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end

15:49:38.008130 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:49:38.019009 [debug] [Thread-4  ]: finished collecting timing info
15:49:38.019501 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Media_Incr: Close
15:49:38.020324 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760346d0>]}
15:49:38.020872 [info ] [Thread-4  ]: 64 of 101 OK snapshotted stg.AH_Media_Incr...................................... [[32mOK[0m in 60.75s]
15:49:38.021307 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Media_Incr
15:49:38.021529 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Mediaassets_Incr
15:49:38.021947 [info ] [Thread-4  ]: 66 of 101 START snapshot stg.AH_Mediaassets_Incr................................ [RUN]
15:49:38.022424 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediaassets_Incr"
15:49:38.022642 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Mediaassets_Incr
15:49:38.022822 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Mediaassets_Incr
15:49:38.025615 [debug] [Thread-4  ]: finished collecting timing info
15:49:38.025893 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Mediaassets_Incr
15:49:38.028741 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:49:38.028963 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:49:38.029127 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:49:38.029306 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:49:38.204687 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:49:38.270937 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:49:38.295104 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:49:38.295552 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:49:38.368286 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:49:38.370698 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:49:38.371014 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediaassets_InterView]
        ) as __dbt_sbq
    
15:49:38.492401 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:49:38.514749 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:49:38.515217 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        ) as __dbt_sbq
    
15:49:38.651988 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 60.83 seconds
15:49:38.655739 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:38.655996 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:38.743343 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:49:38.744903 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:38.745113 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
15:49:38.849387 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:49:38.852778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:49:38.853015 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
15:49:38.981166 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:49:38.985115 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:49:38.985372 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediaassets_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediaassets_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497''), CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:49:38.331497'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediaassets_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end



    
15:49:41.532274 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.79 seconds
15:49:41.533902 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:41.534077 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:41.665865 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:49:41.668460 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:41.668686 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:42.186213 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
15:49:42.189428 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:42.189673 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
15:49:42.310578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:49:42.315060 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:42.315428 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:42.427558 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:49:42.429120 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:42.429317 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
15:49:43.792653 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.52 seconds
15:49:43.794312 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:43.794509 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:43.928417 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:49:43.931214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:43.931519 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:44.621871 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.69 seconds
15:49:44.625126 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:44.625374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
15:49:44.811249 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:49:44.815887 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:44.816245 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:45.224945 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
15:49:45.226471 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:45.226686 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
15:49:45.439960 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.01 seconds
15:49:45.441586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:45.441780 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:45.597061 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:49:45.599653 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:45.599864 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:46.145902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.55 seconds
15:49:46.149088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:46.149301 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
15:49:46.306052 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:49:46.312753 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:46.313178 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:46.414379 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:49:46.416003 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:46.416209 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
15:49:49.130329 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
15:49:49.131949 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:49.132129 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:49.246930 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:49:49.249612 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:49.249848 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:49.628557 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:49:49.631103 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaassetMetaData_Incr"
15:49:49.631581 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:49.631714 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr" (
                  "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:49:54.285741 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.06 seconds
15:49:54.287439 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:54.287647 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:49:54.501327 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:49:54.504156 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:54.504404 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:49:54.837647 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.21 seconds
15:49:54.839433 [debug] [Thread-1  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: COMMIT
15:49:54.840170 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
15:49:54.840309 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end

15:49:55.070504 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:49:55.079707 [debug] [Thread-1  ]: finished collecting timing info
15:49:55.080205 [debug] [Thread-1  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: Close
15:49:55.081035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034280>]}
15:49:55.081595 [info ] [Thread-1  ]: 65 of 101 OK snapshotted stg.AH_MediaassetMetaData_Incr......................... [[32mOK[0m in 77.79s]
15:49:55.082036 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_MediaassetMetaData_Incr
15:49:55.082262 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Mediavariations_Incr
15:49:55.082717 [info ] [Thread-1  ]: 67 of 101 START snapshot stg.AH_Mediavariations_Incr............................ [RUN]
15:49:55.083217 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediavariations_Incr"
15:49:55.083407 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Mediavariations_Incr
15:49:55.083579 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Mediavariations_Incr
15:49:55.086594 [debug] [Thread-1  ]: finished collecting timing info
15:49:55.086833 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Mediavariations_Incr
15:49:55.089698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:49:55.089918 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:49:55.090080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:49:55.090254 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:49:55.367836 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:49:55.617056 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
15:49:55.639577 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:49:55.640052 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:49:55.657984 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
15:49:55.660471 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Logentries_Incr"
15:49:55.661152 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:49:55.661375 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Logentries_Incr" (
                  "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:49:55.756695 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:49:55.758751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:49:55.758960 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediavariations_InterView]
        ) as __dbt_sbq
    
15:49:55.838653 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:49:55.860878 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:49:55.861366 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        ) as __dbt_sbq
    
15:49:55.938755 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:49:55.942061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:49:55.942283 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
15:49:56.037610 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:49:56.043374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:49:56.044071 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediavariations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediavariations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755''), CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:49:55.706755'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediavariations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end



    
15:50:01.055067 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.39 seconds
15:50:01.056853 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Logentries_Incr: COMMIT
15:50:01.057649 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
15:50:01.057802 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end

15:50:01.190831 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:50:01.200977 [debug] [Thread-2  ]: finished collecting timing info
15:50:01.201438 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Logentries_Incr: Close
15:50:01.202263 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760342e0>]}
15:50:01.202837 [info ] [Thread-2  ]: 61 of 101 OK snapshotted stg.AH_Logentries_Incr................................. [[32mOK[0m in 123.99s]
15:50:01.203275 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Logentries_Incr
15:50:01.203501 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Model_Incr
15:50:01.203915 [info ] [Thread-2  ]: 68 of 101 START snapshot stg.AH_Model_Incr...................................... [RUN]
15:50:01.204391 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Model_Incr"
15:50:01.204580 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Model_Incr
15:50:01.204753 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Model_Incr
15:50:01.207752 [debug] [Thread-2  ]: finished collecting timing info
15:50:01.207986 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Model_Incr
15:50:01.210894 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:01.211115 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:01.211277 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:50:01.211453 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:50:01.318121 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:50:01.373633 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:50:01.398878 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:01.399316 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:50:01.466086 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:01.468157 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:01.468327 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Model_InterView]
        ) as __dbt_sbq
    
15:50:01.541570 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:01.565042 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:01.565512 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        ) as __dbt_sbq
    
15:50:01.634476 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:01.637856 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:01.638133 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
15:50:01.725594 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:50:01.729124 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:01.729335 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Model_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Model_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213''), CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:50:01.441213'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Model_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Model_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end



    
15:50:11.257491 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.53 seconds
15:50:11.262027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:11.262313 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:11.322344 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:50:11.323809 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:11.323993 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
15:50:14.123253 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
15:50:14.124890 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:14.125099 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:14.256841 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:50:14.259354 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:14.259552 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:15.089779 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
15:50:15.093009 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:15.093229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
15:50:15.250957 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:50:15.255197 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:15.255453 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:15.442145 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:50:15.443708 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:15.443899 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
15:50:20.382062 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.94 seconds
15:50:20.383750 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:20.383924 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:20.560616 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:50:20.563211 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:20.563434 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:21.278682 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.72 seconds
15:50:21.281795 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:21.282046 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
15:50:21.462083 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:50:21.466435 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:21.466919 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:21.761487 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:50:21.763071 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:21.763263 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
15:50:24.836181 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.07 seconds
15:50:24.837860 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:24.838045 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:24.943866 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:50:24.946351 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:24.946570 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:25.471866 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
15:50:25.473981 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Model_Incr"
15:50:25.474432 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:25.474601 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Model_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Model_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:50:27.011679 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 126.06 seconds
15:50:27.015620 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:27.016008 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:27.165758 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:50:27.167363 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:27.167570 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
15:50:28.202572 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.73 seconds
15:50:28.204265 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Model_Incr: COMMIT
15:50:28.205049 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
15:50:28.205203 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end

15:50:28.282121 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:28.294063 [debug] [Thread-2  ]: finished collecting timing info
15:50:28.294566 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Model_Incr: Close
15:50:28.295359 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034580>]}
15:50:28.295891 [info ] [Thread-2  ]: 68 of 101 OK snapshotted stg.AH_Model_Incr...................................... [[32mOK[0m in 27.09s]
15:50:28.296326 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Model_Incr
15:50:28.296555 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
15:50:28.296969 [info ] [Thread-2  ]: 69 of 101 START snapshot stg.AH_NewSalestoInvoice_Incr.......................... [RUN]
15:50:28.297452 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
15:50:28.297644 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_NewSalestoInvoice_Incr
15:50:28.297816 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_NewSalestoInvoice_Incr
15:50:28.300691 [debug] [Thread-2  ]: finished collecting timing info
15:50:28.300923 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_NewSalestoInvoice_Incr
15:50:28.303906 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:28.304129 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:28.304289 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:50:28.304465 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:50:28.426333 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:50:28.502390 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:50:28.525661 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:28.526095 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:50:28.594067 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:28.596409 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:28.596712 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]
        ) as __dbt_sbq
    
15:50:28.704148 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:50:28.726983 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:28.727439 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        ) as __dbt_sbq
    
15:50:28.855919 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:50:28.859471 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:28.859724 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
15:50:28.934308 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:50:28.936448 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:28.936773 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:28.979885 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:50:28.984369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:28.984720 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]

    ),

    snapshotted_data as (

        select *,
            LineItemID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617''), CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LineItemID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:50:28.566617'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end



    
15:50:29.066922 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:50:29.069580 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:29.069846 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:29.216792 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 50.23 seconds
15:50:29.220533 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:29.220794 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:29.317100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:50:29.318680 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:29.318907 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
15:50:29.383433 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:50:29.386302 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:29.386503 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
15:50:29.499241 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:50:29.503415 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:29.503755 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:29.592110 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:50:29.593512 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:29.593714 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
15:50:30.875005 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
15:50:30.876508 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:30.876684 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:31.182966 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:50:31.185554 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:31.185756 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:31.193651 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
15:50:31.195008 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:31.195178 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:31.252454 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:50:31.255060 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:31.255265 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:31.717443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
15:50:31.720321 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:31.720531 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
15:50:31.819608 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:50:31.823857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:31.824161 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:31.824351 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.57 seconds
15:50:31.827459 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:31.828029 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
15:50:31.894749 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:31.901411 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:31.902298 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:31.904304 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:31.904530 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
15:50:31.902616 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:31.992780 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:50:31.994194 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:31.994374 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
15:50:33.513486 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
15:50:33.515180 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:33.515379 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:33.653972 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:50:33.656576 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:33.656820 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:33.780859 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
15:50:33.782504 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:33.782742 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:33.828221 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:33.830853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:33.831080 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:33.982798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:50:33.986046 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:33.986273 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
15:50:34.091516 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:50:34.096306 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:34.096635 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:34.197525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:50:34.199112 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:34.199319 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
15:50:34.718791 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
15:50:34.720932 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaMetaData_Incr"
15:50:34.721381 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:34.721526 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:50:35.624314 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
15:50:35.626051 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:35.626305 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:35.679587 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.69 seconds
15:50:35.683289 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:35.683598 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:35.760419 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:50:35.763004 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:35.763219 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:35.881183 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:50:35.882803 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:35.883002 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
15:50:36.231415 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
15:50:36.233640 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediaassets_Incr"
15:50:36.234077 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:36.234218 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:50:37.110169 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
15:50:37.111883 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:37.112081 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:37.193535 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:37.196275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:37.196542 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:37.432896 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:50:37.435748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:37.436003 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
15:50:37.514502 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:37.519084 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:37.519460 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:37.556750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:37.558374 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:37.558681 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
15:50:38.070091 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 42.03 seconds
15:50:38.073353 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:38.073559 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:38.113454 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:38.116385 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:38.116787 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
15:50:38.523571 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
15:50:38.525240 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:38.525438 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:38.562324 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:38.565075 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:38.565279 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:38.856834 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.14 seconds
15:50:38.858463 [debug] [Thread-3  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: COMMIT
15:50:38.859241 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
15:50:38.859385 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end

15:50:38.908311 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:38.919132 [debug] [Thread-3  ]: finished collecting timing info
15:50:38.919602 [debug] [Thread-3  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: Close
15:50:38.920416 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034430>]}
15:50:38.920977 [info ] [Thread-3  ]: 63 of 101 OK snapshotted stg.AH_MediaMetaData_Incr.............................. [[32mOK[0m in 138.77s]
15:50:38.921418 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_MediaMetaData_Incr
15:50:38.921645 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Notifications_Incr
15:50:38.922076 [info ] [Thread-3  ]: 70 of 101 START snapshot stg.AH_Notifications_Incr.............................. [RUN]
15:50:38.922607 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Notifications_Incr"
15:50:38.922807 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Notifications_Incr
15:50:38.922981 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Notifications_Incr
15:50:38.925907 [debug] [Thread-3  ]: finished collecting timing info
15:50:38.926152 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Notifications_Incr
15:50:38.929236 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:50:38.929475 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:38.929639 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:50:38.929819 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:50:38.946813 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:50:38.950327 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:38.950850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
15:50:38.980417 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.75 seconds
15:50:38.982124 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Mediaassets_Incr: COMMIT
15:50:38.983011 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
15:50:38.983250 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end

15:50:38.990021 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:38.993898 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:38.994153 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:39.299031 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:50:39.386823 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:50:39.387202 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:50:39.389570 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:39.389817 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
15:50:39.391194 [debug] [Thread-4  ]: finished collecting timing info
15:50:39.391447 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Mediaassets_Incr: Close
15:50:39.392097 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034970>]}
15:50:39.392599 [info ] [Thread-4  ]: 66 of 101 OK snapshotted stg.AH_Mediaassets_Incr................................ [[32mOK[0m in 61.37s]
15:50:39.393020 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Mediaassets_Incr
15:50:39.393245 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Offers_Incr
15:50:39.393664 [info ] [Thread-4  ]: 71 of 101 START snapshot stg.AH_Offers_Incr..................................... [RUN]
15:50:39.394160 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Offers_Incr"
15:50:39.394352 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Offers_Incr
15:50:39.394523 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Offers_Incr
15:50:39.397579 [debug] [Thread-4  ]: finished collecting timing info
15:50:39.397812 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Offers_Incr
15:50:39.400469 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:39.400733 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:39.400904 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:50:39.401080 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:50:39.429613 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
15:50:39.456350 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:50:39.456734 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:50:39.505104 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:39.507187 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:50:39.507481 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Notifications_InterView]
        ) as __dbt_sbq
    
15:50:39.545947 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:50:39.567511 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:50:39.582085 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:50:39.599092 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:50:39.607948 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        ) as __dbt_sbq
    
15:50:39.612854 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:39.613243 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:50:39.643337 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:50:39.645544 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:39.645860 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Offers_InterView]
        ) as __dbt_sbq
    
15:50:39.724904 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:39.747126 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:39.747543 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        ) as __dbt_sbq
    
15:50:39.800528 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:39.804516 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:39.804851 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
15:50:39.830789 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
15:50:39.832388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:39.832664 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:39.897143 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:50:39.900496 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:39.900692 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Offers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Offers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289''), CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.629289'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Offers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Offers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end



    
15:50:39.911643 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:39.913993 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:39.914224 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:40.068725 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
15:50:40.072171 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:50:40.072407 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
15:50:40.140638 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:40.144794 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:50:40.145060 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Notifications_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Notifications_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043''), CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:50:39.473043'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Notifications_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Notifications_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end



    
15:50:40.166776 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:50:40.169854 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:40.170183 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
15:50:40.236042 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:40.240265 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:40.240634 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:40.283929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:40.285652 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:40.285980 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
15:50:40.312388 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:50:40.314173 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:40.314483 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:40.351215 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:40.353868 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:40.354184 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:40.641926 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:50:40.644016 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
15:50:40.644508 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:40.644663 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr" (
                  "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:50:41.452650 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
15:50:41.454367 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:41.454630 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:41.491605 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:41.494135 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:41.494365 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:41.730231 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:50:41.733589 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:41.733810 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
15:50:41.767340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:50:41.773730 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:41.774187 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:41.814493 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:41.816287 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:41.816637 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
15:50:42.093974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
15:50:42.095799 [debug] [Thread-2  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: COMMIT
15:50:42.096941 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
15:50:42.097117 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end

15:50:42.150957 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:42.161034 [debug] [Thread-2  ]: finished collecting timing info
15:50:42.161534 [debug] [Thread-2  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: Close
15:50:42.162387 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37745f00d0>]}
15:50:42.162989 [info ] [Thread-2  ]: 69 of 101 OK snapshotted stg.AH_NewSalestoInvoice_Incr.......................... [[32mOK[0m in 13.86s]
15:50:42.163441 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
15:50:42.163668 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
15:50:42.164099 [info ] [Thread-2  ]: 72 of 101 START snapshot stg.AH_PaymentConfigurationTable_Incr.................. [RUN]
15:50:42.164606 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
15:50:42.164798 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
15:50:42.164973 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_PaymentConfigurationTable_Incr
15:50:42.168026 [debug] [Thread-2  ]: finished collecting timing info
15:50:42.168263 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
15:50:42.171235 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:42.171467 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:42.171631 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:50:42.171808 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:50:42.387792 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:50:42.419470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:50:42.441836 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:42.442335 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:50:42.474969 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:50:42.477390 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:42.477772 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]
        ) as __dbt_sbq
    
15:50:42.532315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:42.555163 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:42.555598 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        ) as __dbt_sbq
    
15:50:42.695112 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:50:42.698788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:42.699076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
15:50:42.786071 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:50:42.790285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:42.790524 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517''), CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:50:42.457517'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end



    
15:50:43.995952 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.18 seconds
15:50:43.997469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:43.997655 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:44.494269 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
15:50:44.496995 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:44.497243 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:44.840659 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:50:44.842781 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediavariations_Incr"
15:50:44.843221 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:44.843353 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:50:47.190326 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.35 seconds
15:50:47.192095 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Mediavariations_Incr: COMMIT
15:50:47.192899 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
15:50:47.193057 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end

15:50:47.229087 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:47.239124 [debug] [Thread-1  ]: finished collecting timing info
15:50:47.239615 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Mediavariations_Incr: Close
15:50:47.240434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37746a96d0>]}
15:50:47.241039 [info ] [Thread-1  ]: 67 of 101 OK snapshotted stg.AH_Mediavariations_Incr............................ [[32mOK[0m in 52.16s]
15:50:47.241490 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Mediavariations_Incr
15:50:47.241724 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_PaymentResponses_Incr
15:50:47.242160 [info ] [Thread-1  ]: 73 of 101 START snapshot stg.AH_PaymentResponses_Incr........................... [RUN]
15:50:47.242695 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr"
15:50:47.242897 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_PaymentResponses_Incr
15:50:47.243071 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_PaymentResponses_Incr
15:50:47.246080 [debug] [Thread-1  ]: finished collecting timing info
15:50:47.246324 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_PaymentResponses_Incr
15:50:47.249340 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:50:47.249572 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:47.249734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:50:47.249909 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:50:47.363992 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:50:47.392499 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:50:47.414919 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:50:47.415403 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:50:47.447189 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:50:47.449594 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:50:47.449935 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentResponses_InterView]
        ) as __dbt_sbq
    
15:50:47.510174 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:50:47.532736 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:50:47.533177 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        ) as __dbt_sbq
    
15:50:47.612196 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:47.616027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:50:47.616287 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
15:50:47.695428 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:47.700013 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:50:47.700389 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentResponses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303''), CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:50:47.426303'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end



    
15:50:52.738589 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 12.84 seconds
15:50:52.743361 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:52.743746 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:52.783816 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:52.785625 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:52.785986 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
15:50:54.329593 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
15:50:54.331284 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:54.331514 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:54.404557 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:54.407561 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:54.407845 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:54.657447 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:50:54.660681 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:54.660942 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
15:50:54.741421 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:54.745892 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:54.746156 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:54.790987 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:54.792727 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:54.793035 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
15:50:55.927778 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 13.14 seconds
15:50:55.931244 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:55.931484 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:55.979548 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:55.981266 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:55.981575 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
15:50:56.074357 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
15:50:56.076116 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:56.076336 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:56.119441 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:56.122217 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:56.122472 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:56.390159 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:50:56.393373 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:56.393635 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
15:50:56.436998 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:56.441588 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:56.441960 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:56.488757 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:50:56.490404 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:56.490721 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
15:50:57.433220 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
15:50:57.434911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:57.435111 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:57.519729 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:57.522182 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:57.522382 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:57.763264 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:50:57.766452 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:57.766901 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
15:50:57.861305 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:50:57.865513 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:57.865786 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:57.883855 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
15:50:57.885989 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:57.886393 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:57.925409 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:57.928252 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:57.928602 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:50:57.930132 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:57.930377 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
15:50:57.928922 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:58.189157 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:50:58.191621 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Offers_Incr"
15:50:58.192149 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:58.192306 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Offers_Incr" (
                  "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:50:58.902566 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:50:58.904241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:58.904447 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:50:59.028406 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:50:59.030939 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:59.031140 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:59.321224 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:50:59.324314 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:59.324550 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
15:50:59.362674 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:50:59.367487 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:59.367857 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:50:59.438301 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:50:59.440071 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:50:59.440389 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
15:50:59.888887 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
15:50:59.890682 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Offers_Incr: COMMIT
15:50:59.891757 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
15:50:59.891919 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end

15:50:59.974868 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:50:59.985791 [debug] [Thread-4  ]: finished collecting timing info
15:50:59.986256 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Offers_Incr: Close
15:50:59.987851 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034c10>]}
15:50:59.988747 [info ] [Thread-4  ]: 71 of 101 OK snapshotted stg.AH_Offers_Incr..................................... [[32mOK[0m in 20.59s]
15:50:59.989234 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Offers_Incr
15:50:59.989465 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
15:50:59.989872 [info ] [Thread-4  ]: 74 of 101 START snapshot stg.AH_PaymentprovIDErs_Incr........................... [RUN]
15:50:59.990361 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
15:50:59.990590 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_PaymentprovIDErs_Incr
15:50:59.990776 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_PaymentprovIDErs_Incr
15:50:59.993655 [debug] [Thread-4  ]: finished collecting timing info
15:50:59.993892 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_PaymentprovIDErs_Incr
15:50:59.996870 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:50:59.997096 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:50:59.997261 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:50:59.997437 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:00.152852 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:00.192725 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:51:00.214857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:00.215325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:00.246801 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:51:00.249225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:00.249607 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]
        ) as __dbt_sbq
    
15:51:00.301482 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:00.325795 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:00.326218 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        ) as __dbt_sbq
    
15:51:00.389806 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:51:00.393431 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:00.393687 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
15:51:00.473391 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:00.476915 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:00.477139 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385''), CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:00.223385'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
15:51:00.497328 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:51:00.499092 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:51:00.499379 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:00.581485 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:00.584201 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:51:00.584458 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:00.818822 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:51:00.821118 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
15:51:00.821598 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:51:00.821743 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr" (
                  "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:02.537319 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
15:51:02.539068 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: COMMIT
15:51:02.539854 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
15:51:02.540003 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end

15:51:02.584396 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:02.594949 [debug] [Thread-2  ]: finished collecting timing info
15:51:02.595360 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: Close
15:51:02.596144 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b040>]}
15:51:02.596678 [info ] [Thread-2  ]: 72 of 101 OK snapshotted stg.AH_PaymentConfigurationTable_Incr.................. [[32mOK[0m in 20.43s]
15:51:02.597115 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
15:51:02.597341 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Properties_Incr
15:51:02.597758 [info ] [Thread-2  ]: 75 of 101 START snapshot stg.AH_Properties_Incr................................. [RUN]
15:51:02.598230 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Properties_Incr"
15:51:02.598431 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Properties_Incr
15:51:02.598633 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Properties_Incr
15:51:02.601466 [debug] [Thread-2  ]: finished collecting timing info
15:51:02.601696 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Properties_Incr
15:51:02.604696 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:02.604930 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:02.605092 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:51:02.605268 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:02.702149 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:02.736951 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:51:02.759179 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:02.759630 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:03.094986 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:51:03.096968 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:03.097169 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Properties_InterView]
        ) as __dbt_sbq
    
15:51:03.170204 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:03.194047 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:03.194473 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        ) as __dbt_sbq
    
15:51:03.267849 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:03.272788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:03.273159 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
15:51:03.359813 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:03.363481 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:03.363759 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Properties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Properties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806''), CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:03.082806'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Properties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Properties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end



    
15:51:03.917120 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 23.77 seconds
15:51:03.920619 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:03.920829 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:03.960699 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:03.962393 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:03.962697 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
15:51:05.555424 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
15:51:05.557103 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:05.557289 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:05.625701 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:05.628617 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:05.628848 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:05.937086 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:51:05.940202 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:05.940412 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
15:51:06.038700 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:51:06.043241 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:06.043514 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:06.082824 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:06.084527 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:06.084820 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
15:51:06.725269 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 19.02 seconds
15:51:06.730294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:06.730654 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:06.768758 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:06.770477 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:06.770791 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
15:51:07.543951 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.07 seconds
15:51:07.547233 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:07.547431 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:07.592665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:07.594229 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:07.594518 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
15:51:07.728421 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.64 seconds
15:51:07.730042 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:07.730227 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:07.829352 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:51:07.832199 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:07.832410 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:08.183723 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:51:08.187012 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:08.187234 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
15:51:08.272709 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:08.277032 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:08.277250 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:08.330071 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:08.331741 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:08.332050 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
15:51:08.377930 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
15:51:08.379569 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:08.379841 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:08.472235 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:08.474925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:08.475116 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:08.588576 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
15:51:08.590225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:08.590417 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:08.675619 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:08.678360 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:08.679372 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:09.089222 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.61 seconds
15:51:09.091944 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:09.092143 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
15:51:09.234812 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:51:09.240091 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:09.240432 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:09.393807 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:51:09.395644 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:09.395837 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
15:51:09.596750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.23 seconds
15:51:09.600406 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:09.600740 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
15:51:09.603012 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:09.603228 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
15:51:09.600970 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:09.648101 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:09.649824 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:09.650122 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
15:51:09.681593 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:09.685707 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:09.685987 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:09.723317 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:09.725099 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:09.725386 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
15:51:10.134508 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
15:51:10.136167 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:10.136360 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:10.190561 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:10.193361 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:10.193581 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:10.527597 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:51:10.530051 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Notifications_Incr"
15:51:10.530722 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:10.530929 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Notifications_Incr" (
                  "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:10.896095 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:51:10.897775 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:10.897976 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:10.908121 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
15:51:10.909434 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:10.909651 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
15:51:10.910979 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:10.911187 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:10.909776 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:10.980504 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:10.983580 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:10.983871 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:10.992156 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:10.994639 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:10.994945 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:11.012172 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:51:11.015096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:11.015448 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:11.264749 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:51:11.268014 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:11.268288 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
15:51:11.285032 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:51:11.290641 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:11.291045 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
15:51:11.357357 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:11.361782 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:11.362191 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:11.390421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:51:11.394673 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:11.395038 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:11.400333 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:11.401635 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:11.401886 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
15:51:11.426467 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
15:51:11.429630 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:11.429968 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
15:51:11.437602 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:11.439233 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:11.439481 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
15:51:11.506157 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:11.511247 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:11.511580 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:11.572346 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:51:11.573782 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:11.573959 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
15:51:12.262813 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
15:51:12.264545 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Notifications_Incr: COMMIT
15:51:12.265332 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
15:51:12.265485 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end

15:51:12.309241 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:12.318597 [debug] [Thread-3  ]: finished collecting timing info
15:51:12.319034 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Notifications_Incr: Close
15:51:12.319845 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776034820>]}
15:51:12.320398 [info ] [Thread-3  ]: 70 of 101 OK snapshotted stg.AH_Notifications_Incr.............................. [[32mOK[0m in 33.40s]
15:51:12.320836 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Notifications_Incr
15:51:12.321056 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_PropertybagItems_Incr
15:51:12.321470 [info ] [Thread-3  ]: 76 of 101 START snapshot stg.AH_PropertybagItems_Incr........................... [RUN]
15:51:12.321939 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr"
15:51:12.322128 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_PropertybagItems_Incr
15:51:12.322298 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_PropertybagItems_Incr
15:51:12.325343 [debug] [Thread-3  ]: finished collecting timing info
15:51:12.325575 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_PropertybagItems_Incr
15:51:12.329489 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:12.329718 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:12.329879 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:51:12.330053 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:12.434389 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:12.496031 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:51:12.519909 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:12.520338 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:12.548883 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:51:12.551237 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:12.551555 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PropertybagItems_InterView]
        ) as __dbt_sbq
    
15:51:12.604293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:12.626067 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:12.626473 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        ) as __dbt_sbq
    
15:51:12.733588 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:51:12.737239 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:12.737547 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
15:51:12.823388 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:12.828283 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:12.828641 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PropertybagItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067''), CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:12.536067'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end



    
15:51:13.395245 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.96 seconds
15:51:13.396958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:13.397182 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:13.479993 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:13.482336 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:13.482516 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:13.552765 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.15 seconds
15:51:13.554383 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:13.554598 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:13.606685 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:13.609213 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:13.609408 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:13.698946 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.12 seconds
15:51:13.700884 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:13.701091 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:13.741522 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:13.744421 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:13.744623 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:13.825033 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:51:13.828847 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:13.829421 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
15:51:13.850033 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:51:13.852376 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
15:51:13.853087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:13.853325 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr" (
                  "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:13.912474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:13.917416 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:13.917701 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:13.960711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:13.962339 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:13.962634 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
15:51:13.972697 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:51:13.974940 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentResponses_Incr"
15:51:13.975503 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:13.975687 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr" (
                  "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:15.664571 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.70 seconds
15:51:15.666246 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:15.666451 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:15.738256 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
15:51:15.739982 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: COMMIT
15:51:15.740777 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
15:51:15.740933 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end

15:51:15.746682 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:15.748941 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:15.749184 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:15.811447 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:15.821975 [debug] [Thread-4  ]: finished collecting timing info
15:51:15.822397 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: Close
15:51:15.823176 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b2e0>]}
15:51:15.823716 [info ] [Thread-4  ]: 74 of 101 OK snapshotted stg.AH_PaymentprovIDErs_Incr........................... [[32mOK[0m in 15.83s]
15:51:15.824883 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
15:51:15.825120 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Propertybags_Incr
15:51:15.825547 [info ] [Thread-4  ]: 77 of 101 START snapshot stg.AH_Propertybags_Incr............................... [RUN]
15:51:15.826371 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Propertybags_Incr"
15:51:15.826591 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Propertybags_Incr
15:51:15.826772 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Propertybags_Incr
15:51:15.829611 [debug] [Thread-4  ]: finished collecting timing info
15:51:15.829839 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Propertybags_Incr
15:51:15.832728 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:15.832970 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:15.833132 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:51:15.833305 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:15.931180 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:15.979588 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:51:16.002637 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:16.003103 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:16.006131 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
15:51:16.007671 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: COMMIT
15:51:16.008818 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
15:51:16.009038 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end

15:51:16.041578 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:16.044020 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:16.044345 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Propertybags_InterView]
        ) as __dbt_sbq
    
15:51:16.084913 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:16.092982 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:51:16.094907 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Properties_Incr"
15:51:16.095505 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:16.095708 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Properties_Incr" (
                  "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:16.098212 [debug] [Thread-1  ]: finished collecting timing info
15:51:16.098475 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: Close
15:51:16.099186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774307df0>]}
15:51:16.099680 [info ] [Thread-1  ]: 73 of 101 OK snapshotted stg.AH_PaymentResponses_Incr........................... [[32mOK[0m in 28.86s]
15:51:16.100097 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_PaymentResponses_Incr
15:51:16.100332 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ReListHistory_Incr
15:51:16.100745 [info ] [Thread-1  ]: 78 of 101 START snapshot stg.AH_ReListHistory_Incr.............................. [RUN]
15:51:16.101219 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ReListHistory_Incr"
15:51:16.101407 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ReListHistory_Incr
15:51:16.101579 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ReListHistory_Incr
15:51:16.104458 [debug] [Thread-1  ]: finished collecting timing info
15:51:16.104724 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ReListHistory_Incr
15:51:16.108214 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:51:16.108372 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:51:16.108559 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:16.119778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:51:16.120007 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:16.130993 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:16.131300 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        ) as __dbt_sbq
    
15:51:16.226717 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:51:16.230202 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:16.230418 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
15:51:16.234814 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:16.268676 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:51:16.291336 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:51:16.291780 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:16.324779 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:16.328709 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:16.329039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:16.330764 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:51:16.330982 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ReListHistory_InterView]
        ) as __dbt_sbq
    
15:51:16.329204 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Propertybags_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Propertybags_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503''), CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.020503'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Propertybags_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Propertybags_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end



    
15:51:16.419725 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:16.442926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:51:16.443394 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        ) as __dbt_sbq
    
15:51:16.595484 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:51:16.599702 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:51:16.600037 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
15:51:16.679428 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:16.683546 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:51:16.683877 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ReListHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ReListHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830''), CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:16.301830'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ReListHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end



    
15:51:17.491847 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
15:51:17.493619 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Properties_Incr: COMMIT
15:51:17.494418 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
15:51:17.494626 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end

15:51:17.541054 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:17.551917 [debug] [Thread-2  ]: finished collecting timing info
15:51:17.552422 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Properties_Incr: Close
15:51:17.553276 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b430>]}
15:51:17.553839 [info ] [Thread-2  ]: 75 of 101 OK snapshotted stg.AH_Properties_Incr................................. [[32mOK[0m in 14.96s]
15:51:17.554282 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Properties_Incr
15:51:17.554522 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Reports_Incr
15:51:17.554986 [info ] [Thread-2  ]: 79 of 101 START snapshot stg.AH_Reports_Incr.................................... [RUN]
15:51:17.555482 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Reports_Incr"
15:51:17.555677 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Reports_Incr
15:51:17.555853 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Reports_Incr
15:51:17.558836 [debug] [Thread-2  ]: finished collecting timing info
15:51:17.559072 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Reports_Incr
15:51:17.562824 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:17.563054 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:17.563218 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:51:17.563394 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:17.662759 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:17.690752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:51:17.713185 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:17.713646 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:17.745442 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:51:17.747981 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:17.748288 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Reports_InterView]
        ) as __dbt_sbq
    
15:51:17.802905 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:17.825907 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:17.826348 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        ) as __dbt_sbq
    
15:51:17.913943 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:17.919177 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:17.919569 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
15:51:17.992905 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:17.998262 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:17.998686 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Reports_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Reports_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643''), CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:17.723643'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Reports_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Reports_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end



    
15:51:19.077274 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.25 seconds
15:51:19.081019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:19.081264 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:19.133681 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:19.135206 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:19.135399 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
15:51:20.276728 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
15:51:20.278425 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:20.278723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:20.377843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:51:20.380265 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:20.380480 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:20.490986 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.49 seconds
15:51:20.494788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:20.495131 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:20.539221 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:20.541050 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:20.541363 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
15:51:20.639501 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:51:20.642394 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:20.642824 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
15:51:20.729571 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:20.735369 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:20.735780 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:20.784631 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:20.786383 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:20.786714 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
15:51:22.070470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
15:51:22.072057 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:22.072252 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:22.148667 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:22.151100 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:22.151321 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:22.429975 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:51:22.433176 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:22.433442 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
15:51:22.526113 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:22.530125 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:22.530464 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
15:51:22.531805 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:22.532022 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:22.530709 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:22.574897 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:22.576635 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:22.576945 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
15:51:22.617242 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:22.620081 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:22.620435 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:22.872770 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:51:22.876071 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:22.876367 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
15:51:22.943670 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:22.948785 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:22.949225 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:23.006227 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:51:23.008463 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:23.008770 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
15:51:23.039719 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.71 seconds
15:51:23.045260 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:23.045690 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:23.081380 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:23.083058 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:23.083361 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
15:51:23.557555 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
15:51:23.559261 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:23.559481 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:23.600292 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:23.603206 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:23.603509 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:37.222907 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 13.62 seconds
15:51:37.226089 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:37.226294 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
15:51:37.335584 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:51:37.339943 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:37.340229 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:37.381426 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:37.383109 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:37.383363 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
15:51:54.584382 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 31.58 seconds
15:51:54.585911 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:54.586110 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:54.699024 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:51:54.701989 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:54.702217 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:54.781334 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 31.70 seconds
15:51:54.783012 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:54.783220 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:54.788472 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 17.40 seconds
15:51:54.789815 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:54.789972 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:54.861108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:54.863711 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:54.863941 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:54.880312 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:51:54.883202 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:54.883515 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:55.000349 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:51:55.002365 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PropertybagItems_Incr"
15:51:55.002883 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:55.003027 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr" (
                  "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:55.079602 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:51:55.083841 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:55.084119 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
15:51:55.118440 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:51:55.120529 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Reports_Incr"
15:51:55.120967 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:55.121091 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Reports_Incr" (
                  "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:51:55.151091 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:55.155259 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:55.155629 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:55.192252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:55.194169 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:55.194438 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
15:51:56.801713 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
15:51:56.803468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:56.803771 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:56.847173 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:56.849660 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:56.849998 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:56.869612 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
15:51:56.871568 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: COMMIT
15:51:56.872876 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
15:51:56.873130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end

15:51:56.912170 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:56.923373 [debug] [Thread-3  ]: finished collecting timing info
15:51:56.923866 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: Close
15:51:56.924699 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b190>]}
15:51:56.925270 [info ] [Thread-3  ]: 76 of 101 OK snapshotted stg.AH_PropertybagItems_Incr........................... [[32mOK[0m in 44.60s]
15:51:56.925721 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_PropertybagItems_Incr
15:51:56.925953 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Roles_Incr
15:51:56.926373 [info ] [Thread-3  ]: 80 of 101 START snapshot stg.AH_Roles_Incr...................................... [RUN]
15:51:56.926928 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Roles_Incr"
15:51:56.927126 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Roles_Incr
15:51:56.927305 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Roles_Incr
15:51:56.930405 [debug] [Thread-3  ]: finished collecting timing info
15:51:56.930668 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Roles_Incr
15:51:56.933676 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:51:56.933898 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:56.934059 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:51:56.934236 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:56.938608 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
15:51:56.940506 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Reports_Incr: COMMIT
15:51:56.941499 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
15:51:56.941716 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end

15:51:56.988298 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:56.998606 [debug] [Thread-2  ]: finished collecting timing info
15:51:56.999091 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Reports_Incr: Close
15:51:56.999933 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b820>]}
15:51:57.000491 [info ] [Thread-2  ]: 79 of 101 OK snapshotted stg.AH_Reports_Incr.................................... [[32mOK[0m in 39.44s]
15:51:57.000945 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Reports_Incr
15:51:57.001176 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SMStemplatecontents_Incr
15:51:57.001597 [info ] [Thread-2  ]: 81 of 101 START snapshot stg.AH_SMStemplatecontents_Incr........................ [RUN]
15:51:57.002098 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr"
15:51:57.002292 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SMStemplatecontents_Incr
15:51:57.002468 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SMStemplatecontents_Incr
15:51:57.005425 [debug] [Thread-2  ]: finished collecting timing info
15:51:57.005660 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SMStemplatecontents_Incr
15:51:57.009172 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:51:57.009400 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:51:57.009565 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:51:57.009742 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:51:57.080830 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:57.091110 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:51:57.094066 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:57.094635 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
15:51:57.125529 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:51:57.136481 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:51:57.148530 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:51:57.148979 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:57.167210 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:57.171662 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:57.172049 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:57.174894 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:51:57.193012 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:57.195191 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:51:57.195513 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Roles_InterView]
        ) as __dbt_sbq
    
15:51:57.200097 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:51:57.200384 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:51:57.207476 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:51:57.208794 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:57.209052 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
15:51:57.233522 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:51:57.235787 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:51:57.236091 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]
        ) as __dbt_sbq
    
15:51:57.262469 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:51:57.284322 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:51:57.284776 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        ) as __dbt_sbq
    
15:51:57.286272 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:57.306988 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:51:57.307465 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        ) as __dbt_sbq
    
15:51:57.369859 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:57.373562 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:51:57.373910 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
15:51:57.419221 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:51:57.423089 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:51:57.423415 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
15:51:57.455833 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:51:57.459575 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:51:57.459957 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Roles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Roles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760''), CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.161760'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Roles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Roles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end



    
15:51:57.487869 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:51:57.492155 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:51:57.492584 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637''), CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:51:57.208637'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
15:51:58.778347 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.57 seconds
15:51:58.780072 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:58.780277 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:51:58.832596 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:51:58.835246 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:58.835520 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:51:59.086737 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:51:59.088701 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Propertybags_Incr"
15:51:59.089159 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:51:59.089292 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:00.340494 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 43.66 seconds
15:52:00.344137 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:00.344344 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:00.404327 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:00.405743 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:00.405925 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
15:52:00.708669 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
15:52:00.710396 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Propertybags_Incr: COMMIT
15:52:00.711260 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
15:52:00.711416 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end

15:52:00.756255 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:00.768486 [debug] [Thread-4  ]: finished collecting timing info
15:52:00.768910 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Propertybags_Incr: Close
15:52:00.769684 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b6d0>]}
15:52:00.770215 [info ] [Thread-4  ]: 77 of 101 OK snapshotted stg.AH_Propertybags_Incr............................... [[32mOK[0m in 44.94s]
15:52:00.770671 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Propertybags_Incr
15:52:00.770903 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_SMStemplates_Incr
15:52:00.771316 [info ] [Thread-4  ]: 82 of 101 START snapshot stg.AH_SMStemplates_Incr............................... [RUN]
15:52:00.771795 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplates_Incr"
15:52:00.771984 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_SMStemplates_Incr
15:52:00.772167 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_SMStemplates_Incr
15:52:00.775001 [debug] [Thread-4  ]: finished collecting timing info
15:52:00.775228 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_SMStemplates_Incr
15:52:00.778005 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:00.778220 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:00.778377 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:52:00.778571 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:00.895780 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:00.949101 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:52:00.971134 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:00.971592 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:00.999913 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:01.002299 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:01.002664 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplates_InterView]
        ) as __dbt_sbq
    
15:52:01.062708 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:01.084527 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:01.085011 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        ) as __dbt_sbq
    
15:52:01.138930 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:01.142379 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:01.142805 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
15:52:01.224143 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:01.229071 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:01.229679 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050''), CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:00.990050'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end



    
15:52:01.347573 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
15:52:01.349203 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:01.349445 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:01.444912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:01.447521 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:01.447722 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:01.701797 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:52:01.704797 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:01.705017 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
15:52:01.790786 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:01.795812 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:01.796133 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:01.884753 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:01.886144 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:01.886345 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
15:52:03.512732 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
15:52:03.514381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:03.514596 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:03.553609 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:03.556432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:03.556644 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:03.722060 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.26 seconds
15:52:03.725431 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:03.725658 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:03.786953 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:52:03.789697 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:03.789885 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
15:52:03.792042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:03.793211 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:03.793422 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
15:52:03.838005 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:03.843021 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:03.843340 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:03.880904 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:03.882625 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:03.882923 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
15:52:04.392108 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.90 seconds
15:52:04.396966 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:04.397217 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:04.444121 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:04.445816 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:04.446102 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
15:52:04.911408 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
15:52:04.913048 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:04.913242 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:04.928439 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
15:52:04.929952 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:04.930133 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:04.995194 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:04.996475 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:04.999314 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:05.001804 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:05.001559 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:05.002167 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:05.229480 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:52:05.230762 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:52:05.232753 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ReListHistory_Incr"
15:52:05.233166 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:05.233301 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr" (
                  "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:05.235318 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:05.235830 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
15:52:05.323950 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:05.327620 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:05.327821 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:05.379492 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
15:52:05.382271 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:05.382577 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:05.382901 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:05.384000 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:05.384233 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
15:52:05.470775 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:05.473364 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:05.473572 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:05.766510 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:52:05.769540 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:05.769743 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
15:52:05.840806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:05.846027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:05.846374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:05.921275 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:05.922870 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:05.923077 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
15:52:07.215581 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
15:52:07.217162 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:07.217349 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:07.232688 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
15:52:07.234212 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ReListHistory_Incr: COMMIT
15:52:07.234961 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
15:52:07.235107 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end

15:52:07.308059 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:07.321638 [debug] [Thread-1  ]: finished collecting timing info
15:52:07.322155 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ReListHistory_Incr: Close
15:52:07.322340 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:07.324539 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:07.324932 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:07.325721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b580>]}
15:52:07.326206 [info ] [Thread-1  ]: 78 of 101 OK snapshotted stg.AH_ReListHistory_Incr.............................. [[32mOK[0m in 51.22s]
15:52:07.326666 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ReListHistory_Incr
15:52:07.326896 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_SalesTaxRates_Incr
15:52:07.327296 [info ] [Thread-1  ]: 83 of 101 START snapshot stg.AH_SalesTaxRates_Incr.............................. [RUN]
15:52:07.327776 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr"
15:52:07.327963 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_SalesTaxRates_Incr
15:52:07.328135 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_SalesTaxRates_Incr
15:52:07.421062 [debug] [Thread-1  ]: finished collecting timing info
15:52:07.421486 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_SalesTaxRates_Incr
15:52:07.424480 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:07.424778 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:07.424954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:52:07.425140 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:07.473688 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
15:52:07.475495 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:07.475837 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:07.555370 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:07.624761 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:52:07.627453 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:07.627708 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:07.628549 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:52:07.653120 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:07.653561 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:07.691995 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
15:52:07.695076 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:07.695388 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
15:52:07.733871 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:07.736471 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:07.736786 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]
        ) as __dbt_sbq
    
15:52:07.758493 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.53 seconds
15:52:07.762193 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:07.762524 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:07.791992 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:07.796616 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:07.796987 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:07.800711 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:07.819811 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:07.821294 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:07.821573 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
15:52:07.824097 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:07.824329 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        ) as __dbt_sbq
    
15:52:07.838689 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:52:07.841682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:07.842027 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
15:52:07.851172 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:07.852529 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:07.852778 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
15:52:07.882951 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:07.886918 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:07.887244 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
15:52:07.919366 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:07.923915 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:07.924307 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:07.953823 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:07.957248 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:07.957551 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179''), CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:07.693179'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end



    
15:52:07.969863 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:07.971250 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:07.971501 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
15:52:09.430950 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
15:52:09.432580 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:09.432769 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:09.503129 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:09.505773 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:09.505966 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:09.776650 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:52:09.779531 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:09.779743 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
15:52:09.792528 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.94 seconds
15:52:09.794065 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:09.794223 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:09.837446 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:09.840162 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:09.840482 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:09.852711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
15:52:09.854267 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:09.854738 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:09.854577 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:09.860108 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:09.860345 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:10.283409 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:52:10.286020 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:10.286223 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:10.328071 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
15:52:10.329624 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:10.329825 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
15:52:11.351115 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
15:52:11.353318 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Roles_Incr"
15:52:11.353804 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:11.353954 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Roles_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:11.731355 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
15:52:11.733063 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:11.733260 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:11.793177 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
15:52:11.795183 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplatecontents_Incr"
15:52:11.795605 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:11.795735 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr" (
                  "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:11.831240 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:11.833815 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:11.834030 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:12.061748 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:52:12.065173 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:12.065411 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
15:52:12.140751 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:12.145345 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:12.145605 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:12.185961 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:12.187690 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:12.187976 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
15:52:13.017735 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
15:52:13.019623 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Roles_Incr: COMMIT
15:52:13.020781 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
15:52:13.020974 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end

15:52:13.072253 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:13.081196 [debug] [Thread-3  ]: finished collecting timing info
15:52:13.081597 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Roles_Incr: Close
15:52:13.082415 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604b970>]}
15:52:13.083005 [info ] [Thread-3  ]: 80 of 101 OK snapshotted stg.AH_Roles_Incr...................................... [[32mOK[0m in 16.16s]
15:52:13.083449 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Roles_Incr
15:52:13.083681 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ShippingMethods_Incr
15:52:13.084114 [info ] [Thread-3  ]: 84 of 101 START snapshot stg.AH_ShippingMethods_Incr............................ [RUN]
15:52:13.084632 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr"
15:52:13.084825 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ShippingMethods_Incr
15:52:13.085000 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ShippingMethods_Incr
15:52:13.087926 [debug] [Thread-3  ]: finished collecting timing info
15:52:13.088161 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ShippingMethods_Incr
15:52:13.091024 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:13.091244 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:13.091404 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:52:13.091579 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:13.213819 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:13.256682 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:52:13.279458 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:13.279889 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:13.286522 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
15:52:13.287923 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:13.288155 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:13.319711 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:13.323018 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:13.323326 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingMethods_InterView]
        ) as __dbt_sbq
    
15:52:13.327474 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:13.329483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:13.329707 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:13.330328 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
15:52:13.331506 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: COMMIT
15:52:13.332245 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
15:52:13.332448 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end

15:52:13.377108 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:13.384415 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:13.392969 [debug] [Thread-2  ]: finished collecting timing info
15:52:13.403926 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: Close
15:52:13.404815 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37745a0040>]}
15:52:13.405364 [info ] [Thread-2  ]: 81 of 101 OK snapshotted stg.AH_SMStemplatecontents_Incr........................ [[32mOK[0m in 16.40s]
15:52:13.405789 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SMStemplatecontents_Incr
15:52:13.406013 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ShippingOptions_Incr
15:52:13.406408 [info ] [Thread-2  ]: 85 of 101 START snapshot stg.AH_ShippingOptions_Incr............................ [RUN]
15:52:13.406936 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr"
15:52:13.407129 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ShippingOptions_Incr
15:52:13.407301 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ShippingOptions_Incr
15:52:13.415104 [debug] [Thread-2  ]: finished collecting timing info
15:52:13.415334 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ShippingOptions_Incr
15:52:13.417925 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:13.412085 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:13.418315 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        ) as __dbt_sbq
    
15:52:13.418146 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:13.418674 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:52:13.418862 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:13.491648 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:13.496272 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:13.496576 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
15:52:13.524986 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:13.566001 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:52:13.567756 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:52:13.569599 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplates_Incr"
15:52:13.570170 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:13.570360 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:13.585136 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:13.588767 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:13.595424 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingMethods_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019''), CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.287019'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end



    
15:52:13.595279 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:13.595908 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:13.623461 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:13.625725 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:13.626043 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingOptions_InterView]
        ) as __dbt_sbq
    
15:52:13.680421 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:13.702493 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:13.702922 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        ) as __dbt_sbq
    
15:52:13.749890 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:13.754799 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:13.755123 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
15:52:13.835805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:13.839331 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:13.839604 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingOptions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148''), CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:13.615148'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end



    
15:52:15.138861 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.57 seconds
15:52:15.140514 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SMStemplates_Incr: COMMIT
15:52:15.141568 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
15:52:15.141711 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end

15:52:15.221736 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:15.230941 [debug] [Thread-4  ]: finished collecting timing info
15:52:15.231339 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SMStemplates_Incr: Close
15:52:15.232121 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377604bac0>]}
15:52:15.232661 [info ] [Thread-4  ]: 82 of 101 OK snapshotted stg.AH_SMStemplates_Incr............................... [[32mOK[0m in 14.46s]
15:52:15.233806 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_SMStemplates_Incr
15:52:15.234039 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Siteproperties_Incr
15:52:15.234787 [info ] [Thread-4  ]: 86 of 101 START snapshot stg.AH_Siteproperties_Incr............................. [RUN]
15:52:15.235317 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Siteproperties_Incr"
15:52:15.235511 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Siteproperties_Incr
15:52:15.235685 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Siteproperties_Incr
15:52:15.238671 [debug] [Thread-4  ]: finished collecting timing info
15:52:15.238903 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Siteproperties_Incr
15:52:15.241746 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:15.241970 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:15.242131 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:52:15.242307 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:15.357565 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:15.405362 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:52:15.427668 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:15.428070 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:15.456598 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:15.458880 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:15.459167 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Siteproperties_InterView]
        ) as __dbt_sbq
    
15:52:15.517070 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:15.540210 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:15.540622 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        ) as __dbt_sbq
    
15:52:15.609977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:15.613553 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:15.613895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
15:52:15.690477 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:15.694243 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:15.694466 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Siteproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Siteproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303''), CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:15.443303'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Siteproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end



    
15:52:17.683033 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 9.73 seconds
15:52:17.687745 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:17.688077 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:17.739716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:17.742061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:17.742377 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
15:52:18.963754 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
15:52:18.965276 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:18.965452 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:19.069208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:19.071912 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:19.072132 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:19.095530 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.50 seconds
15:52:19.099353 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:19.099674 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:19.136109 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:19.137848 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:19.138144 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
15:52:19.312877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:52:19.316117 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:19.316347 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
15:52:19.413901 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:19.417832 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:19.418049 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:19.490498 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:19.492063 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:19.492252 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
15:52:20.586227 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
15:52:20.588078 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:20.588403 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:20.589780 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.75 seconds
15:52:20.592976 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:20.593239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:20.669428 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:20.671520 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:20.671862 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
15:52:20.694286 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:52:20.696796 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:20.697082 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:20.764368 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
15:52:20.766088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:20.766353 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:20.862473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:20.865275 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:20.865496 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:21.048320 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:52:21.051045 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:21.051243 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
15:52:21.137849 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:21.141870 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:21.142099 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:21.145275 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:52:21.147964 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:21.148247 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
15:52:21.178142 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:21.179902 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:21.180237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
15:52:21.227570 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:21.232555 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:21.232963 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:21.285854 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:21.287512 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:21.287814 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
15:52:21.702090 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
15:52:21.703790 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:21.703998 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:21.782012 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:21.784665 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:21.784916 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:22.095437 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:52:22.098419 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:22.098796 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
15:52:22.167625 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:22.171869 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:22.172183 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:22.645042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
15:52:22.646821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:22.647016 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:52:22.648282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:22.648443 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:22.647175 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:22.663963 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
15:52:22.665560 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:22.665848 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
15:52:22.694288 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:22.697322 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:22.694863 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:22.702326 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:22.697655 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:22.702782 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:22.911299 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:52:22.913583 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SalesTaxRates_Incr"
15:52:22.914084 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:22.914239 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr" (
                  "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:23.227136 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
15:52:23.230052 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:23.230263 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
15:52:23.273992 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:23.278814 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:23.279146 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:23.324228 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:23.326259 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:23.326581 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
15:52:23.854750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
15:52:23.856389 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:23.856612 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:23.901075 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:23.903935 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:23.904253 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:24.396875 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
15:52:24.400060 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:24.400286 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
15:52:24.445111 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:24.449717 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:24.450046 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:24.486992 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:24.488711 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:24.489012 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
15:52:25.160694 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
15:52:25.162389 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:25.162605 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:25.199512 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:25.201912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:25.202113 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:25.206807 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.29 seconds
15:52:25.208246 [debug] [Thread-1  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: COMMIT
15:52:25.209065 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
15:52:25.209293 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end

15:52:25.245896 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:25.254987 [debug] [Thread-1  ]: finished collecting timing info
15:52:25.255459 [debug] [Thread-1  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: Close
15:52:25.256278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377438cc10>]}
15:52:25.256833 [info ] [Thread-1  ]: 83 of 101 OK snapshotted stg.AH_SalesTaxRates_Incr.............................. [[32mOK[0m in 17.93s]
15:52:25.257271 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_SalesTaxRates_Incr
15:52:25.257496 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_States_Incr
15:52:25.257910 [info ] [Thread-1  ]: 87 of 101 START snapshot stg.AH_States_Incr..................................... [RUN]
15:52:25.258387 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_States_Incr"
15:52:25.258599 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_States_Incr
15:52:25.258780 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_States_Incr
15:52:25.261850 [debug] [Thread-1  ]: finished collecting timing info
15:52:25.262086 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_States_Incr
15:52:25.265864 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:25.266087 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:25.266246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:52:25.266419 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:25.399094 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:25.400314 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
15:52:25.401880 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:25.402150 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:25.436019 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:52:25.438321 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingMethods_Incr"
15:52:25.439006 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:25.439230 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr" (
                  "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:25.443367 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:52:25.444885 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:25.447003 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:25.447225 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:25.468200 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:25.468629 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:25.496597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:25.499127 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:25.499547 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_States_InterView]
        ) as __dbt_sbq
    
15:52:25.561114 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:25.584485 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:25.584921 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        ) as __dbt_sbq
    
15:52:25.660498 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:25.665148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:25.665502 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
15:52:25.677198 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:52:25.679391 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingOptions_Incr"
15:52:25.680026 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:25.680224 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:25.704474 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 10.01 seconds
15:52:25.708040 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:25.708393 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:25.745078 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:25.748900 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:25.749272 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_States_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_States_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725''), CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:25.474725'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_States_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_States_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end



    
15:52:25.765226 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:25.766886 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:25.767197 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
15:52:27.528823 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.76 seconds
15:52:27.530594 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:27.530835 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:27.532332 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.09 seconds
15:52:27.533807 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: COMMIT
15:52:27.535052 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
15:52:27.535225 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end

15:52:27.571936 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:27.582082 [debug] [Thread-3  ]: finished collecting timing info
15:52:27.582598 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: Close
15:52:27.583439 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377421f700>]}
15:52:27.584017 [info ] [Thread-3  ]: 84 of 101 OK snapshotted stg.AH_ShippingMethods_Incr............................ [[32mOK[0m in 14.50s]
15:52:27.584468 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ShippingMethods_Incr
15:52:27.584695 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_StripeCustomers_Incr
15:52:27.585102 [info ] [Thread-3  ]: 88 of 101 START snapshot stg.AH_StripeCustomers_Incr............................ [RUN]
15:52:27.585588 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr"
15:52:27.585779 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_StripeCustomers_Incr
15:52:27.585957 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_StripeCustomers_Incr
15:52:27.589077 [debug] [Thread-3  ]: finished collecting timing info
15:52:27.589382 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_StripeCustomers_Incr
15:52:27.593458 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:27.593690 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:27.593854 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:52:27.594029 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:27.620433 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:27.623133 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:27.623455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:27.709416 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:27.747344 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:52:27.770212 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:27.771050 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:27.778615 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
15:52:27.780276 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: COMMIT
15:52:27.781136 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
15:52:27.781350 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end

15:52:27.823791 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:27.826177 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:27.826507 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_StripeCustomers_InterView]
        ) as __dbt_sbq
    
15:52:27.850870 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:27.860836 [debug] [Thread-2  ]: finished collecting timing info
15:52:27.861355 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: Close
15:52:27.862186 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776022040>]}
15:52:27.862776 [info ] [Thread-2  ]: 85 of 101 OK snapshotted stg.AH_ShippingOptions_Incr............................ [[32mOK[0m in 14.46s]
15:52:27.863219 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ShippingOptions_Incr
15:52:27.863446 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
15:52:27.863865 [info ] [Thread-2  ]: 89 of 101 START snapshot stg.AH_SubmittedListingPayment_Incr.................... [RUN]
15:52:27.864350 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
15:52:27.864541 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SubmittedListingPayment_Incr
15:52:27.864715 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SubmittedListingPayment_Incr
15:52:27.867720 [debug] [Thread-2  ]: finished collecting timing info
15:52:27.867953 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SubmittedListingPayment_Incr
15:52:27.870909 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:27.871127 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:27.871288 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:52:27.871461 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:27.883436 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:27.908296 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:27.908733 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        ) as __dbt_sbq
    
15:52:27.950710 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:52:27.955345 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:27.955668 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
15:52:27.970428 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:27.976803 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:27.980614 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:27.980917 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
15:52:28.001990 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:52:28.024974 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:28.025446 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:28.043925 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:28.048573 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:28.048918 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:28.064188 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:28.067663 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:28.068061 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_StripeCustomers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889''), CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:27.802889'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end



    
15:52:28.075161 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:28.077261 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:28.077955 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]
        ) as __dbt_sbq
    
15:52:28.083625 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:28.085053 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:28.085313 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
15:52:28.134517 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:28.156867 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:28.157355 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        ) as __dbt_sbq
    
15:52:28.294429 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:52:28.298039 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:28.298270 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
15:52:28.377781 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:28.381562 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:28.381808 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524''), CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:28.068524'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end



    
15:52:29.257493 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
15:52:29.259199 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:29.259393 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:29.316578 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:29.319340 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:29.319578 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:29.643674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:52:29.647157 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:29.647424 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
15:52:29.691471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:29.696284 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:29.696699 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:29.743947 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:29.745668 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:29.745977 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
15:52:30.644619 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
15:52:30.646326 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:30.646516 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:30.685628 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:30.688234 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:30.688420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:30.957580 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:52:30.960201 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Siteproperties_Incr"
15:52:30.960627 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:30.960764 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr" (
                  "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:32.980050 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
15:52:32.981931 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Siteproperties_Incr: COMMIT
15:52:32.982808 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
15:52:32.983028 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end

15:52:33.032786 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:33.046155 [debug] [Thread-4  ]: finished collecting timing info
15:52:33.046522 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Siteproperties_Incr: Close
15:52:33.047289 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774748fa0>]}
15:52:33.047798 [info ] [Thread-4  ]: 86 of 101 OK snapshotted stg.AH_Siteproperties_Incr............................. [[32mOK[0m in 17.81s]
15:52:33.048276 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Siteproperties_Incr
15:52:33.048503 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_SysDiagrams_Incr
15:52:33.048898 [info ] [Thread-4  ]: 90 of 101 START snapshot stg.AH_SysDiagrams_Incr................................ [RUN]
15:52:33.049368 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr"
15:52:33.049556 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_SysDiagrams_Incr
15:52:33.049723 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_SysDiagrams_Incr
15:52:33.052525 [debug] [Thread-4  ]: finished collecting timing info
15:52:33.052756 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_SysDiagrams_Incr
15:52:33.055593 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:33.055815 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:33.055975 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:52:33.056146 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:33.165174 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:33.193675 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:52:33.215846 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:33.216273 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:33.225441 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.48 seconds
15:52:33.228775 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:33.229038 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:33.256768 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:33.259422 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:33.259735 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SysDiagrams_InterView]
        ) as __dbt_sbq
    
15:52:33.270668 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:33.272002 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:33.272258 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
15:52:33.325017 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:33.347008 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:33.347474 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        ) as __dbt_sbq
    
15:52:33.438450 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:33.441693 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:33.441889 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
15:52:33.538406 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:33.541915 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:33.542133 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SysDiagrams_InterView]

    ),

    snapshotted_data as (

        select *,
            Diagram_ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470''), CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(Diagram_ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:33.240470'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end



    
15:52:34.238893 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
15:52:34.240589 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:34.240783 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:34.289443 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.22 seconds
15:52:34.293038 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:34.293232 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:34.314129 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:34.316696 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:34.316984 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:34.333464 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:34.335704 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:34.336293 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
15:52:34.538458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:52:34.541587 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:34.541802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
15:52:34.624095 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:34.628175 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:34.628368 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:34.674942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:34.676672 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:34.676981 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
15:52:35.500283 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.12 seconds
15:52:35.503752 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:35.503949 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:35.545101 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:35.546825 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:35.547122 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
15:52:35.609704 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
15:52:35.611334 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:35.611608 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:35.682452 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:35.685101 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:35.685299 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:35.804863 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
15:52:35.806503 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:35.806718 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:35.849806 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:35.853975 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:35.854252 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:36.262137 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
15:52:36.265049 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:36.265271 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
15:52:36.276924 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
15:52:36.279971 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:36.280229 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
15:52:36.315941 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:36.320514 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:36.320825 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:36.339602 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:36.343471 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:36.343735 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:36.356757 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:36.358017 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:36.358251 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
15:52:36.413357 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:36.414909 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:36.415175 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
15:52:36.705027 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
15:52:36.706711 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:36.706903 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:36.784911 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:36.787926 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:36.788150 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:37.038662 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:52:37.041314 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:37.041516 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
15:52:37.135664 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:37.140005 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:37.140365 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:37.191948 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:37.194408 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:37.194738 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
15:52:37.480350 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
15:52:37.482038 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:37.482244 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:37.519323 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
15:52:37.521026 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:37.521230 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:37.524613 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:37.527080 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:37.527299 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:37.566079 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:37.568803 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:37.569115 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:37.774393 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:52:37.776611 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_States_Incr"
15:52:37.777061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:37.777198 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_States_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_States_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:37.822558 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:52:37.825848 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:37.826180 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
15:52:37.858894 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:37.863774 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:37.864162 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:37.899652 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:37.901395 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:37.901694 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
15:52:38.400410 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
15:52:38.402075 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:38.402272 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:38.438665 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:38.441294 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:38.441523 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:39.134343 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:52:39.135957 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: COMMIT
15:52:39.136949 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
15:52:39.137090 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end

15:52:39.217844 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.78 seconds
15:52:39.220553 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:39.220749 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
15:52:39.220974 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:39.232562 [debug] [Thread-1  ]: finished collecting timing info
15:52:39.233029 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: Close
15:52:39.233831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377452a5e0>]}
15:52:39.303348 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:39.311376 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:39.311750 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:39.372070 [info ] [Thread-1  ]: 87 of 101 OK snapshotted stg.AH_States_Incr..................................... [[32mOK[0m in 13.98s]
15:52:39.373090 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_States_Incr
15:52:39.373337 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ThReadTracking_Incr
15:52:39.373755 [info ] [Thread-1  ]: 91 of 101 START snapshot stg.AH_ThReadTracking_Incr............................. [RUN]
15:52:39.374314 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr"
15:52:39.374519 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ThReadTracking_Incr
15:52:39.374736 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ThReadTracking_Incr
15:52:39.377694 [debug] [Thread-1  ]: finished collecting timing info
15:52:39.378010 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ThReadTracking_Incr
15:52:39.378738 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:39.379924 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:39.380142 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
15:52:39.383287 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:39.383517 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:39.383679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:52:39.383855 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:39.497549 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:39.549399 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:52:39.573680 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:39.574116 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:39.625671 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
15:52:39.628180 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:39.628500 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:39.646055 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:39.648819 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:39.649140 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ThReadTracking_InterView]
        ) as __dbt_sbq
    
15:52:39.678640 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:39.681299 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:39.681572 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:39.720500 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:39.741842 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:39.742294 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        ) as __dbt_sbq
    
15:52:39.805528 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:39.809205 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:39.809486 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
15:52:39.912627 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:39.916031 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:39.916223 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ThReadTracking_InterView]

    ),

    snapshotted_data as (

        select *,
            ThReadGUID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187''), CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ThReadGUID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:39.631187'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end



    
15:52:39.950018 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:52:39.952384 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_StripeCustomers_Incr"
15:52:39.953036 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:39.953259 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr" (
                  "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:40.342310 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
15:52:40.343932 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:40.344106 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:40.411131 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:40.413518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:40.413700 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:40.632486 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:52:40.635196 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
15:52:40.635642 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:40.635782 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr" (
                  "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:40.825613 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.28 seconds
15:52:40.829206 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:40.829413 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:40.878416 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:40.880003 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:40.880272 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
15:52:41.402859 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
15:52:41.404586 [debug] [Thread-3  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: COMMIT
15:52:41.405386 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
15:52:41.405544 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end

15:52:41.449832 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:41.460908 [debug] [Thread-3  ]: finished collecting timing info
15:52:41.461282 [debug] [Thread-3  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: Close
15:52:41.462037 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776022430>]}
15:52:41.462580 [info ] [Thread-3  ]: 88 of 101 OK snapshotted stg.AH_StripeCustomers_Incr............................ [[32mOK[0m in 13.88s]
15:52:41.463018 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_StripeCustomers_Incr
15:52:41.463241 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Tiers_Incr
15:52:41.463634 [info ] [Thread-3  ]: 92 of 101 START snapshot stg.AH_Tiers_Incr...................................... [RUN]
15:52:41.464091 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Tiers_Incr"
15:52:41.464279 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Tiers_Incr
15:52:41.464449 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Tiers_Incr
15:52:41.467425 [debug] [Thread-3  ]: finished collecting timing info
15:52:41.467654 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Tiers_Incr
15:52:41.470619 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:41.470835 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:41.470995 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:52:41.471164 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:41.571779 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:41.603878 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:52:41.626563 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:41.626996 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:41.655565 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:41.657881 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:41.658191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Tiers_InterView]
        ) as __dbt_sbq
    
15:52:41.730051 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:41.754090 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:41.754509 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        ) as __dbt_sbq
    
15:52:41.859628 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:52:41.863478 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:41.863811 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
15:52:41.950845 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:41.954340 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:41.954705 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Tiers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Tiers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836''), CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:41.646836'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Tiers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Tiers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end



    
15:52:41.980655 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
15:52:41.982457 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:41.982831 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:42.000764 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
15:52:42.002575 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: COMMIT
15:52:42.003478 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
15:52:42.003718 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end

15:52:42.045492 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:42.055971 [debug] [Thread-2  ]: finished collecting timing info
15:52:42.056378 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: Close
15:52:42.057158 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774550220>]}
15:52:42.057700 [info ] [Thread-2  ]: 89 of 101 OK snapshotted stg.AH_SubmittedListingPayment_Incr.................... [[32mOK[0m in 14.19s]
15:52:42.058131 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
15:52:42.058356 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_UserAlerts_Incr
15:52:42.058795 [info ] [Thread-2  ]: 93 of 101 START snapshot stg.AH_UserAlerts_Incr................................. [RUN]
15:52:42.059285 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserAlerts_Incr"
15:52:42.059539 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_UserAlerts_Incr
15:52:42.059717 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_UserAlerts_Incr
15:52:42.062732 [debug] [Thread-2  ]: finished collecting timing info
15:52:42.062964 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_UserAlerts_Incr
15:52:42.065806 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:42.066032 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:42.066194 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:52:42.066371 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:42.069192 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:42.071422 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:42.071645 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:42.182762 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:42.212173 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:52:42.234077 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:42.234509 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:42.269327 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:42.272041 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:42.272355 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserAlerts_InterView]
        ) as __dbt_sbq
    
15:52:42.288224 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:52:42.291042 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:42.291322 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
15:52:42.326654 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:42.348943 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:42.349383 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        ) as __dbt_sbq
    
15:52:42.367517 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:42.371924 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:42.372270 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:42.405936 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:42.409550 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:42.409822 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:42.411168 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:42.411380 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
15:52:42.409976 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
15:52:42.491928 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:42.495230 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:42.495425 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserAlerts_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserAlerts_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221''), CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:42.256221'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserAlerts_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end



    
15:52:43.735661 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
15:52:43.737336 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:43.737532 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:43.820754 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:43.823143 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:43.823337 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:44.227030 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:52:44.231626 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:44.231956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
15:52:44.307471 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:44.312602 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:44.313013 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:44.355339 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:44.357071 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:44.357394 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
15:52:44.790603 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.87 seconds
15:52:44.794113 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:44.794414 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:44.835474 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:44.837193 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:44.837490 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
15:52:46.222863 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
15:52:46.224527 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:46.224726 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:46.225031 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
15:52:46.226169 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:46.226324 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:46.303596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:46.306151 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:46.306412 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:46.307031 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:46.309682 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:46.309873 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:46.881466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.57 seconds
15:52:46.884361 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:46.884591 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
15:52:46.903543 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.59 seconds
15:52:46.905570 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SysDiagrams_Incr"
15:52:46.906020 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:46.906152 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr" (
                  "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:46.976748 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:46.982416 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:46.982861 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:47.051670 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:47.053473 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:47.053694 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
15:52:48.447798 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
15:52:48.449494 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:48.449700 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:48.499353 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:48.501989 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:48.502223 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:48.529345 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
15:52:48.531083 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: COMMIT
15:52:48.531941 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
15:52:48.532118 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end

15:52:48.568622 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:48.580384 [debug] [Thread-4  ]: finished collecting timing info
15:52:48.580875 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: Close
15:52:48.581708 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37760226d0>]}
15:52:48.582272 [info ] [Thread-4  ]: 90 of 101 OK snapshotted stg.AH_SysDiagrams_Incr................................ [[32mOK[0m in 15.53s]
15:52:48.582747 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_SysDiagrams_Incr
15:52:48.582980 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_UserMessages_Incr
15:52:48.583395 [info ] [Thread-4  ]: 94 of 101 START snapshot stg.AH_UserMessages_Incr............................... [RUN]
15:52:48.583943 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserMessages_Incr"
15:52:48.584142 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_UserMessages_Incr
15:52:48.584317 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_UserMessages_Incr
15:52:48.587366 [debug] [Thread-4  ]: finished collecting timing info
15:52:48.587608 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_UserMessages_Incr
15:52:48.590619 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:52:48.590842 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:48.591019 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:52:48.591198 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:48.705980 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:48.733706 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:52:48.756236 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:52:48.756713 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:48.772694 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:52:48.775925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:48.776286 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
15:52:48.793417 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:48.795830 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:52:48.796146 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserMessages_InterView]
        ) as __dbt_sbq
    
15:52:48.812528 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:48.817314 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:48.817708 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:48.848276 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:48.870202 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:52:48.870476 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:48.871981 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:48.872213 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
15:52:48.870803 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        ) as __dbt_sbq
    
15:52:49.044108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:52:49.047986 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:52:49.048226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
15:52:49.119232 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:49.123483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:52:49.123832 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserMessages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserMessages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941''), CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:48.771941'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end



    
15:52:49.771934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
15:52:49.773619 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:49.773816 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:49.814164 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:49.816718 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:49.816947 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:50.049015 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:52:50.050975 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ThReadTracking_Incr"
15:52:50.051426 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:50.051558 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr" (
                  "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:51.964343 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 10.01 seconds
15:52:51.967973 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:51.968210 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:52.029239 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:52:52.030719 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:52.030901 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
15:52:52.319008 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.27 seconds
15:52:52.320774 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: COMMIT
15:52:52.321606 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
15:52:52.321761 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end

15:52:52.406017 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:52.513755 [debug] [Thread-1  ]: finished collecting timing info
15:52:52.514273 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: Close
15:52:52.515116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37741042b0>]}
15:52:52.515685 [info ] [Thread-1  ]: 91 of 101 OK snapshotted stg.AH_ThReadTracking_Incr............................. [[32mOK[0m in 13.14s]
15:52:52.516128 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ThReadTracking_Incr
15:52:52.516356 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_UserOptOut_Incr
15:52:52.516767 [info ] [Thread-1  ]: 95 of 101 START snapshot stg.AH_UserOptOut_Incr................................. [RUN]
15:52:52.517245 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserOptOut_Incr"
15:52:52.517456 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_UserOptOut_Incr
15:52:52.517632 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_UserOptOut_Incr
15:52:52.520724 [debug] [Thread-1  ]: finished collecting timing info
15:52:52.520960 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_UserOptOut_Incr
15:52:52.523697 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:52:52.523920 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:52:52.524081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:52:52.524258 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:52:52.650363 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:52:52.697218 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:52:52.719313 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:52:52.719792 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:52:52.752602 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:52:52.754986 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:52:52.755294 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserOptOut_InterView]
        ) as __dbt_sbq
    
15:52:52.865207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:52:52.887403 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:52:52.888067 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        ) as __dbt_sbq
    
15:52:53.024036 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:52:53.027626 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:52:53.027848 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
15:52:53.121387 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:52:53.125403 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:52:53.125733 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserOptOut_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserOptOut_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757''), CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:52:52.740757'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserOptOut_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end



    
15:52:53.241789 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
15:52:53.243544 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:53.243742 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:53.454996 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:52:53.457536 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:53.457750 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:53.721245 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:52:53.724502 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:53.724751 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
15:52:53.795743 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:53.801441 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:53.802237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:53.935260 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:52:53.936840 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:53.937054 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
15:52:55.862276 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.93 seconds
15:52:55.863992 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:55.864231 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:55.901234 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:55.903733 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:55.903947 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:56.002684 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 13.51 seconds
15:52:56.006296 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:56.006771 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:56.049944 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:56.052468 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:56.052833 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
15:52:56.263089 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
15:52:56.266261 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:56.266504 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
15:52:56.315475 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:56.320131 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:56.320562 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:56.521980 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:52:56.523613 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:56.523821 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
15:52:57.420303 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
15:52:57.421992 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:57.422188 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:57.506855 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:57.509475 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:57.509681 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:57.740020 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
15:52:57.743833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:57.744121 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:57.756114 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:52:57.758986 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:57.759329 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
15:52:57.788501 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:57.791706 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:57.792081 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:57.839216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:52:57.843785 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:57.844190 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:57.890456 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:57.892219 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:57.892531 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
15:52:58.091425 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:52:58.093543 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Tiers_Incr"
15:52:58.093972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:52:58.094099 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Tiers_Incr" (
                  "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:52:59.185769 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
15:52:59.187467 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:59.187670 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:52:59.241470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:52:59.244112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:59.244348 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:59.496782 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:52:59.500048 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:59.500270 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
15:52:59.569040 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:52:59.573597 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:59.573813 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:52:59.611828 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:52:59.613533 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:52:59.613851 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
15:53:00.209629 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.12 seconds
15:53:00.213176 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Tiers_Incr: COMMIT
15:53:00.213992 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
15:53:00.214146 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end

15:53:00.281788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:00.292016 [debug] [Thread-3  ]: finished collecting timing info
15:53:00.292483 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Tiers_Incr: Close
15:53:00.293298 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774300970>]}
15:53:00.294606 [info ] [Thread-3  ]: 92 of 101 OK snapshotted stg.AH_Tiers_Incr...................................... [[32mOK[0m in 18.83s]
15:53:00.295355 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Tiers_Incr
15:53:00.295647 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_UserRoles_Incr
15:53:00.296072 [info ] [Thread-3  ]: 96 of 101 START snapshot stg.AH_UserRoles_Incr.................................. [RUN]
15:53:00.296600 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserRoles_Incr"
15:53:00.296796 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_UserRoles_Incr
15:53:00.296969 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_UserRoles_Incr
15:53:00.299942 [debug] [Thread-3  ]: finished collecting timing info
15:53:00.300174 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_UserRoles_Incr
15:53:00.304524 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:00.304855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:53:00.305034 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:53:00.305215 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:53:00.405785 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:53:00.434670 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:53:00.457678 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:00.458149 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:53:00.487384 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:00.489813 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:00.490148 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserRoles_InterView]
        ) as __dbt_sbq
    
15:53:00.569136 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:00.577149 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
15:53:00.579826 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:53:00.580168 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:00.595132 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:00.595588 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        ) as __dbt_sbq
    
15:53:00.613995 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:00.616557 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:53:00.616848 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:00.659475 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.53 seconds
15:53:00.663067 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:00.663410 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:00.673396 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:00.677040 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:00.677391 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
15:53:00.717990 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:00.719612 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:00.719886 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
15:53:00.795906 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:53:00.799592 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:00.799922 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserRoles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserRoles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256''), CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:53:00.475256'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserRoles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserRoles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end



    
15:53:00.804334 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:53:00.807417 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserAlerts_Incr"
15:53:00.807993 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:53:00.808185 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr" (
                  "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:02.491849 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:53:02.493533 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:02.493734 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:02.796851 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:53:02.800179 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:02.800555 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:03.189141 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
15:53:03.192057 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:03.192254 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
15:53:03.272323 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:03.276267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:03.276478 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:03.313018 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:03.314749 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:03.315045 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
15:53:03.515678 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
15:53:03.517408 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserAlerts_Incr: COMMIT
15:53:03.518469 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
15:53:03.518878 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end

15:53:03.727539 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:53:03.738150 [debug] [Thread-2  ]: finished collecting timing info
15:53:03.738603 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserAlerts_Incr: Close
15:53:03.739427 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776022ac0>]}
15:53:03.739958 [info ] [Thread-2  ]: 93 of 101 OK snapshotted stg.AH_UserAlerts_Incr................................. [[32mOK[0m in 21.68s]
15:53:03.740407 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_UserAlerts_Incr
15:53:03.740634 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Userclaims_Incr
15:53:03.741026 [info ] [Thread-2  ]: 97 of 101 START snapshot stg.AH_Userclaims_Incr................................. [RUN]
15:53:03.741502 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userclaims_Incr"
15:53:03.741691 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Userclaims_Incr
15:53:03.741863 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Userclaims_Incr
15:53:03.744709 [debug] [Thread-2  ]: finished collecting timing info
15:53:03.744939 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Userclaims_Incr
15:53:03.747706 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:03.747927 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:53:03.748084 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:53:03.748256 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:53:03.855442 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:53:03.905898 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:53:03.929698 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:03.930880 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:53:03.972776 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:03.974984 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:03.975295 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userclaims_InterView]
        ) as __dbt_sbq
    
15:53:04.071132 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:53:04.092839 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:04.093270 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        ) as __dbt_sbq
    
15:53:04.149228 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:04.152860 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:04.153182 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
15:53:04.338106 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:53:04.341625 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:04.341846 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userclaims_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userclaims_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687''), CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:53:03.959687'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userclaims_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userclaims_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end



    
15:53:04.564729 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
15:53:04.566353 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:04.566566 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:04.640376 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:04.643047 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:04.643312 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:04.942823 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:53:04.946098 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:04.946313 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
15:53:05.001473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:05.005967 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:05.006184 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:05.043620 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:05.045324 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:05.045622 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
15:53:06.239683 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
15:53:06.241367 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:06.241584 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:06.323340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:06.325914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:06.326167 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:06.623823 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:53:06.625974 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserOptOut_Incr"
15:53:06.626438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:06.626626 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr" (
                  "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:08.540466 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 19.42 seconds
15:53:08.544138 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:08.544346 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:08.594681 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:08.598142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:08.598455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
15:53:08.736803 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.11 seconds
15:53:08.738523 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserOptOut_Incr: COMMIT
15:53:08.739553 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
15:53:08.739702 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end

15:53:08.791434 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:08.802895 [debug] [Thread-1  ]: finished collecting timing info
15:53:08.803363 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserOptOut_Incr: Close
15:53:08.804188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776022d60>]}
15:53:08.804744 [info ] [Thread-1  ]: 95 of 101 OK snapshotted stg.AH_UserOptOut_Incr................................. [[32mOK[0m in 16.29s]
15:53:08.805206 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_UserOptOut_Incr
15:53:08.805430 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Userproperties_Incr
15:53:08.805821 [info ] [Thread-1  ]: 98 of 101 START snapshot stg.AH_Userproperties_Incr............................. [RUN]
15:53:08.806298 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userproperties_Incr"
15:53:08.806486 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Userproperties_Incr
15:53:08.806696 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Userproperties_Incr
15:53:08.809600 [debug] [Thread-1  ]: finished collecting timing info
15:53:08.809831 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Userproperties_Incr
15:53:08.812663 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:08.812938 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:53:08.813122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:53:08.813305 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:53:08.936910 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:53:08.967935 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:53:08.990002 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:08.990394 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:53:09.022052 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:09.024361 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:09.024667 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userproperties_InterView]
        ) as __dbt_sbq
    
15:53:09.083506 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:09.105018 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:09.105436 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        ) as __dbt_sbq
    
15:53:09.174722 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.83 seconds
15:53:09.178155 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:09.178442 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:09.217211 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:09.219907 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:09.220192 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
15:53:09.263374 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.46 seconds
15:53:09.266958 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:09.267287 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:09.308625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:09.310325 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:09.310665 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
15:53:09.407726 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:53:09.411562 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:09.412100 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
15:53:09.486400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:09.491491 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:09.491864 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652''), CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:53:09.006652'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end



    
15:53:09.555716 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
15:53:09.557321 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:09.557510 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:09.642935 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:53:09.645416 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:09.645621 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:09.900021 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:53:09.903246 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:09.903432 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
15:53:09.976802 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:09.980916 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:09.981137 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:10.032866 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:10.034383 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:10.034604 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
15:53:10.375818 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
15:53:10.377430 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:10.377614 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:10.382122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
15:53:10.383504 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:10.383665 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:10.678797 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
15:53:10.683250 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:10.683467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:53:10.685374 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:10.685594 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:10.683685 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:11.083864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:53:11.087059 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:11.087275 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
15:53:11.201990 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
15:53:11.204888 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:11.205121 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
15:53:11.261331 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:53:11.265170 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:11.265363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:11.287371 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:11.291409 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:11.292440 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:11.304141 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:11.305567 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:11.305815 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
15:53:11.329848 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:11.331547 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:11.331844 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
15:53:11.450687 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
15:53:11.452331 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:11.452542 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:11.498227 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:11.501286 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:11.501583 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:12.482799 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
15:53:12.485873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:12.486086 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
15:53:12.532663 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:12.537028 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:12.537346 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:12.570900 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:12.572577 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:12.572846 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
15:53:13.319109 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.99 seconds
15:53:13.320737 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:13.320924 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:13.360845 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:13.363408 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:13.363625 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:13.480403 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.17 seconds
15:53:13.482011 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:13.482207 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:13.602702 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:53:13.605168 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:13.605363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:14.232432 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
15:53:14.235683 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:14.235876 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.63 seconds
15:53:14.238007 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:14.238156 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
15:53:14.236024 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
15:53:14.299168 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:14.303292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:14.303610 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:14.319994 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:14.323991 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:14.324249 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:14.361155 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:14.362839 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:14.363130 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
15:53:14.368931 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:14.370150 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:14.370367 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
15:53:14.491929 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
15:53:14.493652 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:14.493902 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:14.534118 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:14.537366 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:14.537723 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:14.875620 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:53:14.878102 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserMessages_Incr"
15:53:14.878801 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:14.879030 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr" (
                  "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:15.874796 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
15:53:15.876500 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:15.876709 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:15.876977 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
15:53:15.878119 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:15.878279 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:15.918566 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:15.921123 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:15.921408 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:15.925935 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:15.921564 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:15.926173 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:16.201170 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:53:16.203354 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userclaims_Incr"
15:53:16.203800 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:16.203939 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr" (
                  "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:16.206728 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:53:16.208189 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserRoles_Incr"
15:53:16.208504 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:16.208620 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr" (
                  "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:16.573136 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
15:53:16.574937 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserMessages_Incr: COMMIT
15:53:16.575919 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
15:53:16.576104 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end

15:53:16.663251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:53:16.672777 [debug] [Thread-4  ]: finished collecting timing info
15:53:16.673236 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserMessages_Incr: Close
15:53:16.674032 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3776022c10>]}
15:53:16.674604 [info ] [Thread-4  ]: 94 of 101 OK snapshotted stg.AH_UserMessages_Incr............................... [[32mOK[0m in 28.09s]
15:53:16.675048 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_UserMessages_Incr
15:53:16.675273 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Users_Incr
15:53:16.675678 [info ] [Thread-4  ]: 99 of 101 START snapshot stg.AH_Users_Incr...................................... [RUN]
15:53:16.676147 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Users_Incr"
15:53:16.676338 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Users_Incr
15:53:16.676512 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Users_Incr
15:53:16.679440 [debug] [Thread-4  ]: finished collecting timing info
15:53:16.679675 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Users_Incr
15:53:16.682448 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:53:16.682688 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:53:16.682850 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:53:16.683025 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:53:16.813483 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:53:16.893623 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:53:16.916519 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:53:16.916956 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:53:16.948610 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:16.950981 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:53:16.951291 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Users_InterView]
        ) as __dbt_sbq
    
15:53:17.008244 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:17.030110 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:53:17.030555 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        ) as __dbt_sbq
    
15:53:17.924228 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.72 seconds
15:53:17.925941 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userclaims_Incr: COMMIT
15:53:17.926730 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
15:53:17.926884 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end

15:53:17.964648 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:17.975940 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
15:53:17.977507 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserRoles_Incr: COMMIT
15:53:17.978351 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
15:53:17.978596 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end

15:53:17.975794 [debug] [Thread-2  ]: finished collecting timing info
15:53:17.979083 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userclaims_Incr: Close
15:53:17.979769 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603e040>]}
15:53:17.980270 [info ] [Thread-2  ]: 97 of 101 OK snapshotted stg.AH_Userclaims_Incr................................. [[32mOK[0m in 14.24s]
15:53:17.980687 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Userclaims_Incr
15:53:17.980909 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Version_Incr
15:53:17.981296 [info ] [Thread-2  ]: 100 of 101 START snapshot stg.AH_Version_Incr................................... [RUN]
15:53:17.981766 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Version_Incr"
15:53:17.981953 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Version_Incr
15:53:17.982126 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Version_Incr
15:53:17.985128 [debug] [Thread-2  ]: finished collecting timing info
15:53:17.985408 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Version_Incr
15:53:17.988155 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:17.988378 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:53:17.988537 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:53:17.988715 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:53:18.042885 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:18.052927 [debug] [Thread-3  ]: finished collecting timing info
15:53:18.053407 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserRoles_Incr: Close
15:53:18.054192 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774193640>]}
15:53:18.054796 [info ] [Thread-3  ]: 96 of 101 OK snapshotted stg.AH_UserRoles_Incr.................................. [[32mOK[0m in 17.76s]
15:53:18.055230 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_UserRoles_Incr
15:53:18.055455 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Watches_Incr
15:53:18.055854 [info ] [Thread-3  ]: 101 of 101 START snapshot stg.AH_Watches_Incr................................... [RUN]
15:53:18.056367 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Watches_Incr"
15:53:18.056570 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Watches_Incr
15:53:18.056743 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Watches_Incr
15:53:18.059947 [debug] [Thread-3  ]: finished collecting timing info
15:53:18.060201 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Watches_Incr
15:53:18.065065 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:18.065671 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
15:53:18.065849 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:53:18.066034 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:53:18.109800 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:53:18.139426 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:53:18.165013 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:18.165458 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:53:18.188320 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:53:18.192829 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:18.195210 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:18.195558 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Version_InterView]
        ) as __dbt_sbq
    
15:53:18.227906 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:53:18.230261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
15:53:18.233894 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:53:18.243746 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
15:53:18.252110 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:18.267388 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:18.275794 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select SYSDATETIME() as snapshot_start
  
15:53:18.277950 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:18.278242 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        ) as __dbt_sbq
    
15:53:18.303088 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:53:18.305593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:18.306042 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Watches_InterView]
        ) as __dbt_sbq
    
15:53:18.316334 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:18.320404 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:53:18.320774 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Users_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Users_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662''), CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:53:16.928662'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Users_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Users_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end



    
15:53:18.361084 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:18.383757 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:18.384255 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        ) as __dbt_sbq
    
15:53:18.385056 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:53:18.388259 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:18.388702 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
15:53:18.463517 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:18.468889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:18.469329 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Version_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Version_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682''), CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.178682'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Version_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Version_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end



    
15:53:18.555016 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:53:18.558358 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:18.558818 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
15:53:18.648165 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:53:18.651782 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:18.652023 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Watches_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132''), CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-16 15:53:18.288132'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Watches_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end



    
15:53:25.532039 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.06 seconds
15:53:25.535712 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:25.535942 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:25.604377 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:25.605981 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:25.606188 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
15:53:26.918347 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
15:53:26.920217 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:26.920529 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:27.053543 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:53:27.056112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:27.056343 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:27.487938 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:53:27.491085 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:27.491328 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
15:53:27.565460 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:27.572743 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:27.573172 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:27.647474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:27.649099 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:27.649295 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
15:53:29.590471 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.94 seconds
15:53:29.592188 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:29.592373 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:29.736848 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:53:29.739461 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:29.739685 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:30.187984 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
15:53:30.191265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:30.191546 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
15:53:30.320195 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:53:30.324649 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:30.324867 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:30.442457 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:53:30.444010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:30.444204 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
15:53:32.608373 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
15:53:32.610050 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:32.610248 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:32.773006 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:53:32.775917 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:32.776236 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:33.217118 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
15:53:33.219261 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Version_Incr"
15:53:33.219714 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:33.219857 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Version_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Version_Incr" (
                  "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:35.344379 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.12 seconds
15:53:35.346100 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Version_Incr: COMMIT
15:53:35.346928 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
15:53:35.347091 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end

15:53:35.533305 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:53:35.543099 [debug] [Thread-2  ]: finished collecting timing info
15:53:35.543559 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Version_Incr: Close
15:53:35.544364 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377603e580>]}
15:53:35.544915 [info ] [Thread-2  ]: 100 of 101 OK snapshotted stg.AH_Version_Incr................................... [[32mOK[0m in 17.56s]
15:53:35.545359 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Version_Incr
15:53:36.800876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 27.31 seconds
15:53:36.804287 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:36.804533 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:37.011350 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:53:37.013175 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:37.013360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
15:53:37.633140 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 18.98 seconds
15:53:37.636505 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:37.636722 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:37.735280 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:53:37.737058 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:37.737252 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
15:53:38.601944 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
15:53:38.603627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:38.603822 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:38.674267 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:38.677027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:38.677238 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:38.895324 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:53:38.899497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:38.899824 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
15:53:38.992863 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:53:38.997017 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:38.997271 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:39.037401 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:39.039101 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:39.039415 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
15:53:39.041369 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
15:53:39.042688 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:39.042933 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:39.260409 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:53:39.263173 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:39.263447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:39.672227 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
15:53:39.675432 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:39.675641 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
15:53:39.756593 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:39.760481 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:39.760663 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:39.816550 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:39.817970 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:39.818155 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
15:53:40.528296 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
15:53:40.529953 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:40.530146 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:40.602073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:53:40.604894 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:40.605133 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:40.809595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:53:40.812783 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:40.813005 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
15:53:40.897057 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:40.901304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:40.901565 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:40.960927 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
15:53:40.962402 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:40.962609 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
15:53:41.333717 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
15:53:41.335431 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:41.335640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:41.422515 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:53:41.424880 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:41.425067 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:41.642850 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:53:41.645987 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:41.646191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
15:53:41.722253 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:53:41.726421 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:41.727114 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:41.769680 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:41.771574 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:41.771880 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
15:53:41.978624 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
15:53:41.980245 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:41.980449 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:42.016741 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:42.019666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:42.019972 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:42.366126 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:53:42.368376 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userproperties_Incr"
15:53:42.368806 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:42.368940 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr" (
                  "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:42.965108 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
15:53:42.966815 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:42.967366 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:53:43.008624 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:53:43.011274 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:43.011472 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:53:43.212848 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:53:43.215073 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Watches_Incr"
15:53:43.215526 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:43.215671 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Watches_Incr" (
                  "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:53:44.293951 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
15:53:44.295691 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Userproperties_Incr: COMMIT
15:53:44.296432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
15:53:44.296564 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end

15:53:44.350193 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:53:44.360955 [debug] [Thread-1  ]: finished collecting timing info
15:53:44.361339 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Userproperties_Incr: Close
15:53:44.362081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3775fc58b0>]}
15:53:44.362646 [info ] [Thread-1  ]: 98 of 101 OK snapshotted stg.AH_Userproperties_Incr............................. [[32mOK[0m in 35.56s]
15:53:44.363087 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Userproperties_Incr
15:53:45.063568 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.85 seconds
15:53:45.065190 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Watches_Incr: COMMIT
15:53:45.066012 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
15:53:45.066160 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end

15:53:45.169179 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:53:45.178820 [debug] [Thread-3  ]: finished collecting timing info
15:53:45.179245 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Watches_Incr: Close
15:53:45.180010 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f377417c910>]}
15:53:45.180546 [info ] [Thread-3  ]: 101 of 101 OK snapshotted stg.AH_Watches_Incr................................... [[32mOK[0m in 27.12s]
15:53:45.180966 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Watches_Incr
15:54:11.933257 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 53.61 seconds
15:54:11.936643 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:11.936863 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:54:11.980071 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:11.982002 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:11.982303 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
15:54:13.295260 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
15:54:13.296932 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:13.297156 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:54:13.408768 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:54:13.412071 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:13.412301 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:54:13.690272 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:54:13.693624 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:13.693852 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
15:54:13.768810 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:54:13.773866 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:13.774121 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:54:13.814930 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:13.816855 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:13.817207 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
15:54:15.153425 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
15:54:15.154967 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:15.155148 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:54:15.229920 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:54:15.232868 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:15.233063 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:54:15.465322 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:54:15.468525 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:15.468738 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
15:54:15.542992 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:54:15.549632 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:15.549991 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:54:15.591339 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:15.593054 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:15.593364 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
15:54:16.752968 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
15:54:16.754677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:16.754872 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
15:54:16.832124 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:54:16.835122 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:16.835363 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

15:54:17.044258 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:54:17.047037 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Users_Incr"
15:54:17.047460 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:17.047600 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Users_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Users_Incr" (
                  "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
15:54:18.489080 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
15:54:18.490882 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Users_Incr: COMMIT
15:54:18.492016 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
15:54:18.492182 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end

15:54:18.531555 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:18.541215 [debug] [Thread-4  ]: finished collecting timing info
15:54:18.541693 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Users_Incr: Close
15:54:18.542591 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c9f1217-2476-4c86-99fa-8da9670fcab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37745c9fd0>]}
15:54:18.543159 [info ] [Thread-4  ]: 99 of 101 OK snapshotted stg.AH_Users_Incr...................................... [[32mOK[0m in 61.87s]
15:54:18.543602 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Users_Incr
15:54:18.545668 [debug] [MainThread]: Acquiring new synapse connection "master"
15:54:18.546012 [debug] [MainThread]: On master: COMMIT
15:54:18.546500 [info ] [MainThread]: 
15:54:18.546856 [info ] [MainThread]: Finished running 101 snapshots in 672.02s.
15:54:18.547116 [debug] [MainThread]: Connection 'master' was properly closed.
15:54:18.547261 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Version_Incr' was properly closed.
15:54:18.547401 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Watches_Incr' was properly closed.
15:54:18.547540 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Userproperties_Incr' was properly closed.
15:54:18.547672 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Users_Incr' was properly closed.
15:54:18.581145 [info ] [MainThread]: 
15:54:18.581606 [info ] [MainThread]: [32mCompleted successfully[0m
15:54:18.582081 [info ] [MainThread]: 
15:54:18.582330 [info ] [MainThread]: Done. PASS=101 WARN=0 ERROR=0 SKIP=0 TOTAL=101
15:54:18.582731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774691160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774691100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3774691340>]}


============================== 2022-09-16 15:54:21.074967 | 90326ebe-6fc2-4c62-a774-482a180197b9 ==============================
15:54:21.074967 [info ] [MainThread]: Running with dbt=1.0.0
15:54:21.075688 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step5_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:54:21.075982 [debug] [MainThread]: Tracking: tracking
15:54:21.076364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf020dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf020e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf020e80>]}
15:54:21.285549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:54:21.286015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:54:21.312738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acef4ac70>]}
15:54:21.363426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ace97fac0>]}
15:54:21.364064 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:54:21.372863 [info ] [MainThread]: 
15:54:21.373729 [debug] [MainThread]: Acquiring new synapse connection "master"
15:54:21.375141 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:54:21.384682 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:54:21.385103 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:54:21.385298 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:21.385493 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:21.691218 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:21.724696 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:54:21.726809 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:54:21.748946 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:54:21.755203 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:54:21.755649 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:54:21.757763 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:54:21.758011 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:54:21.758177 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:21.758353 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:21.756125 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:54:21.760023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:54:21.760254 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:21.761813 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:54:21.763542 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:54:21.763761 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:54:21.763918 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:21.764085 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:21.878799 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:21.879603 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:21.880012 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:21.942744 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:54:21.965925 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:54:21.966354 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:54:21.969639 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:54:21.970369 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:54:21.970207 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:54:21.971863 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:54:22.088059 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:54:22.088843 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:54:31.405053 [debug] [MainThread]: On master: COMMIT
15:54:31.405837 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:54:31.406244 [info ] [MainThread]: 
15:54:31.410130 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Buyers_DM
15:54:31.410963 [info ] [Thread-1  ]: 1 of 5 START table model dbo_dbo.AH_Buyers_DM................................... [RUN]
15:54:31.411575 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Buyers_DM"
15:54:31.410644 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Currencies_DM
15:54:31.412084 [info ] [Thread-4  ]: 4 of 5 START table model dbo_dbo.AH_Currencies_DM............................... [RUN]
15:54:31.412574 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies_DM"
15:54:31.412757 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Currencies_DM
15:54:31.410521 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Consignors_DM
15:54:31.413422 [info ] [Thread-3  ]: 3 of 5 START table model dbo_dbo.AH_Consignors_DM............................... [RUN]
15:54:31.413879 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Consignors_DM"
15:54:31.414059 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Consignors_DM
15:54:31.414224 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Consignors_DM
15:54:31.410415 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Categories_DM
15:54:31.417949 [info ] [Thread-2  ]: 2 of 5 START table model dbo_dbo.AH_Categories_DM............................... [RUN]
15:54:31.418444 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Categories_DM"
15:54:31.418666 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Categories_DM
15:54:31.418839 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Categories_DM
15:54:31.412942 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Currencies_DM
15:54:31.424214 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Currencies_DM"
15:54:31.417564 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Consignors_DM"
15:54:31.411801 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Buyers_DM
15:54:31.424856 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Buyers_DM
15:54:31.428551 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Buyers_DM"
15:54:31.429048 [debug] [Thread-3  ]: finished collecting timing info
15:54:31.429684 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Consignors_DM
15:54:31.429400 [debug] [Thread-4  ]: finished collecting timing info
15:54:31.436123 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Currencies_DM
15:54:31.421562 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Categories_DM"
15:54:31.436433 [debug] [Thread-1  ]: finished collecting timing info
15:54:31.479872 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Buyers_DM
15:54:31.498056 [debug] [Thread-2  ]: finished collecting timing info
15:54:31.510321 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Categories_DM
15:54:31.504328 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies_DM"
15:54:31.509828 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Consignors_DM"
15:54:31.516912 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Buyers_DM"
15:54:31.525909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
15:54:31.526761 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
  
  if object_id ('"dbo_dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Buyers_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Buyers_DM__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Buyers_DM__dbt_tmp_temp_view as
    

with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
), part1 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID not in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
),
part2 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(UserID) from [stg].[AH_ListingActions_FinalView]
        union
        select distinct(UserID) from [stg].[AH_Watches_FinalView]
        union
        select distinct(UserID) from [stg].[AH_ListingComments_FinalView]
    )
)

select
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part1 
union all 
select 
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part2
    ');

  CREATE TABLE "dbo_dbo"."AH_Buyers_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Buyers_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end



15:54:31.526967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:54:31.527164 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:31.526618 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
15:54:31.528500 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
  
  if object_id ('"dbo_dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Currencies_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Currencies_DM__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Currencies_DM__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [CurrencyId],
	[ConversionToUSD],
	[Code],
	[LastUpdatedUser],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_Currencies_FinalView];
    ');

  CREATE TABLE "dbo_dbo"."AH_Currencies_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Currencies_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end



15:54:31.528715 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:54:31.528905 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:31.526276 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
15:54:31.529864 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
  
  if object_id ('"dbo_dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Consignors_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Consignors_DM__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Consignors_DM__dbt_tmp_temp_view as
    
with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
),
DMstg as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) as [Consignor_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
)
SELECT
	[Consignor_SKey],
    [UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMstg
    ');

  CREATE TABLE "dbo_dbo"."AH_Consignors_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Consignors_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end



15:54:31.530078 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:54:31.530261 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:31.524818 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Categories_DM"
15:54:31.532225 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
15:54:31.532424 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
  
  if object_id ('"dbo_dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Categories_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Categories_DM__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Categories_DM__dbt_tmp_temp_view as
    
SELECT
	Id,
	Name,
	ParentCategoryId,
	DisplayOrder,
	LastUpdatedUser,
	Type,
	MVCAction,
	RolesAllowed,
	EnabledCustomProperty,
	lft,
	rgt,
	CreatedOn,
	UpdatedOn,
	DeletedOn
FROM stg.AH_Categories_FinalView;
    ');

  CREATE TABLE "dbo_dbo"."AH_Categories_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Categories_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end



15:54:31.532594 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:54:31.532772 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:31.648140 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:31.648666 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:31.661324 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:31.662031 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:34.089189 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.56 seconds
15:54:34.105330 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
15:54:34.105714 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo_dbo"."AH_Currencies_DM" to AH_Currencies_DM__dbt_backup
15:54:34.617568 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.51 seconds
15:54:34.628873 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
15:54:34.629282 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo_dbo"."AH_Currencies_DM__dbt_tmp" to AH_Currencies_DM
15:54:34.660361 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:54:34.671524 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: COMMIT
15:54:34.677816 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
15:54:34.678227 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
    
  if object_id ('"dbo_dbo"."AH_Currencies_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Currencies_DM__dbt_backup"
    end

15:54:35.009267 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.48 seconds
15:54:35.021529 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
15:54:35.021952 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo_dbo"."AH_Categories_DM" to AH_Categories_DM__dbt_backup
15:54:35.069003 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:54:35.080860 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
15:54:35.081278 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo_dbo"."AH_Categories_DM__dbt_tmp" to AH_Categories_DM
15:54:35.113790 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:54:35.115845 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: COMMIT
15:54:35.119726 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
15:54:35.119913 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
15:54:35.120146 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
    
  if object_id ('"dbo_dbo"."AH_Categories_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Categories_DM__dbt_backup"
    end

15:54:35.129410 [debug] [Thread-4  ]: finished collecting timing info
15:54:35.130149 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: Close
15:54:35.130973 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc497370>]}
15:54:35.131476 [info ] [Thread-4  ]: 4 of 5 OK created table model dbo_dbo.AH_Currencies_DM.......................... [[32mOK[0m in 3.72s]
15:54:35.131908 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Currencies_DM
15:54:35.132138 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ShippingOptions_DM
15:54:35.132532 [info ] [Thread-4  ]: 5 of 5 START table model dbo_dbo.AH_ShippingOptions_DM.......................... [RUN]
15:54:35.133016 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions_DM"
15:54:35.133205 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ShippingOptions_DM
15:54:35.133377 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ShippingOptions_DM
15:54:35.136109 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions_DM"
15:54:35.136652 [debug] [Thread-4  ]: finished collecting timing info
15:54:35.136838 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ShippingOptions_DM
15:54:35.145552 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions_DM"
15:54:35.146267 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
15:54:35.146495 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
  
  if object_id ('"dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view as
    
SELECT
	so.[Id] AS [ShippingOptionID],
	so.[ShippingMethodId] AS [ShippingMethodID],
	sm.[Name] AS [ShippingMethod],
	so.[FirstItemAmount],
	so.[ListingId] AS [ListingID],
	so.[AdditionalItemAmount],
	so.[CreatedOn] AS [CreatedDate],
	so.[UpdatedOn] AS [UpdatedDate],
	so.[DeletedOn] AS [DeletedDate]
From
	[stg].[AH_ShippingOptions_FinalView] AS so
left JOIN [stg].[AH_ShippingMethods_FinalView] AS sm 
on so.ShippingMethodID=sm.ID
    ');

  CREATE TABLE "dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end



15:54:35.146693 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:54:35.146876 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:35.265843 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:35.378501 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
15:54:35.389053 [debug] [Thread-2  ]: finished collecting timing info
15:54:35.389570 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: Close
15:54:35.390409 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc520670>]}
15:54:35.391005 [info ] [Thread-2  ]: 2 of 5 OK created table model dbo_dbo.AH_Categories_DM.......................... [[32mOK[0m in 3.97s]
15:54:35.391446 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Categories_DM
15:54:38.272625 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.13 seconds
15:54:38.284597 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
15:54:38.285010 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo_dbo"."AH_ShippingOptions_DM" to AH_ShippingOptions_DM__dbt_backup
15:54:38.689191 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
15:54:38.700677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
15:54:38.701097 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo_dbo"."AH_ShippingOptions_DM__dbt_tmp" to AH_ShippingOptions_DM
15:54:38.739565 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:38.741627 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions_DM: COMMIT
15:54:38.745468 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
15:54:38.745795 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
    
  if object_id ('"dbo_dbo"."AH_ShippingOptions_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ShippingOptions_DM__dbt_backup"
    end

15:54:38.768516 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.24 seconds
15:54:38.780508 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
15:54:38.780930 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo_dbo"."AH_Consignors_DM" to AH_Consignors_DM__dbt_backup
15:54:38.820215 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:38.832053 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
15:54:38.832477 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo_dbo"."AH_Consignors_DM__dbt_tmp" to AH_Consignors_DM
15:54:38.898458 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:54:38.900405 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: COMMIT
15:54:38.904011 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
15:54:38.904333 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
    
  if object_id ('"dbo_dbo"."AH_Consignors_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Consignors_DM__dbt_backup"
    end

15:54:38.978891 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:54:38.990534 [debug] [Thread-4  ]: finished collecting timing info
15:54:38.991045 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions_DM: Close
15:54:38.991834 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc417580>]}
15:54:38.992352 [info ] [Thread-4  ]: 5 of 5 OK created table model dbo_dbo.AH_ShippingOptions_DM..................... [[32mOK[0m in 3.86s]
15:54:38.992775 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ShippingOptions_DM
15:54:39.178398 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:54:39.189106 [debug] [Thread-3  ]: finished collecting timing info
15:54:39.189581 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: Close
15:54:39.190348 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc484f40>]}
15:54:39.190903 [info ] [Thread-3  ]: 3 of 5 OK created table model dbo_dbo.AH_Consignors_DM.......................... [[32mOK[0m in 7.78s]
15:54:39.191337 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Consignors_DM
15:54:44.007063 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 12.48 seconds
15:54:44.020035 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
15:54:44.020495 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo_dbo"."AH_Buyers_DM" to AH_Buyers_DM__dbt_backup
15:54:44.057970 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:54:44.070104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
15:54:44.070533 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo_dbo"."AH_Buyers_DM__dbt_tmp" to AH_Buyers_DM
15:54:44.100700 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:54:44.103719 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: COMMIT
15:54:44.107729 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
15:54:44.108048 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
    
  if object_id ('"dbo_dbo"."AH_Buyers_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Buyers_DM__dbt_backup"
    end

15:54:44.311611 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:54:44.321507 [debug] [Thread-1  ]: finished collecting timing info
15:54:44.321956 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: Close
15:54:44.322798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90326ebe-6fc2-4c62-a774-482a180197b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acc44b430>]}
15:54:44.323319 [info ] [Thread-1  ]: 1 of 5 OK created table model dbo_dbo.AH_Buyers_DM.............................. [[32mOK[0m in 12.91s]
15:54:44.323741 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Buyers_DM
15:54:44.325247 [debug] [MainThread]: Acquiring new synapse connection "master"
15:54:44.325583 [debug] [MainThread]: On master: COMMIT
15:54:44.325996 [info ] [MainThread]: 
15:54:44.326308 [info ] [MainThread]: Finished running 5 table models in 22.95s.
15:54:44.326584 [debug] [MainThread]: Connection 'master' was properly closed.
15:54:44.326741 [debug] [MainThread]: Connection 'model.Shawn.AH_Buyers_DM' was properly closed.
15:54:44.326882 [debug] [MainThread]: Connection 'model.Shawn.AH_Consignors_DM' was properly closed.
15:54:44.327012 [debug] [MainThread]: Connection 'model.Shawn.AH_Categories_DM' was properly closed.
15:54:44.327137 [debug] [MainThread]: Connection 'model.Shawn.AH_ShippingOptions_DM' was properly closed.
15:54:44.357506 [info ] [MainThread]: 
15:54:44.357996 [info ] [MainThread]: [32mCompleted successfully[0m
15:54:44.358371 [info ] [MainThread]: 
15:54:44.358658 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
15:54:44.359032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ace7a8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aced25280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad102fc40>]}


============================== 2022-09-16 15:54:46.644226 | 5f32e753-e555-45c8-ae76-e119a509d804 ==============================
15:54:46.644226 [info ] [MainThread]: Running with dbt=1.0.0
15:54:46.650974 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_1_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:54:46.651334 [debug] [MainThread]: Tracking: tracking
15:54:46.651744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ab220dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ab220e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ab220e80>]}
15:54:46.855762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:54:46.856216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:54:46.883175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ab148c70>]}
15:54:46.931563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5aab7dac0>]}
15:54:46.932169 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:54:46.940544 [info ] [MainThread]: 
15:54:46.941394 [debug] [MainThread]: Acquiring new synapse connection "master"
15:54:46.942851 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:54:46.952164 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:54:46.952524 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:54:46.952709 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:46.952896 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:47.257313 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:47.288563 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:54:47.290324 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:54:47.311999 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:54:47.318007 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:54:47.318624 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:54:47.320890 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:54:47.321120 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:54:47.321277 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:47.321443 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:47.319076 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:54:47.324112 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:54:47.324655 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:54:47.324861 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:54:47.325055 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:47.319318 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:54:47.326036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:54:47.326231 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:47.432557 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:47.441304 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:47.441825 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:47.496584 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:54:47.498740 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:54:47.499094 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:54:47.511833 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:54:47.536979 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:54:47.539238 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:54:47.539552 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:54:47.652547 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:54:47.653052 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:54:57.058148 [debug] [MainThread]: On master: COMMIT
15:54:57.058957 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:54:57.059374 [info ] [MainThread]: 
15:54:57.063202 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_stg
15:54:57.063924 [info ] [Thread-1  ]: 1 of 6 START table model dbo_stg.AH_Invoices_FT_stg............................. [RUN]
15:54:57.064495 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_stg"
15:54:57.064706 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_stg
15:54:57.063460 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_stg
15:54:57.065181 [info ] [Thread-2  ]: 2 of 6 START table model dbo_stg.AH_LineItems_FT_stg............................ [RUN]
15:54:57.065735 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_stg"
15:54:57.065942 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_stg
15:54:57.066104 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_stg
15:54:57.063559 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_stg
15:54:57.069442 [info ] [Thread-3  ]: 3 of 6 START table model dbo_stg.AH_ListingActions_FT_stg....................... [RUN]
15:54:57.069901 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_stg"
15:54:57.070086 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_stg
15:54:57.070241 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_stg
15:54:57.063642 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_stg
15:54:57.073205 [info ] [Thread-4  ]: 4 of 6 START table model dbo_stg.AH_ListingPaymentCharge_FT_stg................. [RUN]
15:54:57.073700 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg"
15:54:57.073890 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_stg
15:54:57.074061 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_stg
15:54:57.076555 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
15:54:57.064906 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_stg
15:54:57.079234 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_stg"
15:54:57.072881 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_stg"
15:54:57.069109 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_stg"
15:54:57.080195 [debug] [Thread-2  ]: finished collecting timing info
15:54:57.080404 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_stg
15:54:57.086489 [debug] [Thread-1  ]: finished collecting timing info
15:54:57.087171 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_stg
15:54:57.087037 [debug] [Thread-4  ]: finished collecting timing info
15:54:57.113963 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_stg
15:54:57.086843 [debug] [Thread-3  ]: finished collecting timing info
15:54:57.116151 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_stg
15:54:57.158402 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_stg"
15:54:57.164366 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
15:54:57.171450 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
15:54:57.171688 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingPaymentChargeID],
		[BuyerId],
		[ListingId] AS [ListingID],
		[ChargeAmount],
		[TotalBid],
		[BidHoldPercentage],
		[MaximumBidCharge],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM stg.AH_ListingPaymentCharge_FinalView;
    ');

  CREATE TABLE "dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end



15:54:57.172198 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:54:57.172392 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:57.172066 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
15:54:57.173751 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_Invoices_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_Invoices_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Invoices_FT_stg__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [InvoiceID],
	[PayerId] AS [PayerID],
	[OwnerId] AS [OwnerID],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comments] AS [Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingStateRegion] AS [ShippingState],
	[ShippingZipPostal] AS [ShippingPostalCode],
	[ShippingCountry],
	[BIllingFIrstName] AS [BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingStateRegion] AS [BillingState],
	[BillingZIpPostal] AS [BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[Shipped] AS [HasShipped],
	[ShippingDetails],
	[BuyersPremiumPercent] AS [BuyerPremiumPct],
	[BuyersPremiumAmount] AS [BuyerPremiumAmount],
	[IsArchived]
FROM [stg].[AH_Invoices_FinalView];
    ');

  CREATE TABLE "dbo_stg"."AH_Invoices_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Invoices_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end



15:54:57.173975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:54:57.174167 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:57.162451 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_stg"
15:54:57.174963 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
15:54:57.175567 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingActionID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[ActionDTTM],
		[Description],
		[LastUpdatedUser],
		[Amount],
		[ProxyAmount],
		[Quantity] AS [QTY],
		[Reason],
		[Status],
		[UserEntered] AS [HasUserEntered],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_ListingActions_FinalView];
    ');

  CREATE TABLE "dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end



15:54:57.175955 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:54:57.176263 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:57.170427 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_stg"
15:54:57.177325 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
15:54:57.177601 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_LineItems_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_LineItems_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_LineItems_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [LineItemsID],
		[OwnerId] AS [OwnerID],
		[PayerId] AS [PayerID],
		[InvoiceId] AS [InvoiceID],
		[ListingId] AS [ListingID],
		[Description],
		[LastUpdatedUser],
		[Currency],
		[Status],
		[Type],
		[TotalAmount],
		[Quantity] AS [QTY],
		[PerUnitAmount],
		[Taxable] AS [IsTaxable],
		[IsArchived],
		[Relistiteration],
		[BuyersPremiumApplies] AS [HasBuyerPremiumApplies],
		[IsPayerArchived],
		[DateStamp],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_LineItems_FinalView];
    ');

  CREATE TABLE "dbo_stg"."AH_LineItems_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_LineItems_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end



15:54:57.177790 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:54:57.177962 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:54:57.325742 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:57.326287 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:57.335862 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:54:57.339067 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:00.465605 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.29 seconds
15:55:00.481877 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
15:55:00.482251 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "dbo_stg"."AH_ListingPaymentCharge_FT_stg" to AH_ListingPaymentCharge_FT_stg__dbt_backup
15:55:00.485563 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.31 seconds
15:55:00.495306 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
15:55:00.495612 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "dbo_stg"."AH_LineItems_FT_stg" to AH_LineItems_FT_stg__dbt_backup
15:55:00.554719 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:55:00.563734 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:55:00.566436 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
15:55:00.575740 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp" to AH_ListingPaymentCharge_FT_stg
15:55:00.575403 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
15:55:00.576117 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "dbo_stg"."AH_LineItems_FT_stg__dbt_tmp" to AH_LineItems_FT_stg
15:55:00.606451 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:00.615708 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:00.620194 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: COMMIT
15:55:00.622136 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: COMMIT
15:55:00.631279 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
15:55:00.631495 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"
    end

15:55:00.628354 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
15:55:00.631867 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_LineItems_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_LineItems_FT_stg__dbt_backup"
    end

15:55:00.844907 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.67 seconds
15:55:00.856524 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
15:55:00.856907 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "dbo_stg"."AH_Invoices_FT_stg" to AH_Invoices_FT_stg__dbt_backup
15:55:00.860943 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:55:00.869257 [debug] [Thread-4  ]: finished collecting timing info
15:55:00.869557 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: Close
15:55:00.870263 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a8691f10>]}
15:55:00.870784 [info ] [Thread-4  ]: 4 of 6 OK created table model dbo_stg.AH_ListingPaymentCharge_FT_stg............ [[32mOK[0m in 3.80s]
15:55:00.871212 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_stg
15:55:00.871437 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_stg
15:55:00.871816 [info ] [Thread-4  ]: 5 of 6 START table model dbo_stg.AH_SubmittedListingPayment_FT_stg.............. [RUN]
15:55:00.872283 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg"
15:55:00.872472 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_stg
15:55:00.872644 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_stg
15:55:00.875146 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
15:55:00.875670 [debug] [Thread-4  ]: finished collecting timing info
15:55:00.875861 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_stg
15:55:00.884453 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
15:55:00.885006 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
15:55:00.885203 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [SubmittedListingPaymentID],
		[ConsignorId] AS [UserID],
		[ListingId] AS [ListingID],
		[Amount],
		[HasProPhotography],
		[HasProMarketing],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM [stg].[AH_SubmittedListingPayment_FinalView];
    ');

  CREATE TABLE "dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end



15:55:00.885366 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:55:00.885703 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:00.886949 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:00.895865 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
15:55:00.896252 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "dbo_stg"."AH_Invoices_FT_stg__dbt_tmp" to AH_Invoices_FT_stg
15:55:00.924226 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:00.926238 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: COMMIT
15:55:00.929879 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
15:55:00.930129 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_Invoices_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_Invoices_FT_stg__dbt_backup"
    end

15:55:00.981792 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:01.187282 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.56 seconds
15:55:01.197721 [debug] [Thread-2  ]: finished collecting timing info
15:55:01.198165 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: Close
15:55:01.198920 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a86e3340>]}
15:55:01.199434 [info ] [Thread-2  ]: 2 of 6 OK created table model dbo_stg.AH_LineItems_FT_stg....................... [[32mOK[0m in 4.13s]
15:55:01.199860 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_stg
15:55:01.200083 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Watches_FT_stg
15:55:01.200470 [info ] [Thread-2  ]: 6 of 6 START table model dbo_stg.AH_Watches_FT_stg.............................. [RUN]
15:55:01.200948 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_stg"
15:55:01.201136 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Watches_FT_stg
15:55:01.201307 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Watches_FT_stg
15:55:01.203892 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_stg"
15:55:01.204382 [debug] [Thread-2  ]: finished collecting timing info
15:55:01.204575 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Watches_FT_stg
15:55:01.213339 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_stg"
15:55:01.213953 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
15:55:01.214154 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_Watches_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_Watches_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Watches_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [WatchID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[LastUpdatedUser],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
From [stg].[AH_Watches_FinalView]
    ');

  CREATE TABLE "dbo_stg"."AH_Watches_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Watches_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end



15:55:01.214310 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:55:01.214497 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:01.235542 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:55:01.249017 [debug] [Thread-1  ]: finished collecting timing info
15:55:01.249551 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: Close
15:55:01.250330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a86c5100>]}
15:55:01.250872 [info ] [Thread-1  ]: 1 of 6 OK created table model dbo_stg.AH_Invoices_FT_stg........................ [[32mOK[0m in 4.19s]
15:55:01.251295 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_stg
15:55:01.316293 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:03.050037 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.16 seconds
15:55:03.061112 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
15:55:03.061524 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "dbo_stg"."AH_SubmittedListingPayment_FT_stg" to AH_SubmittedListingPayment_FT_stg__dbt_backup
15:55:03.098929 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:03.109569 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
15:55:03.109969 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp" to AH_SubmittedListingPayment_FT_stg
15:55:03.140048 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:03.141768 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: COMMIT
15:55:03.145350 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
15:55:03.145527 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"
    end

15:55:03.871948 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.73 seconds
15:55:03.882669 [debug] [Thread-4  ]: finished collecting timing info
15:55:03.883157 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: Close
15:55:03.883968 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a85c71c0>]}
15:55:03.884520 [info ] [Thread-4  ]: 5 of 6 OK created table model dbo_stg.AH_SubmittedListingPayment_FT_stg......... [[32mOK[0m in 3.01s]
15:55:03.884957 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_stg
15:55:04.369353 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.19 seconds
15:55:04.380258 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
15:55:04.380610 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "dbo_stg"."AH_ListingActions_FT_stg" to AH_ListingActions_FT_stg__dbt_backup
15:55:04.414688 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:04.425812 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
15:55:04.426213 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "dbo_stg"."AH_ListingActions_FT_stg__dbt_tmp" to AH_ListingActions_FT_stg
15:55:04.454793 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:04.456801 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: COMMIT
15:55:04.460608 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
15:55:04.460915 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_ListingActions_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingActions_FT_stg__dbt_backup"
    end

15:55:04.782480 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:55:04.792566 [debug] [Thread-3  ]: finished collecting timing info
15:55:04.793004 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: Close
15:55:04.793760 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a869a670>]}
15:55:04.794277 [info ] [Thread-3  ]: 3 of 6 OK created table model dbo_stg.AH_ListingActions_FT_stg.................. [[32mOK[0m in 7.72s]
15:55:04.794724 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_stg
15:55:05.484704 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.27 seconds
15:55:05.496916 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
15:55:05.497282 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "dbo_stg"."AH_Watches_FT_stg" to AH_Watches_FT_stg__dbt_backup
15:55:05.541418 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:05.551909 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
15:55:05.552289 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "dbo_stg"."AH_Watches_FT_stg__dbt_tmp" to AH_Watches_FT_stg
15:55:06.175388 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
15:55:06.177198 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_stg: COMMIT
15:55:06.180877 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
15:55:06.181226 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_Watches_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_Watches_FT_stg__dbt_backup"
    end

15:55:06.406359 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:55:06.416851 [debug] [Thread-2  ]: finished collecting timing info
15:55:06.417344 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_stg: Close
15:55:06.418208 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f32e753-e555-45c8-ae76-e119a509d804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a869a6a0>]}
15:55:06.418798 [info ] [Thread-2  ]: 6 of 6 OK created table model dbo_stg.AH_Watches_FT_stg......................... [[32mOK[0m in 5.22s]
15:55:06.419246 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Watches_FT_stg
15:55:06.420886 [debug] [MainThread]: Acquiring new synapse connection "master"
15:55:06.421246 [debug] [MainThread]: On master: COMMIT
15:55:06.421711 [info ] [MainThread]: 
15:55:06.422029 [info ] [MainThread]: Finished running 6 table models in 19.48s.
15:55:06.422286 [debug] [MainThread]: Connection 'master' was properly closed.
15:55:06.422431 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_stg' was properly closed.
15:55:06.422617 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT_stg' was properly closed.
15:55:06.422763 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoices_FT_stg' was properly closed.
15:55:06.422894 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_stg' was properly closed.
15:55:06.531196 [info ] [MainThread]: 
15:55:06.531674 [info ] [MainThread]: [32mCompleted successfully[0m
15:55:06.532031 [info ] [MainThread]: 
15:55:06.532270 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
15:55:06.532634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ab168400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ad1dc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a85e6970>]}


============================== 2022-09-16 15:55:08.917915 | 494468bb-90ad-48b9-b348-e298fdcd8f97 ==============================
15:55:08.917915 [info ] [MainThread]: Running with dbt=1.0.0
15:55:08.923212 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_2_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:55:08.923513 [debug] [MainThread]: Tracking: tracking
15:55:08.923919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c9d6bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c9d6bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c9d6be20>]}
15:55:09.144608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:55:09.145077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:55:09.171906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c9c91c10>]}
15:55:09.221820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c96c6af0>]}
15:55:09.222415 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:55:09.230729 [info ] [MainThread]: 
15:55:09.231455 [debug] [MainThread]: Acquiring new synapse connection "master"
15:55:09.232805 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:55:09.241910 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:55:09.242272 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:55:09.242450 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:55:09.242666 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:10.210420 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:10.244270 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 1.00 seconds
15:55:10.246020 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:55:10.269230 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:55:10.276238 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:55:10.276720 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:55:10.279056 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:55:10.279353 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:55:10.279520 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:55:10.279701 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:10.277264 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:55:10.281109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:55:10.281642 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:10.283945 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:55:10.286348 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:55:10.286624 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:55:10.286796 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:55:10.286972 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:10.383981 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:10.384515 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:10.387363 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:10.448700 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:55:10.450913 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:55:10.451140 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:55:10.451946 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:55:10.453158 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:55:10.455118 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:55:10.455348 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:55:10.598183 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:55:10.598715 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:55:20.097107 [debug] [MainThread]: On master: COMMIT
15:55:20.097932 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:55:20.098370 [info ] [MainThread]: 
15:55:20.101695 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_tmp
15:55:20.102435 [info ] [Thread-1  ]: 1 of 6 START table model dbo_stg.AH_Invoices_FT_tmp............................. [RUN]
15:55:20.102060 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_tmp
15:55:20.104095 [info ] [Thread-3  ]: 3 of 6 START table model dbo_stg.AH_ListingActions_FT_tmp....................... [RUN]
15:55:20.101958 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_tmp
15:55:20.105256 [info ] [Thread-2  ]: 2 of 6 START table model dbo_stg.AH_LineItems_FT_tmp............................ [RUN]
15:55:20.105958 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_tmp"
15:55:20.106169 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_tmp
15:55:20.106360 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_tmp
15:55:20.102145 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
15:55:20.109837 [info ] [Thread-4  ]: 4 of 6 START table model dbo_stg.AH_ListingPaymentCharge_FT_tmp................. [RUN]
15:55:20.110332 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
15:55:20.104943 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_tmp"
15:55:20.110734 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_tmp
15:55:20.110911 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_tmp
15:55:20.103739 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_tmp"
15:55:20.114029 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_tmp
15:55:20.114210 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_tmp
15:55:20.110523 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_tmp
15:55:20.118731 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_tmp
15:55:20.121251 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
15:55:20.113780 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
15:55:20.109464 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_tmp"
15:55:20.122098 [debug] [Thread-2  ]: finished collecting timing info
15:55:20.122407 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_tmp
15:55:20.122267 [debug] [Thread-3  ]: finished collecting timing info
15:55:20.132108 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_tmp
15:55:20.118419 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_tmp"
15:55:20.132406 [debug] [Thread-4  ]: finished collecting timing info
15:55:20.156314 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_tmp
15:55:20.173974 [debug] [Thread-1  ]: finished collecting timing info
15:55:20.206718 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_tmp
15:55:20.201761 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
15:55:20.199040 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_tmp"
15:55:20.206365 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
15:55:20.216673 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
15:55:20.217430 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		lpc.[ListingPaymentChargeID],
		b.[Buyer_Skey],
		lpc.[BuyerId],
		lpc.[ListingID],
		lpc.[ChargeAmount],
		lpc.[TotalBid],
		lpc.[BidHoldPercentage],
		lpc.[MaximumBidCharge],
		lpc.[TransactionID],
		lpc.[CreatedDate],
		lpc.[UpdatedDate]
FROM 	[stg].[AH_ListingPaymentCharge_FT_stg] lpc
left join [dbo].[AH_Buyers_DM] b on lpc.BuyerId=b.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end



15:55:20.217599 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:55:20.218015 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:20.217280 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
15:55:20.218689 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		la.[ListingActionID],
		b.[Buyer_Skey],
		la.[UserID],
		la.[ListingID],
		la.[ActionDTTM],
		la.[Description],
		la.[LastUpdatedUser],
		la.[Amount],
		la.[ProxyAmount],
		la.[QTY],
		la.[Reason],
		la.[Status],
		la.[HasUserEntered],
		la.[CreatedDate],
		la.[UpdatedDate],
		la.[DeletedDate]
FROM	[stg].[AH_ListingActions_FT_stg] la
left join [dbo].[AH_Buyers_DM] b on la.UserID=b.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end



15:55:20.218872 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:55:20.219058 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:20.216940 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
15:55:20.219299 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		li.[LineItemsID],
		c.[Consignor_Skey],
		b.[Buyer_Skey],
		li.[OwnerID],
		li.[PayerID],
		li.[InvoiceID],
		li.[ListingID],
		li.[Description],
		li.[LastUpdatedUser],
		li.[Currency],
		li.[Status],
		li.[Type],
		li.[TotalAmount],
		li.[QTY],
		li.[PerUnitAmount],
		li.[IsTaxable],
		li.[IsArchived],
		li.[Relistiteration],
		li.[HasBuyerPremiumApplies],
		li.[IsPayerArchived],
		li.[DateStamp],
		li.[CreatedDate],
		li.[UpdatedDate],
		li.[DeletedDate]
FROM
	[stg].[AH_LineItems_FT_stg] li
left join [dbo].[AH_Buyers_DM] b on li.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on li.OwnerID=c.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end



15:55:20.219462 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:55:20.219624 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:20.222522 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_tmp"
15:55:20.223087 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
15:55:20.223604 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view as
    
SELECT
	i.[InvoiceID],
	
    c.[Consignor_Skey],
    b.[Buyer_Skey],
	
    i.[PayerID],
    i.[OwnerID],
	
    i.[CreatedDate],
    i.[UpdatedDate],
    i.[DeletedDate],
    i.[Status],
    i.[CreatedDTTM],
    i.[FulfilledDTTM],
    i.[Comment],
    i.[LastUpdatedUser],
    i.[Currency],
    i.[Type],
    i.[ShippingAmount],
    i.[Subtotal],
    i.[Total],
	
    i.[ShippingFirstName],
    i.[ShippingLastName],
    i.[ShippingStreet1],
    i.[ShippingStreet2],
    i.[ShippingCity],
    i.[ShippingState],
    i.[ShippingPostalCode],
    i.[ShippingCountry],
	
    i.[BillingFIrstName],
    i.[BillingLastName],
    i.[BillingStreet1],
    i.[BillingStreet2],
    i.[BillingCity],
    i.[BillingState],
    i.[BillingPostalCode],
    i.[BillingCountry],
	
    i.[SalesTax],
    
    i.[PaidDTTM],
    i.[IsPayerLocked],
    i.[HasShipped],
    i.[ShippingDetails],
    i.[BuyerPremiumPct],
    i.[BuyerPremiumAmount],
    i.[IsArchived]
FROM
	[stg].[AH_Invoices_FT_stg] i
left join [dbo].[AH_Buyers_DM] b on i.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on i.OwnerID=c.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end



15:55:20.223787 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:55:20.223962 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:20.329160 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:20.345559 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:20.346182 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:20.347333 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:25.178004 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.96 seconds
15:55:25.194688 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
15:55:25.195093 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "dbo_stg"."AH_ListingPaymentCharge_FT_tmp" to AH_ListingPaymentCharge_FT_tmp__dbt_backup
15:55:25.291977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:55:25.302688 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
15:55:25.303127 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp" to AH_ListingPaymentCharge_FT_tmp
15:55:25.352163 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:55:25.363667 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: COMMIT
15:55:25.370206 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
15:55:25.370610 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"
    end

15:55:25.529819 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.31 seconds
15:55:25.541684 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
15:55:25.542096 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "dbo_stg"."AH_ListingActions_FT_tmp" to AH_ListingActions_FT_tmp__dbt_backup
15:55:25.586182 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:25.597433 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
15:55:25.597850 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "dbo_stg"."AH_ListingActions_FT_tmp__dbt_tmp" to AH_ListingActions_FT_tmp
15:55:25.598972 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:55:25.607796 [debug] [Thread-4  ]: finished collecting timing info
15:55:25.608204 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: Close
15:55:25.608984 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c8236c10>]}
15:55:25.609497 [info ] [Thread-4  ]: 4 of 6 OK created table model dbo_stg.AH_ListingPaymentCharge_FT_tmp............ [[32mOK[0m in 5.50s]
15:55:25.609926 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
15:55:25.610156 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
15:55:25.610572 [info ] [Thread-4  ]: 5 of 6 START table model dbo_stg.AH_SubmittedListingPayment_FT_tmp.............. [RUN]
15:55:25.611064 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
15:55:25.611253 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_tmp
15:55:25.611424 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_tmp
15:55:25.614163 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
15:55:25.614702 [debug] [Thread-4  ]: finished collecting timing info
15:55:25.614899 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_tmp
15:55:25.624014 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
15:55:25.624732 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
15:55:25.624948 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		slp.[SubmittedListingPaymentID],
		c.[Consignor_Skey],
		slp.[UserID],
		slp.[ListingID],
		slp.[Amount],
		slp.[HasProPhotography],
		slp.[HasProMarketing],
		slp.[TransactionID],
		slp.[CreatedDate],
		slp.[UpdatedDate]
FROM
	[stg].[AH_SubmittedListingPayment_FT_stg] slp
left join [dbo].[AH_Consignors_DM] c on slp.UserID=c.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end



15:55:25.625117 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:55:25.625295 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:25.645087 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:55:25.647080 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: COMMIT
15:55:25.650980 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
15:55:25.651295 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_ListingActions_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_ListingActions_FT_tmp__dbt_backup"
    end

15:55:25.735842 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:25.921958 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:55:25.932892 [debug] [Thread-3  ]: finished collecting timing info
15:55:25.933395 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: Close
15:55:25.934220 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c81d4340>]}
15:55:25.934798 [info ] [Thread-3  ]: 3 of 6 OK created table model dbo_stg.AH_ListingActions_FT_tmp.................. [[32mOK[0m in 5.83s]
15:55:25.935239 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_tmp
15:55:25.935463 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Watches_FT_tmp
15:55:25.935850 [info ] [Thread-3  ]: 6 of 6 START table model dbo_stg.AH_Watches_FT_tmp.............................. [RUN]
15:55:25.936348 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_tmp"
15:55:25.936536 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Watches_FT_tmp
15:55:25.936707 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Watches_FT_tmp
15:55:25.939435 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_tmp"
15:55:25.939944 [debug] [Thread-3  ]: finished collecting timing info
15:55:25.940135 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Watches_FT_tmp
15:55:25.949730 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_tmp"
15:55:25.950736 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
15:55:25.950991 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_Watches_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_Watches_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Watches_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		w.[WatchID],
		b.[Buyer_Skey],
		w.[UserID],
		w.[ListingID],
		w.[LastUpdatedUser],
		w.[CreatedDate],
		w.[UpdatedDate],
		w.[DeletedDate]
FROM [stg].[AH_Watches_FT_stg] w
left join [dbo].[AH_Buyers_DM] b on w.UserID=b.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_Watches_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Watches_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end



15:55:25.951167 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:55:25.951352 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:26.069249 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:26.266274 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.05 seconds
15:55:26.278313 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
15:55:26.278797 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "dbo_stg"."AH_LineItems_FT_tmp" to AH_LineItems_FT_tmp__dbt_backup
15:55:26.315858 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:26.327613 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
15:55:26.328063 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "dbo_stg"."AH_LineItems_FT_tmp__dbt_tmp" to AH_LineItems_FT_tmp
15:55:26.376224 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:55:26.378270 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: COMMIT
15:55:26.381819 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
15:55:26.382091 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_LineItems_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_LineItems_FT_tmp__dbt_backup"
    end

15:55:26.642088 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:55:26.652346 [debug] [Thread-2  ]: finished collecting timing info
15:55:26.652858 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: Close
15:55:26.653689 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c81cfb20>]}
15:55:26.654220 [info ] [Thread-2  ]: 2 of 6 OK created table model dbo_stg.AH_LineItems_FT_tmp....................... [[32mOK[0m in 6.55s]
15:55:26.654700 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_tmp
15:55:27.163515 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.94 seconds
15:55:27.175181 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
15:55:27.175632 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "dbo_stg"."AH_Invoices_FT_tmp" to AH_Invoices_FT_tmp__dbt_backup
15:55:27.221608 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:55:27.233033 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
15:55:27.233472 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "dbo_stg"."AH_Invoices_FT_tmp__dbt_tmp" to AH_Invoices_FT_tmp
15:55:27.277221 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:27.279297 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: COMMIT
15:55:27.283113 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
15:55:27.283458 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_Invoices_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_Invoices_FT_tmp__dbt_backup"
    end

15:55:27.547429 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:55:27.557812 [debug] [Thread-1  ]: finished collecting timing info
15:55:27.558344 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: Close
15:55:27.559204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c8187b50>]}
15:55:27.559756 [info ] [Thread-1  ]: 1 of 6 OK created table model dbo_stg.AH_Invoices_FT_tmp........................ [[32mOK[0m in 7.46s]
15:55:27.560215 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_tmp
15:55:29.106861 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.48 seconds
15:55:29.122163 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
15:55:29.122625 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "dbo_stg"."AH_SubmittedListingPayment_FT_tmp" to AH_SubmittedListingPayment_FT_tmp__dbt_backup
15:55:29.155281 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:29.167557 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
15:55:29.168004 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp" to AH_SubmittedListingPayment_FT_tmp
15:55:29.198600 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:29.200653 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: COMMIT
15:55:29.204677 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
15:55:29.205050 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"
    end

15:55:29.410609 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:55:29.420772 [debug] [Thread-4  ]: finished collecting timing info
15:55:29.421246 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: Close
15:55:29.422047 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c9621430>]}
15:55:29.422636 [info ] [Thread-4  ]: 5 of 6 OK created table model dbo_stg.AH_SubmittedListingPayment_FT_tmp......... [[32mOK[0m in 3.81s]
15:55:29.423065 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
15:55:34.343046 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.39 seconds
15:55:34.354496 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
15:55:34.354917 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "dbo_stg"."AH_Watches_FT_tmp" to AH_Watches_FT_tmp__dbt_backup
15:55:34.391971 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:34.403136 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
15:55:34.403557 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "dbo_stg"."AH_Watches_FT_tmp__dbt_tmp" to AH_Watches_FT_tmp
15:55:34.435751 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:34.437775 [debug] [Thread-3  ]: On model.Shawn.AH_Watches_FT_tmp: COMMIT
15:55:34.441535 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
15:55:34.441845 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_Watches_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_Watches_FT_tmp__dbt_backup"
    end

15:55:34.659625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:55:34.669664 [debug] [Thread-3  ]: finished collecting timing info
15:55:34.670140 [debug] [Thread-3  ]: On model.Shawn.AH_Watches_FT_tmp: Close
15:55:34.670991 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494468bb-90ad-48b9-b348-e298fdcd8f97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c82567c0>]}
15:55:34.671519 [info ] [Thread-3  ]: 6 of 6 OK created table model dbo_stg.AH_Watches_FT_tmp......................... [[32mOK[0m in 8.73s]
15:55:34.671945 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Watches_FT_tmp
15:55:34.673406 [debug] [MainThread]: Acquiring new synapse connection "master"
15:55:34.673740 [debug] [MainThread]: On master: COMMIT
15:55:34.674136 [info ] [MainThread]: 
15:55:34.674436 [info ] [MainThread]: Finished running 6 table models in 25.44s.
15:55:34.674719 [debug] [MainThread]: Connection 'master' was properly closed.
15:55:34.674864 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_tmp' was properly closed.
15:55:34.675000 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoices_FT_tmp' was properly closed.
15:55:34.675128 [debug] [MainThread]: Connection 'model.Shawn.AH_LineItems_FT_tmp' was properly closed.
15:55:34.675260 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_tmp' was properly closed.
15:55:34.703857 [info ] [MainThread]: 
15:55:34.704346 [info ] [MainThread]: [32mCompleted successfully[0m
15:55:34.704700 [info ] [MainThread]: 
15:55:34.704934 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
15:55:34.705292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ca818160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8cbd68250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c9caf760>]}


============================== 2022-09-16 15:55:37.076541 | d71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8 ==============================
15:55:37.076541 [info ] [MainThread]: Running with dbt=1.0.0
15:55:37.083004 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:55:37.083377 [debug] [MainThread]: Tracking: tracking
15:55:37.083814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7a4d8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7a4d8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7a4d8d00>]}
15:55:37.288272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:55:37.288723 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:55:37.315700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7a402d00>]}
15:55:37.367121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7a1ea370>]}
15:55:37.367765 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:55:37.376708 [info ] [MainThread]: 
15:55:37.377575 [debug] [MainThread]: Acquiring new synapse connection "master"
15:55:37.379088 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:55:37.388655 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:55:37.389084 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:55:37.389274 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:55:37.389470 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:37.708130 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:37.743679 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:55:37.745694 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:55:37.767822 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:55:37.773991 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:55:37.774655 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:55:37.777563 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:55:37.777800 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:55:37.777960 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:55:37.778127 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:37.775687 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:55:37.780790 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:55:37.781006 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:55:37.781477 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:55:37.781712 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:37.775943 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:55:37.782735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:55:37.782936 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:37.898700 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:37.905652 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:37.906134 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:37.961283 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:55:37.961761 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:55:37.964203 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:55:37.964514 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:55:37.988317 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:55:37.990668 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:55:37.991010 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:55:38.101669 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:55:38.102134 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:55:47.480595 [debug] [MainThread]: On master: COMMIT
15:55:47.481334 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:55:47.481705 [info ] [MainThread]: 
15:55:47.484951 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoice_FT
15:55:47.485658 [info ] [Thread-1  ]: 1 of 6 START table model dbo_dbo.AH_Invoice_FT.................................. [RUN]
15:55:47.486229 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoice_FT"
15:55:47.486453 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoice_FT
15:55:47.485197 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT
15:55:47.486996 [info ] [Thread-2  ]: 2 of 6 START table model dbo_dbo.AH_LineItems_FT................................ [RUN]
15:55:47.487563 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT"
15:55:47.487758 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT
15:55:47.487918 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT
15:55:47.485298 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT
15:55:47.491342 [info ] [Thread-3  ]: 3 of 6 START table model dbo_dbo.AH_ListingActions_FT........................... [RUN]
15:55:47.491825 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT"
15:55:47.492013 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT
15:55:47.492174 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT
15:55:47.485379 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT
15:55:47.495277 [info ] [Thread-4  ]: 4 of 6 START table model dbo_dbo.AH_ListingPaymentCharge_FT..................... [RUN]
15:55:47.495776 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT"
15:55:47.495966 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT
15:55:47.496129 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT
15:55:47.486705 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoice_FT
15:55:47.501409 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoice_FT"
15:55:47.494946 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT"
15:55:47.490991 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT"
15:55:47.502184 [debug] [Thread-2  ]: finished collecting timing info
15:55:47.502389 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT
15:55:47.498775 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
15:55:47.512447 [debug] [Thread-1  ]: finished collecting timing info
15:55:47.512913 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoice_FT
15:55:47.512054 [debug] [Thread-3  ]: finished collecting timing info
15:55:47.536227 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT
15:55:47.512765 [debug] [Thread-4  ]: finished collecting timing info
15:55:47.576987 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT
15:55:47.576780 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT"
15:55:47.574189 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT"
15:55:47.585189 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
15:55:47.585750 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
  
  if object_id ('"dbo_dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_LineItems_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_LineItems_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_LineItems_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
     	FTstg.[LineItemsID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[InvoiceID],
		FTstg.[ListingID],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Status],
		FTstg.[Type],
		FTstg.[TotalAmount],
		FTstg.[QTY],
		FTstg.[PerUnitAmount],
		FTstg.[IsTaxable],
		FTstg.[IsArchived],
		FTstg.[Relistiteration],
		FTstg.[HasBuyerPremiumApplies],
		FTstg.[IsPayerArchived],
		FTstg.[DateStamp],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_LineItems_FT_tmp as FTtmp 
    join stg.AH_LineItems_FT_stg as FTstg 
    on FTstg.LineItemsID=FTtmp.LineItemsID
),
insertData as (
    select 
        [LineItemsID],
        [Consignor_Skey],
        [Buyer_Skey],
        [InvoiceID],
        [ListingID],
        [Description],
        [LastUpdatedUser],
        [Currency],
        [Status],
        [Type],
        [TotalAmount],
        [QTY],
        [PerUnitAmount],
        [IsTaxable],
        [IsArchived],
        [Relistiteration],
        [HasBuyerPremiumApplies],
        [IsPayerArchived],
        [DateStamp],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_LineItems_FT_tmp
    where LineItemsID not in (select  LineItemsID from stg.AH_LineItems_FT_stg)
)
SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_LineItems_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_LineItems_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end



15:55:47.585915 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:55:47.586095 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:47.585608 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
15:55:47.586692 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
  
  if object_id ('"dbo_dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingActions_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingActions_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingActions_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
        FTstg.[ListingActionID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ActionDTTM],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Amount],
		FTstg.[ProxyAmount],
		FTstg.[QTY],
		FTstg.[Reason],
		FTstg.[Status],
		FTstg.[HasUserEntered],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_ListingActions_FT_tmp as FTtmp 
    join stg.AH_ListingActions_FT_stg as FTstg 
    on FTstg.ListingActionID=FTtmp.ListingActionID
)
,
insertData as (
    select 
       	[ListingActionID],
        [Buyer_Skey],
        [ListingID],
        [ActionDTTM],
        [Description],
        [LastUpdatedUser],
        [Amount],
        [ProxyAmount],
        [QTY],
        [Reason],
        [Status],
        [HasUserEntered],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_ListingActions_FT_tmp
    where ListingActionID not in (select  ListingActionID from stg.AH_ListingActions_FT_stg)
)
SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingActions_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingActions_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end



15:55:47.586874 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
15:55:47.587042 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:47.584377 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoice_FT"
15:55:47.587569 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
15:55:47.587753 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
  
  if object_id ('"dbo_dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Invoice_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Invoice_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Invoice_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
        FTstg.[InvoiceID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Status],
		FTstg.[CreatedDTTM],
		FTstg.[FulfilledDTTM],
		FTstg.[Comment],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Type],
		FTstg.[ShippingAmount],
		FTstg.[Subtotal],
		FTstg.[Total],
		FTstg.[ShippingFirstName],
		FTstg.[ShippingLastName],
		FTstg.[ShippingStreet1],
		FTstg.[ShippingStreet2],
		FTstg.[ShippingCity],
		FTstg.[ShippingState],
		FTstg.[ShippingPostalCode],
		FTstg.[ShippingCountry],
		FTstg.[BillingFIrstName],
		FTstg.[BillingLastName],
		FTstg.[BillingStreet1],
		FTstg.[BillingStreet2],
		FTstg.[BillingCity],
		FTstg.[BillingState],
		FTstg.[BillingPostalCode],
		FTstg.[BillingCountry],
		FTstg.[SalesTax],
		FTstg.[PaidDTTM],
		FTstg.[IsPayerLocked],
		FTstg.[HasShipped],
		FTstg.[ShippingDetails],
		FTstg.[BuyerPremiumPct],
		FTstg.[BuyerPremiumAmount],
		FTstg.[IsArchived]
    from stg.AH_Invoices_FT_tmp as FTtmp 
    join stg.AH_Invoices_FT_stg as FTstg 
    on FTstg.InvoiceID=FTtmp.InvoiceID
),
insertData as (
    select 
        [InvoiceID],
        [Consignor_Skey],
        [Buyer_Skey],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Status],
        [CreatedDTTM],
        [FulfilledDTTM],
        [Comment],
        [LastUpdatedUser],
        [Currency],
        [Type],
        [ShippingAmount],
        [Subtotal],
        [Total],
        [ShippingFirstName],
        [ShippingLastName],
        [ShippingStreet1],
        [ShippingStreet2],
        [ShippingCity],
        [ShippingState],
        [ShippingPostalCode],
        [ShippingCountry],
        [BillingFIrstName],
        [BillingLastName],
        [BillingStreet1],
        [BillingStreet2],
        [BillingCity],
        [BillingState],
        [BillingPostalCode],
        [BillingCountry],
        [SalesTax],
        [PaidDTTM],
        [IsPayerLocked],
        [HasShipped],
        [ShippingDetails],
        [BuyerPremiumPct],
        [BuyerPremiumAmount],
        [IsArchived]
    from stg.AH_Invoices_FT_tmp
    where InvoiceID not in (select  InvoiceID from stg.AH_Invoices_FT_stg)
)
SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from updateData

union all

SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_Invoice_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Invoice_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end



15:55:47.589212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:55:47.589438 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:47.592876 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
15:55:47.593382 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
15:55:47.593769 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
  
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[ListingPaymentChargeID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ChargeAmount],
		FTstg.[TotalBid],
		FTstg.[BidHoldPercentage],
		FTstg.[MaximumBidCharge],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp as FTtmp 
    join stg.AH_ListingPaymentCharge_FT_stg as FTstg 
    on FTstg.ListingPaymentChargeID=FTtmp.ListingPaymentChargeID
)
,
insertData as (
    select 
        [ListingPaymentChargeID],
        [Buyer_Skey],
        [ListingID],
        [ChargeAmount],
        [TotalBid],
        [BidHoldPercentage],
        [MaximumBidCharge],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp
    where ListingPaymentChargeID not in (select  ListingPaymentChargeID from stg.AH_ListingPaymentCharge_FT_stg)
)
SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end



15:55:47.593957 [debug] [Thread-4  ]: Opening a new connection, currently in state init
15:55:47.594136 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:47.715709 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:47.725098 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:47.729274 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:47.729886 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:52.354036 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.77 seconds
15:55:52.370688 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
15:55:52.371110 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo_dbo"."AH_LineItems_FT" to AH_LineItems_FT__dbt_backup
15:55:52.448453 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:55:52.459005 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
15:55:52.459432 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo_dbo"."AH_LineItems_FT__dbt_tmp" to AH_LineItems_FT
15:55:52.488481 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:52.500443 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: COMMIT
15:55:52.506790 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
15:55:52.507202 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
    
  if object_id ('"dbo_dbo"."AH_LineItems_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_LineItems_FT__dbt_backup"
    end

15:55:52.765561 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:55:52.776594 [debug] [Thread-2  ]: finished collecting timing info
15:55:52.776859 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.18 seconds
15:55:52.777196 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: Close
15:55:52.788543 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde78175cd0>]}
15:55:52.789130 [info ] [Thread-2  ]: 2 of 6 OK created table model dbo_dbo.AH_LineItems_FT........................... [[32mOK[0m in 5.30s]
15:55:52.789391 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.20 seconds
15:55:52.799863 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT
15:55:52.800694 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT
15:55:52.801141 [info ] [Thread-2  ]: 5 of 6 START table model dbo_dbo.AH_SubmittedListingPayment_FT.................. [RUN]
15:55:52.801664 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT"
15:55:52.800386 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
15:55:52.802037 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo_dbo"."AH_ListingPaymentCharge_FT" to AH_ListingPaymentCharge_FT__dbt_backup
15:55:52.801864 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT
15:55:52.802409 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT
15:55:52.805278 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
15:55:52.805663 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
15:55:52.805949 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo_dbo"."AH_Invoice_FT" to AH_Invoice_FT__dbt_backup
15:55:52.806497 [debug] [Thread-2  ]: finished collecting timing info
15:55:52.806726 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT
15:55:52.815530 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
15:55:52.816268 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
15:55:52.816488 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
  
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[SubmittedListingPaymentID],
		FTtmp.[Consignor_Skey],
		FTstg.[ListingID],
		FTstg.[Amount],
		FTstg.[HasProPhotography],
		FTstg.[HasProMarketing],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp as FTtmp 
    join stg.AH_SubmittedListingPayment_FT_stg as FTstg 
    on FTstg.SubmittedListingPaymentID=FTtmp.SubmittedListingPaymentID
)
,
insertData as (
    select 
        [SubmittedListingPaymentID],
        [Consignor_Skey],
        [ListingID],
        [Amount],
        [HasProPhotography],
        [HasProMarketing],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp
    where SubmittedListingPaymentID not in (select  SubmittedListingPaymentID from stg.AH_SubmittedListingPayment_FT_stg)
)
SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end



15:55:52.816657 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:55:52.816836 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:52.834443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:52.841824 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:52.853815 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
15:55:52.860070 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo_dbo"."AH_Invoice_FT__dbt_tmp" to AH_Invoice_FT
15:55:52.859678 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
15:55:52.860423 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_tmp" to AH_ListingPaymentCharge_FT
15:55:52.891433 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:52.891822 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:52.894414 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: COMMIT
15:55:52.897863 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
15:55:52.898728 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: COMMIT
15:55:52.902030 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
15:55:52.898923 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
    
  if object_id ('"dbo_dbo"."AH_Invoice_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Invoice_FT__dbt_backup"
    end

15:55:52.902288 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
    
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingPaymentCharge_FT__dbt_backup"
    end

15:55:52.917867 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:53.096548 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:55:53.107750 [debug] [Thread-4  ]: finished collecting timing info
15:55:53.108220 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: Close
15:55:53.109045 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7816f040>]}
15:55:53.109565 [info ] [Thread-4  ]: 4 of 6 OK created table model dbo_dbo.AH_ListingPaymentCharge_FT................ [[32mOK[0m in 5.61s]
15:55:53.109998 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT
15:55:53.110228 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Watches_FT
15:55:53.110650 [info ] [Thread-4  ]: 6 of 6 START table model dbo_dbo.AH_Watches_FT.................................. [RUN]
15:55:53.111139 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT"
15:55:53.111330 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Watches_FT
15:55:53.111516 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Watches_FT
15:55:53.114265 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT"
15:55:53.114792 [debug] [Thread-4  ]: finished collecting timing info
15:55:53.114987 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Watches_FT
15:55:53.123820 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT"
15:55:53.124681 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
15:55:53.124906 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
  
  if object_id ('"dbo_dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Watches_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Watches_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Watches_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[WatchID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[LastUpdatedUser],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_Watches_FT_tmp as FTtmp 
    join stg.AH_Watches_FT_stg as FTstg 
    on FTstg.WatchID=FTtmp.WatchID
)
,
insertData as (
    select 
        [WatchID],
        [Buyer_Skey],
        [ListingID],
        [LastUpdatedUser],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_Watches_FT_tmp
    where WatchID not in (select  WatchID from stg.AH_Watches_FT_stg)
)
SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_Watches_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Watches_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end



15:55:53.125068 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
15:55:53.125244 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:55:53.138877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:55:53.150117 [debug] [Thread-1  ]: finished collecting timing info
15:55:53.150616 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: Close
15:55:53.151570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde78184520>]}
15:55:53.152079 [info ] [Thread-1  ]: 1 of 6 OK created table model dbo_dbo.AH_Invoice_FT............................. [[32mOK[0m in 5.67s]
15:55:53.152509 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoice_FT
15:55:53.258903 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:55:53.329581 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.74 seconds
15:55:53.343248 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
15:55:53.343674 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo_dbo"."AH_ListingActions_FT" to AH_ListingActions_FT__dbt_backup
15:55:53.373935 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:53.385244 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
15:55:53.385686 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo_dbo"."AH_ListingActions_FT__dbt_tmp" to AH_ListingActions_FT
15:55:53.422911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:55:53.424935 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: COMMIT
15:55:53.428454 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
15:55:53.428760 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
    
  if object_id ('"dbo_dbo"."AH_ListingActions_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingActions_FT__dbt_backup"
    end

15:55:53.635996 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:55:53.646459 [debug] [Thread-3  ]: finished collecting timing info
15:55:53.646974 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: Close
15:55:53.647740 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde780dd040>]}
15:55:53.648245 [info ] [Thread-3  ]: 3 of 6 OK created table model dbo_dbo.AH_ListingActions_FT...................... [[32mOK[0m in 6.16s]
15:55:53.648667 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT
15:55:56.544681 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.73 seconds
15:55:56.556564 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
15:55:56.556977 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo_dbo"."AH_SubmittedListingPayment_FT" to AH_SubmittedListingPayment_FT__dbt_backup
15:55:56.589819 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:56.600757 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
15:55:56.601320 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_tmp" to AH_SubmittedListingPayment_FT
15:55:56.630157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:55:56.632180 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment_FT: COMMIT
15:55:56.635879 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
15:55:56.636157 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
    
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SubmittedListingPayment_FT__dbt_backup"
    end

15:55:56.826491 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:55:56.836144 [debug] [Thread-2  ]: finished collecting timing info
15:55:56.836602 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment_FT: Close
15:55:56.837396 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde781e3730>]}
15:55:56.837913 [info ] [Thread-2  ]: 5 of 6 OK created table model dbo_dbo.AH_SubmittedListingPayment_FT............. [[32mOK[0m in 4.04s]
15:55:56.838336 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT
15:56:02.014199 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.89 seconds
15:56:02.025255 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
15:56:02.025633 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo_dbo"."AH_Watches_FT" to AH_Watches_FT__dbt_backup
15:56:02.058674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:56:02.069056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
15:56:02.069479 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo_dbo"."AH_Watches_FT__dbt_tmp" to AH_Watches_FT
15:56:02.106730 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:56:02.108681 [debug] [Thread-4  ]: On model.Shawn.AH_Watches_FT: COMMIT
15:56:02.112341 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
15:56:02.112653 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
    
  if object_id ('"dbo_dbo"."AH_Watches_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Watches_FT__dbt_backup"
    end

15:56:02.317082 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:56:02.327334 [debug] [Thread-4  ]: finished collecting timing info
15:56:02.327795 [debug] [Thread-4  ]: On model.Shawn.AH_Watches_FT: Close
15:56:02.328600 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd71f6100-c9bd-4fb7-a9b2-da7c9be5a2b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde79d97700>]}
15:56:02.329118 [info ] [Thread-4  ]: 6 of 6 OK created table model dbo_dbo.AH_Watches_FT............................. [[32mOK[0m in 9.22s]
15:56:02.329551 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Watches_FT
15:56:02.331039 [debug] [MainThread]: Acquiring new synapse connection "master"
15:56:02.331382 [debug] [MainThread]: On master: COMMIT
15:56:02.331784 [info ] [MainThread]: 
15:56:02.332097 [info ] [MainThread]: Finished running 6 table models in 24.95s.
15:56:02.332348 [debug] [MainThread]: Connection 'master' was properly closed.
15:56:02.332494 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT' was properly closed.
15:56:02.332630 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoice_FT' was properly closed.
15:56:02.332762 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT' was properly closed.
15:56:02.332892 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT' was properly closed.
15:56:02.437434 [info ] [MainThread]: 
15:56:02.437932 [info ] [MainThread]: [32mCompleted successfully[0m
15:56:02.438292 [info ] [MainThread]: 
15:56:02.438535 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
15:56:02.438954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7c490ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde79e3e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde7af95ac0>]}


============================== 2022-09-16 15:56:04.775895 | a0d57358-e1ae-4483-9f68-d788a42e69f8 ==============================
15:56:04.775895 [info ] [MainThread]: Running with dbt=1.0.0
15:56:04.778944 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:56:04.779229 [debug] [MainThread]: Tracking: tracking
15:56:04.779596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da610d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da610df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da610e50>]}
15:56:04.973246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:56:04.973711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:56:05.000032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0d57358-e1ae-4483-9f68-d788a42e69f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da538c40>]}
15:56:05.045673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0d57358-e1ae-4483-9f68-d788a42e69f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d9f6ea00>]}
15:56:05.046244 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:56:05.054430 [info ] [MainThread]: 
15:56:05.055108 [debug] [MainThread]: Acquiring new synapse connection "master"
15:56:05.056207 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:56:05.065172 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:56:05.065470 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:56:05.065645 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:56:05.065829 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:05.357034 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:05.387541 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
15:56:05.389566 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:56:05.411350 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:56:05.417123 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:56:05.417583 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:56:05.420238 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:56:05.420451 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:56:05.420611 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:56:05.420774 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:05.418533 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:56:05.423276 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:56:05.423837 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:56:05.424028 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:56:05.424196 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:05.418769 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:56:05.425204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:56:05.425400 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:05.527304 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:05.535814 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:05.536302 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:05.589576 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
15:56:05.592827 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:56:05.594790 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:56:05.595051 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:56:05.596119 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:56:05.597614 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:56:05.597830 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:56:05.736370 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:56:05.736855 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:56:14.981077 [debug] [MainThread]: On master: COMMIT
15:56:14.981825 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:56:14.982214 [info ] [MainThread]: 
15:56:14.985332 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_FieldIDs
15:56:14.985834 [info ] [Thread-1  ]: 1 of 2 START table model dbo_stg.SZ_AH_Properties_FieldIDs...................... [RUN]
15:56:14.986349 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs"
15:56:14.985551 [debug] [Thread-2  ]: Began running node model.Shawn.SZ_AH_Properties_FieldType
15:56:14.986872 [info ] [Thread-2  ]: 2 of 2 START table model dbo_stg.SZ_AH_Properties_FieldType..................... [RUN]
15:56:14.987305 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_FieldType"
15:56:14.987488 [debug] [Thread-2  ]: Began compiling node model.Shawn.SZ_AH_Properties_FieldType
15:56:14.987674 [debug] [Thread-2  ]: Compiling model.Shawn.SZ_AH_Properties_FieldType
15:56:14.986586 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_FieldIDs
15:56:14.990820 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_FieldIDs
15:56:14.993345 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_FieldIDs"
15:56:14.990530 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_FieldType"
15:56:14.994120 [debug] [Thread-1  ]: finished collecting timing info
15:56:14.994447 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_FieldIDs
15:56:14.994319 [debug] [Thread-2  ]: finished collecting timing info
15:56:15.003808 [debug] [Thread-2  ]: Began executing node model.Shawn.SZ_AH_Properties_FieldType
15:56:15.065194 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_FieldIDs"
15:56:15.067624 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_FieldType"
15:56:15.068375 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
15:56:15.068903 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: 
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp"
    end


   EXEC('create view dbo_stg.SZ_AH_Properties_FieldType__dbt_tmp_temp_view as
    

select ''BoolNativeValue'' as column_name, ''bit'' as data_type union all
select ''StringNativeValue'' as column_name, ''nvarchar(4000)'' as data_type union all
select ''IntNativeValue'' as column_name, ''int'' as data_type union all
select ''DecimalNativeValue'' as column_name, ''decimal(10,2)'' as data_type union all
select ''DateTimeNativeValue'' as column_name, ''datetime'' as data_type union all
select ''EnumNativeValue'' as column_name, ''nvarchar(200)'' as data_type
    ');

  CREATE TABLE "dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.SZ_AH_Properties_FieldType__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"
    end



15:56:15.069072 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:56:15.069244 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:15.068769 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
15:56:15.070463 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: 
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"
    end


   EXEC('create view dbo_stg.SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view as
    

select ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS Sequence,
            cf.name, 
            cf.id, 
            count(*) as cnt
        from stg.AH_Listingproperties_FinalView lp 
            inner join stg.AH_CustomFields_FinalView cf 
            on lp.CustomFieldID = cf.id
        group by cf.Name, cf.id
    ');

  CREATE TABLE "dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"
    end



15:56:15.070683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:56:15.070858 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:15.193845 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:15.194387 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:16.445487 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
15:56:16.461761 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
15:56:16.462202 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: rename object "dbo_stg"."SZ_AH_Properties_FieldType" to SZ_AH_Properties_FieldType__dbt_backup
15:56:16.982258 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.52 seconds
15:56:16.993721 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
15:56:16.994128 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: rename object "dbo_stg"."SZ_AH_Properties_FieldType__dbt_tmp" to SZ_AH_Properties_FieldType
15:56:17.042216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
15:56:17.054254 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_FieldType: COMMIT
15:56:17.061908 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
15:56:17.062365 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: 
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldType__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_FieldType__dbt_backup"
    end

15:56:17.300984 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
15:56:17.310693 [debug] [Thread-2  ]: finished collecting timing info
15:56:17.311165 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_FieldType: Close
15:56:17.311944 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0d57358-e1ae-4483-9f68-d788a42e69f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d82bed60>]}
15:56:17.312476 [info ] [Thread-2  ]: 2 of 2 OK created table model dbo_stg.SZ_AH_Properties_FieldType................ [[32mOK[0m in 2.32s]
15:56:17.312902 [debug] [Thread-2  ]: Finished running node model.Shawn.SZ_AH_Properties_FieldType
15:56:18.124162 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.05 seconds
15:56:18.135527 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
15:56:18.136864 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: rename object "dbo_stg"."SZ_AH_Properties_FieldIDs" to SZ_AH_Properties_FieldIDs__dbt_backup
15:56:18.173504 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:56:18.185544 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
15:56:18.185969 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: rename object "dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_tmp" to SZ_AH_Properties_FieldIDs
15:56:18.222630 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:56:18.224607 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_FieldIDs: COMMIT
15:56:18.228157 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
15:56:18.228435 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: 
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_FieldIDs__dbt_backup"
    end

15:56:18.428469 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:56:18.438735 [debug] [Thread-1  ]: finished collecting timing info
15:56:18.439215 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_FieldIDs: Close
15:56:18.440016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0d57358-e1ae-4483-9f68-d788a42e69f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d82a46a0>]}
15:56:18.440551 [info ] [Thread-1  ]: 1 of 2 OK created table model dbo_stg.SZ_AH_Properties_FieldIDs................. [[32mOK[0m in 3.45s]
15:56:18.440972 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_FieldIDs
15:56:18.442302 [debug] [MainThread]: Acquiring new synapse connection "master"
15:56:18.442668 [debug] [MainThread]: On master: COMMIT
15:56:18.443076 [info ] [MainThread]: 
15:56:18.443385 [info ] [MainThread]: Finished running 2 table models in 13.39s.
15:56:18.443637 [debug] [MainThread]: Connection 'master' was properly closed.
15:56:18.443781 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_FieldIDs' was properly closed.
15:56:18.443916 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_FieldType' was properly closed.
15:56:18.444057 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:56:18.472670 [info ] [MainThread]: 
15:56:18.473132 [info ] [MainThread]: [32mCompleted successfully[0m
15:56:18.473482 [info ] [MainThread]: 
15:56:18.473715 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
15:56:18.474070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d82d0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d82d0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0d82d02b0>]}


============================== 2022-09-16 15:56:20.790987 | 46ae29e2-4d63-40e3-ba04-cb9971cb483a ==============================
15:56:20.790987 [info ] [MainThread]: Running with dbt=1.0.0
15:56:20.791699 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_2'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:56:20.791982 [debug] [MainThread]: Tracking: tracking
15:56:20.792341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69c553d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69c553df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69c553e50>]}
15:56:20.992681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:56:20.993145 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:56:21.019784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46ae29e2-4d63-40e3-ba04-cb9971cb483a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69c47cc40>]}
15:56:21.069636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46ae29e2-4d63-40e3-ba04-cb9971cb483a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69beb0a00>]}
15:56:21.070251 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:56:21.078338 [info ] [MainThread]: 
15:56:21.079218 [debug] [MainThread]: Acquiring new synapse connection "master"
15:56:21.080354 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:56:21.089469 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:56:21.089828 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:56:21.090004 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:56:21.090203 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:21.416887 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:21.452909 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.36 seconds
15:56:21.455157 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:56:21.478019 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:56:21.484042 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:56:21.484468 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:56:21.486417 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:56:21.486655 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:56:21.486816 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:56:21.486985 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:21.484889 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:56:21.488537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:56:21.488735 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:21.490011 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:56:21.491936 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:56:21.492150 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:56:21.492305 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:56:21.492463 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:21.607548 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:21.608088 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:21.608689 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:21.672488 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:56:21.694601 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:56:21.696787 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:56:21.697089 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:56:21.698816 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:56:21.699118 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:56:21.698996 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:56:21.813444 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:56:21.813923 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:56:31.131915 [debug] [MainThread]: On master: COMMIT
15:56:31.132631 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:56:31.133005 [info ] [MainThread]: 
15:56:31.136602 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
15:56:31.136980 [info ] [Thread-1  ]: 1 of 1 START table model dbo_stg.SZ_AH_Properties_Value_ColumnMapping........... [RUN]
15:56:31.137469 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
15:56:31.137673 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
15:56:31.137861 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_Value_ColumnMapping
15:56:31.146805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
15:56:31.147035 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
    
    
SELECT distinct customfieldid FROM stg.AH_Listingproperties_FinalView where  customfieldid is not null
    

  
15:56:31.147194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:56:31.147365 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:56:31.287258 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:56:31.532218 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:56:31.535245 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
15:56:31.536015 [debug] [Thread-1  ]: finished collecting timing info
15:56:31.536196 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
15:56:31.574242 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
15:56:31.575392 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
15:56:31.575638 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"
    end


   EXEC('create view dbo_stg.SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view as
    





    

    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161245,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',16575279,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2533219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310753,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3723813,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673475,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14959150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161205,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673478,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161242,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161202,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9895950,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3744978,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161222,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21259499,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21806654,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658044,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161214,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673487,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673481,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13549467,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161732,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897193,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161231,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161211,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673484,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102056,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161234,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045187,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161208,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161271,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161237,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3760788,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810052,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26254668,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161243,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3737940,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673473,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19353344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310748,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289629,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161217,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161240,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161008,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161014,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310751,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289626,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673490,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3901735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7052946,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161220,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4507814,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673479,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161203,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6529375,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',5282840,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161209,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589345,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9888915,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673482,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161246,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19360781,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694977,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367903,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045185,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161226,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673476,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161206,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161020,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673485,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3716724,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161235,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161736,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810050,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6557150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161238,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673488,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4016506,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2080452,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161733,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161275,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161232,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431196,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161212,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',633102,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161241,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310752,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673477,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161221,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21833162,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161244,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673474,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161204,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161012,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694972,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161218,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3752016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673483,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13724070,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161247,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19338647,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1043518,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',23362439,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367904,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897195,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161227,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161207,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102055,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',17214902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673486,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7635382,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673480,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3730851,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161230,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161210,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161018,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3708441,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161216,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161239,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161233,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161734,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289625,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673489,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161213,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19346144,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658043,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161737,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161236,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810051,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2545215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161010,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21817611,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
    select ''''  as customfieldid, '''' as value_columnname  where 1=2

    ');

  CREATE TABLE "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end



15:57:13.237488 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 41.66 seconds
15:57:13.253467 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
15:57:13.253851 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: rename object "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping" to SZ_AH_Properties_Value_ColumnMapping__dbt_backup
15:57:13.527132 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:57:13.538229 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
15:57:13.538627 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: rename object "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp" to SZ_AH_Properties_Value_ColumnMapping
15:57:13.567736 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:57:13.579681 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: COMMIT
15:57:13.585811 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
15:57:13.586186 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_backup"
    end

15:57:13.787258 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
15:57:13.797390 [debug] [Thread-1  ]: finished collecting timing info
15:57:13.797883 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: Close
15:57:13.798765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46ae29e2-4d63-40e3-ba04-cb9971cb483a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe699a25970>]}
15:57:13.799357 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo_stg.SZ_AH_Properties_Value_ColumnMapping...... [[32mOK[0m in 42.66s]
15:57:13.799815 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
15:57:13.801184 [debug] [MainThread]: Acquiring new synapse connection "master"
15:57:13.801522 [debug] [MainThread]: On master: COMMIT
15:57:13.801914 [info ] [MainThread]: 
15:57:13.802222 [info ] [MainThread]: Finished running 1 table model in 52.72s.
15:57:13.802470 [debug] [MainThread]: Connection 'master' was properly closed.
15:57:13.802643 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_Value_ColumnMapping' was properly closed.
15:57:13.802782 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:57:13.802910 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_stg' was properly closed.
15:57:13.832866 [info ] [MainThread]: 
15:57:13.833355 [info ] [MainThread]: [32mCompleted successfully[0m
15:57:13.833700 [info ] [MainThread]: 
15:57:13.833937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:57:13.834292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69c50c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe699a1f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69c482520>]}


============================== 2022-09-16 15:57:16.134652 | 3c9be937-2019-4dde-870e-73caff94610e ==============================
15:57:16.134652 [info ] [MainThread]: Running with dbt=1.0.0
15:57:16.135369 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:57:16.135654 [debug] [MainThread]: Tracking: tracking
15:57:16.136026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b5196f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b5196fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b5196d00>]}
15:57:16.333757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:57:16.334246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:57:16.361150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c9be937-2019-4dde-870e-73caff94610e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b50c0ca0>]}
15:57:16.411712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c9be937-2019-4dde-870e-73caff94610e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b4af5b50>]}
15:57:16.412373 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:57:16.420907 [info ] [MainThread]: 
15:57:16.421800 [debug] [MainThread]: Acquiring new synapse connection "master"
15:57:16.423214 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:57:16.432774 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:57:16.433211 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:57:16.433408 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:57:16.433607 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:57:16.732845 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:57:16.765555 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
15:57:16.767733 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:57:16.789514 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:57:16.795848 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:57:16.796314 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:57:16.798488 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:57:16.798781 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:57:16.798953 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:57:16.799130 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:57:16.796828 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:57:16.800520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:57:16.801047 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:57:16.802474 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:57:16.804686 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:57:16.804917 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:57:16.805079 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:57:16.805249 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:57:16.916183 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:57:16.916940 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:57:16.923695 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:57:16.979479 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:57:16.980681 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:57:16.982853 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:57:16.983040 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:57:16.984595 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:57:16.984829 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:57:16.987140 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:57:17.127478 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:57:17.127976 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:57:26.625522 [debug] [MainThread]: On master: COMMIT
15:57:26.626295 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:57:26.626729 [info ] [MainThread]: 
15:57:26.629869 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_AllProperties_One_Column
15:57:26.630408 [info ] [Thread-1  ]: 1 of 2 START table model dbo_stg.SZ_AH_AllProperties_One_Column................. [RUN]
15:57:26.631034 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column"
15:57:26.631240 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_AllProperties_One_Column
15:57:26.630112 [debug] [Thread-2  ]: Began running node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
15:57:26.631710 [info ] [Thread-2  ]: 2 of 2 START table model dbo_stg.SZ_AH_Properties_CustomFields_Lookup........... [RUN]
15:57:26.632172 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
15:57:26.632356 [debug] [Thread-2  ]: Began compiling node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
15:57:26.632514 [debug] [Thread-2  ]: Compiling model.Shawn.SZ_AH_Properties_CustomFields_Lookup
15:57:26.631433 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_AllProperties_One_Column
15:57:26.635495 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
15:57:26.644639 [debug] [Thread-2  ]: finished collecting timing info
15:57:26.644889 [debug] [Thread-2  ]: Began executing node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
15:57:26.643811 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:26.655964 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
    SELECT id FROM stg.SZ_AH_Properties_FieldIDs 

  
15:57:26.656358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:57:26.656565 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:57:26.692009 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
15:57:26.692949 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
15:57:26.693184 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: 
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"
    end


   EXEC('create view dbo_stg.SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view as
    
select 
    a.*, 
    c.name,
    b.data_type,
           case when b.data_type = ''nvarchar(4000)'' then c.name + '' nvarchar(4000)''
                when b.data_type = ''nvarchar(200)'' then c.name + '' nvarchar(200)''
                when b.data_type = ''decimal(10,2)'' then c.name + '' decimal(11,2)''
                when b.data_type = ''bit'' then c.name + '' bit''
                when b.data_type = ''int'' then c.name + '' bigint''
                when b.data_type = ''datetime'' then c.name + '' datetime''
           end  as col_definition_str,       
           case when b.data_type = ''nvarchar(4000)'' then ''cast('' + c.name + '' as nvarchar(4000)) as '' + c.name 
                when b.data_type = ''nvarchar(200)'' then ''cast('' + c.name + '' as nvarchar(200)) as '' + c.name 
                when b.data_type = ''decimal(10,2)'' then ''cast(cast('' + c.name + '' as nvarchar(10)) as decimal(11,2)) as '' + c.name
                when b.data_type = ''bit'' then ''cast(cast('' + c.name + '' as nvarchar(1)) as bit) as '' + c.name 
                when b.data_type = ''int'' then ''cast(cast('' + c.name + '' as nvarchar(9)) as bigint) as '' + c.name 
                when b.data_type = ''datetime'' then ''cast(cast('' + c.name + '' as nvarchar(23)) as datetime) as '' + c.name 
            end  as col_type_cast
from stg.SZ_AH_Properties_Value_ColumnMapping a
            left join stg.SZ_AH_Properties_FieldType b 
                on a.value_columnname = b.column_name
            left join stg.SZ_AH_Properties_FieldIDs c
                on a.customfieldid = c.id
where a.customfieldid not in (9895950, 9888915, 6529375) -- remove duplicates
    ');

  CREATE TABLE "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end



15:57:26.693357 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
15:57:26.693540 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:57:26.764655 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:57:26.810580 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:57:26.934297 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:57:26.937200 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:26.937428 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2694972
        
  
15:57:27.073546 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:27.075390 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.075582 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3723813
        
  
15:57:27.190297 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:27.192055 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.192256 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3752016
        
  
15:57:27.321356 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:27.323327 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.323564 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 4507814
        
  
15:57:27.439153 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:27.441038 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.441281 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 7052946
        
  
15:57:27.579814 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:27.582129 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.582480 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 10045185
        
  
15:57:27.694816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:27.696648 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.696824 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 13549467
        
  
15:57:27.822171 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:27.824043 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.824258 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14959150
        
  
15:57:27.943433 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:27.945295 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:27.945504 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 17214902
        
  
15:57:28.054378 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:28.056258 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.056487 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310748
        
  
15:57:28.166585 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:28.168320 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.168506 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19338647
        
  
15:57:28.304242 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:28.306154 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.306372 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367902
        
  
15:57:28.412636 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:28.414620 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.414869 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21806654
        
  
15:57:28.547714 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:28.549643 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.549854 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897193
        
  
15:57:28.659965 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:28.661862 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.662094 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26431194
        
  
15:57:28.767046 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:28.769280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.769531 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161008
        
  
15:57:28.882525 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:28.884410 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:28.884631 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161016
        
  
15:57:29.035948 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:57:29.037830 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.038036 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161203
        
  
15:57:29.171466 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:29.173219 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.173425 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161207
        
  
15:57:29.280809 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:29.282768 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.282993 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161211
        
  
15:57:29.395312 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:29.397219 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.397468 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161215
        
  
15:57:29.428560 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.74 seconds
15:57:29.445081 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
15:57:29.445536 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: rename object "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup" to SZ_AH_Properties_CustomFields_Lookup__dbt_backup
15:57:29.520140 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:57:29.534067 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
15:57:29.534329 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:29.536072 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.536337 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161219
        
  
15:57:29.534635 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: rename object "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp" to SZ_AH_Properties_CustomFields_Lookup
15:57:29.568658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:57:29.580643 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: COMMIT
15:57:29.587350 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
15:57:29.587785 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: 
    
  if object_id ('"dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_backup"
    end

15:57:29.657425 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:29.659478 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.659776 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161223
        
  
15:57:29.771148 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:29.772991 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.773188 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161227
        
  
15:57:29.845097 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:57:29.856961 [debug] [Thread-2  ]: finished collecting timing info
15:57:29.857426 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: Close
15:57:29.858529 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9be937-2019-4dde-870e-73caff94610e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ae65ed90>]}
15:57:29.859081 [info ] [Thread-2  ]: 2 of 2 OK created table model dbo_stg.SZ_AH_Properties_CustomFields_Lookup...... [[32mOK[0m in 3.23s]
15:57:29.859518 [debug] [Thread-2  ]: Finished running node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
15:57:29.891254 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:29.893272 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:29.893604 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161231
        
  
15:57:30.002999 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:30.004898 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.005117 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161235
        
  
15:57:30.111028 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:30.112795 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.112994 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161239
        
  
15:57:30.219423 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:30.221293 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.221487 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161243
        
  
15:57:30.326206 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:30.327933 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.328107 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161247
        
  
15:57:30.437117 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:30.439041 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.439262 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161733
        
  
15:57:30.542876 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:30.544620 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.544797 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161737
        
  
15:57:30.672779 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:30.674732 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.674949 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673475
        
  
15:57:30.785006 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:30.786937 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.787146 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673479
        
  
15:57:30.898651 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:30.900515 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:30.900730 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673483
        
  
15:57:31.008688 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.010594 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.010831 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673487
        
  
15:57:31.121842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.123586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.123773 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810050
        
  
15:57:31.234794 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.236656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.236874 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 840229
        
  
15:57:31.347397 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.349306 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.349563 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250225
        
  
15:57:31.459770 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.461710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.461912 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2694977
        
  
15:57:31.572081 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.573975 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.574212 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3730851
        
  
15:57:31.679857 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.681724 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.681993 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3760788
        
  
15:57:31.808107 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:31.809960 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.810150 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 5282840
        
  
15:57:31.923016 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:31.924855 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:31.925063 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 7635382
        
  
15:57:32.035459 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:32.037181 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.037369 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 10045187
        
  
15:57:32.147305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:32.149154 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.149348 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 13724070
        
  
15:57:32.259057 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:32.260893 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.261092 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 15658043
        
  
15:57:32.385674 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:32.387909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.388117 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289625
        
  
15:57:32.539396 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:57:32.541270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.541470 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310751
        
  
15:57:32.768767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:57:32.770666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.770873 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19346144
        
  
15:57:32.881483 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:32.883354 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.883562 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367903
        
  
15:57:32.997447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:32.999332 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:32.999550 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21817611
        
  
15:57:33.119833 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:33.121592 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.123307 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897194
        
  
15:57:33.237257 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:33.239108 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.239306 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26431196
        
  
15:57:33.368337 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:33.370230 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.370443 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161010
        
  
15:57:33.485440 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:33.487287 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.487479 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161018
        
  
15:57:33.603956 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:33.605779 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.605970 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161204
        
  
15:57:33.716655 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:33.718386 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.718760 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161208
        
  
15:57:33.834030 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:33.836342 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.836557 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161212
        
  
15:57:33.945147 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:33.947046 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:33.947252 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161216
        
  
15:57:34.170122 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
15:57:34.171838 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.172017 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161220
        
  
15:57:34.319169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
15:57:34.320946 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.321134 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161224
        
  
15:57:34.456094 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:34.457918 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.458112 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161228
        
  
15:57:34.563469 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:34.565306 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.565505 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161232
        
  
15:57:34.671732 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:34.673584 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.673781 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161236
        
  
15:57:34.788291 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:34.790233 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.790497 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161240
        
  
15:57:34.897508 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:34.899406 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:34.899628 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161244
        
  
15:57:35.006468 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:35.008322 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.008517 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161271
        
  
15:57:35.130886 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:35.132739 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.132929 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161734
        
  
15:57:35.340257 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
15:57:35.342484 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.342767 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 633102
        
  
15:57:35.457438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:35.459330 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.459544 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673476
        
  
15:57:35.565501 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:35.567454 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.567687 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673480
        
  
15:57:35.680798 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:35.682733 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.682951 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673484
        
  
15:57:35.791851 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:35.793708 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.793915 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673488
        
  
15:57:35.900859 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:35.902815 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:35.903013 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810051
        
  
15:57:36.007272 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:36.009027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.009236 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1043518
        
  
15:57:36.132092 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:36.133964 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.134198 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2080452
        
  
15:57:36.242029 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:36.243800 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.243992 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3708441
        
  
15:57:36.354131 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:36.356025 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.356229 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3737940
        
  
15:57:36.466473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:36.468353 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.468555 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3901735
        
  
15:57:36.576939 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:36.579170 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.579391 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 6529375
        
  
15:57:36.686666 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:36.688381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.688572 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 9888915
        
  
15:57:36.792842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:36.794703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.794890 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 11102055
        
  
15:57:36.902771 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:36.904657 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:36.904857 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14589344
        
  
15:57:37.030244 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:37.032109 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:37.032303 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 15658044
        
  
15:57:37.147305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:37.149199 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:37.149435 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289626
        
  
15:57:37.255587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:37.257385 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:37.257580 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310752
        
  
15:57:37.366100 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:37.367947 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:37.368147 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19353344
        
  
15:57:37.474228 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:37.476088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:37.476285 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367904
        
  
15:57:37.905973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
15:57:37.907810 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:37.907996 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21833162
        
  
15:57:38.030824 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:38.032688 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.032894 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897195
        
  
15:57:38.150883 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:38.153086 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.153294 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161012
        
  
15:57:38.266141 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:38.267950 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.268156 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161020
        
  
15:57:38.376013 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:38.377839 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.378050 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161205
        
  
15:57:38.487257 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:38.489010 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.489230 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161209
        
  
15:57:38.597550 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:38.599386 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.599584 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161213
        
  
15:57:38.713493 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:38.715399 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.715601 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161217
        
  
15:57:38.833230 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:38.835059 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.835254 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161221
        
  
15:57:38.967737 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:38.969574 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:38.969762 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161225
        
  
15:57:39.081004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:39.082864 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.083058 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161229
        
  
15:57:39.189181 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:39.190848 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.191026 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161233
        
  
15:57:39.296077 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:39.297965 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.298164 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161237
        
  
15:57:39.418592 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:39.420714 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.420899 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161241
        
  
15:57:39.528033 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:39.529830 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.530036 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161245
        
  
15:57:39.636597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:39.638408 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.638623 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161275
        
  
15:57:39.748141 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:39.749980 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.750182 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161735
        
  
15:57:39.855036 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:39.856878 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.857092 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673473
        
  
15:57:39.963757 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:39.965594 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:39.965791 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673477
        
  
15:57:40.081470 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:40.083327 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.083547 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673481
        
  
15:57:40.190758 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:40.192412 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.192587 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673485
        
  
15:57:40.312815 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:40.314642 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.314843 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673489
        
  
15:57:40.422639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:40.424357 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.424540 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810052
        
  
15:57:40.546153 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:40.548042 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.548242 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250223
        
  
15:57:40.657917 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:40.660006 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.660195 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2533219
        
  
15:57:40.773753 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:40.775598 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.775801 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3716724
        
  
15:57:40.891716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:40.893556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:40.893760 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3744978
        
  
15:57:41.016559 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:41.018367 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.018577 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 4016506
        
  
15:57:41.128866 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:41.130598 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.130814 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 6557150
        
  
15:57:41.237317 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:41.239099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.239312 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 9895950
        
  
15:57:41.350362 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:41.352225 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.352417 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 11102056
        
  
15:57:41.480178 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:41.482026 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.482235 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14589345
        
  
15:57:41.597406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:41.599111 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.599295 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 16575279
        
  
15:57:41.708449 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:41.710159 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.710350 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289629
        
  
15:57:41.814920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:41.816745 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.816925 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310753
        
  
15:57:41.932524 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:41.934729 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:41.934930 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19360781
        
  
15:57:42.043509 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:42.045185 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.045358 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21259499
        
  
15:57:42.160685 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:42.162493 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.162726 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 23362439
        
  
15:57:42.271720 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:42.273420 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.273610 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26254668
        
  
15:57:42.377487 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:42.379308 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.379507 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161014
        
  
15:57:42.505824 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:42.507656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.507857 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161202
        
  
15:57:42.692377 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:57:42.694178 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.694363 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161206
        
  
15:57:42.799835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:42.801640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.801835 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161210
        
  
15:57:42.911603 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:42.913434 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:42.913636 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161214
        
  
15:57:43.032193 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:43.034045 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.034250 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161218
        
  
15:57:43.142423 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:43.144141 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.144325 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161222
        
  
15:57:43.255805 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:43.257969 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.258169 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161226
        
  
15:57:43.379836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:43.381673 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.381872 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161230
        
  
15:57:43.488471 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:43.490255 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.490469 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161234
        
  
15:57:43.629976 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:43.631802 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.632005 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161238
        
  
15:57:43.891356 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
15:57:43.893183 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:43.893374 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161242
        
  
15:57:44.010760 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:44.012569 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.012766 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161246
        
  
15:57:44.146657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
15:57:44.148488 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.148713 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161732
        
  
15:57:44.271091 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:44.272738 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.272935 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161736
        
  
15:57:44.376827 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
15:57:44.378812 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.379025 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673474
        
  
15:57:44.517844 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:44.519647 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.519819 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673478
        
  
15:57:44.664057 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
15:57:44.665927 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.666129 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673482
        
  
15:57:44.788618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
15:57:44.791135 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.791344 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673486
        
  
15:57:44.899388 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:44.901217 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:44.901408 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673490
        
  
15:57:45.081495 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:57:45.083397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:45.083617 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 840228
        
  
15:57:45.189253 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:45.191103 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:45.191313 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250224
        
  
15:57:45.299836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:45.301661 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:45.301862 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2545215
        
  
15:57:45.410941 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
15:57:45.412855 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_AllProperties_One_Column"
15:57:45.413428 [debug] [Thread-1  ]: finished collecting timing info
15:57:45.413594 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_AllProperties_One_Column
15:57:45.423258 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_AllProperties_One_Column"
15:57:45.423999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:57:45.424205 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
  
  if object_id ('"dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"
    end


   EXEC('create view dbo_stg.SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view as
    





    

    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694972

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3723813

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3752016

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4507814

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7052946

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045185

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13549467

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14959150

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 17214902

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310748

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19338647

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367902

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21806654

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897193

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DateTimeNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431194

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161008

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161016

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161203

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161207

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161211

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161215

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161219

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161223

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161227

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161231

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161235

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161239

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161243

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161247

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161733

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161737

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673475

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673479

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673483

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673487

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810050

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840229

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250225

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694977

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3730851

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3760788

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 5282840

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7635382

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045187

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13724070

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658043

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289625

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310751

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19346144

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367903

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21817611

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897194

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431196

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161010

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161018

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161204

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161208

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161212

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161216

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161220

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161224

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161228

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161232

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161236

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161240

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161244

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161271

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161734

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 633102

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673476

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673480

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673484

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673488

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810051

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1043518

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2080452

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3708441

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3737940

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3901735

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6529375

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9888915

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102055

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589344

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658044

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289626

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310752

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19353344

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367904

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21833162

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897195

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161012

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161020

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161205

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161209

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161213

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161217

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161221

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161225

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161229

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161233

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161237

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161241

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161245

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161275

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161735

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673473

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673477

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673481

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673485

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673489

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810052

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250223

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2533219

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3716724

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3744978

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4016506

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6557150

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9895950

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102056

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589345

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 16575279

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289629

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310753

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19360781

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21259499

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 23362439

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26254668

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161014

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161202

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161206

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161210

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161214

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161218

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161222

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161226

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161230

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161234

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161238

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161242

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161246

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161732

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161736

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673474

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673478

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673482

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673486

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673490

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840228

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250224

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2545215

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
    select 
        '''' as listingid, '''' as customfieldid, '''' as customfieldname, '''' as customfieldvalue 
    where 2=1

    ');

  CREATE TABLE "dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"
    end



15:58:39.264400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 53.84 seconds
15:58:39.275157 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:58:39.275571 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: rename object "dbo_stg"."SZ_AH_AllProperties_One_Column" to SZ_AH_AllProperties_One_Column__dbt_backup
15:58:39.543465 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:58:39.553970 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:58:39.554404 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: rename object "dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_tmp" to SZ_AH_AllProperties_One_Column
15:58:39.590607 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
15:58:39.592598 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_AllProperties_One_Column: COMMIT
15:58:39.596197 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
15:58:39.596486 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
  if object_id ('"dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."SZ_AH_AllProperties_One_Column__dbt_backup"
    end

15:58:39.774567 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:58:39.784190 [debug] [Thread-1  ]: finished collecting timing info
15:58:39.784663 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_AllProperties_One_Column: Close
15:58:39.785431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9be937-2019-4dde-870e-73caff94610e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ac5c6670>]}
15:58:39.785943 [info ] [Thread-1  ]: 1 of 2 OK created table model dbo_stg.SZ_AH_AllProperties_One_Column............ [[32mOK[0m in 73.15s]
15:58:39.786384 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_AllProperties_One_Column
15:58:39.787783 [debug] [MainThread]: Acquiring new synapse connection "master"
15:58:39.788110 [debug] [MainThread]: On master: COMMIT
15:58:39.788484 [info ] [MainThread]: 
15:58:39.788783 [info ] [MainThread]: Finished running 2 table models in 83.37s.
15:58:39.789030 [debug] [MainThread]: Connection 'master' was properly closed.
15:58:39.789171 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_CustomFields_Lookup' was properly closed.
15:58:39.789320 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_AllProperties_One_Column' was properly closed.
15:58:39.789449 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:58:39.824447 [info ] [MainThread]: 
15:58:39.824919 [info ] [MainThread]: [32mCompleted successfully[0m
15:58:39.825276 [info ] [MainThread]: 
15:58:39.825518 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
15:58:39.825865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b7164ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ae67ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b50d9a30>]}


============================== 2022-09-16 15:58:42.208052 | 4a6b702f-866e-4396-b84a-c2cb45d8e82d ==============================
15:58:42.208052 [info ] [MainThread]: Running with dbt=1.0.0
15:58:42.213278 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_4'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:58:42.213662 [debug] [MainThread]: Tracking: tracking
15:58:42.214516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a72ecac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a72ecad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a72ecafd0>]}
15:58:42.429845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:58:42.430340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:58:42.457270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a6b702f-866e-4396-b84a-c2cb45d8e82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a72df4d30>]}
15:58:42.509004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a6b702f-866e-4396-b84a-c2cb45d8e82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a72bdc3a0>]}
15:58:42.509591 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:58:42.518355 [info ] [MainThread]: 
15:58:42.519291 [debug] [MainThread]: Acquiring new synapse connection "master"
15:58:42.520499 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:58:42.530020 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:58:42.530464 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:58:42.530689 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:58:42.530884 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:58:42.847699 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:58:42.881945 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
15:58:42.884044 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:58:42.905589 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:58:42.911809 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:58:42.912253 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:58:42.914345 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:58:42.914632 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:58:42.914809 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:58:42.914990 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:58:42.912729 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:58:42.916707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:58:42.916949 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:58:42.918386 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:58:42.920500 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:58:42.920729 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:58:42.920888 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:58:42.921057 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:58:43.029181 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:58:43.039818 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:58:43.040211 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:58:43.092126 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:58:43.095134 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:58:43.095477 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:58:43.099402 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:58:43.106101 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:58:43.108127 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:58:43.108393 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:58:43.247035 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:58:43.247528 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:58:52.687655 [debug] [MainThread]: On master: COMMIT
15:58:52.688394 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:58:52.688798 [info ] [MainThread]: 
15:58:52.692453 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_Pivot
15:58:52.692861 [info ] [Thread-1  ]: 1 of 1 START table model dbo_dbo.SZ_AH_Properties_Pivot......................... [RUN]
15:58:52.693428 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_Pivot"
15:58:52.693632 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_Pivot
15:58:52.693813 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_Pivot
15:58:52.703258 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
15:58:52.703633 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
    select name from stg.SZ_AH_Properties_CustomFields_Lookup where name != 'listingid'

  
15:58:52.703807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:58:52.703988 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:58:52.837658 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:58:52.981826 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
15:58:53.001418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
15:58:53.001869 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
    select col_type_cast  from stg.SZ_AH_Properties_CustomFields_Lookup

  
15:58:53.089759 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
15:58:53.106197 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_Pivot"
15:58:53.107124 [debug] [Thread-1  ]: finished collecting timing info
15:58:53.107374 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_Pivot
15:58:53.145439 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_Pivot"
15:58:53.146453 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
15:58:53.146726 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
  
  if object_id ('"dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp"
    end


   EXEC('create view dbo_dbo.SZ_AH_Properties_Pivot__dbt_tmp_temp_view as
    









    

    

 







    
    

 

WITH pivot_data_input AS
(
    SELECT 
        listingid, -- Grouping Column
        customfieldname, -- Spreading Column
        customfieldvalue -- Aggregate Column
    FROM [stg].[SZ_AH_AllProperties_One_Column] 
        -- [TEST] where listingid = 10023682
),
pivoted_data AS
(
    SELECT 
        listingid, [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [CCID], [OdometerUnits], [DealerName], [Mileage], [MagicBoxSection6], [ReserveReviewEmailDate], [LeadSource], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [Taxonomy], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [HasProPhotography], [HideListing], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [Utm_Source_Listing_Submission], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OriginalEngineText], [HasProMarketing], [CarfaxPassFail], [Specialist_Section_Notes], [Era], [IsPaid], [AddressLine2], [PremiumListing], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [NoReserveCheck], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior], [OriginalEngine], [Commission], [MagicBoxSection1], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [VehicleStoryDescriptionExterior2], [VehicleColor], [MaxReserve], [VehicleStoryOpeningStatement], [Year], [IsApproved], [Specialist_Section_Comp4_Info], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [VehicleStoryDescriptionUndercarriagePictures], [Model], [Copy_Writer_Feedback], [BuyItNowUsed], [UserComments], [BuyItNow], [Dealer], [MileageAccurate], [EstimatedMarketValue], [StateProvinceRegion], [Acct_Rep], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [Utm_Campaign_Listing_Submission], [Zip], [Specialist_Section_Comp3_Info], [IsTaxable], [Transmission], [HasMagicBox], [HasDealerFee], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [ReservePrice], [BeenListedText], [VIN], [VehicleStoryDescriptionExteriorPictures], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [SchedulingComplete], [PhotoPlanId], [EngineSize], [Acct_Rep_Name], [WhereDidYouHearAboutUsListingReferral], [CounterReserve], [CurrentIssues], [TransactionId], [MakeOfferAvailable], [VehicleStoryDescriptionEngineTransmission], [Decade], [VehicleStory], [Acct_Rep_Email], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [VehicleTitle], [VehicleStoryDescriptionExterior2Pictures], [CommissionOverrideReason], [VehicleStoryDescriptionInterior2Pictures], [Comped], [Address], [MagicBoxSection5], [FixedPrice], [ListingNotes], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [IsEdited], [AnythingElseWeShouldKnow], [Photo_Plan], [MagicBoxSection3], [ListingProgress], [IsPromoVehicle], [TransmissionText], [ServiceRecords], [MagicBoxSection2], [SpinCarLink], [ExpertVideoReview], [MarketValue], [LastServiceInformation], [IsFeaturedVehicle], [PaintWork], [Specialist], [CityCL], [PaintWorkText], [ReservePriceCL], [CarTitleInYourName], [WhereDidYouHearAboutUsListing], [CountryOfOrigin], [PackageTransactionId], [SnapprPackage], [StartingBid], [MakeOfferAllowed], [CountryCL], [WGL_Public_Report], [HaveAllPhotos], [HowLongOwned], [Specialist_Section_Comp4_Price], [Make], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [DealerFees], [DealerURL], [Utm_Medium_Listing_Submission], [BeenModified]
    FROM pivot_data_input
    PIVOT (
        max(customfieldvalue) for customfieldname in ( [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [CCID], [OdometerUnits], [DealerName], [Mileage], [MagicBoxSection6], [ReserveReviewEmailDate], [LeadSource], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [Taxonomy], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [HasProPhotography], [HideListing], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [Utm_Source_Listing_Submission], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OriginalEngineText], [HasProMarketing], [CarfaxPassFail], [Specialist_Section_Notes], [Era], [IsPaid], [AddressLine2], [PremiumListing], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [NoReserveCheck], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior], [OriginalEngine], [Commission], [MagicBoxSection1], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [VehicleStoryDescriptionExterior2], [VehicleColor], [MaxReserve], [VehicleStoryOpeningStatement], [Year], [IsApproved], [Specialist_Section_Comp4_Info], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [VehicleStoryDescriptionUndercarriagePictures], [Model], [Copy_Writer_Feedback], [BuyItNowUsed], [UserComments], [BuyItNow], [Dealer], [MileageAccurate], [EstimatedMarketValue], [StateProvinceRegion], [Acct_Rep], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [Utm_Campaign_Listing_Submission], [Zip], [Specialist_Section_Comp3_Info], [IsTaxable], [Transmission], [HasMagicBox], [HasDealerFee], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [ReservePrice], [BeenListedText], [VIN], [VehicleStoryDescriptionExteriorPictures], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [SchedulingComplete], [PhotoPlanId], [EngineSize], [Acct_Rep_Name], [WhereDidYouHearAboutUsListingReferral], [CounterReserve], [CurrentIssues], [TransactionId], [MakeOfferAvailable], [VehicleStoryDescriptionEngineTransmission], [Decade], [VehicleStory], [Acct_Rep_Email], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [VehicleTitle], [VehicleStoryDescriptionExterior2Pictures], [CommissionOverrideReason], [VehicleStoryDescriptionInterior2Pictures], [Comped], [Address], [MagicBoxSection5], [FixedPrice], [ListingNotes], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [IsEdited], [AnythingElseWeShouldKnow], [Photo_Plan], [MagicBoxSection3], [ListingProgress], [IsPromoVehicle], [TransmissionText], [ServiceRecords], [MagicBoxSection2], [SpinCarLink], [ExpertVideoReview], [MarketValue], [LastServiceInformation], [IsFeaturedVehicle], [PaintWork], [Specialist], [CityCL], [PaintWorkText], [ReservePriceCL], [CarTitleInYourName], [WhereDidYouHearAboutUsListing], [CountryOfOrigin], [PackageTransactionId], [SnapprPackage], [StartingBid], [MakeOfferAllowed], [CountryCL], [WGL_Public_Report], [HaveAllPhotos], [HowLongOwned], [Specialist_Section_Comp4_Price], [Make], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [DealerFees], [DealerURL], [Utm_Medium_Listing_Submission], [BeenModified])
    )as pvt
)


select 
    listingid, [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [CCID], [OdometerUnits], [DealerName], [Mileage], [MagicBoxSection6], [ReserveReviewEmailDate], [LeadSource], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [Taxonomy], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [HasProPhotography], [HideListing], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [Utm_Source_Listing_Submission], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OriginalEngineText], [HasProMarketing], [CarfaxPassFail], [Specialist_Section_Notes], [Era], [IsPaid], [AddressLine2], [PremiumListing], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [NoReserveCheck], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior], [OriginalEngine], [Commission], [MagicBoxSection1], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [VehicleStoryDescriptionExterior2], [VehicleColor], [MaxReserve], [VehicleStoryOpeningStatement], [Year], [IsApproved], [Specialist_Section_Comp4_Info], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [VehicleStoryDescriptionUndercarriagePictures], [Model], [Copy_Writer_Feedback], [BuyItNowUsed], [UserComments], [BuyItNow], [Dealer], [MileageAccurate], [EstimatedMarketValue], [StateProvinceRegion], [Acct_Rep], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [Utm_Campaign_Listing_Submission], [Zip], [Specialist_Section_Comp3_Info], [IsTaxable], [Transmission], [HasMagicBox], [HasDealerFee], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [ReservePrice], [BeenListedText], [VIN], [VehicleStoryDescriptionExteriorPictures], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [SchedulingComplete], [PhotoPlanId], [EngineSize], [Acct_Rep_Name], [WhereDidYouHearAboutUsListingReferral], [CounterReserve], [CurrentIssues], [TransactionId], [MakeOfferAvailable], [VehicleStoryDescriptionEngineTransmission], [Decade], [VehicleStory], [Acct_Rep_Email], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [VehicleTitle], [VehicleStoryDescriptionExterior2Pictures], [CommissionOverrideReason], [VehicleStoryDescriptionInterior2Pictures], [Comped], [Address], [MagicBoxSection5], [FixedPrice], [ListingNotes], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [IsEdited], [AnythingElseWeShouldKnow], [Photo_Plan], [MagicBoxSection3], [ListingProgress], [IsPromoVehicle], [TransmissionText], [ServiceRecords], [MagicBoxSection2], [SpinCarLink], [ExpertVideoReview], [MarketValue], [LastServiceInformation], [IsFeaturedVehicle], [PaintWork], [Specialist], [CityCL], [PaintWorkText], [ReservePriceCL], [CarTitleInYourName], [WhereDidYouHearAboutUsListing], [CountryOfOrigin], [PackageTransactionId], [SnapprPackage], [StartingBid], [MakeOfferAllowed], [CountryCL], [WGL_Public_Report], [HaveAllPhotos], [HowLongOwned], [Specialist_Section_Comp4_Price], [Make], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [DealerFees], [DealerURL], [Utm_Medium_Listing_Submission], [BeenModified]
from pivoted_data
    ');

  CREATE TABLE "dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.SZ_AH_Properties_Pivot__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"
    end



15:58:57.812311 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.67 seconds
15:58:57.827695 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
15:58:57.828146 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: rename object "dbo_dbo"."SZ_AH_Properties_Pivot" to SZ_AH_Properties_Pivot__dbt_backup
15:58:57.912644 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:58:57.923710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
15:58:57.924134 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: rename object "dbo_dbo"."SZ_AH_Properties_Pivot__dbt_tmp" to SZ_AH_Properties_Pivot
15:58:57.954353 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:58:57.965853 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Pivot: COMMIT
15:58:57.972700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
15:58:57.973132 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
  if object_id ('"dbo_dbo"."SZ_AH_Properties_Pivot__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."SZ_AH_Properties_Pivot__dbt_backup"
    end

15:58:58.348921 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
15:58:58.359308 [debug] [Thread-1  ]: finished collecting timing info
15:58:58.359809 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Pivot: Close
15:58:58.360634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6b702f-866e-4396-b84a-c2cb45d8e82d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a703287c0>]}
15:58:58.361171 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo_dbo.SZ_AH_Properties_Pivot.................... [[32mOK[0m in 5.67s]
15:58:58.361609 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_Pivot
15:58:58.362983 [debug] [MainThread]: Acquiring new synapse connection "master"
15:58:58.363318 [debug] [MainThread]: On master: COMMIT
15:58:58.363721 [info ] [MainThread]: 
15:58:58.364024 [info ] [MainThread]: Finished running 1 table model in 15.84s.
15:58:58.364274 [debug] [MainThread]: Connection 'master' was properly closed.
15:58:58.364417 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_stg' was properly closed.
15:58:58.364552 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:58:58.364681 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_Pivot' was properly closed.
15:58:58.394843 [info ] [MainThread]: 
15:58:58.395341 [info ] [MainThread]: [32mCompleted successfully[0m
15:58:58.395710 [info ] [MainThread]: 
15:58:58.395950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:58:58.396308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a703c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a74e92970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a72e816d0>]}


============================== 2022-09-16 15:59:00.740072 | 9cf9a6bd-961b-492f-81e0-c2eb89432bcb ==============================
15:59:00.740072 [info ] [MainThread]: Running with dbt=1.0.0
15:59:00.744501 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_1_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:59:00.744809 [debug] [MainThread]: Tracking: tracking
15:59:00.745191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a0f4df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a0f4dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a0f4dd30>]}
15:59:00.943028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:59:00.943503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:59:00.969320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cf9a6bd-961b-492f-81e0-c2eb89432bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a0e77cd0>]}
15:59:01.017164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cf9a6bd-961b-492f-81e0-c2eb89432bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a1a0a4c0>]}
15:59:01.017748 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:59:01.025462 [info ] [MainThread]: 
15:59:01.026145 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:01.027210 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:59:01.036289 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:59:01.036571 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:59:01.036738 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:01.036921 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:01.305846 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:01.339576 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.30 seconds
15:59:01.341783 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:59:01.364224 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:59:01.370506 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:59:01.371085 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:59:01.373302 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:59:01.373576 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:01.373757 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:01.373936 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:01.371593 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:01.375347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:59:01.375887 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:01.377205 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:59:01.379220 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:59:01.379445 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:01.379602 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:01.379767 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:01.497239 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:01.506332 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:01.507199 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:01.561465 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:59:01.563601 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:59:01.563918 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:59:01.566215 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:59:01.568099 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:59:01.568355 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:59:01.571008 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:59:01.714287 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:59:01.714818 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:59:11.170129 [debug] [MainThread]: On master: COMMIT
15:59:11.170929 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:59:11.171328 [info ] [MainThread]: 
15:59:11.174357 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Cars_DM
15:59:11.174806 [info ] [Thread-1  ]: 1 of 1 START table model dbo_dbo.AH_Cars_DM..................................... [RUN]
15:59:11.175372 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Cars_DM"
15:59:11.175576 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Cars_DM
15:59:11.175761 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Cars_DM
15:59:11.179259 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Cars_DM"
15:59:11.179892 [debug] [Thread-1  ]: finished collecting timing info
15:59:11.180104 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Cars_DM
15:59:11.218587 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Cars_DM"
15:59:11.219533 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
15:59:11.219781 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
  
  if object_id ('"dbo_dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Cars_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Cars_DM__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Cars_DM__dbt_tmp_temp_view as
    
with DMStg as (
    SELECT
        HASHBYTES(''SHA2_256'',
            CONCAT(
                COALESCE(CAST(lpp.[ListingId] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[VIN] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Year] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Make] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Model] AS VARCHAR(200)), '''')
            )
        ) as [Car_Skey],
		lpp.[ListingId] AS [ListingID],
		lpp.[VIN],
		lpp.[Year],
		lpp.[Make],
		lpp.[Model],
		lpp.[VehicleColor],
		lpp.[EngineSize],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate]
    from dbo.SZ_AH_Properties_Pivot as lpp
    inner join [stg].[AH_Listings_FinalView] as l 
    on lpp.ListingID=l.ID
)
select 
	[ListingID],	
    [Car_Skey],
	[VIN],
	[Year],
	[Make],
	[Model],
	[VehicleColor],
	[EngineSize],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMStg
    ');

  CREATE TABLE "dbo_dbo"."AH_Cars_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Cars_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end



15:59:11.219943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:59:11.220126 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:11.355700 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:13.559767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.34 seconds
15:59:13.573866 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
15:59:13.574269 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo_dbo"."AH_Cars_DM" to AH_Cars_DM__dbt_backup
15:59:13.641340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
15:59:13.653626 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
15:59:13.654036 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo_dbo"."AH_Cars_DM__dbt_tmp" to AH_Cars_DM
15:59:13.685406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:59:13.697033 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: COMMIT
15:59:13.703285 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
15:59:13.703671 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
    
  if object_id ('"dbo_dbo"."AH_Cars_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Cars_DM__dbt_backup"
    end

15:59:13.931101 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
15:59:13.941603 [debug] [Thread-1  ]: finished collecting timing info
15:59:13.942108 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: Close
15:59:13.942956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cf9a6bd-961b-492f-81e0-c2eb89432bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e405dc0>]}
15:59:13.943495 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo_dbo.AH_Cars_DM................................ [[32mOK[0m in 2.77s]
15:59:13.943949 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Cars_DM
15:59:13.945200 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:13.945529 [debug] [MainThread]: On master: COMMIT
15:59:13.945885 [info ] [MainThread]: 
15:59:13.946184 [info ] [MainThread]: Finished running 1 table model in 12.92s.
15:59:13.946427 [debug] [MainThread]: Connection 'master' was properly closed.
15:59:13.946604 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_stg' was properly closed.
15:59:13.946751 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:59:13.946880 [debug] [MainThread]: Connection 'model.Shawn.AH_Cars_DM' was properly closed.
15:59:13.975124 [info ] [MainThread]: 
15:59:13.975585 [info ] [MainThread]: [32mCompleted successfully[0m
15:59:13.975938 [info ] [MainThread]: 
15:59:13.976172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:59:13.976516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a0e7e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e46afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659e46afd0>]}


============================== 2022-09-16 15:59:16.274296 | add5754d-9d13-4e26-aaa0-16a3dc15cd16 ==============================
15:59:16.274296 [info ] [MainThread]: Running with dbt=1.0.0
15:59:16.279348 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_2_FT_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:59:16.279686 [debug] [MainThread]: Tracking: tracking
15:59:16.280176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b087ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b087edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b087ee20>]}
15:59:16.498054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:59:16.498530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:59:16.525332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'add5754d-9d13-4e26-aaa0-16a3dc15cd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b07a7c10>]}
15:59:16.576178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'add5754d-9d13-4e26-aaa0-16a3dc15cd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b01dcaf0>]}
15:59:16.576796 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:59:16.585138 [info ] [MainThread]: 
15:59:16.585938 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:16.587129 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:59:16.596291 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:59:16.596663 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:59:16.596860 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:16.597055 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:16.876803 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:16.910194 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.31 seconds
15:59:16.912491 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:59:16.935837 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:59:16.941901 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:59:16.942532 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:59:16.944870 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:59:16.945104 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:16.945262 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:16.945431 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:16.943030 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:59:16.948170 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:59:16.948729 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:16.948919 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:16.949091 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:16.943283 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:16.950108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:59:16.950305 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:17.051425 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:17.059748 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:17.061340 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:17.122118 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:59:17.124285 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:59:17.124511 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:59:17.126637 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:59:17.125007 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:59:17.127406 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:59:17.129260 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:59:17.273574 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:59:17.274047 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:59:26.812743 [debug] [MainThread]: On master: COMMIT
15:59:26.813511 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:59:26.813898 [info ] [MainThread]: 
15:59:26.817648 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_stg
15:59:26.818101 [info ] [Thread-1  ]: 1 of 1 START table model dbo_stg.AH_Listings_FT_stg............................. [RUN]
15:59:26.818728 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_stg"
15:59:26.818940 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_stg
15:59:26.819134 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_stg
15:59:26.822435 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_stg"
15:59:26.823126 [debug] [Thread-1  ]: finished collecting timing info
15:59:26.823343 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_stg
15:59:26.862345 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_stg"
15:59:26.863280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
15:59:26.863517 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
  
  if object_id ('"dbo_stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_Listings_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_Listings_FT_stg__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Listings_FT_stg__dbt_tmp_temp_view as
    
SELECT
		l.[ID] AS [ListingID],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		lt.[Name] AS [ListingType],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		lp.[VehicleStoryOpeningStatement],
		lp.[VehicleStoryDescriptionCarFax],
		lp.[Acct_Rep_Phone],
		lp.[HasMagicBox],
		lp.[HasDealerFee],
		lp.[VehicleStory],
		lp.[CarfaxPassFailError],
		lp.[LeadSource],
		lp.[VehicleStoryDescriptionInterior2Pictures],
		lp.[Decade],
		lp.[PaintWork],
		lp.[Specialist_Section_Comp2_Info],
		lp.[Curated],
		lp.[VehicleStoryDescriptionUndercarriagePictures],
		lp.[IsFeaturedVehicle],
		lp.[VehicleStoryOpeningStatementPictures],
		lp.[Copy_Writer_Status],
		lp.[FixedPrice],
		lp.[LockUsername],
		lp.[NoReserveCheck],
		lp.[VehicleStoryDescriptionCarFaxPictures],
		lp.[BeenListed],
		lp.[Acct_Rep],
		lp.[MagicBoxSection4],
		lp.[Copy_Writer],
		lp.[Taxonomy],
		lp.[PersonalMileage],
		lp.[Specialist_Section_Comp2_Price],
		lp.[VehicleStoryDescriptionInterior2],
		lp.[VehicleStoryDescriptionUndercarriage],
		lp.[VehicleStoryDescriptionInteriorPictures],
		lp.[Acct_Rep_Name],
		lp.[CarfaxLink],
		lp.[HideListing],
		lp.[CurrentIssues],
		lp.[TargetReserve],
		lp.[TransactionId],
		lp.[Specialist],
		lp.[BuyItNow],
		lp.[VehicleStoryDescriptionEngineTransmission],
		lp.[CountryOfOrigin],
		lp.[CommissionOverrideReason],
		lp.[WhereDidYouHearAboutUsListingReferral],
		lp.[CaliforniaSmogCheck],
		lp.[Modifications],
		lp.[Zip],
		lp.[ListingState],
		lp.[AnythingElseWeShouldKnow],
		lp.[VehicleTitle],
		lp.[Specialist_Section_Notes],
		lp.[VehicleStoryDescriptionExterior2],
		lp.[Photo_Plan],
		lp.[VehicleStoryDescriptionExterior2Pictures],
		lp.[Era],
		lp.[Commission],
		lp.[MakeOfferAvailable],
		lp.[IsEdited],
		lp.[WhereDidYouHearAboutUsListingOther],
		lp.[MagicBoxSection1],
		lp.[VehicleStoryDescriptionExteriorPictures],
		lp.[Specialist_Section_Original_Reserve],
		lp.[Specialist_Section_Comp1_Info],
		lp.[UI_ListingStateHold],
		lp.[AddressLine2],
		lp.[Specialist_Section_Comp5_Price],
		lp.[WGL_Public_Report],
		lp.[PremiumListing],
		lp.[ReservePrice],
		lp.[DealerURL],
		lp.[IsPaid],
		lp.[OriginalEngineText],
		lp.[HasProMarketing],
		lp.[PhotoPlanId],
		lp.[TransmissionText],
		lp.[MakeOfferAllowed],
		lp.[SchedulingComplete],
		lp.[ServiceRecords],
		lp.[CountryCL],
		lp.[OdometerUnits],
		lp.[BuyItNowUsed],
		lp.[MagicBoxSection3],
		lp.[SnapprPackage],
		lp.[CarfaxPassFail],
		lp.[CCID],
		lp.[StateProvinceRegion],
		lp.[DealerName],
		lp.[ListingProgress],
		lp.[StartingBid],
		lp.[EstimatedMarketValue],
		lp.[Mileage],
		lp.[IsPromoVehicle],
		lp.[MagicBoxSection2],
		lp.[SpinCarLink],
		lp.[MagicBoxSection5],
		lp.[Photo_Plan_Status],
		lp.[Address],
		lp.[HaveAllPhotos],
		lp.[MagicBoxSection6],
		lp.[OriginalEngine],
		lp.[VehicleStoryDescriptionInterior],
		lp.[UserComments],
		lp.[CarTitleInYourName],
		lp.[MarketValue],
		lp.[PackageTransactionId],
		lp.[Specialist_Section_Comp1_Price],
		lp.[Rust],
		lp.[MakeWholeAmount],
		lp.[Specialist_Section_Comp3_Price],
		lp.[VehicleStoryDescriptionEngineTransmissionPictures],
		lp.[WhereDidYouHearAboutUsListing],
		lp.[HasProPhotography],
		lp.[IsApproved],
		lp.[ListingNotes],
		lp.[Specialist_Section_Comp4_Info],
		lp.[HowLongOwned],
		lp.[DraftEmailNotificationSent],
		lp.[Copy_Writer_Feedback],
		lp.[ExpertVideoReview],
		lp.[Specialist_Section_Comp5_Info],
		lp.[Comped],
		lp.[BeenListedText],
		lp.[IsTaxable],
		lp.[Transmission],
		lp.[BeenModified],
		lp.[Specialist_Section_Comp3_Info],
		lp.[CityCL],
		lp.[PaintWorkText],
		lp.[Dealer],
		lp.[ReservePriceCL],
		lp.[MileageAccurate],
		lp.[Acct_Rep_Email],
		lp.[LastServiceInformation],
		lp.[DealerFees],
		lp.[Specialist_Section_Comp4_Price],
		lp.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FinalView] l
left join dbo.SZ_AH_Properties_Pivot lp on l.ID=lp.ListingID
left join [stg].[AH_ListingTypes_FinalView] lt on l.ListingTypeID=lt.ID
    ');

  CREATE TABLE "dbo_stg"."AH_Listings_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Listings_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end



15:59:26.863690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:59:26.863870 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:26.971354 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:32.266600 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.40 seconds
15:59:32.283585 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
15:59:32.283946 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "dbo_stg"."AH_Listings_FT_stg" to AH_Listings_FT_stg__dbt_backup
15:59:32.359693 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:59:32.371800 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
15:59:32.372158 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "dbo_stg"."AH_Listings_FT_stg__dbt_tmp" to AH_Listings_FT_stg
15:59:32.403055 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:59:32.413998 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: COMMIT
15:59:32.420162 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
15:59:32.420477 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
    
  if object_id ('"dbo_stg"."AH_Listings_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_Listings_FT_stg__dbt_backup"
    end

15:59:32.873391 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
15:59:32.882687 [debug] [Thread-1  ]: finished collecting timing info
15:59:32.883118 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: Close
15:59:32.883896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'add5754d-9d13-4e26-aaa0-16a3dc15cd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07add3ae50>]}
15:59:32.884433 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo_stg.AH_Listings_FT_stg........................ [[32mOK[0m in 6.07s]
15:59:32.884882 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_stg
15:59:32.886178 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:32.886515 [debug] [MainThread]: On master: COMMIT
15:59:32.886915 [info ] [MainThread]: 
15:59:32.887224 [info ] [MainThread]: Finished running 1 table model in 16.30s.
15:59:32.887474 [debug] [MainThread]: Connection 'master' was properly closed.
15:59:32.887614 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_stg' was properly closed.
15:59:32.887748 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:59:32.887876 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_stg' was properly closed.
15:59:32.915791 [info ] [MainThread]: 
15:59:32.916241 [info ] [MainThread]: [32mCompleted successfully[0m
15:59:32.916587 [info ] [MainThread]: 
15:59:32.916829 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:59:32.917175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b07ad640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07add91e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b08396a0>]}


============================== 2022-09-16 15:59:35.201996 | 05607a4b-b4e8-4e04-9a9a-42d1f45d3b60 ==============================
15:59:35.201996 [info ] [MainThread]: Running with dbt=1.0.0
15:59:35.207055 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_3_FT_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:59:35.207347 [debug] [MainThread]: Tracking: tracking
15:59:35.207712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790937d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790937dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790937e20>]}
15:59:35.408358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:59:35.408837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:59:35.436125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05607a4b-b4e8-4e04-9a9a-42d1f45d3b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f879085fc10>]}
15:59:35.482203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05607a4b-b4e8-4e04-9a9a-42d1f45d3b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790295af0>]}
15:59:35.482780 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:59:35.490318 [info ] [MainThread]: 
15:59:35.491046 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:35.492113 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:59:35.501359 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:59:35.501607 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:59:35.501777 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:35.501956 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:35.810405 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:35.843222 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:59:35.845403 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:59:35.866692 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:59:35.872646 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:59:35.873045 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:59:35.874995 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:59:35.875227 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:35.875387 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:35.875557 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:35.873455 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:35.877117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:59:35.877327 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:35.878589 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:59:35.880377 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:59:35.880591 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:35.880762 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:35.880924 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:35.981486 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:35.986886 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:35.987242 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:36.043659 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:59:36.045415 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:59:36.045647 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:59:36.045908 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:59:36.047624 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
15:59:36.049332 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:59:36.049551 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:59:36.182010 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:59:36.182473 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
15:59:45.537780 [debug] [MainThread]: On master: COMMIT
15:59:45.538571 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
15:59:45.538976 [info ] [MainThread]: 
15:59:45.542617 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_tmp
15:59:45.543033 [info ] [Thread-1  ]: 1 of 1 START table model dbo_stg.AH_Listings_FT_tmp............................. [RUN]
15:59:45.543586 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_tmp"
15:59:45.543793 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_tmp
15:59:45.543986 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_tmp
15:59:45.547226 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_tmp"
15:59:45.547843 [debug] [Thread-1  ]: finished collecting timing info
15:59:45.548044 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_tmp
15:59:45.585418 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_tmp"
15:59:45.586313 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
15:59:45.586587 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
  
  if object_id ('"dbo_stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_stg"."AH_Listings_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "dbo_stg"."AH_Listings_FT_tmp__dbt_tmp"
    end


   EXEC('create view dbo_stg.AH_Listings_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		l.[ListingID],
		condm.[Consignor_SKey],
		cardm.[Car_Skey],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		l.[ListingType],
		l.[CreatedDate],
		l.[UpdatedDate],
		l.[DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		l.[VehicleStoryOpeningStatement],
		l.[VehicleStoryDescriptionCarFax],
		l.[Acct_Rep_Phone],
		l.[HasMagicBox],
		l.[HasDealerFee],
		l.[VehicleStory],
		l.[CarfaxPassFailError],
		l.[LeadSource],
		l.[VehicleStoryDescriptionInterior2Pictures],
		l.[Decade],
		l.[PaintWork],
		l.[Specialist_Section_Comp2_Info],
		l.[Curated],
		l.[VehicleStoryDescriptionUndercarriagePictures],
		l.[IsFeaturedVehicle],
		l.[VehicleStoryOpeningStatementPictures],
		l.[Copy_Writer_Status],
		l.[FixedPrice],
		l.[LockUsername],
		l.[NoReserveCheck],
		l.[VehicleStoryDescriptionCarFaxPictures],
		l.[BeenListed],
		l.[Acct_Rep],
		l.[MagicBoxSection4],
		l.[Copy_Writer],
		l.[Taxonomy],
		l.[PersonalMileage],
		l.[Specialist_Section_Comp2_Price],
		l.[VehicleStoryDescriptionInterior2],
		l.[VehicleStoryDescriptionUndercarriage],
		l.[VehicleStoryDescriptionInteriorPictures],
		l.[Acct_Rep_Name],
		l.[CarfaxLink],
		l.[HideListing],
		l.[CurrentIssues],
		l.[TargetReserve],
		l.[TransactionId],
		l.[Specialist],
		l.[BuyItNow],
		l.[VehicleStoryDescriptionEngineTransmission],
		l.[CountryOfOrigin],
		l.[CommissionOverrideReason],
		l.[WhereDidYouHearAboutUsListingReferral],
		l.[CaliforniaSmogCheck],
		l.[Modifications],
		l.[Zip],
		l.[ListingState],
		l.[AnythingElseWeShouldKnow],
		l.[VehicleTitle],
		l.[Specialist_Section_Notes],
		l.[VehicleStoryDescriptionExterior2],
		l.[Photo_Plan],
		l.[VehicleStoryDescriptionExterior2Pictures],
		l.[Era],
		l.[Commission],
		l.[MakeOfferAvailable],
		l.[IsEdited],
		l.[WhereDidYouHearAboutUsListingOther],
		l.[MagicBoxSection1],
		l.[VehicleStoryDescriptionExteriorPictures],
		l.[Specialist_Section_Original_Reserve],
		l.[Specialist_Section_Comp1_Info],
		l.[UI_ListingStateHold],
		l.[AddressLine2],
		l.[Specialist_Section_Comp5_Price],
		l.[WGL_Public_Report],
		l.[PremiumListing],
		l.[ReservePrice],
		l.[DealerURL],
		l.[IsPaid],
		l.[OriginalEngineText],
		l.[HasProMarketing],
		l.[PhotoPlanId],
		l.[TransmissionText],
		l.[MakeOfferAllowed],
		l.[SchedulingComplete],
		l.[ServiceRecords],
		l.[CountryCL],
		l.[OdometerUnits],
		l.[BuyItNowUsed],
		l.[MagicBoxSection3],
		l.[SnapprPackage],
		l.[CarfaxPassFail],
		l.[CCID],
		l.[StateProvinceRegion],
		l.[DealerName],
		l.[ListingProgress],
		l.[StartingBid],
		l.[EstimatedMarketValue],
		l.[Mileage],
		l.[IsPromoVehicle],
		l.[MagicBoxSection2],
		l.[SpinCarLink],
		l.[MagicBoxSection5],
		l.[Photo_Plan_Status],
		l.[Address],
		l.[HaveAllPhotos],
		l.[MagicBoxSection6],
		l.[OriginalEngine],
		l.[VehicleStoryDescriptionInterior],
		l.[UserComments],
		l.[CarTitleInYourName],
		l.[MarketValue],
		l.[PackageTransactionId],
		l.[Specialist_Section_Comp1_Price],
		l.[Rust],
		l.[MakeWholeAmount],
		l.[Specialist_Section_Comp3_Price],
		l.[VehicleStoryDescriptionEngineTransmissionPictures],
		l.[WhereDidYouHearAboutUsListing],
		l.[HasProPhotography],
		l.[IsApproved],
		l.[ListingNotes],
		l.[Specialist_Section_Comp4_Info],
		l.[HowLongOwned],
		l.[DraftEmailNotificationSent],
		l.[Copy_Writer_Feedback],
		l.[ExpertVideoReview],
		l.[Specialist_Section_Comp5_Info],
		l.[Comped],
		l.[BeenListedText],
		l.[IsTaxable],
		l.[Transmission],
		l.[BeenModified],
		l.[Specialist_Section_Comp3_Info],
		l.[CityCL],
		l.[PaintWorkText],
		l.[Dealer],
		l.[ReservePriceCL],
		l.[MileageAccurate],
		l.[Acct_Rep_Email],
		l.[LastServiceInformation],
		l.[DealerFees],
		l.[Specialist_Section_Comp4_Price],
		l.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FT_stg] l
left join [dbo].[AH_Cars_DM] cardm on l.ListingID=cardm.ListingID
left join [dbo].[AH_Consignors_DM] condm on l.OwnerID=condm.UserID
    ');

  CREATE TABLE "dbo_stg"."AH_Listings_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_stg.AH_Listings_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end



15:59:45.586783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:59:45.586970 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:45.705141 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:49.178266 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.59 seconds
15:59:49.193270 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
15:59:49.193700 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "dbo_stg"."AH_Listings_FT_tmp" to AH_Listings_FT_tmp__dbt_backup
15:59:49.276675 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
15:59:49.290014 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
15:59:49.290450 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "dbo_stg"."AH_Listings_FT_tmp__dbt_tmp" to AH_Listings_FT_tmp
15:59:49.321683 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
15:59:49.333566 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: COMMIT
15:59:49.340351 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
15:59:49.340781 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
    
  if object_id ('"dbo_stg"."AH_Listings_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "dbo_stg"."AH_Listings_FT_tmp__dbt_backup"
    end

15:59:49.615234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
15:59:49.625700 [debug] [Thread-1  ]: finished collecting timing info
15:59:49.626167 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: Close
15:59:49.627005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05607a4b-b4e8-4e04-9a9a-42d1f45d3b60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f878ddfdd00>]}
15:59:49.627540 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo_stg.AH_Listings_FT_tmp........................ [[32mOK[0m in 4.08s]
15:59:49.627989 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_tmp
15:59:49.629307 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:49.629636 [debug] [MainThread]: On master: COMMIT
15:59:49.630007 [info ] [MainThread]: 
15:59:49.630308 [info ] [MainThread]: Finished running 1 table model in 14.14s.
15:59:49.630578 [debug] [MainThread]: Connection 'master' was properly closed.
15:59:49.630734 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_tmp' was properly closed.
15:59:49.630871 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
15:59:49.630999 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_stg' was properly closed.
15:59:49.659115 [info ] [MainThread]: 
15:59:49.659587 [info ] [MainThread]: [32mCompleted successfully[0m
15:59:49.659935 [info ] [MainThread]: 
15:59:49.660176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:59:49.660528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8790866640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87908f18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87908f13a0>]}


============================== 2022-09-16 15:59:51.997411 | 293a4760-8879-4ca3-ab30-3320cb380d1c ==============================
15:59:51.997411 [info ] [MainThread]: Running with dbt=1.0.0
15:59:52.001029 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_4_FT'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
15:59:52.001723 [debug] [MainThread]: Tracking: tracking
15:59:52.002886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdd57c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdd57ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdd57d00>]}
15:59:52.220551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:59:52.221046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:59:52.247621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '293a4760-8879-4ca3-ab30-3320cb380d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdc80af0>]}
15:59:52.297502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '293a4760-8879-4ca3-ab30-3320cb380d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fd6b6eb0>]}
15:59:52.298143 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
15:59:52.306659 [info ] [MainThread]: 
15:59:52.307539 [debug] [MainThread]: Acquiring new synapse connection "master"
15:59:52.308726 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
15:59:52.318096 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
15:59:52.318524 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
15:59:52.318772 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:52.318963 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:52.613225 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:52.662705 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
15:59:52.666620 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
15:59:52.689765 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
15:59:52.697420 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
15:59:52.697910 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
15:59:52.700203 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
15:59:52.700459 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:52.700624 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:52.700800 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:52.698442 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:52.702210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:59:52.702780 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:52.704226 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
15:59:52.707617 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
15:59:52.707931 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
15:59:52.708103 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:59:52.708280 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
15:59:52.815908 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:52.817840 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:52.824491 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
15:59:52.877746 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:59:52.879775 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
15:59:52.881044 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
15:59:52.881323 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
15:59:52.902821 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
15:59:52.905355 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
15:59:52.908319 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
15:59:53.022100 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
15:59:53.022626 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
16:00:02.443043 [debug] [MainThread]: On master: COMMIT
16:00:02.443797 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
16:00:02.444179 [info ] [MainThread]: 
16:00:02.447289 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT
16:00:02.447697 [info ] [Thread-1  ]: 1 of 1 START table model dbo_dbo.AH_Listings_FT................................. [RUN]
16:00:02.448230 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT"
16:00:02.448430 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT
16:00:02.448621 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT
16:00:02.453249 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT"
16:00:02.453887 [debug] [Thread-1  ]: finished collecting timing info
16:00:02.454093 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT
16:00:02.491294 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT"
16:00:02.492189 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
16:00:02.492419 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
  
  if object_id ('"dbo_dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Listings_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listings_FT__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Listings_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
    	FTstg.[ListingID],
		FTtmp.[Consignor_SKey],
		FTtmp.[Car_Skey],
		FTstg.[PrimaryCategoryId],
		FTstg.[CurrencyID],
		FTstg.[ListingTypeID],
		FTstg.[ListingType],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Title],
		FTstg.[OriginalRelistCount],
		FTstg.[Hits],
		FTstg.[EndDTTM],
		FTstg.[StartDTTM],
		FTstg.[Subtitle],
		FTstg.[Location],
		FTstg.[Status],
		FTstg.[CurrentPrice],
		FTstg.[LastUpdatedUser],
		FTstg.[Duration],
		FTstg.[Version],
		FTstg.[Increment],
		FTstg.[OriginalPrice],
		FTstg.[AutoRelistRemaining],
		FTstg.[CurrentQuantity],
		FTstg.[OriginalQuantity],
		FTstg.[RelistIteration],
		FTstg.[PrimaryImageURI],
		FTstg.[AcceptedActionCount],
		FTstg.[OwnerUserName],
		FTstg.[CurrentListingActionId],
		FTstg.[CurrentListingActionUserName],
		FTstg.[OfferCount],
		FTstg.[VehicleStoryOpeningStatement],
		FTstg.[VehicleStoryDescriptionCarFax],
		FTstg.[Acct_Rep_Phone],
		FTstg.[HasMagicBox],
		FTstg.[HasDealerFee],
		FTstg.[VehicleStory],
		FTstg.[CarfaxPassFailError],
		FTstg.[LeadSource],
		FTstg.[VehicleStoryDescriptionInterior2Pictures],
		FTstg.[Decade],
		FTstg.[PaintWork],
		FTstg.[Specialist_Section_Comp2_Info],
		FTstg.[Curated],
		FTstg.[VehicleStoryDescriptionUndercarriagePictures],
		FTstg.[IsFeaturedVehicle],
		FTstg.[VehicleStoryOpeningStatementPictures],
		FTstg.[Copy_Writer_Status],
		FTstg.[FixedPrice],
		FTstg.[LockUsername],
		FTstg.[NoReserveCheck],
		FTstg.[VehicleStoryDescriptionCarFaxPictures],
		FTstg.[BeenListed],
		FTstg.[Acct_Rep],
		FTstg.[MagicBoxSection4],
		FTstg.[Copy_Writer],
		FTstg.[Taxonomy],
		FTstg.[PersonalMileage],
		FTstg.[Specialist_Section_Comp2_Price],
		FTstg.[VehicleStoryDescriptionInterior2],
		FTstg.[VehicleStoryDescriptionUndercarriage],
		FTstg.[VehicleStoryDescriptionInteriorPictures],
		FTstg.[Acct_Rep_Name],
		FTstg.[CarfaxLink],
		FTstg.[HideListing],
		FTstg.[CurrentIssues],
		FTstg.[TargetReserve],
		FTstg.[TransactionId],
		FTstg.[Specialist],
		FTstg.[BuyItNow],
		FTstg.[VehicleStoryDescriptionEngineTransmission],
		FTstg.[CountryOfOrigin],
		FTstg.[CommissionOverrideReason],
		FTstg.[WhereDidYouHearAboutUsListingReferral],
		FTstg.[CaliforniaSmogCheck],
		FTstg.[Modifications],
		FTstg.[Zip],
		FTstg.[ListingState],
		FTstg.[AnythingElseWeShouldKnow],
		FTstg.[VehicleTitle],
		FTstg.[Specialist_Section_Notes],
		FTstg.[VehicleStoryDescriptionExterior2],
		FTstg.[Photo_Plan],
		FTstg.[VehicleStoryDescriptionExterior2Pictures],
		FTstg.[Era],
		FTstg.[Commission],
		FTstg.[MakeOfferAvailable],
		FTstg.[IsEdited],
		FTstg.[WhereDidYouHearAboutUsListingOther],
		FTstg.[MagicBoxSection1],
		FTstg.[VehicleStoryDescriptionExteriorPictures],
		FTstg.[Specialist_Section_Original_Reserve],
		FTstg.[Specialist_Section_Comp1_Info],
		FTstg.[UI_ListingStateHold],
		FTstg.[AddressLine2],
		FTstg.[Specialist_Section_Comp5_Price],
		FTstg.[WGL_Public_Report],
		FTstg.[PremiumListing],
		FTstg.[ReservePrice],
		FTstg.[DealerURL],
		FTstg.[IsPaid],
		FTstg.[OriginalEngineText],
		FTstg.[HasProMarketing],
		FTstg.[PhotoPlanId],
		FTstg.[TransmissionText],
		FTstg.[MakeOfferAllowed],
		FTstg.[SchedulingComplete],
		FTstg.[ServiceRecords],
		FTstg.[CountryCL],
		FTstg.[OdometerUnits],
		FTstg.[BuyItNowUsed],
		FTstg.[MagicBoxSection3],
		FTstg.[SnapprPackage],
		FTstg.[CarfaxPassFail],
		FTstg.[CCID],
		FTstg.[StateProvinceRegion],
		FTstg.[DealerName],
		FTstg.[ListingProgress],
		FTstg.[StartingBid],
		FTstg.[EstimatedMarketValue],
		FTstg.[Mileage],
		FTstg.[IsPromoVehicle],
		FTstg.[MagicBoxSection2],
		FTstg.[SpinCarLink],
		FTstg.[MagicBoxSection5],
		FTstg.[Photo_Plan_Status],
		FTstg.[Address],
		FTstg.[HaveAllPhotos],
		FTstg.[MagicBoxSection6],
		FTstg.[OriginalEngine],
		FTstg.[VehicleStoryDescriptionInterior],
		FTstg.[UserComments],
		FTstg.[CarTitleInYourName],
		FTstg.[MarketValue],
		FTstg.[PackageTransactionId],
		FTstg.[Specialist_Section_Comp1_Price],
		FTstg.[Rust],
		FTstg.[MakeWholeAmount],
		FTstg.[Specialist_Section_Comp3_Price],
		FTstg.[VehicleStoryDescriptionEngineTransmissionPictures],
		FTstg.[WhereDidYouHearAboutUsListing],
		FTstg.[HasProPhotography],
		FTstg.[IsApproved],
		FTstg.[ListingNotes],
		FTstg.[Specialist_Section_Comp4_Info],
		FTstg.[HowLongOwned],
		FTstg.[DraftEmailNotificationSent],
		FTstg.[Copy_Writer_Feedback],
		FTstg.[ExpertVideoReview],
		FTstg.[Specialist_Section_Comp5_Info],
		FTstg.[Comped],
		FTstg.[BeenListedText],
		FTstg.[IsTaxable],
		FTstg.[Transmission],
		FTstg.[BeenModified],
		FTstg.[Specialist_Section_Comp3_Info],
		FTstg.[CityCL],
		FTstg.[PaintWorkText],
		FTstg.[Dealer],
		FTstg.[ReservePriceCL],
		FTstg.[MileageAccurate],
		FTstg.[Acct_Rep_Email],
		FTstg.[LastServiceInformation],
		FTstg.[DealerFees],
		FTstg.[Specialist_Section_Comp4_Price],
		FTstg.[VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp as FTtmp 
    join stg.AH_Listings_FT_stg as FTstg 
    on FTstg.ListingID=FTtmp.ListingID
)
,
insertData as (
    select 
        [ListingID],
        [Consignor_SKey],
        [Car_Skey],
        [PrimaryCategoryId],
        [CurrencyID],
        [ListingTypeID],
        [ListingType],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Title],
        [OriginalRelistCount],
        [Hits],
        [EndDTTM],
        [StartDTTM],
        [Subtitle],
        [Location],
        [Status],
        [CurrentPrice],
        [LastUpdatedUser],
        [Duration],
        [Version],
        [Increment],
        [OriginalPrice],
        [AutoRelistRemaining],
        [CurrentQuantity],
        [OriginalQuantity],
        [RelistIteration],
        [PrimaryImageURI],
        [AcceptedActionCount],
        [OwnerUserName],
        [CurrentListingActionId],
        [CurrentListingActionUserName],
        [OfferCount],
        [VehicleStoryOpeningStatement],
        [VehicleStoryDescriptionCarFax],
        [Acct_Rep_Phone],
        [HasMagicBox],
        [HasDealerFee],
        [VehicleStory],
        [CarfaxPassFailError],
        [LeadSource],
        [VehicleStoryDescriptionInterior2Pictures],
        [Decade],
        [PaintWork],
        [Specialist_Section_Comp2_Info],
        [Curated],
        [VehicleStoryDescriptionUndercarriagePictures],
        [IsFeaturedVehicle],
        [VehicleStoryOpeningStatementPictures],
        [Copy_Writer_Status],
        [FixedPrice],
        [LockUsername],
        [NoReserveCheck],
        [VehicleStoryDescriptionCarFaxPictures],
        [BeenListed],
        [Acct_Rep],
        [MagicBoxSection4],
        [Copy_Writer],
        [Taxonomy],
        [PersonalMileage],
        [Specialist_Section_Comp2_Price],
        [VehicleStoryDescriptionInterior2],
        [VehicleStoryDescriptionUndercarriage],
        [VehicleStoryDescriptionInteriorPictures],
        [Acct_Rep_Name],
        [CarfaxLink],
        [HideListing],
        [CurrentIssues],
        [TargetReserve],
        [TransactionId],
        [Specialist],
        [BuyItNow],
        [VehicleStoryDescriptionEngineTransmission],
        [CountryOfOrigin],
        [CommissionOverrideReason],
        [WhereDidYouHearAboutUsListingReferral],
        [CaliforniaSmogCheck],
        [Modifications],
        [Zip],
        [ListingState],
        [AnythingElseWeShouldKnow],
        [VehicleTitle],
        [Specialist_Section_Notes],
        [VehicleStoryDescriptionExterior2],
        [Photo_Plan],
        [VehicleStoryDescriptionExterior2Pictures],
        [Era],
        [Commission],
        [MakeOfferAvailable],
        [IsEdited],
        [WhereDidYouHearAboutUsListingOther],
        [MagicBoxSection1],
        [VehicleStoryDescriptionExteriorPictures],
        [Specialist_Section_Original_Reserve],
        [Specialist_Section_Comp1_Info],
        [UI_ListingStateHold],
        [AddressLine2],
        [Specialist_Section_Comp5_Price],
        [WGL_Public_Report],
        [PremiumListing],
        [ReservePrice],
        [DealerURL],
        [IsPaid],
        [OriginalEngineText],
        [HasProMarketing],
        [PhotoPlanId],
        [TransmissionText],
        [MakeOfferAllowed],
        [SchedulingComplete],
        [ServiceRecords],
        [CountryCL],
        [OdometerUnits],
        [BuyItNowUsed],
        [MagicBoxSection3],
        [SnapprPackage],
        [CarfaxPassFail],
        [CCID],
        [StateProvinceRegion],
        [DealerName],
        [ListingProgress],
        [StartingBid],
        [EstimatedMarketValue],
        [Mileage],
        [IsPromoVehicle],
        [MagicBoxSection2],
        [SpinCarLink],
        [MagicBoxSection5],
        [Photo_Plan_Status],
        [Address],
        [HaveAllPhotos],
        [MagicBoxSection6],
        [OriginalEngine],
        [VehicleStoryDescriptionInterior],
        [UserComments],
        [CarTitleInYourName],
        [MarketValue],
        [PackageTransactionId],
        [Specialist_Section_Comp1_Price],
        [Rust],
        [MakeWholeAmount],
        [Specialist_Section_Comp3_Price],
        [VehicleStoryDescriptionEngineTransmissionPictures],
        [WhereDidYouHearAboutUsListing],
        [HasProPhotography],
        [IsApproved],
        [ListingNotes],
        [Specialist_Section_Comp4_Info],
        [HowLongOwned],
        [DraftEmailNotificationSent],
        [Copy_Writer_Feedback],
        [ExpertVideoReview],
        [Specialist_Section_Comp5_Info],
        [Comped],
        [BeenListedText],
        [IsTaxable],
        [Transmission],
        [BeenModified],
        [Specialist_Section_Comp3_Info],
        [CityCL],
        [PaintWorkText],
        [Dealer],
        [ReservePriceCL],
        [MileageAccurate],
        [Acct_Rep_Email],
        [LastServiceInformation],
        [DealerFees],
        [Specialist_Section_Comp4_Price],
        [VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp
    where ListingID not in (select  ListingID from stg.AH_Listings_FT_stg)
)
SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from updateData

union all

SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from insertData
    ');

  CREATE TABLE "dbo_dbo"."AH_Listings_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Listings_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end



16:00:02.492628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:00:02.492816 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
16:00:03.731957 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
16:00:09.173376 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.68 seconds
16:00:09.189110 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
16:00:09.189515 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo_dbo"."AH_Listings_FT" to AH_Listings_FT__dbt_backup
16:00:09.346722 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
16:00:09.359259 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
16:00:09.359611 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo_dbo"."AH_Listings_FT__dbt_tmp" to AH_Listings_FT
16:00:09.390733 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
16:00:09.401895 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: COMMIT
16:00:09.407983 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
16:00:09.408295 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
    
  if object_id ('"dbo_dbo"."AH_Listings_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listings_FT__dbt_backup"
    end

16:00:10.197966 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.79 seconds
16:00:10.207993 [debug] [Thread-1  ]: finished collecting timing info
16:00:10.208368 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: Close
16:00:10.209173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '293a4760-8879-4ca3-ab30-3320cb380d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fc222d30>]}
16:00:10.209675 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo_dbo.AH_Listings_FT............................ [[32mOK[0m in 7.76s]
16:00:10.210113 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT
16:00:10.211402 [debug] [MainThread]: Acquiring new synapse connection "master"
16:00:10.211737 [debug] [MainThread]: On master: COMMIT
16:00:10.212108 [info ] [MainThread]: 
16:00:10.212408 [info ] [MainThread]: Finished running 1 table model in 17.90s.
16:00:10.212651 [debug] [MainThread]: Connection 'master' was properly closed.
16:00:10.212788 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo_dbo' was properly closed.
16:00:10.212921 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_stg' was properly closed.
16:00:10.213062 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT' was properly closed.
16:00:10.241247 [info ] [MainThread]: 
16:00:10.241733 [info ] [MainThread]: [32mCompleted successfully[0m
16:00:10.242089 [info ] [MainThread]: 
16:00:10.242333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:00:10.242719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdc883a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdd11520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fdd11790>]}


============================== 2022-09-16 19:49:47.306716 | 43f38e61-f20f-4ac2-ad0e-64ff2ac06456 ==============================
19:49:47.306716 [info ] [MainThread]: Running with dbt=1.0.0
19:49:47.308266 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step4_dboSingle'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
19:49:47.308623 [debug] [MainThread]: Tracking: tracking
19:49:47.309003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31bf74c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31bf74cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31bf74d30>]}
19:49:47.521253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 15 files added, 90 files changed.
19:49:47.523544 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Invoices.sql
19:49:47.523916 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Countries.sql
19:49:47.524147 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_CustomFields.sql
19:49:47.524361 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Userproperties.sql
19:49:47.524572 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_ListingCommentsMedias.sql
19:49:47.524780 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Addresses.sql
19:49:47.524987 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_LineItems.sql
19:49:47.525194 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Mediaassets.sql
19:49:47.525400 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Roles.sql
19:49:47.525607 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Users.sql
19:49:47.525810 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Listingproperties.sql
19:49:47.526018 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_UserRoles.sql
19:49:47.526223 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_MediaMetaData.sql
19:49:47.526423 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Mediavariations.sql
19:49:47.526649 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Media.sql
19:49:47.526956 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Properties.sql
19:49:47.527239 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Offers.sql
19:49:47.527524 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryCustomFields.sql
19:49:47.527789 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserLogins.sql
19:49:47.528052 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryListings.sql
19:49:47.528314 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ReListHistory.sql
19:49:47.528575 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Attributes.sql
19:49:47.528839 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ShippingMethods.sql
19:49:47.529105 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryListingTypes.sql
19:49:47.529366 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PaymentResponses.sql
19:49:47.529631 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
19:49:47.529890 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Currencies.sql
19:49:47.530156 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_BannedUsers.sql
19:49:47.530420 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryCount.sql
19:49:47.530705 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedregionMap.sql
19:49:47.530970 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SubmittedListingPayment.sql
19:49:47.531230 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_LogentriesBuffer.sql
19:49:47.531490 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_KeyTable.sql
19:49:47.531758 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingMedias.sql
19:49:47.532067 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Eventproperties.sql
19:49:47.532346 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Listingdecorations.sql
19:49:47.532613 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PaymentprovIDErs.sql
19:49:47.532874 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_AuctionEventMedias.sql
19:49:47.533143 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Events.sql
19:49:47.533412 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Tiers.sql
19:49:47.533675 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Emailtemplatecontents.sql
19:49:47.533937 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Feeschedules.sql
19:49:47.534199 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingActionproperties.sql
19:49:47.534470 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingActions.sql
19:49:47.534813 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_StripeCustomers.sql
19:49:47.535083 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypes.sql
19:49:47.535348 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Listings.sql
19:49:47.535610 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_States.sql
19:49:47.535887 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SMStemplates.sql
19:49:47.536167 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UnProcessedQueueMessages.sql
19:49:47.536454 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ThReadTracking.sql
19:49:47.536719 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Banners.sql
19:49:47.536982 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Emailtemplates.sql
19:49:47.537243 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCards.sql
19:49:47.537509 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Watches.sql
19:49:47.537775 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Logstats.sql
19:49:47.538039 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Contactus.sql
19:49:47.538302 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingPaymentCharge.sql
19:49:47.538579 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Languages.sql
19:49:47.538857 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Notifications.sql
19:49:47.539125 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Contents.sql
19:49:47.539387 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Customcurrencies.sql
19:49:47.539644 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Locations.sql
19:49:47.539902 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingsReserveHistory.sql
19:49:47.540169 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ShippingOptions.sql
19:49:47.540470 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_NewSalestoInvoice.sql
19:49:47.540745 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Decorations.sql
19:49:47.541009 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_BiddingTransactions.sql
19:49:47.541270 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserMessages.sql
19:49:47.541536 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ExternalUserIDs.sql
19:49:47.541798 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypeproperties.sql
19:49:47.542059 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Reports.sql
19:49:47.542320 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Logentries.sql
19:49:47.542598 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedUserMap.sql
19:49:47.542869 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PaymentConfigurationTable.sql
19:49:47.543142 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingQuestions.sql
19:49:47.543407 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Siteproperties.sql
19:49:47.543666 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserAlerts.sql
19:49:47.543923 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedListingsMap.sql
19:49:47.544203 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Userclaims.sql
19:49:47.544477 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_AuctionEvents.sql
19:49:47.544746 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_MediaassetMetaData.sql
19:49:47.545009 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCardsExtraInFormation.sql
19:49:47.545269 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Feedbacks.sql
19:49:47.545547 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingLocations.sql
19:49:47.545819 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CustomFieldenums.sql
19:49:47.546095 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingComments.sql
19:49:47.546365 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Model.sql
19:49:47.546650 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SalesTaxRates.sql
19:49:47.546921 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingEnddttmAudit.sql
19:49:47.547191 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_BannerCategories.sql
19:49:47.547457 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SysDiagrams.sql
19:49:47.547722 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Increments.sql
19:49:47.548004 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Feeproperties.sql
19:49:47.548267 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedCategoryMap.sql
19:49:47.548571 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
19:49:47.548849 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Propertybags.sql
19:49:47.549116 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PropertybagItems.sql
19:49:47.549380 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SMStemplatecontents.sql
19:49:47.549642 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Lots.sql
19:49:47.549907 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserOptOut.sql
19:49:47.550178 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCardTypes.sql
19:49:47.550445 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Version.sql
19:49:47.550748 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypeMedia.sql
19:49:47.551022 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Categories.sql
19:49:47.563145 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Invoices.sql
19:49:47.577006 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Countries.sql
19:49:47.579556 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFields.sql
19:49:47.581778 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userproperties.sql
19:49:47.583946 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingCommentsMedias.sql
19:49:47.586050 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Addresses.sql
19:49:47.588370 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LineItems.sql
19:49:47.590437 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediaassets.sql
19:49:47.592527 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Roles.sql
19:49:47.594615 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Users.sql
19:49:47.596689 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingproperties.sql
19:49:47.599690 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserRoles.sql
19:49:47.601739 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaMetaData.sql
19:49:47.603824 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediavariations.sql
19:49:47.605883 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Media.sql
19:49:47.607257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31bef3b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31beb99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb31beb9ca0>]}


============================== 2022-09-16 19:51:16.724216 | 36430c4c-bbd0-4e8b-842e-9137413ee482 ==============================
19:51:16.724216 [info ] [MainThread]: Running with dbt=1.0.0
19:51:16.729753 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step4_dboSingle'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
19:51:16.730139 [debug] [MainThread]: Tracking: tracking
19:51:16.730568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d9badd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d9baddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d9bade20>]}
19:51:16.951808 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 15 files added, 90 files changed.
19:51:16.953939 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Mediavariations.sql
19:51:16.954293 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Countries.sql
19:51:16.954522 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Roles.sql
19:51:16.954789 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_UserRoles.sql
19:51:16.955000 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Userproperties.sql
19:51:16.955207 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Invoices.sql
19:51:16.955412 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_LineItems.sql
19:51:16.955618 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Listingproperties.sql
19:51:16.955821 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_CustomFields.sql
19:51:16.956024 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Addresses.sql
19:51:16.956230 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_MediaMetaData.sql
19:51:16.956441 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Media.sql
19:51:16.956644 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Mediaassets.sql
19:51:16.956846 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_ListingCommentsMedias.sql
19:51:16.957049 [debug] [MainThread]: Partial parsing: added file: Shawn://models/step4_dboSingle/AH_Users.sql
19:51:16.957220 [debug] [MainThread]: Partial parsing: deleted file: Shawn://models/step4_dboJoin/AH_Media.sql
19:51:16.957366 [debug] [MainThread]: Partial parsing: deleted file: Shawn://models/step4_dboJoin/AH_Car.sql
19:51:16.957498 [debug] [MainThread]: Partial parsing: deleted file: Shawn://models/step4_dboJoin/AH_MediaAssetMetaData.sql
19:51:16.957641 [debug] [MainThread]: Partial parsing: deleted file: Shawn://models/step4_dboJoin/AH_Customer.sql
19:51:16.957771 [debug] [MainThread]: Partial parsing: deleted file: Shawn://models/step4_dboJoin/AH_Invoice.sql
19:51:16.958060 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserMessages.sql
19:51:16.958341 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SubmittedListingPayment.sql
19:51:16.958660 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ThReadTracking.sql
19:51:16.958947 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_States.sql
19:51:16.959214 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedListingsMap.sql
19:51:16.959478 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_BiddingTransactions.sql
19:51:16.959738 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Events.sql
19:51:16.960009 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_KeyTable.sql
19:51:16.960275 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Propertybags.sql
19:51:16.960544 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CustomFieldenums.sql
19:51:16.960805 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserAlerts.sql
19:51:16.961064 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Listingdecorations.sql
19:51:16.961324 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ShippingOptions.sql
19:51:16.961589 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCardsExtraInFormation.sql
19:51:16.961852 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_BannerCategories.sql
19:51:16.962110 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Increments.sql
19:51:16.962370 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Attributes.sql
19:51:16.962645 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingPaymentCharge.sql
19:51:16.962925 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Languages.sql
19:51:16.963297 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Contactus.sql
19:51:16.963566 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryCustomFields.sql
19:51:16.963827 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Categories.sql
19:51:16.964085 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Offers.sql
19:51:16.964354 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Properties.sql
19:51:16.964625 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Model.sql
19:51:16.964891 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_AuctionEventMedias.sql
19:51:16.965160 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SysDiagrams.sql
19:51:16.965420 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Banners.sql
19:51:16.965686 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserOptOut.sql
19:51:16.965956 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
19:51:16.966219 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Customcurrencies.sql
19:51:16.966496 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PropertybagItems.sql
19:51:16.966796 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_LogentriesBuffer.sql
19:51:16.967064 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_StripeCustomers.sql
19:51:16.967333 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Locations.sql
19:51:16.967595 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Currencies.sql
19:51:16.967858 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypes.sql
19:51:16.968121 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UnProcessedQueueMessages.sql
19:51:16.968392 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Listings.sql
19:51:16.968662 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypeproperties.sql
19:51:16.968929 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PaymentprovIDErs.sql
19:51:16.969192 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Watches.sql
19:51:16.969450 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_AuctionEvents.sql
19:51:16.969706 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Emailtemplatecontents.sql
19:51:16.969974 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_BannedUsers.sql
19:51:16.970239 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Tiers.sql
19:51:16.970502 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ReListHistory.sql
19:51:16.970788 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_NewSalestoInvoice.sql
19:51:16.971051 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ShippingMethods.sql
19:51:16.971346 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingActions.sql
19:51:16.971615 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
19:51:16.971873 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCardTypes.sql
19:51:16.972140 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Reports.sql
19:51:16.972401 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Userclaims.sql
19:51:16.972657 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingsReserveHistory.sql
19:51:16.972922 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingTypeMedia.sql
19:51:16.973184 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingLocations.sql
19:51:16.973443 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedUserMap.sql
19:51:16.973701 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingComments.sql
19:51:16.973959 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Version.sql
19:51:16.974224 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Emailtemplates.sql
19:51:16.974487 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Feeproperties.sql
19:51:16.974770 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SMStemplates.sql
19:51:16.975036 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Decorations.sql
19:51:16.975294 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCards.sql
19:51:16.975579 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryListings.sql
19:51:16.975849 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryCount.sql
19:51:16.976114 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PaymentResponses.sql
19:51:16.976384 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Siteproperties.sql
19:51:16.976654 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SalesTaxRates.sql
19:51:16.976925 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Logstats.sql
19:51:16.977189 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_MediaassetMetaData.sql
19:51:16.977449 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_PaymentConfigurationTable.sql
19:51:16.977711 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingQuestions.sql
19:51:16.977973 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Eventproperties.sql
19:51:16.978232 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Feeschedules.sql
19:51:16.978497 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Notifications.sql
19:51:16.978784 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingActionproperties.sql
19:51:16.979058 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingMedias.sql
19:51:16.979358 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Logentries.sql
19:51:16.979636 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_UserLogins.sql
19:51:16.979911 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ExternalUserIDs.sql
19:51:16.980176 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedCategoryMap.sql
19:51:16.980445 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Contents.sql
19:51:16.980706 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_SMStemplatecontents.sql
19:51:16.980965 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ImportedregionMap.sql
19:51:16.981231 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Lots.sql
19:51:16.981498 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Feedbacks.sql
19:51:16.981765 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_ListingEnddttmAudit.sql
19:51:16.982028 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CategoryListingTypes.sql
19:51:16.993791 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediavariations.sql
19:51:17.007233 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Countries.sql
19:51:17.009700 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Roles.sql
19:51:17.012015 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserRoles.sql
19:51:17.014268 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userproperties.sql
19:51:17.016499 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Invoices.sql
19:51:17.018875 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LineItems.sql
19:51:17.020962 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingproperties.sql
19:51:17.023084 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFields.sql
19:51:17.025184 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Addresses.sql
19:51:17.027324 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaMetaData.sql
19:51:17.029586 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Media.sql
19:51:17.031682 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediaassets.sql
19:51:17.033821 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingCommentsMedias.sql
19:51:17.035918 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Users.sql
19:51:17.037987 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserMessages.sql
19:51:17.040988 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SubmittedListingPayment.sql
19:51:17.043066 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ThReadTracking.sql
19:51:17.045128 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_States.sql
19:51:17.047224 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedListingsMap.sql
19:51:17.049487 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BiddingTransactions.sql
19:51:17.051791 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Events.sql
19:51:17.053839 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_KeyTable.sql
19:51:17.055926 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Propertybags.sql
19:51:17.057965 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFieldenums.sql
19:51:17.060037 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserAlerts.sql
19:51:17.062287 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingdecorations.sql
19:51:17.064356 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingOptions.sql
19:51:17.066413 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardsExtraInFormation.sql
19:51:17.068480 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannerCategories.sql
19:51:17.070503 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Increments.sql
19:51:17.072767 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Attributes.sql
19:51:17.074822 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingPaymentCharge.sql
19:51:17.076876 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Languages.sql
19:51:17.078955 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contactus.sql
19:51:17.081022 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCustomFields.sql
19:51:17.083301 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Categories.sql
19:51:17.085347 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Offers.sql
19:51:17.087400 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Properties.sql
19:51:17.089416 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Model.sql
19:51:17.091502 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEventMedias.sql
19:51:17.093731 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SysDiagrams.sql
19:51:17.095786 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Banners.sql
19:51:17.097833 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserOptOut.sql
19:51:17.099878 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
19:51:17.101963 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Customcurrencies.sql
19:51:17.104214 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PropertybagItems.sql
19:51:17.106247 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LogentriesBuffer.sql
19:51:17.108296 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_StripeCustomers.sql
19:51:17.110310 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Locations.sql
19:51:17.112503 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Currencies.sql
19:51:17.114758 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypes.sql
19:51:17.116793 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UnProcessedQueueMessages.sql
19:51:17.118875 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listings.sql
19:51:17.121188 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeproperties.sql
19:51:17.123426 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentprovIDErs.sql
19:51:17.125680 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Watches.sql
19:51:17.127788 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEvents.sql
19:51:17.129836 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplatecontents.sql
19:51:17.131882 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannedUsers.sql
19:51:17.133950 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
19:51:17.136246 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ReListHistory.sql
19:51:17.138300 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_NewSalestoInvoice.sql
19:51:17.140352 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingMethods.sql
19:51:17.142376 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActions.sql
19:51:17.144440 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
19:51:17.146932 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardTypes.sql
19:51:17.149155 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Reports.sql
19:51:17.151254 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userclaims.sql
19:51:17.153281 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingsReserveHistory.sql
19:51:17.155378 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeMedia.sql
19:51:17.157632 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingLocations.sql
19:51:17.159698 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedUserMap.sql
19:51:17.161717 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingComments.sql
19:51:17.163788 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Version.sql
19:51:17.165830 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplates.sql
19:51:17.168314 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeproperties.sql
19:51:17.170342 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplates.sql
19:51:17.172403 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Decorations.sql
19:51:17.174430 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
19:51:17.176522 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListings.sql
19:51:17.178768 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCount.sql
19:51:17.180806 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentResponses.sql
19:51:17.182864 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Siteproperties.sql
19:51:17.184880 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SalesTaxRates.sql
19:51:17.186941 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logstats.sql
19:51:17.189178 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaassetMetaData.sql
19:51:17.191240 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentConfigurationTable.sql
19:51:17.193251 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingQuestions.sql
19:51:17.195290 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Eventproperties.sql
19:51:17.197345 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeschedules.sql
19:51:17.199608 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Notifications.sql
19:51:17.201651 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActionproperties.sql
19:51:17.203722 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingMedias.sql
19:51:17.205744 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logentries.sql
19:51:17.207840 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserLogins.sql
19:51:17.210077 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ExternalUserIDs.sql
19:51:17.212130 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedCategoryMap.sql
19:51:17.214173 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contents.sql
19:51:17.216225 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplatecontents.sql
19:51:17.218318 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedregionMap.sql
19:51:17.220595 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Lots.sql
19:51:17.222663 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feedbacks.sql
19:51:17.224703 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingEnddttmAudit.sql
19:51:17.226752 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListingTypes.sql
19:51:17.281640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d924f6a0>]}
19:51:17.396376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d9897280>]}
19:51:17.396967 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 211 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:51:17.413957 [info ] [MainThread]: 
19:51:17.415609 [debug] [MainThread]: Acquiring new synapse connection "master"
19:51:17.421572 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
19:51:17.430936 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
19:51:17.431256 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
19:51:17.431434 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:51:17.431639 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:17.772307 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:17.803506 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.37 seconds
19:51:17.805596 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
19:51:17.827908 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
19:51:17.834942 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
19:51:17.835398 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_dbo"
19:51:17.837850 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_dbo".
19:51:17.838005 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
19:51:17.838096 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:51:17.838203 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:17.835889 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
19:51:17.839668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:51:17.839878 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:17.841469 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo_stg"
19:51:17.843528 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo_stg".
19:51:17.843742 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo_stg'
      and table_catalog like 'BJAC_DW_PROD'
  
19:51:17.843896 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:51:17.844058 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:17.944382 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:17.945163 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:17.949719 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:18.004803 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
19:51:18.007181 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: ROLLBACK
19:51:18.007505 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_stg: Close
19:51:18.009354 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
19:51:18.022757 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
19:51:18.025423 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: ROLLBACK
19:51:18.025721 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo_dbo: Close
19:51:18.087286 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
19:51:18.087812 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
19:51:27.701859 [debug] [MainThread]: On master: COMMIT
19:51:27.702706 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
19:51:27.704310 [info ] [MainThread]: 
19:51:27.710524 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Addresses
19:51:27.710935 [info ] [Thread-1  ]: 1 of 105 START table model dbo_dbo.AH_Addresses................................. [RUN]
19:51:27.711267 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Attributes
19:51:27.711481 [info ] [Thread-2  ]: 2 of 105 START table model dbo_dbo.AH_Attributes................................ [RUN]
19:51:27.711663 [debug] [Thread-3  ]: Began running node model.Shawn.AH_AuctionEventMedias
19:51:27.711809 [info ] [Thread-3  ]: 3 of 105 START table model dbo_dbo.AH_AuctionEventMedias........................ [RUN]
19:51:27.711978 [debug] [Thread-4  ]: Began running node model.Shawn.AH_AuctionEvents
19:51:27.712125 [info ] [Thread-4  ]: 4 of 105 START table model dbo_dbo.AH_AuctionEvents............................. [RUN]
19:51:27.713420 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Addresses"
19:51:27.715336 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Addresses
19:51:27.715574 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Addresses
19:51:27.714717 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEvents"
19:51:27.719482 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_AuctionEvents
19:51:27.719603 [debug] [Thread-4  ]: Compiling model.Shawn.AH_AuctionEvents
19:51:27.722315 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEvents"
19:51:27.714081 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Attributes"
19:51:27.722744 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Attributes
19:51:27.722879 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Attributes
19:51:27.725123 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Attributes"
19:51:27.725517 [debug] [Thread-2  ]: finished collecting timing info
19:51:27.725656 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Attributes
19:51:27.714417 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEventMedias"
19:51:27.731862 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_AuctionEventMedias
19:51:27.732022 [debug] [Thread-3  ]: Compiling model.Shawn.AH_AuctionEventMedias
19:51:27.734415 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEventMedias"
19:51:27.719278 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Addresses"
19:51:27.735286 [debug] [Thread-1  ]: finished collecting timing info
19:51:27.735420 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Addresses
19:51:27.734881 [debug] [Thread-4  ]: finished collecting timing info
19:51:27.743901 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_AuctionEvents
19:51:27.762047 [debug] [Thread-3  ]: finished collecting timing info
19:51:27.762336 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_AuctionEventMedias
19:51:27.820906 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Addresses"
19:51:27.831382 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
19:51:27.831605 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
  
  if object_id ('"dbo_dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Addresses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Addresses__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Addresses__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Addresses__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXAddresses],
	cast([DeletedOn] as datetime) [DeletedDate_RWXAddresses],
	cast([CreatedOn] as datetime) [Created_RWXAddresses],
	cast([UserID] as int) [UserID],
	cast([ID] as int) [AddressID],
	cast([CountryID] as int) [CountryID],
	cast([Street1] as varchar(128)) [Street1],
	cast([Street2] as varchar(128)) [Street2],
	cast([City] as nvarchar(100)) [City],
	cast([Stateregion] as nvarchar(50)) [State],
	cast([ZipPostal] as nvarchar(50)) [PostalCode],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXAddresses],
	cast([Description] as nvarchar(4000)) [Description],
	cast([FirstName] as nvarchar(500)) [FirstName],
	cast([LastName] as nvarchar(500)) [LastName] 
From stg.[AH_Addresses_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Addresses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Addresses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Addresses__dbt_tmp_temp_view"
    end



19:51:27.831774 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:51:27.831954 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:27.824811 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Attributes"
19:51:27.830521 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEvents"
19:51:27.833723 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
19:51:27.833919 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
  
  if object_id ('"dbo_dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_AuctionEvents__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_AuctionEvents__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_AuctionEvents__dbt_tmp_temp_view as
    
Select
	cast([SoftclosingGroupIncrementseconds] as int) [SoftclosingGroupIncrementseconds],
	cast([LotCount] as int) [LotCount],
	cast([CategoryID] as int) [CategoryID],
	cast([CurrencyID] as int) [CurrencyID],
	cast([ID] as int) [ID],
	cast([ClosingGroupIncrementseconds] as int) [ClosingGroupIncrementseconds],
	cast([CurrentclosingGroup] as int) [CurrentclosingGroup],
	cast([CurrentSoftclosingGroup] as int) [CurrentSoftclosingGroup],
	cast([CurrentLotOrder] as int) [CurrentLotOrder],
	cast([OwnerID] as int) [OwnerID],
	cast([ProxyBidding] as bit) [ProxyBidding],
	cast([Published] as bit) [Published],
	cast([PreviewLots] as bit) [PreviewLots],
	cast([LotsTaxable] as bit) [LotsTaxable],
	cast([FollowLiveEnabled] as bit) [FollowLiveEnabled],
	cast([BuyersPremiumPercent] as numeric(19,4)) [BuyersPremiumPercent],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Startdttm] as datetime) [Startdttm],
	cast([Enddttm] as datetime) [Enddttm],
	cast([EstimatedLastEnddttm] as datetime) [EstimatedLastEnddttm],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([Timezone] as nvarchar(4000)) [Timezone],
	cast([TermsandConditions] as nvarchar(4000)) [TermsandConditions],
	cast([PrimaryImageURI] as nvarchar(4000)) [PrimaryImageURI],
	cast([Title] as nvarchar(4000)) [Title],
	cast([SecondaryImageURI] as nvarchar(4000)) [SecondaryImageURI],
	cast([OwnerUserName] as nvarchar(4000)) [OwnerUserName],
	cast([ShippingInfo] as nvarchar(4000)) [ShippingInfo],
	cast([SubTitle] as nvarchar(4000)) [SubTitle],
	cast([ManagedByName] as nvarchar(4000)) [ManagedByName] 
From stg.[AH_AuctionEvents_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_AuctionEvents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_AuctionEvents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end



19:51:27.834081 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:51:27.834473 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:27.834342 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
19:51:27.835425 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
  
  if object_id ('"dbo_dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Attributes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Attributes__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Attributes__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Attributes__dbt_tmp_temp_view as
    
Select
	cast([ConText] as nvarchar(4000)) [ConText],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([EditMode] as nvarchar(4000)) [EditMode],
	cast([Type] as nvarchar(4000)) [Type],
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Attributes_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Attributes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Attributes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Attributes__dbt_tmp_temp_view"
    end



19:51:27.835603 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:27.835763 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:27.828335 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEventMedias"
19:51:27.836852 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
19:51:27.837330 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
  
  if object_id ('"dbo_dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_AuctionEventMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_AuctionEventMedias__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_AuctionEventMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([EventID] as int) [EventID] 
From stg.[AH_AuctionEventMedias_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_AuctionEventMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_AuctionEventMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end



19:51:27.837923 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:27.838153 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:27.960603 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:27.963375 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:27.970908 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:27.971397 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:31.070331 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.23 seconds
19:51:31.078283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.25 seconds
19:51:31.166531 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
19:51:31.166862 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: rename object "dbo_dbo"."AH_AuctionEventMedias__dbt_tmp" to AH_AuctionEventMedias
19:51:31.167107 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.33 seconds
19:51:31.178885 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
19:51:31.185607 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: rename object "dbo_dbo"."AH_Attributes__dbt_tmp" to AH_Attributes
19:51:31.185423 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.35 seconds
19:51:31.185211 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
19:51:31.195916 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: rename object "dbo_dbo"."AH_Addresses__dbt_tmp" to AH_Addresses
19:51:31.196476 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
19:51:31.196695 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: rename object "dbo_dbo"."AH_AuctionEvents__dbt_tmp" to AH_AuctionEvents
19:51:31.456041 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
19:51:31.463753 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
19:51:31.470620 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: COMMIT
19:51:31.470862 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
19:51:31.478105 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: COMMIT
19:51:31.471891 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: COMMIT
19:51:31.482185 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
19:51:31.482342 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
    
  if object_id ('"dbo_dbo"."AH_Attributes__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Attributes__dbt_backup"
    end

19:51:31.470949 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
19:51:31.483887 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: COMMIT
19:51:31.485563 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
19:51:31.485706 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
    
  if object_id ('"dbo_dbo"."AH_Addresses__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Addresses__dbt_backup"
    end

19:51:31.476711 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
19:51:31.486135 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
    
  if object_id ('"dbo_dbo"."AH_AuctionEventMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_AuctionEventMedias__dbt_backup"
    end

19:51:31.480126 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
19:51:31.486451 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
    
  if object_id ('"dbo_dbo"."AH_AuctionEvents__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_AuctionEvents__dbt_backup"
    end

19:51:31.523633 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:31.524088 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:31.524226 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:31.524309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:31.537323 [debug] [Thread-2  ]: finished collecting timing info
19:51:31.552452 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: Close
19:51:31.553248 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d57b20>]}
19:51:31.553703 [info ] [Thread-2  ]: 2 of 105 OK created table model dbo_dbo.AH_Attributes........................... [[32mOK[0m in 3.84s]
19:51:31.552090 [debug] [Thread-1  ]: finished collecting timing info
19:51:31.559569 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Attributes
19:51:31.564699 [debug] [Thread-2  ]: Began running node model.Shawn.AH_BannedUsers
19:51:31.564979 [info ] [Thread-2  ]: 5 of 105 START table model dbo_dbo.AH_BannedUsers............................... [RUN]
19:51:31.566532 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_BannedUsers"
19:51:31.566857 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_BannedUsers
19:51:31.567051 [debug] [Thread-2  ]: Compiling model.Shawn.AH_BannedUsers
19:51:31.564460 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: Close
19:51:31.571207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2da5f40>]}
19:51:31.571625 [info ] [Thread-1  ]: 1 of 105 OK created table model dbo_dbo.AH_Addresses............................ [[32mOK[0m in 3.86s]
19:51:31.559334 [debug] [Thread-3  ]: finished collecting timing info
19:51:31.572500 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: Close
19:51:31.573075 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d6c4c0>]}
19:51:31.564001 [debug] [Thread-4  ]: finished collecting timing info
19:51:31.574524 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: Close
19:51:31.574303 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Addresses
19:51:31.575776 [debug] [Thread-1  ]: Began running node model.Shawn.AH_BannerCategories
19:51:31.576246 [info ] [Thread-1  ]: 6 of 105 START table model dbo_dbo.AH_BannerCategories.......................... [RUN]
19:51:31.574100 [info ] [Thread-3  ]: 3 of 105 OK created table model dbo_dbo.AH_AuctionEventMedias................... [[32mOK[0m in 3.86s]
19:51:31.577500 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_BannerCategories"
19:51:31.578745 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_BannerCategories
19:51:31.578939 [debug] [Thread-1  ]: Compiling model.Shawn.AH_BannerCategories
19:51:31.575477 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d57160>]}
19:51:31.582945 [info ] [Thread-4  ]: 4 of 105 OK created table model dbo_dbo.AH_AuctionEvents........................ [[32mOK[0m in 3.86s]
19:51:31.578520 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_AuctionEventMedias
19:51:31.583377 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Banners
19:51:31.583594 [info ] [Thread-3  ]: 7 of 105 START table model dbo_dbo.AH_Banners................................... [RUN]
19:51:31.570421 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_BannedUsers"
19:51:31.584722 [debug] [Thread-2  ]: finished collecting timing info
19:51:31.584869 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_BannedUsers
19:51:31.582450 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_BannerCategories"
19:51:31.592939 [debug] [Thread-1  ]: finished collecting timing info
19:51:31.593189 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_BannerCategories
19:51:31.599976 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_AuctionEvents
19:51:31.600297 [debug] [Thread-4  ]: Began running node model.Shawn.AH_BiddingTransactions
19:51:31.600513 [info ] [Thread-4  ]: 8 of 105 START table model dbo_dbo.AH_BiddingTransactions....................... [RUN]
19:51:31.603020 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_BiddingTransactions"
19:51:31.603527 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Banners"
19:51:31.604295 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Banners
19:51:31.604416 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Banners
19:51:31.604122 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_BiddingTransactions
19:51:31.608492 [debug] [Thread-4  ]: Compiling model.Shawn.AH_BiddingTransactions
19:51:31.611338 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_BiddingTransactions"
19:51:31.620801 [debug] [Thread-4  ]: finished collecting timing info
19:51:31.620961 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_BiddingTransactions
19:51:31.608247 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Banners"
19:51:31.628105 [debug] [Thread-3  ]: finished collecting timing info
19:51:31.628287 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Banners
19:51:31.616653 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_BannerCategories"
19:51:31.620355 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_BannedUsers"
19:51:31.631141 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
19:51:31.631258 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
  
  if object_id ('"dbo_dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_BannedUsers__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_BannedUsers__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_BannedUsers__dbt_tmp_temp_view as
    
Select
	cast([Lastip] as nvarchar(4000)) [Lastip],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([FName] as nvarchar(4000)) [FName],
	cast([LName] as nvarchar(4000)) [LName],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID] 
From stg.[AH_BannedUsers_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_BannedUsers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_BannedUsers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end



19:51:31.631349 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:31.631466 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:31.630842 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
19:51:31.632739 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
  
  if object_id ('"dbo_dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_BannerCategories__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_BannerCategories__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_BannerCategories__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([BannerID] as int) [BannerID],
	cast([CategoryID] as int) [CategoryID] 
From stg.[AH_BannerCategories_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_BannerCategories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_BannerCategories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end



19:51:31.632879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:51:31.632990 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:31.637178 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_BiddingTransactions"
19:51:31.646089 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
19:51:31.646239 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
  
  if object_id ('"dbo_dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_BiddingTransactions__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_BiddingTransactions__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_BiddingTransactions__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionID],
	cast([Maxmindscore] as decimal(5,2)) [MaxMindScore],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ID] as int) [ID],
	cast([ListingActionID] as int) [ListingActionID],
	cast([CreditCardID] as int) [CreditCardID],
	cast([Active] as bit) [IsActive] 
From stg.[AH_BiddingTransactions_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_BiddingTransactions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_BiddingTransactions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end



19:51:31.646330 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:31.646436 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:31.645545 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Banners"
19:51:31.648643 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
19:51:31.648880 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
  
  if object_id ('"dbo_dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Banners__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Banners__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Banners__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Banners__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([LinkURI] as nvarchar(4000)) [LinkURI],
	cast([BannerLocation] as nvarchar(4000)) [BannerLocation] 
From stg.[AH_Banners_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Banners__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Banners__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Banners__dbt_tmp_temp_view"
    end



19:51:31.649051 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:31.649228 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:31.749253 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:31.749740 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:31.761280 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:31.764274 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:34.303122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.67 seconds
19:51:34.315981 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
19:51:34.316412 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: rename object "dbo_dbo"."AH_BannedUsers__dbt_tmp" to AH_BannedUsers
19:51:34.351246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:34.353358 [debug] [Thread-2  ]: On model.Shawn.AH_BannedUsers: COMMIT
19:51:34.355656 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
19:51:34.355928 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
    
  if object_id ('"dbo_dbo"."AH_BannedUsers__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_BannedUsers__dbt_backup"
    end

19:51:34.394293 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:34.404592 [debug] [Thread-2  ]: finished collecting timing info
19:51:34.405084 [debug] [Thread-2  ]: On model.Shawn.AH_BannedUsers: Close
19:51:34.405941 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c8c2e0>]}
19:51:34.406617 [info ] [Thread-2  ]: 5 of 105 OK created table model dbo_dbo.AH_BannedUsers.......................... [[32mOK[0m in 2.84s]
19:51:34.408215 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_BannedUsers
19:51:34.408505 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Categories
19:51:34.408986 [info ] [Thread-2  ]: 9 of 105 START table model dbo_dbo.AH_Categories................................ [RUN]
19:51:34.409917 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Categories"
19:51:34.410129 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Categories
19:51:34.410306 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Categories
19:51:34.413914 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Categories"
19:51:34.414461 [debug] [Thread-2  ]: finished collecting timing info
19:51:34.414706 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Categories
19:51:34.425055 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Categories"
19:51:34.425796 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
19:51:34.426031 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
  
  if object_id ('"dbo_dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Categories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Categories__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Categories__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Categories__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [PrimaryCategoryID],
	cast([ParentCategoryID] as int) [ParentCategoryID],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Lft] as int) [lft],
	cast([Rgt] as int) [rgt],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([RolesAllowed] as nvarchar(100)) [RolesAllowed],
	cast([EnabledCustomProperty] as nvarchar(100)) [EnabledCustomProperty],
	cast([MetaKeyWords] as nvarchar(4000)) [MetaKeyWords],
	cast([MetaDescription] as nvarchar(4000)) [MetaDescription],
	cast([PageTitle] as nvarchar(4000)) [PageTitle],
	cast([Pagecontent] as nvarchar(4000)) [Pagecontent],
	cast([Name] as nvarchar(500)) [Name],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Type] as nvarchar(50)) [Type],
	cast([MvcAction] as nvarchar(100)) [MVCAction] 
From stg.[AH_Categories_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Categories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Categories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Categories__dbt_tmp_temp_view"
    end



19:51:34.426201 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:34.426394 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:34.475506 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.83 seconds
19:51:34.488940 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
19:51:34.489520 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Banners: rename object "dbo_dbo"."AH_Banners__dbt_tmp" to AH_Banners
19:51:34.526330 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:34.528367 [debug] [Thread-3  ]: On model.Shawn.AH_Banners: COMMIT
19:51:34.530594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
19:51:34.530886 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
    
  if object_id ('"dbo_dbo"."AH_Banners__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Banners__dbt_backup"
    end

19:51:34.536330 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.90 seconds
19:51:34.546579 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:34.548766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
19:51:34.549092 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: rename object "dbo_dbo"."AH_BannerCategories__dbt_tmp" to AH_BannerCategories
19:51:34.605835 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:51:34.616350 [debug] [Thread-3  ]: finished collecting timing info
19:51:34.616860 [debug] [Thread-3  ]: On model.Shawn.AH_Banners: Close
19:51:34.617710 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0cbb370>]}
19:51:34.618246 [info ] [Thread-3  ]: 7 of 105 OK created table model dbo_dbo.AH_Banners.............................. [[32mOK[0m in 3.01s]
19:51:34.619414 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Banners
19:51:34.619703 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CategoryCount
19:51:34.620186 [info ] [Thread-3  ]: 10 of 105 START table model dbo_dbo.AH_CategoryCount............................ [RUN]
19:51:34.621616 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCount"
19:51:34.621833 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CategoryCount
19:51:34.622014 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CategoryCount
19:51:34.626850 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCount"
19:51:34.627495 [debug] [Thread-3  ]: finished collecting timing info
19:51:34.627717 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CategoryCount
19:51:34.634400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
19:51:34.636041 [debug] [Thread-1  ]: On model.Shawn.AH_BannerCategories: COMMIT
19:51:34.639627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
19:51:34.639966 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
    
  if object_id ('"dbo_dbo"."AH_BannerCategories__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_BannerCategories__dbt_backup"
    end

19:51:34.644245 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCount"
19:51:34.644449 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.00 seconds
19:51:34.655212 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
19:51:34.655673 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
19:51:34.656204 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
  
  if object_id ('"dbo_dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CategoryCount__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryCount__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CategoryCount__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Count] as int) [Count],
	cast([CategoryID] as int) [CategoryID] 
From stg.[AH_CategoryCount_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CategoryCount__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CategoryCount__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end



19:51:34.656297 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:34.656410 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:34.656071 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: rename object "dbo_dbo"."AH_BiddingTransactions__dbt_tmp" to AH_BiddingTransactions
19:51:34.675839 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:34.689670 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:34.691413 [debug] [Thread-4  ]: On model.Shawn.AH_BiddingTransactions: COMMIT
19:51:34.693217 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
19:51:34.693387 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
    
  if object_id ('"dbo_dbo"."AH_BiddingTransactions__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_BiddingTransactions__dbt_backup"
    end

19:51:34.693812 [debug] [Thread-1  ]: finished collecting timing info
19:51:34.694052 [debug] [Thread-1  ]: On model.Shawn.AH_BannerCategories: Close
19:51:34.695689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfa130>]}
19:51:34.696249 [info ] [Thread-1  ]: 6 of 105 OK created table model dbo_dbo.AH_BannerCategories..................... [[32mOK[0m in 3.12s]
19:51:34.697367 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_BannerCategories
19:51:34.697644 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CategoryCustomFields
19:51:34.698129 [info ] [Thread-1  ]: 11 of 105 START table model dbo_dbo.AH_CategoryCustomFields..................... [RUN]
19:51:34.699593 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCustomFields"
19:51:34.699827 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CategoryCustomFields
19:51:34.700013 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CategoryCustomFields
19:51:34.703661 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCustomFields"
19:51:34.704242 [debug] [Thread-1  ]: finished collecting timing info
19:51:34.704449 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CategoryCustomFields
19:51:34.714880 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCustomFields"
19:51:34.715648 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
19:51:34.715874 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
  
  if object_id ('"dbo_dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CategoryCustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryCustomFields__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CategoryCustomFields__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([CategoryID] as int) [CategoryID],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryCustomFields_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CategoryCustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CategoryCustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end



19:51:34.716036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:51:34.716219 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:34.728793 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:34.745776 [debug] [Thread-4  ]: finished collecting timing info
19:51:34.747440 [debug] [Thread-4  ]: On model.Shawn.AH_BiddingTransactions: Close
19:51:34.748864 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c3ecd0>]}
19:51:34.749884 [info ] [Thread-4  ]: 8 of 105 OK created table model dbo_dbo.AH_BiddingTransactions.................. [[32mOK[0m in 3.15s]
19:51:34.751170 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_BiddingTransactions
19:51:34.751477 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CategoryListingTypes
19:51:34.752013 [info ] [Thread-4  ]: 12 of 105 START table model dbo_dbo.AH_CategoryListingTypes..................... [RUN]
19:51:34.753639 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListingTypes"
19:51:34.754250 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CategoryListingTypes
19:51:34.755179 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CategoryListingTypes
19:51:34.763472 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListingTypes"
19:51:34.764157 [debug] [Thread-4  ]: finished collecting timing info
19:51:34.764407 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CategoryListingTypes
19:51:34.780969 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListingTypes"
19:51:34.782330 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
19:51:34.782706 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
  
  if object_id ('"dbo_dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CategoryListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryListingTypes__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CategoryListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CategoryID] as int) [CategoryID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryListingTypes_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CategoryListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CategoryListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end



19:51:34.782901 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:34.783092 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:34.784732 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:34.834492 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:34.887204 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:36.552357 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
19:51:36.564111 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
19:51:36.564541 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: rename object "dbo_dbo"."AH_Categories__dbt_tmp" to AH_Categories
19:51:36.601178 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:36.603343 [debug] [Thread-2  ]: On model.Shawn.AH_Categories: COMMIT
19:51:36.605619 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
19:51:36.605889 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
    
  if object_id ('"dbo_dbo"."AH_Categories__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Categories__dbt_backup"
    end

19:51:36.641245 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:36.652290 [debug] [Thread-2  ]: finished collecting timing info
19:51:36.652784 [debug] [Thread-2  ]: On model.Shawn.AH_Categories: Close
19:51:36.653629 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfa6a0>]}
19:51:36.654143 [info ] [Thread-2  ]: 9 of 105 OK created table model dbo_dbo.AH_Categories........................... [[32mOK[0m in 2.24s]
19:51:36.655356 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Categories
19:51:36.655631 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CategoryListings
19:51:36.656096 [info ] [Thread-2  ]: 13 of 105 START table model dbo_dbo.AH_CategoryListings......................... [RUN]
19:51:36.657427 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListings"
19:51:36.657641 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CategoryListings
19:51:36.657828 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CategoryListings
19:51:36.661215 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListings"
19:51:36.661720 [debug] [Thread-2  ]: finished collecting timing info
19:51:36.661910 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CategoryListings
19:51:36.671154 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListings"
19:51:36.671890 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
19:51:36.672116 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
  
  if object_id ('"dbo_dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CategoryListings__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryListings__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CategoryListings__dbt_tmp_temp_view as
    
Select
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([CategoryID] as int) [CategoryID] 
From stg.[AH_CategoryListings_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CategoryListings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CategoryListings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end



19:51:36.672280 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:36.672456 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:36.775941 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:37.288675 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.63 seconds
19:51:37.300928 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
19:51:37.301355 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: rename object "dbo_dbo"."AH_CategoryCount__dbt_tmp" to AH_CategoryCount
19:51:37.333045 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:37.335179 [debug] [Thread-3  ]: On model.Shawn.AH_CategoryCount: COMMIT
19:51:37.337445 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
19:51:37.337732 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
    
  if object_id ('"dbo_dbo"."AH_CategoryCount__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryCount__dbt_backup"
    end

19:51:37.382878 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:37.393221 [debug] [Thread-3  ]: finished collecting timing info
19:51:37.393730 [debug] [Thread-3  ]: On model.Shawn.AH_CategoryCount: Close
19:51:37.394634 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfaa30>]}
19:51:37.395147 [info ] [Thread-3  ]: 10 of 105 OK created table model dbo_dbo.AH_CategoryCount....................... [[32mOK[0m in 2.77s]
19:51:37.396302 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CategoryCount
19:51:37.396598 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Contactus
19:51:37.397110 [info ] [Thread-3  ]: 14 of 105 START table model dbo_dbo.AH_Contactus................................ [RUN]
19:51:37.398517 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Contactus"
19:51:37.398760 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Contactus
19:51:37.398939 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Contactus
19:51:37.402489 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Contactus"
19:51:37.403063 [debug] [Thread-3  ]: finished collecting timing info
19:51:37.403263 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Contactus
19:51:37.412791 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Contactus"
19:51:37.413549 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
19:51:37.413775 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
  
  if object_id ('"dbo_dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Contactus__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Contactus__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Contactus__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Contactus__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([ID] as int) [ID] 
From stg.[AH_Contactus_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Contactus__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Contactus__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Contactus__dbt_tmp_temp_view"
    end



19:51:37.413935 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:37.414108 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:37.518831 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:38.054485 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.27 seconds
19:51:38.066789 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
19:51:38.067217 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: rename object "dbo_dbo"."AH_CategoryListingTypes__dbt_tmp" to AH_CategoryListingTypes
19:51:38.099105 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:38.101197 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryListingTypes: COMMIT
19:51:38.103518 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
19:51:38.103807 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
    
  if object_id ('"dbo_dbo"."AH_CategoryListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryListingTypes__dbt_backup"
    end

19:51:38.151641 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:38.161757 [debug] [Thread-4  ]: finished collecting timing info
19:51:38.162224 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryListingTypes: Close
19:51:38.163080 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfaa90>]}
19:51:38.163629 [info ] [Thread-4  ]: 12 of 105 OK created table model dbo_dbo.AH_CategoryListingTypes................ [[32mOK[0m in 3.41s]
19:51:38.164768 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CategoryListingTypes
19:51:38.165049 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Contents
19:51:38.165530 [info ] [Thread-4  ]: 15 of 105 START table model dbo_dbo.AH_Contents................................. [RUN]
19:51:38.166951 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Contents"
19:51:38.167164 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Contents
19:51:38.167344 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Contents
19:51:38.170787 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Contents"
19:51:38.171308 [debug] [Thread-4  ]: finished collecting timing info
19:51:38.171502 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Contents
19:51:38.181061 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Contents"
19:51:38.181786 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
19:51:38.182021 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
  
  if object_id ('"dbo_dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Contents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Contents__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Contents__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Contents__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Usehtmleditor] as bit) [Usehtmleditor],
	cast([Userdefined] as bit) [Userdefined],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Text] as nvarchar(4000)) [Text],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([PageTitle] as nvarchar(4000)) [PageTitle] 
From stg.[AH_Contents_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Contents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Contents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Contents__dbt_tmp_temp_view"
    end



19:51:38.182176 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:38.182353 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:38.308109 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:41.095480 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.68 seconds
19:51:41.107262 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
19:51:41.107678 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contactus: rename object "dbo_dbo"."AH_Contactus__dbt_tmp" to AH_Contactus
19:51:41.149053 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.48 seconds
19:51:41.160951 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
19:51:41.161355 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: rename object "dbo_dbo"."AH_CategoryListings__dbt_tmp" to AH_CategoryListings
19:51:41.174685 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:51:41.176508 [debug] [Thread-3  ]: On model.Shawn.AH_Contactus: COMMIT
19:51:41.178286 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
19:51:41.178438 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
    
  if object_id ('"dbo_dbo"."AH_Contactus__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Contactus__dbt_backup"
    end

19:51:41.192271 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:41.193953 [debug] [Thread-2  ]: On model.Shawn.AH_CategoryListings: COMMIT
19:51:41.195995 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
19:51:41.196237 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
    
  if object_id ('"dbo_dbo"."AH_CategoryListings__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryListings__dbt_backup"
    end

19:51:41.214302 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:41.224154 [debug] [Thread-3  ]: finished collecting timing info
19:51:41.224562 [debug] [Thread-3  ]: On model.Shawn.AH_Contactus: Close
19:51:41.225321 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfad30>]}
19:51:41.225844 [info ] [Thread-3  ]: 14 of 105 OK created table model dbo_dbo.AH_Contactus........................... [[32mOK[0m in 3.83s]
19:51:41.227444 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Contactus
19:51:41.227723 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Countries
19:51:41.228198 [info ] [Thread-3  ]: 16 of 105 START table model dbo_dbo.AH_Countries................................ [RUN]
19:51:41.229399 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Countries"
19:51:41.229610 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Countries
19:51:41.229789 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Countries
19:51:41.233316 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Countries"
19:51:41.233476 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:41.242250 [debug] [Thread-2  ]: finished collecting timing info
19:51:41.242528 [debug] [Thread-3  ]: finished collecting timing info
19:51:41.242992 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Countries
19:51:41.242852 [debug] [Thread-2  ]: On model.Shawn.AH_CategoryListings: Close
19:51:41.252296 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfabe0>]}
19:51:41.252667 [info ] [Thread-2  ]: 13 of 105 OK created table model dbo_dbo.AH_CategoryListings.................... [[32mOK[0m in 4.60s]
19:51:41.253666 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CategoryListings
19:51:41.253935 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CreditCardTypes
19:51:41.254367 [info ] [Thread-2  ]: 17 of 105 START table model dbo_dbo.AH_CreditCardTypes.......................... [RUN]
19:51:41.256094 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardTypes"
19:51:41.256308 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CreditCardTypes
19:51:41.256484 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CreditCardTypes
19:51:41.259934 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardTypes"
19:51:41.260074 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Countries"
19:51:41.260523 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
19:51:41.260646 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
  
  if object_id ('"dbo_dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Countries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Countries__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Countries__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Countries__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Country],
	cast([Code] as char(5)) [Code],
	cast([CreatedOn] as datetime) [Created_RWXCountries],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXCountries],
	cast([DeletedOn] as datetime) [DeletedDate_RWXCountries],
	cast([ID] as int) [CountryID],
	cast([Enabled] as bit) [IsEnabled],
	cast([StateRequired] as bit) [IsStateRequired] 
From stg.[AH_Countries_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Countries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Countries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Countries__dbt_tmp_temp_view"
    end



19:51:41.260736 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:41.260850 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:41.262429 [debug] [Thread-2  ]: finished collecting timing info
19:51:41.262671 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CreditCardTypes
19:51:41.357365 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardTypes"
19:51:41.358159 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
19:51:41.358398 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
  
  if object_id ('"dbo_dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CreditCardTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CreditCardTypes__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CreditCardTypes__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_CreditCardTypes_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CreditCardTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CreditCardTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end



19:51:41.358583 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:41.358780 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:41.375277 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:41.454326 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.27 seconds
19:51:41.465814 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
19:51:41.466072 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:41.466349 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Contents: rename object "dbo_dbo"."AH_Contents__dbt_tmp" to AH_Contents
19:51:41.498957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:41.501020 [debug] [Thread-4  ]: On model.Shawn.AH_Contents: COMMIT
19:51:41.503266 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
19:51:41.503523 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
    
  if object_id ('"dbo_dbo"."AH_Contents__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Contents__dbt_backup"
    end

19:51:41.539287 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:41.548756 [debug] [Thread-4  ]: finished collecting timing info
19:51:41.549211 [debug] [Thread-4  ]: On model.Shawn.AH_Contents: Close
19:51:41.549996 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd10a0>]}
19:51:41.550514 [info ] [Thread-4  ]: 15 of 105 OK created table model dbo_dbo.AH_Contents............................ [[32mOK[0m in 3.38s]
19:51:41.551676 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Contents
19:51:41.551949 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CreditCards
19:51:41.552409 [info ] [Thread-4  ]: 18 of 105 START table model dbo_dbo.AH_CreditCards.............................. [RUN]
19:51:41.553652 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards"
19:51:41.553866 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CreditCards
19:51:41.554047 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CreditCards
19:51:41.557204 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards"
19:51:41.557869 [debug] [Thread-4  ]: finished collecting timing info
19:51:41.558064 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CreditCards
19:51:41.567210 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards"
19:51:41.567853 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
19:51:41.568060 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
  
  if object_id ('"dbo_dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CreditCards__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CreditCards__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CreditCards__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([ExpirationMonth] as int) [ExpirationMonth],
	cast([ExpirationYear] as int) [ExpirationYear],
	cast([CreditCardTypeID] as int) [CreditCardTypeID],
	cast([UserID] as int) [UserID],
	cast([AddressID] as int) [AddressID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CardNumber] as nvarchar(4000)) [CardNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([LastFourdigits] as nvarchar(4000)) [LastFourdigits],
	cast([Description] as nvarchar(4000)) [Description] 
From stg.[AH_CreditCards_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CreditCards__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CreditCards__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end



19:51:41.568216 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:41.568391 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:41.666659 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:43.614344 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.35 seconds
19:51:43.624685 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
19:51:43.625057 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Countries: rename object "dbo_dbo"."AH_Countries__dbt_tmp" to AH_Countries
19:51:43.664761 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:43.666913 [debug] [Thread-3  ]: On model.Shawn.AH_Countries: COMMIT
19:51:43.669134 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
19:51:43.669406 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
    
  if object_id ('"dbo_dbo"."AH_Countries__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Countries__dbt_backup"
    end

19:51:43.709897 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:43.722385 [debug] [Thread-3  ]: finished collecting timing info
19:51:43.722877 [debug] [Thread-3  ]: On model.Shawn.AH_Countries: Close
19:51:43.723705 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd12b0>]}
19:51:43.725919 [info ] [Thread-3  ]: 16 of 105 OK created table model dbo_dbo.AH_Countries........................... [[32mOK[0m in 2.49s]
19:51:43.727529 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Countries
19:51:43.727845 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CreditCardsExtraInFormation
19:51:43.728325 [info ] [Thread-3  ]: 19 of 105 START table model dbo_dbo.AH_CreditCardsExtraInFormation.............. [RUN]
19:51:43.729694 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardsExtraInFormation"
19:51:43.729908 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CreditCardsExtraInFormation
19:51:43.730089 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CreditCardsExtraInFormation
19:51:43.735475 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
19:51:43.739059 [debug] [Thread-3  ]: finished collecting timing info
19:51:43.739294 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CreditCardsExtraInFormation
19:51:43.755534 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
19:51:43.757621 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
19:51:43.757841 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
  
  if object_id ('"dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view as
    
Select
	cast([Cvv] as nvarchar(4000)) [Cvv],
	cast([ID] as int) [ID],
	cast([CreditCardID] as int) [CreditCardID] 
From stg.[AH_CreditCardsExtraInFormation_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end



19:51:43.757999 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:43.758178 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:43.829200 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
19:51:43.842695 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
19:51:43.843082 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: rename object "dbo_dbo"."AH_CreditCardTypes__dbt_tmp" to AH_CreditCardTypes
19:51:43.865861 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:43.877579 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:43.879577 [debug] [Thread-2  ]: On model.Shawn.AH_CreditCardTypes: COMMIT
19:51:43.881773 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
19:51:43.882031 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
    
  if object_id ('"dbo_dbo"."AH_CreditCardTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CreditCardTypes__dbt_backup"
    end

19:51:43.928894 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:43.939285 [debug] [Thread-2  ]: finished collecting timing info
19:51:43.939754 [debug] [Thread-2  ]: On model.Shawn.AH_CreditCardTypes: Close
19:51:43.940554 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd1160>]}
19:51:43.941104 [info ] [Thread-2  ]: 17 of 105 OK created table model dbo_dbo.AH_CreditCardTypes..................... [[32mOK[0m in 2.68s]
19:51:43.942305 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CreditCardTypes
19:51:43.942606 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Currencies
19:51:43.943083 [info ] [Thread-2  ]: 20 of 105 START table model dbo_dbo.AH_Currencies............................... [RUN]
19:51:43.944385 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies"
19:51:43.944597 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Currencies
19:51:43.944777 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Currencies
19:51:43.948383 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Currencies"
19:51:43.948880 [debug] [Thread-2  ]: finished collecting timing info
19:51:43.949073 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Currencies
19:51:43.958057 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies"
19:51:43.958739 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
19:51:43.958961 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
  
  if object_id ('"dbo_dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Currencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Currencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Currencies__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Currencies__dbt_tmp_temp_view as
    
Select
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([ConVersiontousd] as numeric(19,4)) [ConVersiontousd] 
From stg.[AH_Currencies_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Currencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Currencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Currencies__dbt_tmp_temp_view"
    end



19:51:43.959122 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:43.959299 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:44.064572 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:44.647012 [debug] [Thread-4  ]: SQLServer adapter: Database error: ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conversion failed when converting the nvarchar value '9f076b7eb7fdc0311cd3208cdbbebbf8014dd3a05e35191c96947b358a362b40' to data type int.  (245) (SQLExecDirectW)")
19:51:44.647409 [debug] [Thread-4  ]: On model.Shawn.AH_CreditCards: ROLLBACK
19:51:44.647581 [debug] [Thread-4  ]: On model.Shawn.AH_CreditCards: Close
19:51:44.648034 [debug] [Thread-4  ]: finished collecting timing info
19:51:44.648502 [debug] [Thread-4  ]: Database Error in model AH_CreditCards (models/step4_dboSingle/AH_CreditCards.sql)
  ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conversion failed when converting the nvarchar value '9f076b7eb7fdc0311cd3208cdbbebbf8014dd3a05e35191c96947b358a362b40' to data type int.  (245) (SQLExecDirectW)")
  compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_CreditCards.sql
19:51:44.648835 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c591f0>]}
19:51:44.649263 [error] [Thread-4  ]: 18 of 105 ERROR creating table model dbo_dbo.AH_CreditCards..................... [[31mERROR[0m in 3.10s]
19:51:44.650459 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CreditCards
19:51:44.651146 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CustomFieldenums
19:51:44.652172 [info ] [Thread-4  ]: 21 of 105 START table model dbo_dbo.AH_CustomFieldenums......................... [RUN]
19:51:44.653497 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFieldenums"
19:51:44.653736 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CustomFieldenums
19:51:44.653939 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CustomFieldenums
19:51:44.657363 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CustomFieldenums"
19:51:44.657848 [debug] [Thread-4  ]: finished collecting timing info
19:51:44.658038 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CustomFieldenums
19:51:44.667207 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFieldenums"
19:51:44.667848 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
19:51:44.668056 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
  
  if object_id ('"dbo_dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CustomFieldenums__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CustomFieldenums__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CustomFieldenums__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_CustomFieldenums_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CustomFieldenums__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CustomFieldenums__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end



19:51:44.668211 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:44.668383 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:44.765722 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:46.000874 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.24 seconds
19:51:46.012314 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
19:51:46.012729 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: rename object "dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_tmp" to AH_CreditCardsExtraInFormation
19:51:46.092173 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:51:46.095436 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCardsExtraInFormation: COMMIT
19:51:46.097611 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
19:51:46.097888 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
    
  if object_id ('"dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CreditCardsExtraInFormation__dbt_backup"
    end

19:51:46.149416 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:46.159432 [debug] [Thread-3  ]: finished collecting timing info
19:51:46.159935 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCardsExtraInFormation: Close
19:51:46.160770 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c72d90>]}
19:51:46.161300 [info ] [Thread-3  ]: 19 of 105 OK created table model dbo_dbo.AH_CreditCardsExtraInFormation......... [[32mOK[0m in 2.43s]
19:51:46.162363 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CreditCardsExtraInFormation
19:51:46.162675 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CustomFields
19:51:46.163149 [info ] [Thread-3  ]: 22 of 105 START table model dbo_dbo.AH_CustomFields............................. [RUN]
19:51:46.164554 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFields"
19:51:46.164803 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CustomFields
19:51:46.164995 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CustomFields
19:51:46.168661 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CustomFields"
19:51:46.169187 [debug] [Thread-3  ]: finished collecting timing info
19:51:46.169381 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CustomFields
19:51:46.181378 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFields"
19:51:46.182125 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
19:51:46.182357 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
  
  if object_id ('"dbo_dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_CustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CustomFields__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_CustomFields__dbt_tmp_temp_view as
    
Select
	cast([Required] as bit) [IsRequired],
	cast([Deferred] as bit) [IsDeferred],
	cast([Encrypted] as bit) [IsEncrypted],
	cast([IncludeonInvoice] as bit) [IsIncludeOnInvoice],
	cast([IncludeinSalesReport] as bit) [IsIncludeInSalesReport],
	cast([IncludeonInvoiceasSeller] as bit) [IsIncludeOnInvoiceAsSeller],
	cast([IncludeonInvoiceasBuyer] as bit) [IsIncludeOnInvoiceAsBuyer],
	cast([IncludeinSalesReportasSeller] as bit) [IsIncludeInSalesReportAsSeller],
	cast([IncludeinSalesReportasBuyer] as bit) [IsIncludeInSalesReportAsBuyer],
	cast([ID] as int) [CustomFieldID],
	cast([Type] as int) [Type],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([VisiBIlity] as int) [Visibility],
	cast([MutaBIlity] as int) [Mutability],
	cast([CreatedOn] as datetime) [Created_RWXCustomFields],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXCustomFields],
	cast([DeletedOn] as datetime) [DeletedDate_RWXCustomFields],
	cast([Name] as nvarchar(500)) [Name],
	cast([DefaultValue] as nvarchar(300)) [DefaultValue],
	cast([GroupName] as nvarchar(500)) [GroupName],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXCustomFields] 
From stg.[AH_CustomFields_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_CustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_CustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end



19:51:46.182522 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:46.182743 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:46.283232 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:46.395803 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
19:51:46.406740 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
19:51:46.407131 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: rename object "dbo_dbo"."AH_Currencies__dbt_tmp" to AH_Currencies
19:51:46.462968 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:51:46.465063 [debug] [Thread-2  ]: On model.Shawn.AH_Currencies: COMMIT
19:51:46.467366 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
19:51:46.467626 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
    
  if object_id ('"dbo_dbo"."AH_Currencies__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Currencies__dbt_backup"
    end

19:51:46.511616 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:46.521202 [debug] [Thread-2  ]: finished collecting timing info
19:51:46.521697 [debug] [Thread-2  ]: On model.Shawn.AH_Currencies: Close
19:51:46.522575 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd16a0>]}
19:51:46.523152 [info ] [Thread-2  ]: 20 of 105 OK created table model dbo_dbo.AH_Currencies.......................... [[32mOK[0m in 2.58s]
19:51:46.525186 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Currencies
19:51:46.525485 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Customcurrencies
19:51:46.525967 [info ] [Thread-2  ]: 23 of 105 START table model dbo_dbo.AH_Customcurrencies......................... [RUN]
19:51:46.526945 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Customcurrencies"
19:51:46.527155 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Customcurrencies
19:51:46.527335 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Customcurrencies
19:51:46.530653 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Customcurrencies"
19:51:46.531342 [debug] [Thread-2  ]: finished collecting timing info
19:51:46.531540 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Customcurrencies
19:51:46.540967 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Customcurrencies"
19:51:46.541707 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
19:51:46.541929 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
  
  if object_id ('"dbo_dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Customcurrencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Customcurrencies__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Customcurrencies__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Isocurrencysymbol] as nvarchar(4000)) [Isocurrencysymbol],
	cast([Currencysymbol] as nvarchar(4000)) [Currencysymbol],
	cast([CurrencyenglishName] as nvarchar(4000)) [CurrencyenglishName],
	cast([CurrencynativeName] as nvarchar(4000)) [CurrencynativeName] 
From stg.[AH_Customcurrencies_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Customcurrencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Customcurrencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end



19:51:46.542086 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:46.542265 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:46.659261 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:46.865033 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.20 seconds
19:51:46.876419 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
19:51:46.876859 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: rename object "dbo_dbo"."AH_CustomFieldenums__dbt_tmp" to AH_CustomFieldenums
19:51:46.917323 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:46.919444 [debug] [Thread-4  ]: On model.Shawn.AH_CustomFieldenums: COMMIT
19:51:46.921668 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
19:51:46.921946 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
    
  if object_id ('"dbo_dbo"."AH_CustomFieldenums__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CustomFieldenums__dbt_backup"
    end

19:51:47.034849 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
19:51:47.045478 [debug] [Thread-4  ]: finished collecting timing info
19:51:47.046020 [debug] [Thread-4  ]: On model.Shawn.AH_CustomFieldenums: Close
19:51:47.046901 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd17f0>]}
19:51:47.047452 [info ] [Thread-4  ]: 21 of 105 OK created table model dbo_dbo.AH_CustomFieldenums.................... [[32mOK[0m in 2.39s]
19:51:47.048607 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CustomFieldenums
19:51:47.048886 [debug] [Thread-4  ]: Began running node model.Shawn.AH_DailyhuntEmailSubscribers
19:51:47.049366 [info ] [Thread-4  ]: 24 of 105 START table model dbo_dbo.AH_DailyhuntEmailSubscribers................ [RUN]
19:51:47.050876 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers"
19:51:47.051093 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_DailyhuntEmailSubscribers
19:51:47.051274 [debug] [Thread-4  ]: Compiling model.Shawn.AH_DailyhuntEmailSubscribers
19:51:47.054941 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
19:51:47.055514 [debug] [Thread-4  ]: finished collecting timing info
19:51:47.055721 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_DailyhuntEmailSubscribers
19:51:47.065638 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
19:51:47.066461 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
19:51:47.066750 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
  
  if object_id ('"dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([ID] as int) [ID],
	cast([ZipCode] as int) [ZipCode],
	cast([ASenthusiast] as bit) [ASenthusiast],
	cast([AsBidder] as bit) [AsBidder],
	cast([AsConsignor] as bit) [AsConsignor] 
From stg.[AH_DailyhuntEmailSubscribers_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end



19:51:47.066929 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:47.067110 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:47.179288 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:49.077670 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.90 seconds
19:51:49.088932 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
19:51:49.089352 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: rename object "dbo_dbo"."AH_CustomFields__dbt_tmp" to AH_CustomFields
19:51:49.151357 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:51:49.153271 [debug] [Thread-3  ]: On model.Shawn.AH_CustomFields: COMMIT
19:51:49.155333 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
19:51:49.155572 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
    
  if object_id ('"dbo_dbo"."AH_CustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CustomFields__dbt_backup"
    end

19:51:49.211591 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:51:49.223425 [debug] [Thread-3  ]: finished collecting timing info
19:51:49.223905 [debug] [Thread-3  ]: On model.Shawn.AH_CustomFields: Close
19:51:49.224760 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d39e80>]}
19:51:49.225303 [info ] [Thread-3  ]: 22 of 105 OK created table model dbo_dbo.AH_CustomFields........................ [[32mOK[0m in 3.06s]
19:51:49.226564 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CustomFields
19:51:49.226854 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Decorations
19:51:49.227321 [info ] [Thread-3  ]: 25 of 105 START table model dbo_dbo.AH_Decorations.............................. [RUN]
19:51:49.235065 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Decorations"
19:51:49.235347 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Decorations
19:51:49.235911 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Decorations
19:51:49.238756 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Decorations"
19:51:49.239274 [debug] [Thread-3  ]: finished collecting timing info
19:51:49.239584 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Decorations
19:51:49.250164 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Decorations"
19:51:49.250809 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
19:51:49.251013 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
  
  if object_id ('"dbo_dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Decorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Decorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Decorations__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Decorations__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToproceed],
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ValIDFields] as nvarchar(4000)) [ValIDFields],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name],
	cast([FormatString] as nvarchar(4000)) [FormatString],
	cast([Amount] as numeric(19,4)) [Amount] 
From stg.[AH_Decorations_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Decorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Decorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Decorations__dbt_tmp_temp_view"
    end



19:51:49.251178 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:49.251351 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:49.279143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.74 seconds
19:51:49.290809 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
19:51:49.291213 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: rename object "dbo_dbo"."AH_Customcurrencies__dbt_tmp" to AH_Customcurrencies
19:51:49.333120 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:49.335041 [debug] [Thread-2  ]: On model.Shawn.AH_Customcurrencies: COMMIT
19:51:49.337061 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
19:51:49.337290 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
    
  if object_id ('"dbo_dbo"."AH_Customcurrencies__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Customcurrencies__dbt_backup"
    end

19:51:49.369455 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:49.373425 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:49.383408 [debug] [Thread-2  ]: finished collecting timing info
19:51:49.383832 [debug] [Thread-2  ]: On model.Shawn.AH_Customcurrencies: Close
19:51:49.384652 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0cbda60>]}
19:51:49.385170 [info ] [Thread-2  ]: 23 of 105 OK created table model dbo_dbo.AH_Customcurrencies.................... [[32mOK[0m in 2.86s]
19:51:49.386248 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Customcurrencies
19:51:49.386514 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Emailtemplatecontents
19:51:49.386997 [info ] [Thread-2  ]: 26 of 105 START table model dbo_dbo.AH_Emailtemplatecontents.................... [RUN]
19:51:49.388344 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplatecontents"
19:51:49.388555 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Emailtemplatecontents
19:51:49.388735 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Emailtemplatecontents
19:51:49.392203 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplatecontents"
19:51:49.392698 [debug] [Thread-2  ]: finished collecting timing info
19:51:49.392889 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Emailtemplatecontents
19:51:49.402148 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplatecontents"
19:51:49.402829 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
19:51:49.403042 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
  
  if object_id ('"dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([SuBJect] as nvarchar(4000)) [SuBJect],
	cast([Body] as nvarchar(4000)) [Body],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID] 
From stg.[AH_Emailtemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end



19:51:49.403213 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:49.403392 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:49.529587 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:49.929171 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.86 seconds
19:51:49.940455 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
19:51:49.940813 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: rename object "dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp" to AH_DailyhuntEmailSubscribers
19:51:49.978171 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:49.980328 [debug] [Thread-4  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: COMMIT
19:51:49.982565 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
19:51:49.982820 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
    
  if object_id ('"dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"
    end

19:51:50.022038 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:50.032536 [debug] [Thread-4  ]: finished collecting timing info
19:51:50.033029 [debug] [Thread-4  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: Close
19:51:50.033867 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd1be0>]}
19:51:50.034386 [info ] [Thread-4  ]: 24 of 105 OK created table model dbo_dbo.AH_DailyhuntEmailSubscribers........... [[32mOK[0m in 2.98s]
19:51:50.035558 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_DailyhuntEmailSubscribers
19:51:50.035833 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Emailtemplates
19:51:50.036307 [info ] [Thread-4  ]: 27 of 105 START table model dbo_dbo.AH_Emailtemplates........................... [RUN]
19:51:50.038981 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplates"
19:51:50.039252 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Emailtemplates
19:51:50.039453 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Emailtemplates
19:51:50.042916 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplates"
19:51:50.043428 [debug] [Thread-4  ]: finished collecting timing info
19:51:50.043624 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Emailtemplates
19:51:50.052794 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplates"
19:51:50.054231 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
19:51:50.054443 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
  
  if object_id ('"dbo_dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Emailtemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Emailtemplates__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Emailtemplates__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Emailtemplates_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Emailtemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Emailtemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end



19:51:50.054854 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:50.055056 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:50.159237 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:50.210067 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 15.49 seconds
19:51:50.223115 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
19:51:50.223499 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: rename object "dbo_dbo"."AH_CategoryCustomFields__dbt_tmp" to AH_CategoryCustomFields
19:51:50.255257 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:50.257164 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCustomFields: COMMIT
19:51:50.259180 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
19:51:50.259396 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
    
  if object_id ('"dbo_dbo"."AH_CategoryCustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_CategoryCustomFields__dbt_backup"
    end

19:51:50.309005 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:50.318190 [debug] [Thread-1  ]: finished collecting timing info
19:51:50.318675 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCustomFields: Close
19:51:50.319490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfa7f0>]}
19:51:50.319989 [info ] [Thread-1  ]: 11 of 105 OK created table model dbo_dbo.AH_CategoryCustomFields................ [[32mOK[0m in 15.62s]
19:51:50.321082 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CategoryCustomFields
19:51:50.321353 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Eventproperties
19:51:50.321843 [info ] [Thread-1  ]: 28 of 105 START table model dbo_dbo.AH_Eventproperties.......................... [RUN]
19:51:50.323161 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Eventproperties"
19:51:50.323372 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Eventproperties
19:51:50.323549 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Eventproperties
19:51:50.327054 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Eventproperties"
19:51:50.327564 [debug] [Thread-1  ]: finished collecting timing info
19:51:50.327755 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Eventproperties
19:51:50.338249 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Eventproperties"
19:51:50.339060 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
19:51:50.339296 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
  
  if object_id ('"dbo_dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Eventproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Eventproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Eventproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([CustomFieldID] as int) [CustomFieldID] 
From stg.[AH_Eventproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Eventproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Eventproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end



19:51:50.339472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:51:50.339653 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:50.436690 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:51.744694 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.49 seconds
19:51:51.755811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
19:51:51.756221 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: rename object "dbo_dbo"."AH_Decorations__dbt_tmp" to AH_Decorations
19:51:51.787655 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:51.789732 [debug] [Thread-3  ]: On model.Shawn.AH_Decorations: COMMIT
19:51:51.791991 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
19:51:51.792242 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
    
  if object_id ('"dbo_dbo"."AH_Decorations__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Decorations__dbt_backup"
    end

19:51:51.823395 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.42 seconds
19:51:51.834081 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
19:51:51.834451 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: rename object "dbo_dbo"."AH_Emailtemplatecontents__dbt_tmp" to AH_Emailtemplatecontents
19:51:51.834701 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:51.842431 [debug] [Thread-3  ]: finished collecting timing info
19:51:51.842886 [debug] [Thread-3  ]: On model.Shawn.AH_Decorations: Close
19:51:51.843618 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dd1d30>]}
19:51:51.844117 [info ] [Thread-3  ]: 25 of 105 OK created table model dbo_dbo.AH_Decorations......................... [[32mOK[0m in 2.61s]
19:51:51.845293 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Decorations
19:51:51.845573 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Events
19:51:51.846056 [info ] [Thread-3  ]: 29 of 105 START table model dbo_dbo.AH_Events................................... [RUN]
19:51:51.847482 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Events"
19:51:51.847695 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Events
19:51:51.847877 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Events
19:51:51.851338 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Events"
19:51:51.851884 [debug] [Thread-3  ]: finished collecting timing info
19:51:51.852077 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Events
19:51:51.861399 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Events"
19:51:51.861972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
19:51:51.862167 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Events: 
  
  if object_id ('"dbo_dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Events__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Events__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Events__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Events__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Events_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Events__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Events__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Events__dbt_tmp_temp_view"
    end



19:51:51.862324 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:51.862495 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:51.874293 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:51.876011 [debug] [Thread-2  ]: On model.Shawn.AH_Emailtemplatecontents: COMMIT
19:51:51.879478 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
19:51:51.879992 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
    
  if object_id ('"dbo_dbo"."AH_Emailtemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Emailtemplatecontents__dbt_backup"
    end

19:51:51.919177 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:51.931952 [debug] [Thread-2  ]: finished collecting timing info
19:51:51.932436 [debug] [Thread-2  ]: On model.Shawn.AH_Emailtemplatecontents: Close
19:51:51.933398 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0ceb3a0>]}
19:51:51.933934 [info ] [Thread-2  ]: 26 of 105 OK created table model dbo_dbo.AH_Emailtemplatecontents............... [[32mOK[0m in 2.55s]
19:51:51.935069 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Emailtemplatecontents
19:51:51.935349 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ExternalUserIDs
19:51:51.935806 [info ] [Thread-2  ]: 30 of 105 START table model dbo_dbo.AH_ExternalUserIDs.......................... [RUN]
19:51:51.937316 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ExternalUserIDs"
19:51:51.937529 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ExternalUserIDs
19:51:51.937711 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ExternalUserIDs
19:51:51.940902 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ExternalUserIDs"
19:51:51.941390 [debug] [Thread-2  ]: finished collecting timing info
19:51:51.941588 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ExternalUserIDs
19:51:51.950864 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ExternalUserIDs"
19:51:51.951410 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
19:51:51.951602 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
  
  if object_id ('"dbo_dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ExternalUserIDs__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ExternalUserIDs__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ExternalUserIDs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProvIDErName],
	cast([ProvIDErUserID] as nvarchar(4000)) [ProvIDErUserID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([LocalUserID] as int) [LocalUserID] 
From stg.[AH_ExternalUserIDs_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ExternalUserIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ExternalUserIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end



19:51:51.951759 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:51.951930 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:51.967824 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:52.055273 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:53.983453 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
19:51:53.995094 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
19:51:53.995517 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: rename object "dbo_dbo"."AH_ExternalUserIDs__dbt_tmp" to AH_ExternalUserIDs
19:51:54.037261 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:54.039439 [debug] [Thread-2  ]: On model.Shawn.AH_ExternalUserIDs: COMMIT
19:51:54.041668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
19:51:54.041910 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
    
  if object_id ('"dbo_dbo"."AH_ExternalUserIDs__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ExternalUserIDs__dbt_backup"
    end

19:51:54.043025 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.99 seconds
19:51:54.133270 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
19:51:54.138372 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
19:51:54.146180 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: rename object "dbo_dbo"."AH_Emailtemplates__dbt_tmp" to AH_Emailtemplates
19:51:54.145874 [debug] [Thread-2  ]: finished collecting timing info
19:51:54.146737 [debug] [Thread-2  ]: On model.Shawn.AH_ExternalUserIDs: Close
19:51:54.147523 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2de92b0>]}
19:51:54.172274 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.83 seconds
19:51:54.183913 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
19:51:54.184259 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:54.186157 [debug] [Thread-4  ]: On model.Shawn.AH_Emailtemplates: COMMIT
19:51:54.188123 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
19:51:54.188356 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
    
  if object_id ('"dbo_dbo"."AH_Emailtemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Emailtemplates__dbt_backup"
    end

19:51:54.184571 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: rename object "dbo_dbo"."AH_Eventproperties__dbt_tmp" to AH_Eventproperties
19:51:54.221160 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:54.223223 [debug] [Thread-1  ]: On model.Shawn.AH_Eventproperties: COMMIT
19:51:54.225285 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
19:51:54.225439 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.36 seconds
19:51:54.226529 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
    
  if object_id ('"dbo_dbo"."AH_Eventproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Eventproperties__dbt_backup"
    end

19:51:54.233904 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:54.239048 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
19:51:54.245991 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Events: rename object "dbo_dbo"."AH_Events__dbt_tmp" to AH_Events
19:51:54.245786 [debug] [Thread-4  ]: finished collecting timing info
19:51:54.248328 [debug] [Thread-4  ]: On model.Shawn.AH_Emailtemplates: Close
19:51:54.249069 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2de90a0>]}
19:51:54.270769 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:54.281113 [info ] [Thread-2  ]: 30 of 105 OK created table model dbo_dbo.AH_ExternalUserIDs..................... [[32mOK[0m in 2.21s]
19:51:54.281744 [info ] [Thread-4  ]: 27 of 105 OK created table model dbo_dbo.AH_Emailtemplates...................... [[32mOK[0m in 4.21s]
19:51:54.283230 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ExternalUserIDs
19:51:54.286475 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Feedbacks
19:51:54.283412 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Emailtemplates
19:51:54.287184 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Feeproperties
19:51:54.287349 [info ] [Thread-4  ]: 32 of 105 START table model dbo_dbo.AH_Feeproperties............................ [RUN]
19:51:54.290100 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Feeproperties"
19:51:54.290258 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Feeproperties
19:51:54.290374 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Feeproperties
19:51:54.286980 [info ] [Thread-2  ]: 31 of 105 START table model dbo_dbo.AH_Feedbacks................................ [RUN]
19:51:54.294531 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Feedbacks"
19:51:54.294700 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Feedbacks
19:51:54.294807 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Feedbacks
19:51:54.297824 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Feedbacks"
19:51:54.286282 [debug] [Thread-1  ]: finished collecting timing info
19:51:54.298205 [debug] [Thread-1  ]: On model.Shawn.AH_Eventproperties: Close
19:51:54.298891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0cfca60>]}
19:51:54.293520 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Feeproperties"
19:51:54.299929 [debug] [Thread-4  ]: finished collecting timing info
19:51:54.300316 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Feeproperties
19:51:54.300189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:54.299428 [info ] [Thread-1  ]: 28 of 105 OK created table model dbo_dbo.AH_Eventproperties..................... [[32mOK[0m in 3.98s]
19:51:54.308256 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Eventproperties
19:51:54.308442 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Feeschedules
19:51:54.308636 [info ] [Thread-1  ]: 33 of 105 START table model dbo_dbo.AH_Feeschedules............................. [RUN]
19:51:54.305857 [debug] [Thread-2  ]: finished collecting timing info
19:51:54.309407 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Feedbacks
19:51:54.307478 [debug] [Thread-3  ]: On model.Shawn.AH_Events: COMMIT
19:51:54.311658 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Feeschedules"
19:51:54.312060 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Feeschedules
19:51:54.312209 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Feeschedules
19:51:54.315337 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Feeschedules"
19:51:54.323317 [debug] [Thread-1  ]: finished collecting timing info
19:51:54.323470 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Feeschedules
19:51:54.318571 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
19:51:54.325413 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Events: 
    
  if object_id ('"dbo_dbo"."AH_Events__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Events__dbt_backup"
    end

19:51:54.328848 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Feeproperties"
19:51:54.340134 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
19:51:54.340284 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
  
  if object_id ('"dbo_dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Feeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Feeproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Feeproperties__dbt_tmp_temp_view as
    
Select
	cast([Processor] as nvarchar(4000)) [Processor],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([EventID] as int) [EventID] 
From stg.[AH_Feeproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Feeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Feeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end



19:51:54.340379 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:54.340490 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:54.332141 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Feedbacks"
19:51:54.341705 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
19:51:54.341859 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
  
  if object_id ('"dbo_dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Feedbacks__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Feedbacks__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Feedbacks__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([SEndingUserID] as int) [SEndingUserID],
	cast([ReceivINgUserID] as int) [ReceivINgUserID],
	cast([Rating] as int) [Rating],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([ListingOwnerUserName] as nvarchar(4000)) [ListingOwnerUserName] 
From stg.[AH_Feedbacks_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Feedbacks__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Feedbacks__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end



19:51:54.341958 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:54.342065 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:54.339699 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Feeschedules"
19:51:54.343822 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
19:51:54.344015 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
  
  if object_id ('"dbo_dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Feeschedules__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Feeschedules__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Feeschedules__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToproceed],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([EventID] as int) [EventID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Feeschedules_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Feeschedules__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Feeschedules__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end



19:51:54.344169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:51:54.344351 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:54.366038 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:54.382821 [debug] [Thread-3  ]: finished collecting timing info
19:51:54.383291 [debug] [Thread-3  ]: On model.Shawn.AH_Events: Close
19:51:54.384068 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d49f70>]}
19:51:54.384604 [info ] [Thread-3  ]: 29 of 105 OK created table model dbo_dbo.AH_Events.............................. [[32mOK[0m in 2.54s]
19:51:54.385720 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Events
19:51:54.386013 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ImportedCategoryMap
19:51:54.386484 [info ] [Thread-3  ]: 34 of 105 START table model dbo_dbo.AH_ImportedCategoryMap...................... [RUN]
19:51:54.389712 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedCategoryMap"
19:51:54.389938 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ImportedCategoryMap
19:51:54.390126 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ImportedCategoryMap
19:51:54.393417 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ImportedCategoryMap"
19:51:54.393908 [debug] [Thread-3  ]: finished collecting timing info
19:51:54.394102 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ImportedCategoryMap
19:51:54.405671 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedCategoryMap"
19:51:54.406395 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
19:51:54.406659 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
  
  if object_id ('"dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view as
    
Select
	cast([LocalCategoryID] as int) [LocalCategoryID],
	cast([ForeignCategoryID] as int) [ForeignCategoryID] 
From stg.[AH_ImportedCategoryMap_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end



19:51:54.407034 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:54.407223 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:54.449822 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:54.450621 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:54.453990 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:54.508179 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:56.656901 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.31 seconds
19:51:56.668236 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
19:51:56.668653 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: rename object "dbo_dbo"."AH_Feedbacks__dbt_tmp" to AH_Feedbacks
19:51:56.703315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:56.705418 [debug] [Thread-2  ]: On model.Shawn.AH_Feedbacks: COMMIT
19:51:56.707681 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
19:51:56.707963 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
    
  if object_id ('"dbo_dbo"."AH_Feedbacks__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Feedbacks__dbt_backup"
    end

19:51:56.782036 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:51:56.794620 [debug] [Thread-2  ]: finished collecting timing info
19:51:56.795085 [debug] [Thread-2  ]: On model.Shawn.AH_Feedbacks: Close
19:51:56.795905 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2de97f0>]}
19:51:56.796463 [info ] [Thread-2  ]: 31 of 105 OK created table model dbo_dbo.AH_Feedbacks........................... [[32mOK[0m in 2.50s]
19:51:56.797539 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Feedbacks
19:51:56.797815 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ImportedListingsMap
19:51:56.798290 [info ] [Thread-2  ]: 35 of 105 START table model dbo_dbo.AH_ImportedListingsMap...................... [RUN]
19:51:56.799657 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedListingsMap"
19:51:56.799873 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ImportedListingsMap
19:51:56.800052 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ImportedListingsMap
19:51:56.803227 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ImportedListingsMap"
19:51:56.803944 [debug] [Thread-2  ]: finished collecting timing info
19:51:56.804142 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ImportedListingsMap
19:51:56.815672 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedListingsMap"
19:51:56.816414 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
19:51:56.816643 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
  
  if object_id ('"dbo_dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ImportedListingsMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedListingsMap__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ImportedListingsMap__dbt_tmp_temp_view as
    
Select
	cast([ForeignListingID] as int) [ForeignListingID],
	cast([LoCallistingID] as int) [LoCallistingID] 
From stg.[AH_ImportedListingsMap_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ImportedListingsMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ImportedListingsMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end



19:51:56.816804 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:51:56.816981 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:57.078591 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.67 seconds
19:51:57.090185 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
19:51:57.090630 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: rename object "dbo_dbo"."AH_ImportedCategoryMap__dbt_tmp" to AH_ImportedCategoryMap
19:51:57.114405 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.77 seconds
19:51:57.124416 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:57.126157 [debug] [Thread-3  ]: On model.Shawn.AH_ImportedCategoryMap: COMMIT
19:51:57.126634 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
19:51:57.129956 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
19:51:57.140982 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: rename object "dbo_dbo"."AH_Feeproperties__dbt_tmp" to AH_Feeproperties
19:51:57.131550 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
19:51:57.141490 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
    
  if object_id ('"dbo_dbo"."AH_ImportedCategoryMap__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedCategoryMap__dbt_backup"
    end

19:51:57.140698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
19:51:57.141856 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: rename object "dbo_dbo"."AH_Feeschedules__dbt_tmp" to AH_Feeschedules
19:51:57.172947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:57.175029 [debug] [Thread-1  ]: On model.Shawn.AH_Feeschedules: COMMIT
19:51:57.177165 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
19:51:57.177309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:57.178739 [debug] [Thread-4  ]: On model.Shawn.AH_Feeproperties: COMMIT
19:51:57.180494 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
19:51:57.180629 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:57.177492 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
    
  if object_id ('"dbo_dbo"."AH_Feeschedules__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Feeschedules__dbt_backup"
    end

19:51:57.180804 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
    
  if object_id ('"dbo_dbo"."AH_Feeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Feeproperties__dbt_backup"
    end

19:51:57.189970 [debug] [Thread-3  ]: finished collecting timing info
19:51:57.190749 [debug] [Thread-3  ]: On model.Shawn.AH_ImportedCategoryMap: Close
19:51:57.191497 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2de96a0>]}
19:51:57.192003 [info ] [Thread-3  ]: 34 of 105 OK created table model dbo_dbo.AH_ImportedCategoryMap................. [[32mOK[0m in 2.80s]
19:51:57.193123 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ImportedCategoryMap
19:51:57.193394 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ImportedUserMap
19:51:57.193867 [info ] [Thread-3  ]: 36 of 105 START table model dbo_dbo.AH_ImportedUserMap.......................... [RUN]
19:51:57.195205 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedUserMap"
19:51:57.195425 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ImportedUserMap
19:51:57.195607 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ImportedUserMap
19:51:57.199127 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ImportedUserMap"
19:51:57.199645 [debug] [Thread-3  ]: finished collecting timing info
19:51:57.199844 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ImportedUserMap
19:51:57.209341 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedUserMap"
19:51:57.210019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
19:51:57.210324 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
  
  if object_id ('"dbo_dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ImportedUserMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedUserMap__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ImportedUserMap__dbt_tmp_temp_view as
    
Select
	cast([LocalUserID] as int) [LocalUserID],
	cast([ForeignUserID] as int) [ForeignUserID],
	cast([ImportedUserName] as nvarchar(4000)) [ImportedUserName] 
From stg.[AH_ImportedUserMap_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ImportedUserMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ImportedUserMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end



19:51:57.210497 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:51:57.210714 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:57.227640 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:57.236427 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:51:57.246270 [debug] [Thread-4  ]: finished collecting timing info
19:51:57.251383 [debug] [Thread-4  ]: On model.Shawn.AH_Feeproperties: Close
19:51:57.252148 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c40580>]}
19:51:57.252644 [info ] [Thread-4  ]: 32 of 105 OK created table model dbo_dbo.AH_Feeproperties....................... [[32mOK[0m in 2.96s]
19:51:57.250730 [debug] [Thread-1  ]: finished collecting timing info
19:51:57.253696 [debug] [Thread-1  ]: On model.Shawn.AH_Feeschedules: Close
19:51:57.254324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c61640>]}
19:51:57.256100 [info ] [Thread-1  ]: 33 of 105 OK created table model dbo_dbo.AH_Feeschedules........................ [[32mOK[0m in 2.94s]
19:51:57.256342 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Feeproperties
19:51:57.257154 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ImportedregionMap
19:51:57.257764 [info ] [Thread-4  ]: 37 of 105 START table model dbo_dbo.AH_ImportedregionMap........................ [RUN]
19:51:57.258208 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Feeschedules
19:51:57.258843 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Increments
19:51:57.260138 [info ] [Thread-1  ]: 38 of 105 START table model dbo_dbo.AH_Increments............................... [RUN]
19:51:57.259834 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedregionMap"
19:51:57.260714 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ImportedregionMap
19:51:57.262978 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ImportedregionMap
19:51:57.262834 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Increments"
19:51:57.266789 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Increments
19:51:57.266908 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Increments
19:51:57.269581 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Increments"
19:51:57.269940 [debug] [Thread-1  ]: finished collecting timing info
19:51:57.270066 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Increments
19:51:57.266523 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ImportedregionMap"
19:51:57.276052 [debug] [Thread-4  ]: finished collecting timing info
19:51:57.276205 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ImportedregionMap
19:51:57.287849 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedregionMap"
19:51:57.294445 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
19:51:57.294974 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
  
  if object_id ('"dbo_dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ImportedregionMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedregionMap__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ImportedregionMap__dbt_tmp_temp_view as
    
Select
	cast([LocalregionID] as int) [LocalregionID],
	cast([ForeignregionID] as int) [ForeignregionID],
	cast([Foreignregiontier] as int) [Foreignregiontier] 
From stg.[AH_ImportedregionMap_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ImportedregionMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ImportedregionMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end



19:51:57.295116 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:51:57.295232 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:57.293924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Increments"
19:51:57.296889 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
19:51:57.297093 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
  
  if object_id ('"dbo_dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Increments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Increments__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Increments__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Increments__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([PriceLevel] as numeric(19,4)) [PriceLevel],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Increments_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Increments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Increments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Increments__dbt_tmp_temp_view"
    end



19:51:57.297251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:51:57.297420 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:51:57.311663 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:57.395518 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:57.400183 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:57.944160 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:51:59.849667 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.64 seconds
19:51:59.856426 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.56 seconds
19:51:59.863308 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
19:51:59.871840 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: rename object "dbo_dbo"."AH_ImportedUserMap__dbt_tmp" to AH_ImportedUserMap
19:51:59.873485 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
19:51:59.873763 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Increments: rename object "dbo_dbo"."AH_Increments__dbt_tmp" to AH_Increments
19:51:59.903923 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:59.906018 [debug] [Thread-3  ]: On model.Shawn.AH_ImportedUserMap: COMMIT
19:51:59.908369 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
19:51:59.908648 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:59.910312 [debug] [Thread-1  ]: On model.Shawn.AH_Increments: COMMIT
19:51:59.908803 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
    
  if object_id ('"dbo_dbo"."AH_ImportedUserMap__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedUserMap__dbt_backup"
    end

19:51:59.912457 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.10 seconds
19:51:59.912336 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
19:51:59.919891 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
    
  if object_id ('"dbo_dbo"."AH_Increments__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Increments__dbt_backup"
    end

19:51:59.924576 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
19:51:59.924926 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: rename object "dbo_dbo"."AH_ImportedListingsMap__dbt_tmp" to AH_ImportedListingsMap
19:51:59.931833 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.64 seconds
19:51:59.943057 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
19:51:59.943488 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: rename object "dbo_dbo"."AH_ImportedregionMap__dbt_tmp" to AH_ImportedregionMap
19:51:59.952782 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:59.954808 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedListingsMap: COMMIT
19:51:59.956999 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
19:51:59.957179 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
    
  if object_id ('"dbo_dbo"."AH_ImportedListingsMap__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedListingsMap__dbt_backup"
    end

19:51:59.957605 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:59.963761 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:51:59.969136 [debug] [Thread-3  ]: finished collecting timing info
19:51:59.977469 [debug] [Thread-3  ]: On model.Shawn.AH_ImportedUserMap: Close
19:51:59.978304 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2de9d30>]}
19:51:59.977078 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:51:59.980654 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedregionMap: COMMIT
19:51:59.978993 [info ] [Thread-3  ]: 36 of 105 OK created table model dbo_dbo.AH_ImportedUserMap..................... [[32mOK[0m in 2.78s]
19:51:59.982199 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ImportedUserMap
19:51:59.982521 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Invoices
19:51:59.983077 [info ] [Thread-3  ]: 39 of 105 START table model dbo_dbo.AH_Invoices................................. [RUN]
19:51:59.984688 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices"
19:51:59.986295 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Invoices
19:51:59.988720 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Invoices
19:51:59.991879 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Invoices"
19:51:59.988457 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
19:51:59.992222 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
    
  if object_id ('"dbo_dbo"."AH_ImportedregionMap__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ImportedregionMap__dbt_backup"
    end

19:51:59.986161 [debug] [Thread-1  ]: finished collecting timing info
19:51:59.992631 [debug] [Thread-1  ]: On model.Shawn.AH_Increments: Close
19:51:59.993339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0baff70>]}
19:51:59.993727 [info ] [Thread-1  ]: 38 of 105 OK created table model dbo_dbo.AH_Increments.......................... [[32mOK[0m in 2.73s]
19:51:59.994007 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:00.002314 [debug] [Thread-3  ]: finished collecting timing info
19:52:00.002936 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Invoices
19:52:00.002652 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Increments
19:52:00.004860 [debug] [Thread-1  ]: Began running node model.Shawn.AH_KeyTable
19:52:00.005124 [info ] [Thread-1  ]: 40 of 105 START table model dbo_dbo.AH_KeyTable................................. [RUN]
19:52:00.006460 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_KeyTable"
19:52:00.006734 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_KeyTable
19:52:00.006920 [debug] [Thread-1  ]: Compiling model.Shawn.AH_KeyTable
19:52:00.010352 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_KeyTable"
19:52:00.105492 [debug] [Thread-1  ]: finished collecting timing info
19:52:00.105691 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_KeyTable
19:52:00.104895 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
19:52:00.109822 [debug] [Thread-2  ]: finished collecting timing info
19:52:00.123896 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedListingsMap: Close
19:52:00.124758 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0b06af0>]}
19:52:00.125236 [info ] [Thread-2  ]: 35 of 105 OK created table model dbo_dbo.AH_ImportedListingsMap................. [[32mOK[0m in 3.33s]
19:52:00.126406 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ImportedListingsMap
19:52:00.126754 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Languages
19:52:00.127232 [info ] [Thread-2  ]: 41 of 105 START table model dbo_dbo.AH_Languages................................ [RUN]
19:52:00.128703 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Languages"
19:52:00.138981 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Languages
19:52:00.139179 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Languages
19:52:00.142036 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Languages"
19:52:00.131325 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_KeyTable"
19:52:00.147543 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
19:52:00.147699 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
  
  if object_id ('"dbo_dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_KeyTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_KeyTable__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_KeyTable__dbt_tmp_temp_view as
    
Select
	cast([NextID] as int) [NextID] 
From stg.[AH_KeyTable_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_KeyTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_KeyTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end



19:52:00.147796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:00.147911 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:00.138746 [debug] [Thread-4  ]: finished collecting timing info
19:52:00.149483 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedregionMap: Close
19:52:00.150226 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0b63d30>]}
19:52:00.142489 [debug] [Thread-2  ]: finished collecting timing info
19:52:00.151319 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Languages
19:52:00.151084 [info ] [Thread-4  ]: 37 of 105 OK created table model dbo_dbo.AH_ImportedregionMap................... [[32mOK[0m in 2.89s]
19:52:00.147012 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices"
19:52:00.159874 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
19:52:00.160081 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
  
  if object_id ('"dbo_dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Invoices__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Invoices__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Invoices__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Invoices__dbt_tmp_temp_view as
    
Select
	cast([Paiddttm] as datetime) [PaidDTTM],
	cast([CreatedOn] as datetime) [Created_RWXInvoices],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXInvoices],
	cast([DeletedOn] as datetime) [DeletedDate_RWXInvoices],
	cast([Createddttm] as datetime) [CreatedDTTM],
	cast([Fulfilleddttm] as datetime) [FulfilledDTTM],
	cast([PropertybagID] as int) [PropertybagID],
	cast([ID] as int) [InvoiceID_RWXInvoices],
	cast([ShippingOptionID] as int) [ShippingOptionID],
	cast([PayerID] as int) [PayerID],
	cast([OwnerID] as int) [OwnerID_RWXInvoices],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([SalesTax] as decimal(24,2)) [SalesTax],
	cast([BuyersPremiumPercent] as numeric(24,2)) [BuyerPremiumPct],
	cast([BuyersPremiumAmount] as decimal(24,2)) [BuyerPremiumAmount],
	cast([ShippingAmount] as decimal(24,2)) [ShippingAmount],
	cast([SubTotal] as decimal(24,2)) [Subtotal],
	cast([Total] as decimal(24,2)) [Total],
	cast([IsPayerLocked] as bit) [IsPayerLocked],
	cast([Shipped] as bit) [HasShipped],
	cast([IsArchived] as bit) [IsArchived_RWXInvoices],
	cast([Status] as nvarchar(100)) [Status_RWXInvoices],
	cast([ShippingLastName] as nvarchar(500)) [ShippingLastName],
	cast([BillingLastName] as nvarchar(500)) [BillingLastName],
	cast([OwnerName] as nvarchar(200)) [OwnerName],
	cast([Shippingdetails] as nvarchar(500)) [ShippingDetails],
	cast([OwnerCity] as nvarchar(200)) [OwnerCity],
	cast([OwnerStateregion] as nvarchar(200)) [OwnerStateRegion],
	cast([OwnerzipPostal] as varchar(128)) [OwnerPostalCode],
	cast([OwnerCountry] as nvarchar(200)) [OwnerCountry],
	cast([ShippingFirstName] as nvarchar(500)) [ShippingFirstName],
	cast([BillingFirstName] as nvarchar(500)) [BIllingFirstName],
	cast([BillingCity] as nvarchar(40)) [BillingCity],
	cast([BillingStateregion] as nvarchar(40)) [BillingState],
	cast([BillingzipPostal] as varchar(128)) [BillingPostalCode],
	cast([BillingCountry] as nvarchar(40)) [BillingCountry],
	cast([OwnerStreet1] as varchar(128)) [OwnerStreet1],
	cast([OwnerStreet2] as varchar(128)) [OwnerStreet2],
	cast([ShippingCity] as nvarchar(100)) [ShippingCity],
	cast([ShippingStateregion] as nvarchar(50)) [ShippingState],
	cast([ShippingzipPostal] as varchar(128)) [ShippingPostalCode],
	cast([ShippingCountry] as nvarchar(100)) [ShippingCountry],
	cast([BillingStreet1] as varchar(128)) [BillingStreet1],
	cast([BillingStreet2] as varchar(128)) [BillingStreet2],
	cast([Comments] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXInvoices],
	cast([Currency] as nvarchar(10)) [CurrencyID],
	cast([Type] as nvarchar(50)) [Type_RWXInvoices],
	cast([ShippingStreet1] as varchar(128)) [ShippingStreet1],
	cast([ShippingStreet2] as varchar(128)) [ShippingStreet2] 
From stg.[AH_Invoices_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Invoices__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Invoices__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Invoices__dbt_tmp_temp_view"
    end



19:52:00.160190 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:00.160307 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:00.162115 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ImportedregionMap
19:52:00.162356 [debug] [Thread-4  ]: Began running node model.Shawn.AH_LineItems
19:52:00.163316 [info ] [Thread-4  ]: 42 of 105 START table model dbo_dbo.AH_LineItems................................ [RUN]
19:52:00.165523 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems"
19:52:00.166159 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_LineItems
19:52:00.167078 [debug] [Thread-4  ]: Compiling model.Shawn.AH_LineItems
19:52:00.170715 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_LineItems"
19:52:00.179542 [debug] [Thread-4  ]: finished collecting timing info
19:52:00.179776 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_LineItems
19:52:00.187964 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Languages"
19:52:00.188766 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
19:52:00.189013 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
  
  if object_id ('"dbo_dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Languages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Languages__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Languages__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Languages__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Languages_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Languages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Languages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Languages__dbt_tmp_temp_view"
    end



19:52:00.189185 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:52:00.190507 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:00.196959 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems"
19:52:00.197724 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
19:52:00.197963 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
  
  if object_id ('"dbo_dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_LineItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_LineItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_LineItems__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_LineItems__dbt_tmp_temp_view as
    
Select
	cast([Currency] as nvarchar(10)) [Currency],
	cast([Status] as nvarchar(100)) [Status_RWXLineItems],
	cast([Type] as nvarchar(50)) [Type_RWXLineItems],
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXLineItems],
	cast([CreatedOn] as datetime) [Created_RWXLineItems],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXLineItems],
	cast([DeletedOn] as datetime) [DeletedDate_RWXLineItems],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [LineItemsID],
	cast([InvoiceID] as int) [InvoiceID_RWXLineItems],
	cast([ListingID] as int) [ListingID],
	cast([Quantity] as int) [QTY],
	cast([OwnerID] as int) [OwnerID_RWXLineItems],
	cast([PayerID] as int) [UserID],
	cast([ReListiteration] as int) [ReListiteration],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([TotalAmount] as decimal(24,2)) [TotalAmount],
	cast([PeRunitAmount] as decimal(24,2)) [PerUnitAmount],
	cast([Taxable] as bit) [IsTaxable],
	cast([IsArchived] as bit) [IsArchived_RWXLineItems],
	cast([BuyersPremiuMapplies] as bit) [HasBuyerPremiumApplies],
	cast([IsPayerArchived] as bit) [IsPayerArchived] 
From stg.[AH_LineItems_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_LineItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_LineItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_LineItems__dbt_tmp_temp_view"
    end



19:52:00.198134 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:00.198312 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:00.280326 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:00.282246 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:00.287247 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:00.313161 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:02.194483 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
19:52:02.205849 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
19:52:02.206295 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: rename object "dbo_dbo"."AH_KeyTable__dbt_tmp" to AH_KeyTable
19:52:02.247984 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:02.250134 [debug] [Thread-1  ]: On model.Shawn.AH_KeyTable: COMMIT
19:52:02.252336 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
19:52:02.252608 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
    
  if object_id ('"dbo_dbo"."AH_KeyTable__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_KeyTable__dbt_backup"
    end

19:52:02.298748 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:02.308897 [debug] [Thread-1  ]: finished collecting timing info
19:52:02.309412 [debug] [Thread-1  ]: On model.Shawn.AH_KeyTable: Close
19:52:02.310259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0b5aca0>]}
19:52:02.310822 [info ] [Thread-1  ]: 40 of 105 OK created table model dbo_dbo.AH_KeyTable............................ [[32mOK[0m in 2.30s]
19:52:02.312264 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_KeyTable
19:52:02.312560 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingActionproperties
19:52:02.313039 [info ] [Thread-1  ]: 43 of 105 START table model dbo_dbo.AH_ListingActionproperties.................. [RUN]
19:52:02.314031 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActionproperties"
19:52:02.314245 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingActionproperties
19:52:02.314446 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingActionproperties
19:52:02.319808 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingActionproperties"
19:52:02.320420 [debug] [Thread-1  ]: finished collecting timing info
19:52:02.320637 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingActionproperties
19:52:02.331146 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActionproperties"
19:52:02.331937 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
19:52:02.332177 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
  
  if object_id ('"dbo_dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingActionproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingActionproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingActionproperties__dbt_tmp_temp_view as
    
Select
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([ListingActionID] as int) [ListingActionID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingActionproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingActionproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingActionproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end



19:52:02.332337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:02.332511 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:02.404460 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
19:52:02.418989 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
19:52:02.419409 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LineItems: rename object "dbo_dbo"."AH_LineItems__dbt_tmp" to AH_LineItems
19:52:02.450707 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:02.452670 [debug] [Thread-4  ]: On model.Shawn.AH_LineItems: COMMIT
19:52:02.454811 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
19:52:02.455065 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
    
  if object_id ('"dbo_dbo"."AH_LineItems__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_LineItems__dbt_backup"
    end

19:52:02.469223 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:02.496422 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:02.507576 [debug] [Thread-4  ]: finished collecting timing info
19:52:02.508115 [debug] [Thread-4  ]: On model.Shawn.AH_LineItems: Close
19:52:02.508992 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0bafb80>]}
19:52:02.509580 [info ] [Thread-4  ]: 42 of 105 OK created table model dbo_dbo.AH_LineItems........................... [[32mOK[0m in 2.34s]
19:52:02.510827 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_LineItems
19:52:02.511126 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingActions
19:52:02.511619 [info ] [Thread-4  ]: 44 of 105 START table model dbo_dbo.AH_ListingActions........................... [RUN]
19:52:02.513327 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions"
19:52:02.513548 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingActions
19:52:02.513737 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingActions
19:52:02.517169 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions"
19:52:02.517733 [debug] [Thread-4  ]: finished collecting timing info
19:52:02.517941 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingActions
19:52:02.529694 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions"
19:52:02.530477 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
19:52:02.530773 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
  
  if object_id ('"dbo_dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingActions__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingActions__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingActions__dbt_tmp_temp_view as
    
Select
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Reason] as nvarchar(4000)) [Reason],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([Actiondttm] as datetime) [ActionDTTM],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ProxyAmount] as decimal(24,2)) [ProxyAmount],
	cast([Userentered] as bit) [HasUserEntered],
	cast([ID] as int) [ListingActionID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([Quantity] as int) [QTY] 
From stg.[AH_ListingActions_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingActions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingActions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end



19:52:02.530941 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:02.531123 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:02.628153 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
19:52:02.639459 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
19:52:02.639741 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:02.640046 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: rename object "dbo_dbo"."AH_Languages__dbt_tmp" to AH_Languages
19:52:02.671546 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:02.673641 [debug] [Thread-2  ]: On model.Shawn.AH_Languages: COMMIT
19:52:02.675941 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
19:52:02.676205 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
    
  if object_id ('"dbo_dbo"."AH_Languages__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Languages__dbt_backup"
    end

19:52:02.746611 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:52:02.758535 [debug] [Thread-2  ]: finished collecting timing info
19:52:02.759049 [debug] [Thread-2  ]: On model.Shawn.AH_Languages: Close
19:52:02.759898 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0bafdf0>]}
19:52:02.760420 [info ] [Thread-2  ]: 41 of 105 OK created table model dbo_dbo.AH_Languages........................... [[32mOK[0m in 2.63s]
19:52:02.761550 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Languages
19:52:02.761835 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingComments
19:52:02.762308 [info ] [Thread-2  ]: 45 of 105 START table model dbo_dbo.AH_ListingComments.......................... [RUN]
19:52:02.763746 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingComments"
19:52:02.763968 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingComments
19:52:02.764152 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingComments
19:52:02.767802 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingComments"
19:52:02.768333 [debug] [Thread-2  ]: finished collecting timing info
19:52:02.768532 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingComments
19:52:02.779980 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingComments"
19:52:02.780812 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
19:52:02.781065 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
  
  if object_id ('"dbo_dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingComments__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingComments__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingComments__dbt_tmp_temp_view as
    
Select
	cast([IsBID] as bit) [IsBid],
	cast([Approved] as bit) [IsApproved],
	cast([ParentID] as int) [ParentID],
	cast([ReportCount] as int) [ReportCount],
	cast([ID] as int) [CommentID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([UserName] as nvarchar(500)) [Name],
	cast([Comment] as nvarchar(4000)) [Comment] 
From stg.[AH_ListingComments_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingComments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingComments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end



19:52:02.781228 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:52:02.781413 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:02.879928 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:03.140626 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.98 seconds
19:52:03.152018 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
19:52:03.152452 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Invoices: rename object "dbo_dbo"."AH_Invoices__dbt_tmp" to AH_Invoices
19:52:03.185776 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:03.188046 [debug] [Thread-3  ]: On model.Shawn.AH_Invoices: COMMIT
19:52:03.190427 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
19:52:03.190795 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
    
  if object_id ('"dbo_dbo"."AH_Invoices__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Invoices__dbt_backup"
    end

19:52:03.244142 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:03.254301 [debug] [Thread-3  ]: finished collecting timing info
19:52:03.254842 [debug] [Thread-3  ]: On model.Shawn.AH_Invoices: Close
19:52:03.255717 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfd0a0>]}
19:52:03.256264 [info ] [Thread-3  ]: 39 of 105 OK created table model dbo_dbo.AH_Invoices............................ [[32mOK[0m in 3.27s]
19:52:03.257401 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Invoices
19:52:03.257682 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingCommentsMedias
19:52:03.258154 [info ] [Thread-3  ]: 46 of 105 START table model dbo_dbo.AH_ListingCommentsMedias.................... [RUN]
19:52:03.259605 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingCommentsMedias"
19:52:03.259822 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingCommentsMedias
19:52:03.260003 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingCommentsMedias
19:52:03.263630 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingCommentsMedias"
19:52:03.264179 [debug] [Thread-3  ]: finished collecting timing info
19:52:03.264384 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingCommentsMedias
19:52:03.277305 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingCommentsMedias"
19:52:03.278102 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
19:52:03.278340 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
  
  if object_id ('"dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedDate_AHListingCommentsMedias],
	cast([DeletedOn] as datetime) [DeletedDate_AHListingCommentsMedias],
	cast([CreatedOn] as datetime) [Created_AHListingCommentsMedias],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([CommentID] as int) [CommentID],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingCommentsMedias_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end



19:52:03.278500 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:03.278729 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:03.379433 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:06.586729 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.31 seconds
19:52:06.597777 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
19:52:06.598218 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: rename object "dbo_dbo"."AH_ListingCommentsMedias__dbt_tmp" to AH_ListingCommentsMedias
19:52:06.631396 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:06.633295 [debug] [Thread-3  ]: On model.Shawn.AH_ListingCommentsMedias: COMMIT
19:52:06.635395 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
19:52:06.635648 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
    
  if object_id ('"dbo_dbo"."AH_ListingCommentsMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingCommentsMedias__dbt_backup"
    end

19:52:06.693051 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:52:06.702832 [debug] [Thread-3  ]: finished collecting timing info
19:52:06.703315 [debug] [Thread-3  ]: On model.Shawn.AH_ListingCommentsMedias: Close
19:52:06.704152 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfd400>]}
19:52:06.704686 [info ] [Thread-3  ]: 46 of 105 OK created table model dbo_dbo.AH_ListingCommentsMedias............... [[32mOK[0m in 3.44s]
19:52:06.706217 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingCommentsMedias
19:52:06.706510 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingEnddttmAudit
19:52:06.707038 [info ] [Thread-3  ]: 47 of 105 START table model dbo_dbo.AH_ListingEnddttmAudit...................... [RUN]
19:52:06.708335 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingEnddttmAudit"
19:52:06.708553 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingEnddttmAudit
19:52:06.708734 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingEnddttmAudit
19:52:06.712902 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingEnddttmAudit"
19:52:06.713847 [debug] [Thread-3  ]: finished collecting timing info
19:52:06.714065 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingEnddttmAudit
19:52:06.726129 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingEnddttmAudit"
19:52:06.726963 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
19:52:06.727200 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
  
  if object_id ('"dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view as
    
Select
	cast([SqlDaTestamp] as datetime) [SqlDaTestamp],
	cast([Enddttm] as datetime) [Enddttm],
	cast([SourceListingID] as int) [SourceListingID],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([Origin] as nvarchar(4000)) [Origin] 
From stg.[AH_ListingEnddttmAudit_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end



19:52:06.727360 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:06.727542 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:06.836466 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:09.862870 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.14 seconds
19:52:09.874381 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
19:52:09.874829 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: rename object "dbo_dbo"."AH_ListingEnddttmAudit__dbt_tmp" to AH_ListingEnddttmAudit
19:52:09.909393 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:09.911517 [debug] [Thread-3  ]: On model.Shawn.AH_ListingEnddttmAudit: COMMIT
19:52:09.913625 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
19:52:09.913849 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
    
  if object_id ('"dbo_dbo"."AH_ListingEnddttmAudit__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingEnddttmAudit__dbt_backup"
    end

19:52:09.950750 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:09.960328 [debug] [Thread-3  ]: finished collecting timing info
19:52:09.960773 [debug] [Thread-3  ]: On model.Shawn.AH_ListingEnddttmAudit: Close
19:52:09.961551 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfdd30>]}
19:52:09.962052 [info ] [Thread-3  ]: 47 of 105 OK created table model dbo_dbo.AH_ListingEnddttmAudit................. [[32mOK[0m in 3.25s]
19:52:09.965566 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingEnddttmAudit
19:52:09.965857 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingLocations
19:52:09.966331 [info ] [Thread-3  ]: 48 of 105 START table model dbo_dbo.AH_ListingLocations......................... [RUN]
19:52:09.967736 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingLocations"
19:52:09.967948 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingLocations
19:52:09.968130 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingLocations
19:52:09.971627 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingLocations"
19:52:09.972127 [debug] [Thread-3  ]: finished collecting timing info
19:52:09.972319 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingLocations
19:52:09.981877 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingLocations"
19:52:09.982518 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
19:52:09.982768 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
  
  if object_id ('"dbo_dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingLocations__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingLocations__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingLocations__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([LocationID] as int) [LocationID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_ListingLocations_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingLocations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingLocations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end



19:52:09.982928 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:09.983099 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:10.084409 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:10.089985 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.31 seconds
19:52:10.100712 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
19:52:10.101105 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: rename object "dbo_dbo"."AH_ListingComments__dbt_tmp" to AH_ListingComments
19:52:10.143776 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:10.145857 [debug] [Thread-2  ]: On model.Shawn.AH_ListingComments: COMMIT
19:52:10.148108 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
19:52:10.148359 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
    
  if object_id ('"dbo_dbo"."AH_ListingComments__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingComments__dbt_backup"
    end

19:52:10.425296 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
19:52:10.436777 [debug] [Thread-2  ]: finished collecting timing info
19:52:10.437191 [debug] [Thread-2  ]: On model.Shawn.AH_ListingComments: Close
19:52:10.438010 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfd6a0>]}
19:52:10.438519 [info ] [Thread-2  ]: 45 of 105 OK created table model dbo_dbo.AH_ListingComments..................... [[32mOK[0m in 7.67s]
19:52:10.439633 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingComments
19:52:10.439918 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingMedias
19:52:10.440383 [info ] [Thread-2  ]: 49 of 105 START table model dbo_dbo.AH_ListingMedias............................ [RUN]
19:52:10.441717 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingMedias"
19:52:10.441929 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingMedias
19:52:10.442114 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingMedias
19:52:10.445474 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingMedias"
19:52:10.446202 [debug] [Thread-2  ]: finished collecting timing info
19:52:10.446411 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingMedias
19:52:10.456468 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingMedias"
19:52:10.457140 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
19:52:10.457351 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
  
  if object_id ('"dbo_dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingMedias__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingMedias__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([ListingID] as int) [ListingID],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingMedias_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end



19:52:10.457504 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:52:10.457687 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:10.597599 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:11.878092 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 9.55 seconds
19:52:11.889610 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
19:52:11.890015 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: rename object "dbo_dbo"."AH_ListingActionproperties__dbt_tmp" to AH_ListingActionproperties
19:52:11.967229 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:52:11.969241 [debug] [Thread-1  ]: On model.Shawn.AH_ListingActionproperties: COMMIT
19:52:11.972807 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
19:52:11.973122 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
    
  if object_id ('"dbo_dbo"."AH_ListingActionproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingActionproperties__dbt_backup"
    end

19:52:12.156406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
19:52:12.166206 [debug] [Thread-1  ]: finished collecting timing info
19:52:12.166699 [debug] [Thread-1  ]: On model.Shawn.AH_ListingActionproperties: Close
19:52:12.167527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfd550>]}
19:52:12.168043 [info ] [Thread-1  ]: 43 of 105 OK created table model dbo_dbo.AH_ListingActionproperties............. [[32mOK[0m in 9.85s]
19:52:12.169128 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingActionproperties
19:52:12.169401 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingPaymentCharge
19:52:12.169854 [info ] [Thread-1  ]: 50 of 105 START table model dbo_dbo.AH_ListingPaymentCharge..................... [RUN]
19:52:12.171195 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge"
19:52:12.171412 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge
19:52:12.171596 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingPaymentCharge
19:52:12.175186 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge"
19:52:12.175700 [debug] [Thread-1  ]: finished collecting timing info
19:52:12.175897 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingPaymentCharge
19:52:12.186013 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge"
19:52:12.186690 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
19:52:12.186901 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
  
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view as
    
Select
	cast([BuyerID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([ID] as int) [ID],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([CreatedOn] as datetime) [Created],
	cast([TransactionID] as nvarchar(30)) [TransactionID],
	cast([ChargeAmount] as decimal(24,2)) [ChargeAmount],
	cast([TotalBID] as decimal(24,2)) [TotalBid],
	cast([BidHoldPercentage] as decimal(24,3)) [BidHoldPercentage],
	cast([MaximumBidCharge] as decimal(24,2)) [MaximumBidCharge] 
From stg.[AH_ListingPaymentCharge_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end



19:52:12.187067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:12.187243 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:12.349016 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:13.356573 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.37 seconds
19:52:13.368333 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
19:52:13.368777 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: rename object "dbo_dbo"."AH_ListingLocations__dbt_tmp" to AH_ListingLocations
19:52:13.426382 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:52:13.428300 [debug] [Thread-3  ]: On model.Shawn.AH_ListingLocations: COMMIT
19:52:13.430361 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
19:52:13.430617 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
    
  if object_id ('"dbo_dbo"."AH_ListingLocations__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingLocations__dbt_backup"
    end

19:52:13.511411 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:52:13.523309 [debug] [Thread-3  ]: finished collecting timing info
19:52:13.524201 [debug] [Thread-3  ]: On model.Shawn.AH_ListingLocations: Close
19:52:13.525129 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfde80>]}
19:52:13.525659 [info ] [Thread-3  ]: 48 of 105 OK created table model dbo_dbo.AH_ListingLocations.................... [[32mOK[0m in 3.56s]
19:52:13.526780 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingLocations
19:52:13.527056 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingQuestions
19:52:13.527527 [info ] [Thread-3  ]: 51 of 105 START table model dbo_dbo.AH_ListingQuestions......................... [RUN]
19:52:13.528850 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingQuestions"
19:52:13.529066 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingQuestions
19:52:13.529247 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingQuestions
19:52:13.533418 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingQuestions"
19:52:13.533989 [debug] [Thread-3  ]: finished collecting timing info
19:52:13.534200 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingQuestions
19:52:13.544656 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingQuestions"
19:52:13.545375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
19:52:13.545602 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
  
  if object_id ('"dbo_dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingQuestions__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingQuestions__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingQuestions__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([Question] as nvarchar(4000)) [Question],
	cast([Answer] as nvarchar(4000)) [Answer] 
From stg.[AH_ListingQuestions_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingQuestions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingQuestions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end



19:52:13.545769 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:13.545948 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:13.614771 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 11.08 seconds
19:52:13.626991 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
19:52:13.627396 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: rename object "dbo_dbo"."AH_ListingActions__dbt_tmp" to AH_ListingActions
19:52:13.654998 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:13.668819 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:13.670776 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActions: COMMIT
19:52:13.672796 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
19:52:13.673017 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
    
  if object_id ('"dbo_dbo"."AH_ListingActions__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingActions__dbt_backup"
    end

19:52:13.712798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:13.725087 [debug] [Thread-4  ]: finished collecting timing info
19:52:13.729864 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActions: Close
19:52:13.730827 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfd7f0>]}
19:52:13.731354 [info ] [Thread-4  ]: 44 of 105 OK created table model dbo_dbo.AH_ListingActions...................... [[32mOK[0m in 11.22s]
19:52:13.732445 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingActions
19:52:13.732721 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingTypeFeeprovIDErs
19:52:13.733165 [info ] [Thread-4  ]: 52 of 105 START table model dbo_dbo.AH_ListingTypeFeeprovIDErs.................. [RUN]
19:52:13.735515 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs"
19:52:13.735890 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingTypeFeeprovIDErs
19:52:13.736102 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingTypeFeeprovIDErs
19:52:13.742785 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
19:52:13.744953 [debug] [Thread-4  ]: finished collecting timing info
19:52:13.745165 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingTypeFeeprovIDErs
19:52:13.759343 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
19:52:13.759949 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
19:52:13.760150 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
  
  if object_id ('"dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProvIDErName],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_ListingTypeFeeprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end



19:52:13.760316 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:13.760493 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:13.852576 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.40 seconds
19:52:13.863069 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
19:52:13.863463 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: rename object "dbo_dbo"."AH_ListingMedias__dbt_tmp" to AH_ListingMedias
19:52:13.876989 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:13.893146 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:13.895227 [debug] [Thread-2  ]: On model.Shawn.AH_ListingMedias: COMMIT
19:52:13.897962 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
19:52:13.898220 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
    
  if object_id ('"dbo_dbo"."AH_ListingMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingMedias__dbt_backup"
    end

19:52:14.124974 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
19:52:14.134721 [debug] [Thread-2  ]: finished collecting timing info
19:52:14.135152 [debug] [Thread-2  ]: On model.Shawn.AH_ListingMedias: Close
19:52:14.135946 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfdbe0>]}
19:52:14.136461 [info ] [Thread-2  ]: 49 of 105 OK created table model dbo_dbo.AH_ListingMedias....................... [[32mOK[0m in 3.69s]
19:52:14.138118 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingMedias
19:52:14.138417 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingTypeMedia
19:52:14.138905 [info ] [Thread-2  ]: 53 of 105 START table model dbo_dbo.AH_ListingTypeMedia......................... [RUN]
19:52:14.139809 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeMedia"
19:52:14.140017 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingTypeMedia
19:52:14.140194 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingTypeMedia
19:52:14.143344 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeMedia"
19:52:14.144109 [debug] [Thread-2  ]: finished collecting timing info
19:52:14.144310 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingTypeMedia
19:52:14.154004 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeMedia"
19:52:14.154653 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
19:52:14.154864 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
  
  if object_id ('"dbo_dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingTypeMedia__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypeMedia__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingTypeMedia__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([MediaassetName] as nvarchar(4000)) [MediaassetName],
	cast([Scope] as nvarchar(4000)) [Scope] 
From stg.[AH_ListingTypeMedia_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingTypeMedia__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingTypeMedia__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end



19:52:14.155027 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:52:14.155203 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:14.291330 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:15.238232 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.05 seconds
19:52:15.328100 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
19:52:15.328517 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: rename object "dbo_dbo"."AH_ListingPaymentCharge__dbt_tmp" to AH_ListingPaymentCharge
19:52:15.363437 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:15.365405 [debug] [Thread-1  ]: On model.Shawn.AH_ListingPaymentCharge: COMMIT
19:52:15.367605 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
19:52:15.367870 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
    
  if object_id ('"dbo_dbo"."AH_ListingPaymentCharge__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingPaymentCharge__dbt_backup"
    end

19:52:15.413010 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:15.423254 [debug] [Thread-1  ]: finished collecting timing info
19:52:15.423734 [debug] [Thread-1  ]: On model.Shawn.AH_ListingPaymentCharge: Close
19:52:15.424556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0cd75e0>]}
19:52:15.425099 [info ] [Thread-1  ]: 50 of 105 OK created table model dbo_dbo.AH_ListingPaymentCharge................ [[32mOK[0m in 3.25s]
19:52:15.426195 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingPaymentCharge
19:52:15.426474 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingTypeproperties
19:52:15.426959 [info ] [Thread-1  ]: 54 of 105 START table model dbo_dbo.AH_ListingTypeproperties.................... [RUN]
19:52:15.428250 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeproperties"
19:52:15.428458 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingTypeproperties
19:52:15.428639 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingTypeproperties
19:52:15.432149 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeproperties"
19:52:15.432647 [debug] [Thread-1  ]: finished collecting timing info
19:52:15.432835 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingTypeproperties
19:52:15.443801 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeproperties"
19:52:15.444388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
19:52:15.444598 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
  
  if object_id ('"dbo_dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingTypeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypeproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingTypeproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Scope] as nvarchar(4000)) [Scope],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([BoolnativeValue] as bit) [BoolnativeValue] 
From stg.[AH_ListingTypeproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingTypeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingTypeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end



19:52:15.444754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:15.444927 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:15.540658 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:16.215101 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.67 seconds
19:52:16.226408 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
19:52:16.226815 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: rename object "dbo_dbo"."AH_ListingQuestions__dbt_tmp" to AH_ListingQuestions
19:52:16.392162 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
19:52:16.394116 [debug] [Thread-3  ]: On model.Shawn.AH_ListingQuestions: COMMIT
19:52:16.396184 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
19:52:16.396423 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
    
  if object_id ('"dbo_dbo"."AH_ListingQuestions__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingQuestions__dbt_backup"
    end

19:52:16.448937 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:16.458424 [debug] [Thread-3  ]: finished collecting timing info
19:52:16.458882 [debug] [Thread-3  ]: On model.Shawn.AH_ListingQuestions: Close
19:52:16.459681 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df40a0>]}
19:52:16.460187 [info ] [Thread-3  ]: 51 of 105 OK created table model dbo_dbo.AH_ListingQuestions.................... [[32mOK[0m in 2.93s]
19:52:16.461294 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingQuestions
19:52:16.461563 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingTypes
19:52:16.462007 [info ] [Thread-3  ]: 55 of 105 START table model dbo_dbo.AH_ListingTypes............................. [RUN]
19:52:16.463295 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypes"
19:52:16.463521 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingTypes
19:52:16.463713 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingTypes
19:52:16.467162 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypes"
19:52:16.467649 [debug] [Thread-3  ]: finished collecting timing info
19:52:16.467839 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingTypes
19:52:16.477433 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypes"
19:52:16.477976 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
19:52:16.478163 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
  
  if object_id ('"dbo_dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypes__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingTypes_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end



19:52:16.478318 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:16.478486 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:16.531674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.77 seconds
19:52:16.546422 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
19:52:16.546889 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: rename object "dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp" to AH_ListingTypeFeeprovIDErs
19:52:16.570563 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.42 seconds
19:52:16.581518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
19:52:16.581765 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:16.581857 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:16.583877 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: COMMIT
19:52:16.585578 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
19:52:16.585722 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
    
  if object_id ('"dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"
    end

19:52:16.582120 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: rename object "dbo_dbo"."AH_ListingTypeMedia__dbt_tmp" to AH_ListingTypeMedia
19:52:16.618307 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:16.620422 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeMedia: COMMIT
19:52:16.622776 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
19:52:16.623060 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
    
  if object_id ('"dbo_dbo"."AH_ListingTypeMedia__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypeMedia__dbt_backup"
    end

19:52:16.625916 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:16.635651 [debug] [Thread-4  ]: finished collecting timing info
19:52:16.636097 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: Close
19:52:16.636914 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0bf37f0>]}
19:52:16.637430 [info ] [Thread-4  ]: 52 of 105 OK created table model dbo_dbo.AH_ListingTypeFeeprovIDErs............. [[32mOK[0m in 2.90s]
19:52:16.638496 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingTypeFeeprovIDErs
19:52:16.638822 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Listingdecorations
19:52:16.639276 [info ] [Thread-4  ]: 56 of 105 START table model dbo_dbo.AH_Listingdecorations....................... [RUN]
19:52:16.640609 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Listingdecorations"
19:52:16.640823 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Listingdecorations
19:52:16.641006 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Listingdecorations
19:52:16.644169 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Listingdecorations"
19:52:16.644887 [debug] [Thread-4  ]: finished collecting timing info
19:52:16.645130 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Listingdecorations
19:52:16.655624 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Listingdecorations"
19:52:16.656293 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
19:52:16.656498 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
  
  if object_id ('"dbo_dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Listingdecorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listingdecorations__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Listingdecorations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([DecorationID] as int) [DecorationID],
	cast([ListingID] as int) [ListingID] 
From stg.[AH_Listingdecorations_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Listingdecorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Listingdecorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end



19:52:16.656656 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:16.656827 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:16.660840 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:16.669708 [debug] [Thread-2  ]: finished collecting timing info
19:52:16.670100 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeMedia: Close
19:52:16.670890 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df4160>]}
19:52:16.671391 [info ] [Thread-2  ]: 53 of 105 OK created table model dbo_dbo.AH_ListingTypeMedia.................... [[32mOK[0m in 2.53s]
19:52:16.677681 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingTypeMedia
19:52:16.678001 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Listingproperties
19:52:16.678487 [info ] [Thread-2  ]: 57 of 105 START table model dbo_dbo.AH_Listingproperties........................ [RUN]
19:52:16.679828 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Listingproperties"
19:52:16.680049 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Listingproperties
19:52:16.680238 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Listingproperties
19:52:16.683405 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Listingproperties"
19:52:16.686967 [debug] [Thread-2  ]: finished collecting timing info
19:52:16.687235 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Listingproperties
19:52:16.697439 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Listingproperties"
19:52:16.698117 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
19:52:16.698337 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
  
  if object_id ('"dbo_dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Listingproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listingproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Listingproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as decimal(29,14)) [DecimalNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(200)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXListingProperties],
	cast([CreatedOn] as datetime) [Created_RWXListingProperties],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXListingProperties],
	cast([DeletedOn] as datetime) [DeletedDate_RWXListingProperties],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([BoolnativeValue] as bit) [HasBoolNativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([ListingID] as int) [ListingID],
	cast([CustomFieldID] as int) [CustomFieldID] 
From stg.[AH_Listingproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Listingproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Listingproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end



19:52:16.698500 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:52:16.698718 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:16.790141 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:16.798274 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:17.331373 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
19:52:17.343689 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
19:52:17.344087 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: rename object "dbo_dbo"."AH_ListingTypeproperties__dbt_tmp" to AH_ListingTypeproperties
19:52:17.391768 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:17.393844 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypeproperties: COMMIT
19:52:17.396105 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
19:52:17.396353 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
    
  if object_id ('"dbo_dbo"."AH_ListingTypeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypeproperties__dbt_backup"
    end

19:52:17.433453 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:17.444709 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.445122 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypeproperties: Close
19:52:17.445931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df42b0>]}
19:52:17.446439 [info ] [Thread-1  ]: 54 of 105 OK created table model dbo_dbo.AH_ListingTypeproperties............... [[32mOK[0m in 2.02s]
19:52:17.447550 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingTypeproperties
19:52:17.447817 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings
19:52:17.448274 [info ] [Thread-1  ]: 58 of 105 START table model dbo_dbo.AH_Listings................................. [RUN]
19:52:17.449581 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings"
19:52:17.449793 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings
19:52:17.449970 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings
19:52:17.453676 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings"
19:52:17.454200 [debug] [Thread-1  ]: finished collecting timing info
19:52:17.454394 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings
19:52:17.464642 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings"
19:52:17.465273 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
19:52:17.465489 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
  
  if object_id ('"dbo_dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Listings__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listings__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Listings__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([PrimaryImageURI] as nvarchar(2048)) [PrimaryImageURL],
	cast([OwnerUserName] as nvarchar(500)) [OwnerUserName],
	cast([CurrentListingActionUserName] as nvarchar(500)) [CurrentListingActionUserName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([Description] as nvarchar(4000)) [Description],
	cast([SubTitle] as nvarchar(4000)) [Subtitle],
	cast([Location] as nvarchar(4000)) [Location],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([Startdttm] as datetime) [StartDTTM],
	cast([AutoreListrEMAining] as int) [AutoreListrEMAining],
	cast([CurrentQuantity] as int) [CurrentQuantity],
	cast([OriginalQuantity] as int) [OriginalQuantity],
	cast([ReListiteration] as int) [ReListiteration],
	cast([LotID] as int) [LotID],
	cast([AcceptedActionCount] as int) [AcceptedActionCount],
	cast([OwnerID] as int) [OwnerID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([Duration] as int) [Duration],
	cast([Version] as int) [Version],
	cast([CurrencyID] as money) [CurrencyID],
	cast([PrimaryCategoryID] as int) [PrimaryCategoryId],
	cast([CurrentListingActionID] as int) [CurrentListingActionId],
	cast([OfferCount] as int) [OfferCount],
	cast([ID] as int) [ListingID],
	cast([OriginalreListCount] as int) [OriginalreListCount],
	cast([Hits] as int) [Hits],
	cast([CurrentPrice] as decimal(24,2)) [CurrentPrice],
	cast([Increment] as decimal(24,2)) [Increment],
	cast([OriginalPrice] as money) [OriginalPrice] 
From stg.[AH_Listings_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Listings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Listings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Listings__dbt_tmp_temp_view"
    end



19:52:17.465658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:17.465836 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:17.566607 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:18.445047 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.97 seconds
19:52:18.456146 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
19:52:18.456563 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: rename object "dbo_dbo"."AH_ListingTypes__dbt_tmp" to AH_ListingTypes
19:52:19.262065 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.81 seconds
19:52:19.264133 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypes: COMMIT
19:52:19.266442 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
19:52:19.266719 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
    
  if object_id ('"dbo_dbo"."AH_ListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingTypes__dbt_backup"
    end

19:52:19.311101 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:19.320979 [debug] [Thread-3  ]: finished collecting timing info
19:52:19.321435 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypes: Close
19:52:19.322257 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df4400>]}
19:52:19.322810 [info ] [Thread-3  ]: 55 of 105 OK created table model dbo_dbo.AH_ListingTypes........................ [[32mOK[0m in 2.86s]
19:52:19.324124 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingTypes
19:52:19.324404 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingsReserveHistory
19:52:19.324855 [info ] [Thread-3  ]: 59 of 105 START table model dbo_dbo.AH_ListingsReserveHistory................... [RUN]
19:52:19.326184 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingsReserveHistory"
19:52:19.326396 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingsReserveHistory
19:52:19.326604 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingsReserveHistory
19:52:19.330264 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingsReserveHistory"
19:52:19.330813 [debug] [Thread-3  ]: finished collecting timing info
19:52:19.331011 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingsReserveHistory
19:52:19.341782 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingsReserveHistory"
19:52:19.342611 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
19:52:19.342855 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
  
  if object_id ('"dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([OldReserve] as numeric(19,4)) [OldReserve],
	cast([NewReserve] as numeric(19,4)) [NewReserve] 
From stg.[AH_ListingsReserveHistory_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end



19:52:19.343030 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:19.343214 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:19.444296 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:19.577433 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.92 seconds
19:52:19.589154 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
19:52:19.589587 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: rename object "dbo_dbo"."AH_Listingdecorations__dbt_tmp" to AH_Listingdecorations
19:52:19.707807 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
19:52:19.709893 [debug] [Thread-4  ]: On model.Shawn.AH_Listingdecorations: COMMIT
19:52:19.712173 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
19:52:19.712430 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
    
  if object_id ('"dbo_dbo"."AH_Listingdecorations__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listingdecorations__dbt_backup"
    end

19:52:19.788250 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:52:19.800046 [debug] [Thread-4  ]: finished collecting timing info
19:52:19.800517 [debug] [Thread-4  ]: On model.Shawn.AH_Listingdecorations: Close
19:52:19.801334 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df4550>]}
19:52:19.801849 [info ] [Thread-4  ]: 56 of 105 OK created table model dbo_dbo.AH_Listingdecorations.................. [[32mOK[0m in 3.16s]
19:52:19.803228 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Listingdecorations
19:52:19.803523 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Locations
19:52:19.803987 [info ] [Thread-4  ]: 60 of 105 START table model dbo_dbo.AH_Locations................................ [RUN]
19:52:19.804930 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Locations"
19:52:19.805142 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Locations
19:52:19.805321 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Locations
19:52:19.808620 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Locations"
19:52:19.809302 [debug] [Thread-4  ]: finished collecting timing info
19:52:19.809500 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Locations
19:52:19.819811 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Locations"
19:52:19.820553 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
19:52:19.820769 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
  
  if object_id ('"dbo_dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Locations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Locations__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Locations__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Locations__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([PayToproceed] as bit) [PayToproceed],
	cast([ID] as int) [ID] 
From stg.[AH_Locations_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Locations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Locations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Locations__dbt_tmp_temp_view"
    end



19:52:19.820940 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:19.821121 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:19.956853 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:20.508113 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.04 seconds
19:52:20.521217 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
19:52:20.521606 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings: rename object "dbo_dbo"."AH_Listings__dbt_tmp" to AH_Listings
19:52:20.562617 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:20.564647 [debug] [Thread-1  ]: On model.Shawn.AH_Listings: COMMIT
19:52:20.566710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
19:52:20.566943 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
    
  if object_id ('"dbo_dbo"."AH_Listings__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listings__dbt_backup"
    end

19:52:20.603505 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:20.612854 [debug] [Thread-1  ]: finished collecting timing info
19:52:20.613287 [debug] [Thread-1  ]: On model.Shawn.AH_Listings: Close
19:52:20.614086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df47f0>]}
19:52:20.700407 [info ] [Thread-1  ]: 58 of 105 OK created table model dbo_dbo.AH_Listings............................ [[32mOK[0m in 3.16s]
19:52:20.702260 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings
19:52:20.702633 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Logentries
19:52:20.703087 [info ] [Thread-1  ]: 61 of 105 START table model dbo_dbo.AH_Logentries............................... [RUN]
19:52:20.704073 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Logentries"
19:52:20.704289 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Logentries
19:52:20.704470 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Logentries
19:52:20.707722 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Logentries"
19:52:20.708379 [debug] [Thread-1  ]: finished collecting timing info
19:52:20.708576 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Logentries
19:52:20.718771 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Logentries"
19:52:20.719356 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
19:52:20.719549 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
  
  if object_id ('"dbo_dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Logentries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Logentries__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Logentries__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Logentries__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID],
	cast([SqlDaTestamp] as datetime) [SqlDaTestamp],
	cast([EntryDaTestamp] as datetime) [EntryDaTestamp],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [Stacktrace],
	cast([Properties] as nvarchar(4000)) [Properties] 
From stg.[AH_Logentries_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Logentries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Logentries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Logentries__dbt_tmp_temp_view"
    end



19:52:20.719717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:20.719893 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:20.833676 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:21.602458 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.26 seconds
19:52:21.614282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
19:52:21.614675 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: rename object "dbo_dbo"."AH_ListingsReserveHistory__dbt_tmp" to AH_ListingsReserveHistory
19:52:21.649118 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:21.651216 [debug] [Thread-3  ]: On model.Shawn.AH_ListingsReserveHistory: COMMIT
19:52:21.653422 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
19:52:21.653670 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
    
  if object_id ('"dbo_dbo"."AH_ListingsReserveHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ListingsReserveHistory__dbt_backup"
    end

19:52:21.702707 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:21.712735 [debug] [Thread-3  ]: finished collecting timing info
19:52:21.713147 [debug] [Thread-3  ]: On model.Shawn.AH_ListingsReserveHistory: Close
19:52:21.713923 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df4940>]}
19:52:21.714428 [info ] [Thread-3  ]: 59 of 105 OK created table model dbo_dbo.AH_ListingsReserveHistory.............. [[32mOK[0m in 2.39s]
19:52:21.715570 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingsReserveHistory
19:52:21.715841 [debug] [Thread-3  ]: Began running node model.Shawn.AH_LogentriesBuffer
19:52:21.716275 [info ] [Thread-3  ]: 62 of 105 START table model dbo_dbo.AH_LogentriesBuffer......................... [RUN]
19:52:21.717522 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_LogentriesBuffer"
19:52:21.717730 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_LogentriesBuffer
19:52:21.717906 [debug] [Thread-3  ]: Compiling model.Shawn.AH_LogentriesBuffer
19:52:21.721059 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_LogentriesBuffer"
19:52:21.721719 [debug] [Thread-3  ]: finished collecting timing info
19:52:21.721912 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_LogentriesBuffer
19:52:21.731641 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_LogentriesBuffer"
19:52:21.732205 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
19:52:21.732398 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
  
  if object_id ('"dbo_dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_LogentriesBuffer__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_LogentriesBuffer__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_LogentriesBuffer__dbt_tmp_temp_view as
    
Select
	cast([Message] as nvarchar(4000)) [Message],
	cast([Properties] as nvarchar(4000)) [Properties],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [Stacktrace],
	cast([SqlDaTestamp] as datetime) [SqlDaTestamp],
	cast([EntryDaTestamp] as datetime) [EntryDaTestamp],
	cast([ID] as int) [ID],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID] 
From stg.[AH_LogentriesBuffer_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_LogentriesBuffer__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_LogentriesBuffer__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end



19:52:21.732565 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:21.732738 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:21.831003 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:23.131032 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.31 seconds
19:52:23.141947 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
19:52:23.142324 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Locations: rename object "dbo_dbo"."AH_Locations__dbt_tmp" to AH_Locations
19:52:23.184490 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:23.186565 [debug] [Thread-4  ]: On model.Shawn.AH_Locations: COMMIT
19:52:23.188865 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
19:52:23.189117 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
    
  if object_id ('"dbo_dbo"."AH_Locations__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Locations__dbt_backup"
    end

19:52:23.238610 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:23.248647 [debug] [Thread-4  ]: finished collecting timing info
19:52:23.249124 [debug] [Thread-4  ]: On model.Shawn.AH_Locations: Close
19:52:23.249949 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0bbf670>]}
19:52:23.250485 [info ] [Thread-4  ]: 60 of 105 OK created table model dbo_dbo.AH_Locations........................... [[32mOK[0m in 3.45s]
19:52:23.251635 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Locations
19:52:23.251907 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Logstats
19:52:23.252349 [info ] [Thread-4  ]: 63 of 105 START table model dbo_dbo.AH_Logstats................................. [RUN]
19:52:23.253665 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats"
19:52:23.253879 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Logstats
19:52:23.254061 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Logstats
19:52:23.257326 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Logstats"
19:52:23.258063 [debug] [Thread-4  ]: finished collecting timing info
19:52:23.258274 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Logstats
19:52:23.269019 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats"
19:52:23.269731 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
19:52:23.269945 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
  
  if object_id ('"dbo_dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Logstats__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Logstats__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Logstats__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Logstats__dbt_tmp_temp_view as
    
Select
	cast([FromDate] as datetime) [FromDate],
	cast([RangeMinutes] as int) [RangeMinutes],
	cast([EntryCount] as int) [EntryCount],
	cast([IsArchived] as bit) [IsArchived],
	cast([Severity] as nvarchar(4000)) [Severity] 
From stg.[AH_Logstats_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Logstats__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Logstats__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Logstats__dbt_tmp_temp_view"
    end



19:52:23.270103 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:23.270273 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:23.381860 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:25.207183 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.47 seconds
19:52:25.218625 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
19:52:25.219025 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: rename object "dbo_dbo"."AH_LogentriesBuffer__dbt_tmp" to AH_LogentriesBuffer
19:52:25.256555 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:25.258623 [debug] [Thread-3  ]: On model.Shawn.AH_LogentriesBuffer: COMMIT
19:52:25.260663 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
19:52:25.260882 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
    
  if object_id ('"dbo_dbo"."AH_LogentriesBuffer__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_LogentriesBuffer__dbt_backup"
    end

19:52:25.297917 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:25.308496 [debug] [Thread-3  ]: finished collecting timing info
19:52:25.308960 [debug] [Thread-3  ]: On model.Shawn.AH_LogentriesBuffer: Close
19:52:25.309758 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df4e80>]}
19:52:25.310265 [info ] [Thread-3  ]: 62 of 105 OK created table model dbo_dbo.AH_LogentriesBuffer.................... [[32mOK[0m in 3.59s]
19:52:25.311527 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_LogentriesBuffer
19:52:25.311795 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Lots
19:52:25.312224 [info ] [Thread-3  ]: 64 of 105 START table model dbo_dbo.AH_Lots..................................... [RUN]
19:52:25.313460 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Lots"
19:52:25.313671 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Lots
19:52:25.313851 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Lots
19:52:25.317121 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Lots"
19:52:25.317836 [debug] [Thread-3  ]: finished collecting timing info
19:52:25.318029 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Lots
19:52:25.327905 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Lots"
19:52:25.328485 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
19:52:25.328680 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
  
  if object_id ('"dbo_dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Lots__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Lots__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Lots__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Lots__dbt_tmp_temp_view as
    
Select
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([IsSoftclosing] as bit) [IsSoftclosing],
	cast([SoftclosingGroup] as int) [SoftclosingGroup],
	cast([LotOrder] as int) [LotOrder],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([ID] as int) [ID],
	cast([ClosingGroup] as int) [ClosingGroup],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Lots_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Lots__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Lots__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Lots__dbt_tmp_temp_view"
    end



19:52:25.328831 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:25.329004 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:25.438610 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:25.809253 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.54 seconds
19:52:25.901499 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
19:52:25.901913 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Logstats: rename object "dbo_dbo"."AH_Logstats__dbt_tmp" to AH_Logstats
19:52:25.936104 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:25.937914 [debug] [Thread-4  ]: On model.Shawn.AH_Logstats: COMMIT
19:52:25.942228 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
19:52:25.942473 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
    
  if object_id ('"dbo_dbo"."AH_Logstats__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Logstats__dbt_backup"
    end

19:52:25.980971 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:25.990227 [debug] [Thread-4  ]: finished collecting timing info
19:52:25.990663 [debug] [Thread-4  ]: On model.Shawn.AH_Logstats: Close
19:52:25.991462 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d950a0>]}
19:52:25.991967 [info ] [Thread-4  ]: 63 of 105 OK created table model dbo_dbo.AH_Logstats............................ [[32mOK[0m in 2.74s]
19:52:25.993063 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Logstats
19:52:25.993334 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Media
19:52:25.993770 [info ] [Thread-4  ]: 65 of 105 START table model dbo_dbo.AH_Media.................................... [RUN]
19:52:25.995197 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Media"
19:52:25.995417 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Media
19:52:25.995599 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Media
19:52:25.998566 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Media"
19:52:25.999217 [debug] [Thread-4  ]: finished collecting timing info
19:52:25.999410 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Media
19:52:26.009588 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Media"
19:52:26.010150 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
19:52:26.010343 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Media: 
  
  if object_id ('"dbo_dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Media__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Media__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Media__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Media__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created_RWXMedia],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMedia],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMedia],
	cast([ID] as int) [MediaID],
	cast([GUID] as uniqueidentifier) [GUID],
	cast([DefaultvariationName] as nvarchar(500)) [DefaultVariationName],
	cast([Loader] as nvarchar(500)) [Loader],
	cast([Saver] as nvarchar(500)) [Saver],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([ConText] as nvarchar(4000)) [Context],
	cast([Status] as nvarchar(100)) [Status] 
From stg.[AH_Media_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Media__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Media__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Media__dbt_tmp_temp_view"
    end



19:52:26.010496 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:26.010699 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:26.110751 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:28.713949 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.39 seconds
19:52:28.729315 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
19:52:28.734174 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Lots: rename object "dbo_dbo"."AH_Lots__dbt_tmp" to AH_Lots
19:52:28.785911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:52:28.787809 [debug] [Thread-3  ]: On model.Shawn.AH_Lots: COMMIT
19:52:28.789921 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
19:52:28.790093 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
    
  if object_id ('"dbo_dbo"."AH_Lots__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Lots__dbt_backup"
    end

19:52:28.866204 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:52:28.877053 [debug] [Thread-3  ]: finished collecting timing info
19:52:28.877519 [debug] [Thread-3  ]: On model.Shawn.AH_Lots: Close
19:52:28.878327 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d952b0>]}
19:52:28.878905 [info ] [Thread-3  ]: 64 of 105 OK created table model dbo_dbo.AH_Lots................................ [[32mOK[0m in 3.56s]
19:52:28.880148 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Lots
19:52:28.880428 [debug] [Thread-3  ]: Began running node model.Shawn.AH_MediaMetaData
19:52:28.880873 [info ] [Thread-3  ]: 66 of 105 START table model dbo_dbo.AH_MediaMetaData............................ [RUN]
19:52:28.882243 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_MediaMetaData"
19:52:28.882457 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_MediaMetaData
19:52:28.882663 [debug] [Thread-3  ]: Compiling model.Shawn.AH_MediaMetaData
19:52:28.886295 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_MediaMetaData"
19:52:28.887515 [debug] [Thread-3  ]: finished collecting timing info
19:52:28.887720 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_MediaMetaData
19:52:28.898259 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_MediaMetaData"
19:52:28.899002 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
19:52:28.899223 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
  
  if object_id ('"dbo_dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_MediaMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_MediaMetaData__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_MediaMetaData__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Name_RWXMediaMetaData],
	cast([Value] as nvarchar(4000)) [Value],
	cast([ID] as int) [MediaMetaDataID_RWXMediaMetaData],
	cast([CreatedOn] as datetime) [Created_RWXMediaMetaData],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaMetaData],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaMetaData] 
From stg.[AH_MediaMetaData_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_MediaMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_MediaMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end



19:52:28.899380 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:52:28.899554 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:29.009645 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:29.379874 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.66 seconds
19:52:29.391876 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
19:52:29.392282 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Logentries: rename object "dbo_dbo"."AH_Logentries__dbt_tmp" to AH_Logentries
19:52:29.424107 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:52:29.426200 [debug] [Thread-1  ]: On model.Shawn.AH_Logentries: COMMIT
19:52:29.428417 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
19:52:29.428644 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
    
  if object_id ('"dbo_dbo"."AH_Logentries__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Logentries__dbt_backup"
    end

19:52:29.464875 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:29.475321 [debug] [Thread-1  ]: finished collecting timing info
19:52:29.475788 [debug] [Thread-1  ]: On model.Shawn.AH_Logentries: Close
19:52:29.476617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c47370>]}
19:52:29.477122 [info ] [Thread-1  ]: 61 of 105 OK created table model dbo_dbo.AH_Logentries.......................... [[32mOK[0m in 8.77s]
19:52:29.478182 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Logentries
19:52:29.478451 [debug] [Thread-1  ]: Began running node model.Shawn.AH_MediaassetMetaData
19:52:29.478939 [info ] [Thread-1  ]: 67 of 105 START table model dbo_dbo.AH_MediaassetMetaData....................... [RUN]
19:52:29.480305 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_MediaassetMetaData"
19:52:29.480522 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_MediaassetMetaData
19:52:29.480719 [debug] [Thread-1  ]: Compiling model.Shawn.AH_MediaassetMetaData
19:52:29.484263 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_MediaassetMetaData"
19:52:29.484784 [debug] [Thread-1  ]: finished collecting timing info
19:52:29.484978 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_MediaassetMetaData
19:52:29.495640 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_MediaassetMetaData"
19:52:29.496403 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
19:52:29.496639 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
  
  if object_id ('"dbo_dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_MediaassetMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_MediaassetMetaData__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_MediaassetMetaData__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID_RWXMediaAssetMetaData],
	cast([MediaassetID] as int) [MediaAssetID],
	cast([MediaMetaDataID] as int) [MediaMetaDataID_RWXMediaAssetMetaData],
	cast([CreatedOn] as datetime) [Created_RWXMediaAssetMetaData],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaAssetMetaData],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaAssetMetaData] 
From stg.[AH_MediaassetMetaData_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_MediaassetMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_MediaassetMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end



19:52:29.496799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:29.496975 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:29.624056 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:52.307159 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 22.81 seconds
19:52:52.319366 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
19:52:52.319763 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: rename object "dbo_dbo"."AH_MediaassetMetaData__dbt_tmp" to AH_MediaassetMetaData
19:52:52.388725 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:52:52.390760 [debug] [Thread-1  ]: On model.Shawn.AH_MediaassetMetaData: COMMIT
19:52:52.392837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
19:52:52.393065 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
    
  if object_id ('"dbo_dbo"."AH_MediaassetMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_MediaassetMetaData__dbt_backup"
    end

19:52:52.432199 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:52.441522 [debug] [Thread-1  ]: finished collecting timing info
19:52:52.441919 [debug] [Thread-1  ]: On model.Shawn.AH_MediaassetMetaData: Close
19:52:52.442700 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d95160>]}
19:52:52.443190 [info ] [Thread-1  ]: 67 of 105 OK created table model dbo_dbo.AH_MediaassetMetaData.................. [[32mOK[0m in 22.96s]
19:52:52.444337 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_MediaassetMetaData
19:52:52.444602 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Mediaassets
19:52:52.445054 [info ] [Thread-1  ]: 68 of 105 START table model dbo_dbo.AH_Mediaassets.............................. [RUN]
19:52:52.446325 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Mediaassets"
19:52:52.446535 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Mediaassets
19:52:52.446748 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Mediaassets
19:52:52.450044 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Mediaassets"
19:52:52.450771 [debug] [Thread-1  ]: finished collecting timing info
19:52:52.450969 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Mediaassets
19:52:52.462706 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Mediaassets"
19:52:52.463285 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
19:52:52.463484 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
  
  if object_id ('"dbo_dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Mediaassets__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Mediaassets__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Mediaassets__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created_RWXMediaAssets],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaAssets],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaAssets],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [MediaAssetID_RWX_MediaAssets],
	cast([Type] as nvarchar(500)) [Type],
	cast([Reference] as nvarchar(4000)) [Reference],
	cast([Sha1] as nvarchar(4000)) [Sha1] 
From stg.[AH_Mediaassets_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Mediaassets__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Mediaassets__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end



19:52:52.463635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:52:52.463807 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:52.591790 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:52:58.337203 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 32.33 seconds
19:52:58.351905 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
19:52:58.352338 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Media: rename object "dbo_dbo"."AH_Media__dbt_tmp" to AH_Media
19:52:58.416372 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:52:58.418372 [debug] [Thread-4  ]: On model.Shawn.AH_Media: COMMIT
19:52:58.420560 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
19:52:58.420822 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Media: 
    
  if object_id ('"dbo_dbo"."AH_Media__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Media__dbt_backup"
    end

19:52:58.459535 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:52:58.477062 [debug] [Thread-4  ]: finished collecting timing info
19:52:58.477549 [debug] [Thread-4  ]: On model.Shawn.AH_Media: Close
19:52:58.478390 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d95400>]}
19:52:58.479027 [info ] [Thread-4  ]: 65 of 105 OK created table model dbo_dbo.AH_Media............................... [[32mOK[0m in 32.48s]
19:52:58.481756 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Media
19:52:58.482056 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Mediavariations
19:52:58.482570 [info ] [Thread-4  ]: 69 of 105 START table model dbo_dbo.AH_Mediavariations.......................... [RUN]
19:52:58.484324 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Mediavariations"
19:52:58.485154 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Mediavariations
19:52:58.485419 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Mediavariations
19:52:58.489891 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Mediavariations"
19:52:58.490931 [debug] [Thread-4  ]: finished collecting timing info
19:52:58.491146 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Mediavariations
19:52:58.508364 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Mediavariations"
19:52:58.509621 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
19:52:58.509858 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
  
  if object_id ('"dbo_dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Mediavariations__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Mediavariations__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Mediavariations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created_RWXMediaVariations],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaVariations],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaVariations],
	cast([ID] as int) [ID],
	cast([MediaassetID] as int) [MediaAssetID_RWX_MediaVariations],
	cast([MediaID] as int) [MediaID],
	cast([Name] as nvarchar(500)) [Name_RWXMediaVariations] 
From stg.[AH_Mediavariations_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Mediavariations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Mediavariations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end



19:52:58.510022 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:52:58.510203 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:52:58.621519 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:13.484665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 14.97 seconds
19:53:13.495667 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
19:53:13.496054 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: rename object "dbo_dbo"."AH_Mediavariations__dbt_tmp" to AH_Mediavariations
19:53:13.574230 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:53:13.576232 [debug] [Thread-4  ]: On model.Shawn.AH_Mediavariations: COMMIT
19:53:13.580992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
19:53:13.581272 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
    
  if object_id ('"dbo_dbo"."AH_Mediavariations__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Mediavariations__dbt_backup"
    end

19:53:13.622360 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:13.632817 [debug] [Thread-4  ]: finished collecting timing info
19:53:13.633275 [debug] [Thread-4  ]: On model.Shawn.AH_Mediavariations: Close
19:53:13.634103 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d956a0>]}
19:53:13.634679 [info ] [Thread-4  ]: 69 of 105 OK created table model dbo_dbo.AH_Mediavariations..................... [[32mOK[0m in 15.15s]
19:53:13.636272 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Mediavariations
19:53:13.636567 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Model
19:53:13.637006 [info ] [Thread-4  ]: 70 of 105 START table model dbo_dbo.AH_Model.................................... [RUN]
19:53:13.637911 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Model"
19:53:13.638120 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Model
19:53:13.638298 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Model
19:53:13.641758 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Model"
19:53:13.642302 [debug] [Thread-4  ]: finished collecting timing info
19:53:13.642498 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Model
19:53:13.655132 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Model"
19:53:13.655917 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
19:53:13.656148 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Model: 
  
  if object_id ('"dbo_dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Model__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Model__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Model__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Model__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Model_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Model__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Model__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Model__dbt_tmp_temp_view"
    end



19:53:13.656305 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:13.656483 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:13.780198 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:16.126325 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
19:53:16.139892 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
19:53:16.140244 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Model: rename object "dbo_dbo"."AH_Model__dbt_tmp" to AH_Model
19:53:16.174043 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:16.175959 [debug] [Thread-4  ]: On model.Shawn.AH_Model: COMMIT
19:53:16.178037 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
19:53:16.178278 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Model: 
    
  if object_id ('"dbo_dbo"."AH_Model__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Model__dbt_backup"
    end

19:53:16.214141 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:16.223776 [debug] [Thread-4  ]: finished collecting timing info
19:53:16.224226 [debug] [Thread-4  ]: On model.Shawn.AH_Model: Close
19:53:16.225019 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d95be0>]}
19:53:16.225528 [info ] [Thread-4  ]: 70 of 105 OK created table model dbo_dbo.AH_Model............................... [[32mOK[0m in 2.59s]
19:53:16.226696 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Model
19:53:16.226976 [debug] [Thread-4  ]: Began running node model.Shawn.AH_NewSalestoInvoice
19:53:16.227409 [info ] [Thread-4  ]: 71 of 105 START table model dbo_dbo.AH_NewSalestoInvoice........................ [RUN]
19:53:16.251039 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_NewSalestoInvoice"
19:53:16.254770 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_NewSalestoInvoice
19:53:16.255865 [debug] [Thread-4  ]: Compiling model.Shawn.AH_NewSalestoInvoice
19:53:16.267647 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_NewSalestoInvoice"
19:53:16.268403 [debug] [Thread-4  ]: finished collecting timing info
19:53:16.268665 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_NewSalestoInvoice
19:53:16.280656 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_NewSalestoInvoice"
19:53:16.281499 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
19:53:16.281753 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
  
  if object_id ('"dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view as
    
Select
	cast([LineItemID] as int) [LineItemID] 
From stg.[AH_NewSalestoInvoice_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end



19:53:16.281909 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:16.282090 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:16.403132 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:18.810442 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
19:53:18.822524 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
19:53:18.822919 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: rename object "dbo_dbo"."AH_NewSalestoInvoice__dbt_tmp" to AH_NewSalestoInvoice
19:53:18.861030 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:18.862973 [debug] [Thread-4  ]: On model.Shawn.AH_NewSalestoInvoice: COMMIT
19:53:18.865118 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
19:53:18.865411 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
    
  if object_id ('"dbo_dbo"."AH_NewSalestoInvoice__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_NewSalestoInvoice__dbt_backup"
    end

19:53:18.903406 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:18.912699 [debug] [Thread-4  ]: finished collecting timing info
19:53:18.913106 [debug] [Thread-4  ]: On model.Shawn.AH_NewSalestoInvoice: Close
19:53:18.913890 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d95d30>]}
19:53:18.914406 [info ] [Thread-4  ]: 71 of 105 OK created table model dbo_dbo.AH_NewSalestoInvoice................... [[32mOK[0m in 2.66s]
19:53:18.915601 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_NewSalestoInvoice
19:53:18.915868 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Notifications
19:53:18.916321 [info ] [Thread-4  ]: 72 of 105 START table model dbo_dbo.AH_Notifications............................ [RUN]
19:53:18.917584 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Notifications"
19:53:18.917793 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Notifications
19:53:18.917971 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Notifications
19:53:18.921208 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Notifications"
19:53:18.921858 [debug] [Thread-4  ]: finished collecting timing info
19:53:18.922050 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Notifications
19:53:18.933556 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Notifications"
19:53:18.934122 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
19:53:18.934315 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
  
  if object_id ('"dbo_dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Notifications__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Notifications__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Notifications__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Notifications__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([DetailID] as int) [DetailID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Queueddttm] as datetime) [Queueddttm],
	cast([Statusdttm] as datetime) [Statusdttm],
	cast([RecipientEmail] as nvarchar(4000)) [RecipientEmail],
	cast([CcEmail] as nvarchar(4000)) [CcEmail],
	cast([BCcEmail] as nvarchar(4000)) [BCcEmail],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([StatusMessage] as nvarchar(4000)) [StatusMessage],
	cast([Message] as nvarchar(4000)) [Message],
	cast([DetailType] as nvarchar(4000)) [DetailType],
	cast([ReplytoEmail] as nvarchar(4000)) [ReplytoEmail],
	cast([SEnderUserName] as nvarchar(4000)) [SEnderUserName],
	cast([ReceiverUserName] as nvarchar(4000)) [ReceiverUserName],
	cast([Template] as nvarchar(4000)) [Template] 
From stg.[AH_Notifications_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Notifications__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Notifications__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Notifications__dbt_tmp_temp_view"
    end



19:53:18.934468 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:18.934669 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:19.038964 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:21.966153 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.03 seconds
19:53:21.979593 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
19:53:21.980022 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Notifications: rename object "dbo_dbo"."AH_Notifications__dbt_tmp" to AH_Notifications
19:53:22.014444 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:22.016423 [debug] [Thread-4  ]: On model.Shawn.AH_Notifications: COMMIT
19:53:22.018559 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
19:53:22.018812 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
    
  if object_id ('"dbo_dbo"."AH_Notifications__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Notifications__dbt_backup"
    end

19:53:22.057739 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:22.069945 [debug] [Thread-4  ]: finished collecting timing info
19:53:22.070448 [debug] [Thread-4  ]: On model.Shawn.AH_Notifications: Close
19:53:22.071314 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d95e80>]}
19:53:22.071852 [info ] [Thread-4  ]: 72 of 105 OK created table model dbo_dbo.AH_Notifications....................... [[32mOK[0m in 3.15s]
19:53:22.073250 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Notifications
19:53:22.073550 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Offers
19:53:22.074019 [info ] [Thread-4  ]: 73 of 105 START table model dbo_dbo.AH_Offers................................... [RUN]
19:53:22.075012 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Offers"
19:53:22.075229 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Offers
19:53:22.075414 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Offers
19:53:22.079132 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Offers"
19:53:22.079656 [debug] [Thread-4  ]: finished collecting timing info
19:53:22.079849 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Offers
19:53:22.090529 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Offers"
19:53:22.091319 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
19:53:22.091547 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
  
  if object_id ('"dbo_dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Offers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Offers__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Offers__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Offers__dbt_tmp_temp_view as
    
Select
	cast([Amount] as numeric(19,4)) [Amount],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([OfferMessage] as nvarchar(4000)) [OfferMessage],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DecLineMessage] as nvarchar(4000)) [DecLineMessage],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Expirationdttm] as datetime) [Expirationdttm],
	cast([ID] as int) [ID],
	cast([SEndingUserID] as int) [SEndingUserID],
	cast([ReceivINgUserID] as int) [ReceivINgUserID],
	cast([BuyerID] as int) [BuyerID],
	cast([Quantity] as int) [Quantity],
	cast([ListingID] as int) [ListingID] 
From stg.[AH_Offers_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Offers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Offers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Offers__dbt_tmp_temp_view"
    end



19:53:22.091705 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:22.091883 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:22.206851 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:24.643178 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.55 seconds
19:53:24.665210 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
19:53:24.668195 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Offers: rename object "dbo_dbo"."AH_Offers__dbt_tmp" to AH_Offers
19:53:24.703072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:24.704798 [debug] [Thread-4  ]: On model.Shawn.AH_Offers: COMMIT
19:53:24.707248 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
19:53:24.707520 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
    
  if object_id ('"dbo_dbo"."AH_Offers__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Offers__dbt_backup"
    end

19:53:24.744123 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:24.755737 [debug] [Thread-4  ]: finished collecting timing info
19:53:24.756206 [debug] [Thread-4  ]: On model.Shawn.AH_Offers: Close
19:53:24.757029 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d980a0>]}
19:53:24.757536 [info ] [Thread-4  ]: 73 of 105 OK created table model dbo_dbo.AH_Offers.............................. [[32mOK[0m in 2.68s]
19:53:24.758715 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Offers
19:53:24.758984 [debug] [Thread-4  ]: Began running node model.Shawn.AH_PaymentConfigurationTable
19:53:24.759412 [info ] [Thread-4  ]: 74 of 105 START table model dbo_dbo.AH_PaymentConfigurationTable................ [RUN]
19:53:24.760632 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentConfigurationTable"
19:53:24.760849 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_PaymentConfigurationTable
19:53:24.761030 [debug] [Thread-4  ]: Compiling model.Shawn.AH_PaymentConfigurationTable
19:53:24.764305 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_PaymentConfigurationTable"
19:53:24.765060 [debug] [Thread-4  ]: finished collecting timing info
19:53:24.765259 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_PaymentConfigurationTable
19:53:24.775366 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentConfigurationTable"
19:53:24.775921 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
19:53:24.776110 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
  
  if object_id ('"dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Active] as bit) [Active],
	cast([MinimumBidHold] as numeric(19,4)) [MinimumBidHold],
	cast([BasicplanPrice] as numeric(19,4)) [BasicplanPrice],
	cast([ProPhotographyPrice] as numeric(19,4)) [ProPhotographyPrice],
	cast([ProMarketingPrice] as numeric(19,4)) [ProMarketingPrice],
	cast([Minfraudscore] as numeric(19,4)) [Minfraudscore],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([MaximumBidCharge] as numeric(19,4)) [MaximumBidCharge],
	cast([BidHoldPercentage] as numeric(19,4)) [BidHoldPercentage] 
From stg.[AH_PaymentConfigurationTable_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end



19:53:24.776264 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:24.776434 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:24.910400 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:27.860241 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.08 seconds
19:53:27.873834 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
19:53:27.874240 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: rename object "dbo_dbo"."AH_PaymentConfigurationTable__dbt_tmp" to AH_PaymentConfigurationTable
19:53:27.908498 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:27.910429 [debug] [Thread-4  ]: On model.Shawn.AH_PaymentConfigurationTable: COMMIT
19:53:27.912732 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
19:53:27.913064 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
    
  if object_id ('"dbo_dbo"."AH_PaymentConfigurationTable__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PaymentConfigurationTable__dbt_backup"
    end

19:53:27.952662 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:27.964855 [debug] [Thread-4  ]: finished collecting timing info
19:53:27.965384 [debug] [Thread-4  ]: On model.Shawn.AH_PaymentConfigurationTable: Close
19:53:27.966255 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98160>]}
19:53:27.966843 [info ] [Thread-4  ]: 74 of 105 OK created table model dbo_dbo.AH_PaymentConfigurationTable........... [[32mOK[0m in 3.21s]
19:53:27.968260 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_PaymentConfigurationTable
19:53:27.968567 [debug] [Thread-4  ]: Began running node model.Shawn.AH_PaymentResponses
19:53:27.969112 [info ] [Thread-4  ]: 75 of 105 START table model dbo_dbo.AH_PaymentResponses......................... [RUN]
19:53:27.970355 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentResponses"
19:53:27.970606 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_PaymentResponses
19:53:27.970802 [debug] [Thread-4  ]: Compiling model.Shawn.AH_PaymentResponses
19:53:27.974304 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_PaymentResponses"
19:53:27.974858 [debug] [Thread-4  ]: finished collecting timing info
19:53:27.975056 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_PaymentResponses
19:53:27.987409 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentResponses"
19:53:27.988500 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
19:53:27.988732 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
  
  if object_id ('"dbo_dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_PaymentResponses__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PaymentResponses__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_PaymentResponses__dbt_tmp_temp_view as
    
Select
	cast([Approved] as bit) [Approved],
	cast([ID] as int) [ID],
	cast([InvoiceID] as int) [InvoiceID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([AuthorizationCode] as nvarchar(4000)) [AuthorizationCode],
	cast([AvsResponseCode] as nvarchar(4000)) [AvsResponseCode],
	cast([Cvv2ResponseCode] as nvarchar(4000)) [Cvv2ResponseCode],
	cast([CavResponseCode] as nvarchar(4000)) [CavResponseCode],
	cast([BuyerStreet] as nvarchar(4000)) [BuyerStreet],
	cast([BuyerCity] as nvarchar(4000)) [BuyerCity],
	cast([ResponseStatus] as nvarchar(4000)) [ResponseStatus],
	cast([ProvIDEr] as nvarchar(4000)) [ProvIDEr],
	cast([RawResponseCode] as nvarchar(4000)) [RawResponseCode],
	cast([Description] as nvarchar(4000)) [Description],
	cast([TransactionID] as nvarchar(4000)) [TransactionID],
	cast([Method] as nvarchar(4000)) [Method],
	cast([BuyerStateregion] as nvarchar(4000)) [BuyerStateregion],
	cast([BuyerzipPostal] as nvarchar(4000)) [BuyerzipPostal],
	cast([BuyerEmail] as nvarchar(4000)) [BuyerEmail],
	cast([AllFields] as nvarchar(4000)) [AllFields],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_PaymentResponses_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_PaymentResponses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_PaymentResponses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end



19:53:27.988908 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:27.989104 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:28.123670 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:30.476345 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.49 seconds
19:53:30.488582 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
19:53:30.488992 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: rename object "dbo_dbo"."AH_PaymentResponses__dbt_tmp" to AH_PaymentResponses
19:53:30.522257 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:30.524339 [debug] [Thread-4  ]: On model.Shawn.AH_PaymentResponses: COMMIT
19:53:30.528301 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
19:53:30.528635 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
    
  if object_id ('"dbo_dbo"."AH_PaymentResponses__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PaymentResponses__dbt_backup"
    end

19:53:30.565475 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:30.576783 [debug] [Thread-4  ]: finished collecting timing info
19:53:30.577269 [debug] [Thread-4  ]: On model.Shawn.AH_PaymentResponses: Close
19:53:30.578131 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d982b0>]}
19:53:30.578725 [info ] [Thread-4  ]: 75 of 105 OK created table model dbo_dbo.AH_PaymentResponses.................... [[32mOK[0m in 2.61s]
19:53:30.580281 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_PaymentResponses
19:53:30.580573 [debug] [Thread-4  ]: Began running node model.Shawn.AH_PaymentprovIDErs
19:53:30.581047 [info ] [Thread-4  ]: 76 of 105 START table model dbo_dbo.AH_PaymentprovIDErs......................... [RUN]
19:53:30.582338 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentprovIDErs"
19:53:30.582586 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_PaymentprovIDErs
19:53:30.582792 [debug] [Thread-4  ]: Compiling model.Shawn.AH_PaymentprovIDErs
19:53:30.586980 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_PaymentprovIDErs"
19:53:30.587572 [debug] [Thread-4  ]: finished collecting timing info
19:53:30.587783 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_PaymentprovIDErs
19:53:30.601347 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentprovIDErs"
19:53:30.602171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
19:53:30.602420 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
  
  if object_id ('"dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Batchcapable] as bit) [Batchcapable],
	cast([ID] as int) [ID] 
From stg.[AH_PaymentprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end



19:53:30.603241 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:30.603518 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:30.725393 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:33.473023 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.87 seconds
19:53:33.484344 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
19:53:33.484759 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: rename object "dbo_dbo"."AH_PaymentprovIDErs__dbt_tmp" to AH_PaymentprovIDErs
19:53:33.522169 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:33.524758 [debug] [Thread-4  ]: On model.Shawn.AH_PaymentprovIDErs: COMMIT
19:53:33.613941 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
19:53:33.614391 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
    
  if object_id ('"dbo_dbo"."AH_PaymentprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PaymentprovIDErs__dbt_backup"
    end

19:53:33.653295 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:33.665095 [debug] [Thread-4  ]: finished collecting timing info
19:53:33.665595 [debug] [Thread-4  ]: On model.Shawn.AH_PaymentprovIDErs: Close
19:53:33.666442 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98400>]}
19:53:33.667024 [info ] [Thread-4  ]: 76 of 105 OK created table model dbo_dbo.AH_PaymentprovIDErs.................... [[32mOK[0m in 3.08s]
19:53:33.668130 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_PaymentprovIDErs
19:53:33.668404 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Properties
19:53:33.668867 [info ] [Thread-4  ]: 77 of 105 START table model dbo_dbo.AH_Properties............................... [RUN]
19:53:33.670367 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Properties"
19:53:33.670611 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Properties
19:53:33.670802 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Properties
19:53:33.674026 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Properties"
19:53:33.674532 [debug] [Thread-4  ]: finished collecting timing info
19:53:33.674769 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Properties
19:53:33.685595 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Properties"
19:53:33.686382 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
19:53:33.686640 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
  
  if object_id ('"dbo_dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Properties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Properties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Properties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Properties__dbt_tmp_temp_view as
    
Select
	cast([Value] as nvarchar(4000)) [Value],
	cast([Name] as nvarchar(4000)) [Name],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([LineItemID] as int) [LineItemID] 
From stg.[AH_Properties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Properties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Properties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Properties__dbt_tmp_temp_view"
    end



19:53:33.686826 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:33.687008 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:33.797381 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:36.067780 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.38 seconds
19:53:36.080517 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
19:53:36.080993 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Properties: rename object "dbo_dbo"."AH_Properties__dbt_tmp" to AH_Properties
19:53:36.116231 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:36.118215 [debug] [Thread-4  ]: On model.Shawn.AH_Properties: COMMIT
19:53:36.120395 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
19:53:36.120663 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
    
  if object_id ('"dbo_dbo"."AH_Properties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Properties__dbt_backup"
    end

19:53:36.159597 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:36.171798 [debug] [Thread-4  ]: finished collecting timing info
19:53:36.172284 [debug] [Thread-4  ]: On model.Shawn.AH_Properties: Close
19:53:36.173124 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0cff0d0>]}
19:53:36.173635 [info ] [Thread-4  ]: 77 of 105 OK created table model dbo_dbo.AH_Properties.......................... [[32mOK[0m in 2.50s]
19:53:36.174759 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Properties
19:53:36.175033 [debug] [Thread-4  ]: Began running node model.Shawn.AH_PropertybagItems
19:53:36.175477 [info ] [Thread-4  ]: 78 of 105 START table model dbo_dbo.AH_PropertybagItems......................... [RUN]
19:53:36.176798 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_PropertybagItems"
19:53:36.177012 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_PropertybagItems
19:53:36.177188 [debug] [Thread-4  ]: Compiling model.Shawn.AH_PropertybagItems
19:53:36.180609 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_PropertybagItems"
19:53:36.181394 [debug] [Thread-4  ]: finished collecting timing info
19:53:36.181601 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_PropertybagItems
19:53:36.192416 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_PropertybagItems"
19:53:36.193197 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
19:53:36.193434 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
  
  if object_id ('"dbo_dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_PropertybagItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PropertybagItems__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_PropertybagItems__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([PropertybagID] as int) [PropertybagID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value] 
From stg.[AH_PropertybagItems_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_PropertybagItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_PropertybagItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end



19:53:36.193595 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:36.193776 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:36.299158 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:38.721670 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
19:53:38.736184 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
19:53:38.736613 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: rename object "dbo_dbo"."AH_PropertybagItems__dbt_tmp" to AH_PropertybagItems
19:53:38.773994 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:38.776101 [debug] [Thread-4  ]: On model.Shawn.AH_PropertybagItems: COMMIT
19:53:38.778257 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
19:53:38.778526 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
    
  if object_id ('"dbo_dbo"."AH_PropertybagItems__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_PropertybagItems__dbt_backup"
    end

19:53:38.823058 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:38.833634 [debug] [Thread-4  ]: finished collecting timing info
19:53:38.834184 [debug] [Thread-4  ]: On model.Shawn.AH_PropertybagItems: Close
19:53:38.835137 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d986a0>]}
19:53:38.835699 [info ] [Thread-4  ]: 78 of 105 OK created table model dbo_dbo.AH_PropertybagItems.................... [[32mOK[0m in 2.66s]
19:53:38.837226 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_PropertybagItems
19:53:38.837539 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Propertybags
19:53:38.838029 [info ] [Thread-4  ]: 79 of 105 START table model dbo_dbo.AH_Propertybags............................. [RUN]
19:53:38.839424 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Propertybags"
19:53:38.839650 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Propertybags
19:53:38.839838 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Propertybags
19:53:38.843317 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Propertybags"
19:53:38.843914 [debug] [Thread-4  ]: finished collecting timing info
19:53:38.844126 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Propertybags
19:53:38.857929 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Propertybags"
19:53:38.858844 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
19:53:38.859124 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
  
  if object_id ('"dbo_dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Propertybags__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Propertybags__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Propertybags__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID] 
From stg.[AH_Propertybags_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Propertybags__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Propertybags__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end



19:53:38.859299 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:38.859493 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:38.974702 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:42.093097 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.23 seconds
19:53:42.104443 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
19:53:42.104836 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: rename object "dbo_dbo"."AH_Propertybags__dbt_tmp" to AH_Propertybags
19:53:42.142418 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:42.144532 [debug] [Thread-4  ]: On model.Shawn.AH_Propertybags: COMMIT
19:53:42.148343 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
19:53:42.148600 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
    
  if object_id ('"dbo_dbo"."AH_Propertybags__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Propertybags__dbt_backup"
    end

19:53:42.193645 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:42.204304 [debug] [Thread-4  ]: finished collecting timing info
19:53:42.204782 [debug] [Thread-4  ]: On model.Shawn.AH_Propertybags: Close
19:53:42.205600 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d987f0>]}
19:53:42.206129 [info ] [Thread-4  ]: 79 of 105 OK created table model dbo_dbo.AH_Propertybags........................ [[32mOK[0m in 3.37s]
19:53:42.207283 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Propertybags
19:53:42.207553 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ReListHistory
19:53:42.207982 [info ] [Thread-4  ]: 80 of 105 START table model dbo_dbo.AH_ReListHistory............................ [RUN]
19:53:42.210616 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ReListHistory"
19:53:42.210833 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ReListHistory
19:53:42.211011 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ReListHistory
19:53:42.215045 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ReListHistory"
19:53:42.215542 [debug] [Thread-4  ]: finished collecting timing info
19:53:42.215733 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ReListHistory
19:53:42.226247 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ReListHistory"
19:53:42.226977 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
19:53:42.227209 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
  
  if object_id ('"dbo_dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ReListHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ReListHistory__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ReListHistory__dbt_tmp_temp_view as
    
Select
	cast([CurrentPrice_Old] as numeric(19,4)) [CurrentPrice_Old],
	cast([CurrentPrice_New] as numeric(19,4)) [CurrentPrice_New],
	cast([ReservePrice] as numeric(19,4)) [ReservePrice],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([NewreListiteration] as int) [NewreListiteration],
	cast([Duration_Old] as int) [Duration_Old],
	cast([Duration_New] as int) [Duration_New],
	cast([HighBidderID] as int) [HighBidderID],
	cast([BidCount] as int) [BidCount],
	cast([Startdttm_New] as datetime) [Startdttm_New],
	cast([Enddttm_Old] as datetime) [Enddttm_Old],
	cast([Enddttm_New] as datetime) [Enddttm_New],
	cast([ReListdttm] as datetime) [ReListdttm],
	cast([Startdttm_Old] as datetime) [Startdttm_Old],
	cast([MaxBidAmount] as numeric(19,4)) [MaxBidAmount],
	cast([ProxyBidAmount] as numeric(19,4)) [ProxyBidAmount],
	cast([BidIncrement] as numeric(19,4)) [BidIncrement],
	cast([ListingTitle] as nvarchar(4000)) [ListingTitle] 
From stg.[AH_ReListHistory_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ReListHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ReListHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end



19:53:42.227370 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:42.227545 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:42.326707 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:44.935014 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
19:53:44.948469 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
19:53:44.948843 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: rename object "dbo_dbo"."AH_ReListHistory__dbt_tmp" to AH_ReListHistory
19:53:44.986475 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:44.988530 [debug] [Thread-4  ]: On model.Shawn.AH_ReListHistory: COMMIT
19:53:44.990784 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
19:53:44.991031 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
    
  if object_id ('"dbo_dbo"."AH_ReListHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ReListHistory__dbt_backup"
    end

19:53:45.028257 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:45.039872 [debug] [Thread-4  ]: finished collecting timing info
19:53:45.040296 [debug] [Thread-4  ]: On model.Shawn.AH_ReListHistory: Close
19:53:45.041085 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98940>]}
19:53:45.041614 [info ] [Thread-4  ]: 80 of 105 OK created table model dbo_dbo.AH_ReListHistory....................... [[32mOK[0m in 2.83s]
19:53:45.043214 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ReListHistory
19:53:45.043521 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Reports
19:53:45.043993 [info ] [Thread-4  ]: 81 of 105 START table model dbo_dbo.AH_Reports.................................. [RUN]
19:53:45.045107 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Reports"
19:53:45.045321 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Reports
19:53:45.045504 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Reports
19:53:45.049135 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Reports"
19:53:45.049656 [debug] [Thread-4  ]: finished collecting timing info
19:53:45.049903 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Reports
19:53:45.060971 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Reports"
19:53:45.061727 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
19:53:45.061967 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
  
  if object_id ('"dbo_dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Reports__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Reports__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Reports__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Reports__dbt_tmp_temp_view as
    
Select
	cast([SecondstogeneRate] as numeric(19,4)) [SecondstogeneRate],
	cast([ReportName] as nvarchar(4000)) [ReportName],
	cast([Data] as nvarchar(4000)) [Data],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID] 
From stg.[AH_Reports_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Reports__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Reports__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Reports__dbt_tmp_temp_view"
    end



19:53:45.062131 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:45.062312 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:45.157002 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:47.674616 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.61 seconds
19:53:47.686110 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
19:53:47.686500 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Reports: rename object "dbo_dbo"."AH_Reports__dbt_tmp" to AH_Reports
19:53:47.721571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:47.724079 [debug] [Thread-4  ]: On model.Shawn.AH_Reports: COMMIT
19:53:47.726516 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
19:53:47.726825 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
    
  if object_id ('"dbo_dbo"."AH_Reports__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Reports__dbt_backup"
    end

19:53:47.764616 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:47.774097 [debug] [Thread-4  ]: finished collecting timing info
19:53:47.774573 [debug] [Thread-4  ]: On model.Shawn.AH_Reports: Close
19:53:47.775407 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98a90>]}
19:53:47.775920 [info ] [Thread-4  ]: 81 of 105 OK created table model dbo_dbo.AH_Reports............................. [[32mOK[0m in 2.73s]
19:53:47.777063 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Reports
19:53:47.777339 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Roles
19:53:47.777792 [info ] [Thread-4  ]: 82 of 105 START table model dbo_dbo.AH_Roles.................................... [RUN]
19:53:47.779372 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Roles"
19:53:47.779596 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Roles
19:53:47.779785 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Roles
19:53:47.784124 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Roles"
19:53:47.784682 [debug] [Thread-4  ]: finished collecting timing info
19:53:47.784890 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Roles
19:53:47.795725 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Roles"
19:53:47.796345 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
19:53:47.796548 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
  
  if object_id ('"dbo_dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Roles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Roles__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Roles__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Roles__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [RoleID],
	cast([CreatedOn] as datetime) [Created_RWXRoles],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXRoles],
	cast([DeletedOn] as datetime) [DeletedDate_RWXRoles],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXRoles],
	cast([Name] as nvarchar(500)) [Role] 
From stg.[AH_Roles_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Roles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Roles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Roles__dbt_tmp_temp_view"
    end



19:53:47.796701 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:47.796870 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:47.905367 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:50.989520 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.19 seconds
19:53:51.003203 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
19:53:51.003606 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Roles: rename object "dbo_dbo"."AH_Roles__dbt_tmp" to AH_Roles
19:53:51.037710 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:51.039675 [debug] [Thread-4  ]: On model.Shawn.AH_Roles: COMMIT
19:53:51.041791 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
19:53:51.042036 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
    
  if object_id ('"dbo_dbo"."AH_Roles__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Roles__dbt_backup"
    end

19:53:51.079128 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:53:51.116591 [debug] [Thread-4  ]: finished collecting timing info
19:53:51.124663 [debug] [Thread-4  ]: On model.Shawn.AH_Roles: Close
19:53:51.126051 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98be0>]}
19:53:51.126636 [info ] [Thread-4  ]: 82 of 105 OK created table model dbo_dbo.AH_Roles............................... [[32mOK[0m in 3.35s]
19:53:51.127685 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Roles
19:53:51.127963 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SMStemplatecontents
19:53:51.128380 [info ] [Thread-4  ]: 83 of 105 START table model dbo_dbo.AH_SMStemplatecontents...................... [RUN]
19:53:51.129546 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplatecontents"
19:53:51.129757 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SMStemplatecontents
19:53:51.129936 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SMStemplatecontents
19:53:51.133214 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplatecontents"
19:53:51.133951 [debug] [Thread-4  ]: finished collecting timing info
19:53:51.134150 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SMStemplatecontents
19:53:51.145042 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplatecontents"
19:53:51.145778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
19:53:51.145998 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
  
  if object_id ('"dbo_dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_SMStemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SMStemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_SMStemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Body] as nvarchar(4000)) [Body],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [ID] 
From stg.[AH_SMStemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_SMStemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_SMStemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end



19:53:51.146155 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:51.146336 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:51.270319 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:55.046964 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.90 seconds
19:53:55.058137 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
19:53:55.058570 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: rename object "dbo_dbo"."AH_SMStemplatecontents__dbt_tmp" to AH_SMStemplatecontents
19:53:55.093186 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:55.095405 [debug] [Thread-4  ]: On model.Shawn.AH_SMStemplatecontents: COMMIT
19:53:55.097440 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
19:53:55.097678 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
    
  if object_id ('"dbo_dbo"."AH_SMStemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SMStemplatecontents__dbt_backup"
    end

19:53:55.148226 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:53:55.158491 [debug] [Thread-4  ]: finished collecting timing info
19:53:55.158983 [debug] [Thread-4  ]: On model.Shawn.AH_SMStemplatecontents: Close
19:53:55.159810 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98d30>]}
19:53:55.160322 [info ] [Thread-4  ]: 83 of 105 OK created table model dbo_dbo.AH_SMStemplatecontents................. [[32mOK[0m in 4.03s]
19:53:55.162243 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SMStemplatecontents
19:53:55.162566 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SMStemplates
19:53:55.163466 [info ] [Thread-4  ]: 84 of 105 START table model dbo_dbo.AH_SMStemplates............................. [RUN]
19:53:55.164360 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplates"
19:53:55.164569 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SMStemplates
19:53:55.164786 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SMStemplates
19:53:55.168494 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplates"
19:53:55.169237 [debug] [Thread-4  ]: finished collecting timing info
19:53:55.169433 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SMStemplates
19:53:55.180439 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplates"
19:53:55.181152 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
19:53:55.181377 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
  
  if object_id ('"dbo_dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_SMStemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SMStemplates__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_SMStemplates__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Enabled] as bit) [Enabled],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_SMStemplates_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_SMStemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_SMStemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end



19:53:55.181532 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:55.181725 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:55.301650 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:58.271483 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.09 seconds
19:53:58.282457 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
19:53:58.282928 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: rename object "dbo_dbo"."AH_SMStemplates__dbt_tmp" to AH_SMStemplates
19:53:58.328725 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:53:58.331906 [debug] [Thread-4  ]: On model.Shawn.AH_SMStemplates: COMMIT
19:53:58.334121 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
19:53:58.334415 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
    
  if object_id ('"dbo_dbo"."AH_SMStemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SMStemplates__dbt_backup"
    end

19:53:58.395251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:53:58.406479 [debug] [Thread-4  ]: finished collecting timing info
19:53:58.406993 [debug] [Thread-4  ]: On model.Shawn.AH_SMStemplates: Close
19:53:58.407821 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d98e80>]}
19:53:58.408340 [info ] [Thread-4  ]: 84 of 105 OK created table model dbo_dbo.AH_SMStemplates........................ [[32mOK[0m in 3.24s]
19:53:58.409445 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SMStemplates
19:53:58.409731 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SalesTaxRates
19:53:58.411367 [info ] [Thread-4  ]: 85 of 105 START table model dbo_dbo.AH_SalesTaxRates............................ [RUN]
19:53:58.413674 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SalesTaxRates"
19:53:58.413908 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SalesTaxRates
19:53:58.414479 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SalesTaxRates
19:53:58.417546 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SalesTaxRates"
19:53:58.418057 [debug] [Thread-4  ]: finished collecting timing info
19:53:58.418249 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SalesTaxRates
19:53:58.430584 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SalesTaxRates"
19:53:58.431345 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
19:53:58.431577 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
  
  if object_id ('"dbo_dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_SalesTaxRates__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SalesTaxRates__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_SalesTaxRates__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Shipping] as nvarchar(4000)) [Shipping],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([StateID] as int) [StateID],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([TaxRate] as numeric(19,4)) [TaxRate] 
From stg.[AH_SalesTaxRates_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_SalesTaxRates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_SalesTaxRates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end



19:53:58.431733 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:53:58.431910 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:58.551590 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:53:58.640895 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 101.94 seconds
19:53:58.653658 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
19:53:58.654057 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: rename object "dbo_dbo"."AH_Listingproperties__dbt_tmp" to AH_Listingproperties
19:53:58.682264 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:53:58.684374 [debug] [Thread-2  ]: On model.Shawn.AH_Listingproperties: COMMIT
19:53:58.686672 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
19:53:58.686929 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
    
  if object_id ('"dbo_dbo"."AH_Listingproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Listingproperties__dbt_backup"
    end

19:53:58.737414 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:53:58.747147 [debug] [Thread-2  ]: finished collecting timing info
19:53:58.747632 [debug] [Thread-2  ]: On model.Shawn.AH_Listingproperties: Close
19:53:58.748484 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2df46a0>]}
19:53:58.749035 [info ] [Thread-2  ]: 57 of 105 OK created table model dbo_dbo.AH_Listingproperties................... [[32mOK[0m in 102.07s]
19:53:58.750151 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Listingproperties
19:53:58.750431 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ShippingMethods
19:53:58.750911 [info ] [Thread-2  ]: 86 of 105 START table model dbo_dbo.AH_ShippingMethods.......................... [RUN]
19:53:58.752359 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingMethods"
19:53:58.752575 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ShippingMethods
19:53:58.752761 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ShippingMethods
19:53:58.757242 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ShippingMethods"
19:53:58.757818 [debug] [Thread-2  ]: finished collecting timing info
19:53:58.758019 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ShippingMethods
19:53:58.769479 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingMethods"
19:53:58.770285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
19:53:58.770519 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
  
  if object_id ('"dbo_dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ShippingMethods__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ShippingMethods__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ShippingMethods__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_ShippingMethods_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ShippingMethods__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ShippingMethods__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end



19:53:58.770723 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:53:58.770904 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:53:58.869324 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:00.827542 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.40 seconds
19:54:00.838607 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
19:54:00.839022 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: rename object "dbo_dbo"."AH_SalesTaxRates__dbt_tmp" to AH_SalesTaxRates
19:54:00.889191 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:54:00.891195 [debug] [Thread-4  ]: On model.Shawn.AH_SalesTaxRates: COMMIT
19:54:00.893254 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
19:54:00.893500 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
    
  if object_id ('"dbo_dbo"."AH_SalesTaxRates__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SalesTaxRates__dbt_backup"
    end

19:54:00.932363 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:00.943749 [debug] [Thread-4  ]: finished collecting timing info
19:54:00.944237 [debug] [Thread-4  ]: On model.Shawn.AH_SalesTaxRates: Close
19:54:00.945081 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d930a0>]}
19:54:00.945622 [info ] [Thread-4  ]: 85 of 105 OK created table model dbo_dbo.AH_SalesTaxRates....................... [[32mOK[0m in 2.53s]
19:54:00.946795 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SalesTaxRates
19:54:00.947074 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ShippingOptions
19:54:00.947518 [info ] [Thread-4  ]: 87 of 105 START table model dbo_dbo.AH_ShippingOptions.......................... [RUN]
19:54:00.948830 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions"
19:54:00.949043 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ShippingOptions
19:54:00.949228 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ShippingOptions
19:54:00.952565 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions"
19:54:00.953303 [debug] [Thread-4  ]: finished collecting timing info
19:54:00.953499 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ShippingOptions
19:54:00.964613 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions"
19:54:00.965402 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
19:54:00.965633 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
  
  if object_id ('"dbo_dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ShippingOptions__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ShippingOptions__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ShippingOptions__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([ID] as int) [ShippingOptionID],
	cast([ShippingMethodID] as int) [ShippingMethodID],
	cast([ListingID] as int) [ListingID],
	cast([FirstItEMAmount] as decimal(24,2)) [FirstItemAmount],
	cast([AdditionalItEMAmount] as decimal(24,2)) [AdditionalItemAmount] 
From stg.[AH_ShippingOptions_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ShippingOptions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ShippingOptions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end



19:54:00.965790 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:00.965972 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:01.070213 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:01.147308 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.38 seconds
19:54:01.160877 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
19:54:01.161921 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: rename object "dbo_dbo"."AH_ShippingMethods__dbt_tmp" to AH_ShippingMethods
19:54:01.192550 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:01.194492 [debug] [Thread-2  ]: On model.Shawn.AH_ShippingMethods: COMMIT
19:54:01.196595 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
19:54:01.196860 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
    
  if object_id ('"dbo_dbo"."AH_ShippingMethods__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ShippingMethods__dbt_backup"
    end

19:54:01.233520 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:01.243478 [debug] [Thread-2  ]: finished collecting timing info
19:54:01.244011 [debug] [Thread-2  ]: On model.Shawn.AH_ShippingMethods: Close
19:54:01.244858 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0be9040>]}
19:54:01.245391 [info ] [Thread-2  ]: 86 of 105 OK created table model dbo_dbo.AH_ShippingMethods..................... [[32mOK[0m in 2.49s]
19:54:01.246585 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ShippingMethods
19:54:01.246884 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Siteproperties
19:54:01.247331 [info ] [Thread-2  ]: 88 of 105 START table model dbo_dbo.AH_Siteproperties........................... [RUN]
19:54:01.248781 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Siteproperties"
19:54:01.248999 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Siteproperties
19:54:01.249181 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Siteproperties
19:54:01.252831 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Siteproperties"
19:54:01.253382 [debug] [Thread-2  ]: finished collecting timing info
19:54:01.253583 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Siteproperties
19:54:01.266813 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Siteproperties"
19:54:01.267601 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
19:54:01.267833 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
  
  if object_id ('"dbo_dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Siteproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Siteproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Siteproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Siteproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Siteproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Siteproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end



19:54:01.267995 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:01.268174 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:01.368513 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:04.023496 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.06 seconds
19:54:04.034789 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
19:54:04.035204 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: rename object "dbo_dbo"."AH_ShippingOptions__dbt_tmp" to AH_ShippingOptions
19:54:04.072863 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:04.075015 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions: COMMIT
19:54:04.170431 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
19:54:04.170902 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
    
  if object_id ('"dbo_dbo"."AH_ShippingOptions__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ShippingOptions__dbt_backup"
    end

19:54:04.195886 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.93 seconds
19:54:04.208285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
19:54:04.208701 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: rename object "dbo_dbo"."AH_Siteproperties__dbt_tmp" to AH_Siteproperties
19:54:04.211261 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:04.220989 [debug] [Thread-4  ]: finished collecting timing info
19:54:04.221450 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions: Close
19:54:04.222276 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d93160>]}
19:54:04.222827 [info ] [Thread-4  ]: 87 of 105 OK created table model dbo_dbo.AH_ShippingOptions..................... [[32mOK[0m in 3.27s]
19:54:04.224233 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ShippingOptions
19:54:04.224514 [debug] [Thread-4  ]: Began running node model.Shawn.AH_States
19:54:04.224938 [info ] [Thread-4  ]: 89 of 105 START table model dbo_dbo.AH_States................................... [RUN]
19:54:04.225863 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_States"
19:54:04.226071 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_States
19:54:04.226251 [debug] [Thread-4  ]: Compiling model.Shawn.AH_States
19:54:04.229516 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_States"
19:54:04.230179 [debug] [Thread-4  ]: finished collecting timing info
19:54:04.230378 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_States
19:54:04.242711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:04.244504 [debug] [Thread-2  ]: On model.Shawn.AH_Siteproperties: COMMIT
19:54:04.246151 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
19:54:04.246299 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
    
  if object_id ('"dbo_dbo"."AH_Siteproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Siteproperties__dbt_backup"
    end

19:54:04.247539 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_States"
19:54:04.248116 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
19:54:04.248303 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: 
  
  if object_id ('"dbo_dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_States__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_States__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_States__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_States__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Code] as nvarchar(4000)) [Code],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([CountryID] as int) [CountryID] 
From stg.[AH_States_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_States__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_States__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_States__dbt_tmp_temp_view"
    end



19:54:04.248458 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:04.248642 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:04.283700 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:04.297430 [debug] [Thread-2  ]: finished collecting timing info
19:54:04.297918 [debug] [Thread-2  ]: On model.Shawn.AH_Siteproperties: Close
19:54:04.298777 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d932b0>]}
19:54:04.299311 [info ] [Thread-2  ]: 88 of 105 OK created table model dbo_dbo.AH_Siteproperties...................... [[32mOK[0m in 3.05s]
19:54:04.300420 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Siteproperties
19:54:04.300702 [debug] [Thread-2  ]: Began running node model.Shawn.AH_StripeCustomers
19:54:04.301132 [info ] [Thread-2  ]: 90 of 105 START table model dbo_dbo.AH_StripeCustomers.......................... [RUN]
19:54:04.302417 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_StripeCustomers"
19:54:04.302655 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_StripeCustomers
19:54:04.302843 [debug] [Thread-2  ]: Compiling model.Shawn.AH_StripeCustomers
19:54:04.306648 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_StripeCustomers"
19:54:04.307174 [debug] [Thread-2  ]: finished collecting timing info
19:54:04.307376 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_StripeCustomers
19:54:04.322975 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_StripeCustomers"
19:54:04.324131 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
19:54:04.324381 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
  
  if object_id ('"dbo_dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_StripeCustomers__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_StripeCustomers__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_StripeCustomers__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([SellerID] as int) [SellerID],
	cast([BuyerID] as int) [BuyerID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CustomerID] as nvarchar(4000)) [CustomerID] 
From stg.[AH_StripeCustomers_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_StripeCustomers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_StripeCustomers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end



19:54:04.324552 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:04.324742 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:04.371536 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:04.419329 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:07.039121 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
19:54:07.050842 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
19:54:07.051277 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: rename object "dbo_dbo"."AH_StripeCustomers__dbt_tmp" to AH_StripeCustomers
19:54:07.096897 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:54:07.099160 [debug] [Thread-2  ]: On model.Shawn.AH_StripeCustomers: COMMIT
19:54:07.101291 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
19:54:07.106688 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
    
  if object_id ('"dbo_dbo"."AH_StripeCustomers__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_StripeCustomers__dbt_backup"
    end

19:54:07.138114 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.89 seconds
19:54:07.153801 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
19:54:07.154233 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: rename object "dbo_dbo"."AH_States__dbt_tmp" to AH_States
19:54:07.159745 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:54:07.169636 [debug] [Thread-2  ]: finished collecting timing info
19:54:07.170121 [debug] [Thread-2  ]: On model.Shawn.AH_StripeCustomers: Close
19:54:07.171075 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d93550>]}
19:54:07.185397 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:07.187436 [debug] [Thread-4  ]: On model.Shawn.AH_States: COMMIT
19:54:07.189601 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
19:54:07.189870 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: 
    
  if object_id ('"dbo_dbo"."AH_States__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_States__dbt_backup"
    end

19:54:07.243210 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:54:07.256151 [debug] [Thread-4  ]: finished collecting timing info
19:54:07.256663 [debug] [Thread-4  ]: On model.Shawn.AH_States: Close
19:54:07.257502 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d93400>]}
19:54:07.308200 [info ] [Thread-2  ]: 90 of 105 OK created table model dbo_dbo.AH_StripeCustomers..................... [[32mOK[0m in 2.87s]
19:54:07.308896 [info ] [Thread-4  ]: 89 of 105 OK created table model dbo_dbo.AH_States.............................. [[32mOK[0m in 3.03s]
19:54:07.312939 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_StripeCustomers
19:54:07.313179 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_States
19:54:07.314256 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SysDiagrams
19:54:07.314514 [info ] [Thread-4  ]: 92 of 105 START table model dbo_dbo.AH_SysDiagrams.............................. [RUN]
19:54:07.315403 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SysDiagrams"
19:54:07.315871 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SysDiagrams
19:54:07.316238 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SysDiagrams
19:54:07.314056 [debug] [Thread-2  ]: Began running node model.Shawn.AH_SubmittedListingPayment
19:54:07.321181 [info ] [Thread-2  ]: 91 of 105 START table model dbo_dbo.AH_SubmittedListingPayment.................. [RUN]
19:54:07.322634 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment"
19:54:07.322875 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment
19:54:07.323366 [debug] [Thread-2  ]: Compiling model.Shawn.AH_SubmittedListingPayment
19:54:07.319965 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SysDiagrams"
19:54:07.327132 [debug] [Thread-4  ]: finished collecting timing info
19:54:07.327276 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SysDiagrams
19:54:07.326703 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment"
19:54:07.336413 [debug] [Thread-2  ]: finished collecting timing info
19:54:07.336667 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_SubmittedListingPayment
19:54:07.344004 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SysDiagrams"
19:54:07.354522 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
19:54:07.354969 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
  
  if object_id ('"dbo_dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_SysDiagrams__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SysDiagrams__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_SysDiagrams__dbt_tmp_temp_view as
    
Select
	cast([Diagram_ID] as int) [Diagram_ID],
	cast([Version] as int) [Version],
	cast([Principal_ID] as int) [Principal_ID],
	cast([Definition] as varbinary(8000)) [Definition],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_SysDiagrams_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_SysDiagrams__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_SysDiagrams__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end



19:54:07.355084 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:07.355213 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:07.358600 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment"
19:54:07.359288 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
19:54:07.359784 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
  
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionID],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([ListingID] as int) [ListingID],
	cast([ID] as int) [ID],
	cast([ConsignorID] as int) [UserID],
	cast([HasproMarketing] as bit) [HasProMarketing],
	cast([HasproPhotography] as bit) [HasProPhotography] 
From stg.[AH_SubmittedListingPayment_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end



19:54:07.360009 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:07.360195 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:07.457884 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:07.480439 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:09.835469 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.48 seconds
19:54:09.846578 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
19:54:09.846976 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: rename object "dbo_dbo"."AH_SubmittedListingPayment__dbt_tmp" to AH_SubmittedListingPayment
19:54:09.881572 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:09.883720 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment: COMMIT
19:54:09.885947 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
19:54:09.886960 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
    
  if object_id ('"dbo_dbo"."AH_SubmittedListingPayment__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SubmittedListingPayment__dbt_backup"
    end

19:54:09.926886 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:09.936748 [debug] [Thread-2  ]: finished collecting timing info
19:54:09.937227 [debug] [Thread-2  ]: On model.Shawn.AH_SubmittedListingPayment: Close
19:54:09.938090 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0cf9400>]}
19:54:09.938644 [info ] [Thread-2  ]: 91 of 105 OK created table model dbo_dbo.AH_SubmittedListingPayment............. [[32mOK[0m in 2.62s]
19:54:09.940178 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_SubmittedListingPayment
19:54:09.940456 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ThReadTracking
19:54:09.940892 [info ] [Thread-2  ]: 93 of 105 START table model dbo_dbo.AH_ThReadTracking........................... [RUN]
19:54:09.941792 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ThReadTracking"
19:54:09.941998 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ThReadTracking
19:54:09.942172 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ThReadTracking
19:54:09.945396 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ThReadTracking"
19:54:09.946102 [debug] [Thread-2  ]: finished collecting timing info
19:54:09.946299 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ThReadTracking
19:54:09.958830 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ThReadTracking"
19:54:09.959478 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
19:54:09.959694 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
  
  if object_id ('"dbo_dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_ThReadTracking__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ThReadTracking__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_ThReadTracking__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([ThReadGUID] as nvarchar(4000)) [ThReadGUID],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([PrimarythRead] as bit) [PrimarythRead] 
From stg.[AH_ThReadTracking_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_ThReadTracking__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_ThReadTracking__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end



19:54:09.959848 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:09.960021 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:10.159801 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:10.600324 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.25 seconds
19:54:10.611821 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
19:54:10.612263 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: rename object "dbo_dbo"."AH_SysDiagrams__dbt_tmp" to AH_SysDiagrams
19:54:10.648926 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:10.651089 [debug] [Thread-4  ]: On model.Shawn.AH_SysDiagrams: COMMIT
19:54:10.654941 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
19:54:10.655233 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
    
  if object_id ('"dbo_dbo"."AH_SysDiagrams__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_SysDiagrams__dbt_backup"
    end

19:54:10.692223 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:10.702022 [debug] [Thread-4  ]: finished collecting timing info
19:54:10.702492 [debug] [Thread-4  ]: On model.Shawn.AH_SysDiagrams: Close
19:54:10.703332 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0ba90a0>]}
19:54:10.703857 [info ] [Thread-4  ]: 92 of 105 OK created table model dbo_dbo.AH_SysDiagrams......................... [[32mOK[0m in 3.39s]
19:54:10.705244 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SysDiagrams
19:54:10.705532 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Tiers
19:54:10.705963 [info ] [Thread-4  ]: 94 of 105 START table model dbo_dbo.AH_Tiers.................................... [RUN]
19:54:10.706933 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Tiers"
19:54:10.707147 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Tiers
19:54:10.707327 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Tiers
19:54:10.711532 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Tiers"
19:54:10.712020 [debug] [Thread-4  ]: finished collecting timing info
19:54:10.712459 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Tiers
19:54:10.723759 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Tiers"
19:54:10.724421 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
19:54:10.724636 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
  
  if object_id ('"dbo_dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Tiers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Tiers__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Tiers__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Tiers__dbt_tmp_temp_view as
    
Select
	cast([Upperboundexclusive] as numeric(19,4)) [Upperboundexclusive],
	cast([Value] as numeric(19,4)) [Value],
	cast([Lowerboundinclusive] as numeric(19,4)) [Lowerboundinclusive],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([FeescheduleID] as int) [FeescheduleID],
	cast([ValueType] as nvarchar(4000)) [ValueType],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Tiers_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Tiers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Tiers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Tiers__dbt_tmp_temp_view"
    end



19:54:10.724797 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:10.724975 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:10.828554 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:13.282719 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.32 seconds
19:54:13.293917 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
19:54:13.294322 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: rename object "dbo_dbo"."AH_ThReadTracking__dbt_tmp" to AH_ThReadTracking
19:54:13.329794 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:13.331969 [debug] [Thread-2  ]: On model.Shawn.AH_ThReadTracking: COMMIT
19:54:13.335143 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
19:54:13.335394 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
    
  if object_id ('"dbo_dbo"."AH_ThReadTracking__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_ThReadTracking__dbt_backup"
    end

19:54:13.382132 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:54:13.393764 [debug] [Thread-2  ]: finished collecting timing info
19:54:13.394220 [debug] [Thread-2  ]: On model.Shawn.AH_ThReadTracking: Close
19:54:13.395056 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d93940>]}
19:54:13.395577 [info ] [Thread-2  ]: 93 of 105 OK created table model dbo_dbo.AH_ThReadTracking...................... [[32mOK[0m in 3.45s]
19:54:13.396583 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ThReadTracking
19:54:13.396854 [debug] [Thread-2  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages
19:54:13.397276 [info ] [Thread-2  ]: 95 of 105 START table model dbo_dbo.AH_UnProcessedQueueMessages................. [RUN]
19:54:13.398441 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages"
19:54:13.398675 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages
19:54:13.398859 [debug] [Thread-2  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages
19:54:13.401943 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
19:54:13.402616 [debug] [Thread-2  ]: finished collecting timing info
19:54:13.402815 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages
19:54:13.414154 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
19:54:13.414951 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
19:54:13.415193 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
  
  if object_id ('"dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view as
    
Select
	cast([QueueName] as nvarchar(4000)) [QueueName],
	cast([QueueData] as nvarchar(4000)) [QueueData],
	cast([QueueOrder] as int) [QueueOrder] 
From stg.[AH_UnProcessedQueueMessages_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end



19:54:13.415354 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:13.415533 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:13.601031 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:13.655041 [debug] [Thread-4  ]: SQLServer adapter: Database error: ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
19:54:13.655391 [debug] [Thread-4  ]: On model.Shawn.AH_Tiers: ROLLBACK
19:54:13.655506 [debug] [Thread-4  ]: On model.Shawn.AH_Tiers: Close
19:54:13.655906 [debug] [Thread-4  ]: finished collecting timing info
19:54:13.656348 [debug] [Thread-4  ]: Database Error in model AH_Tiers (models/step4_dboSingle/AH_Tiers.sql)
  ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
  compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_Tiers.sql
19:54:13.656648 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0bcf700>]}
19:54:13.657014 [error] [Thread-4  ]: 94 of 105 ERROR creating table model dbo_dbo.AH_Tiers........................... [[31mERROR[0m in 2.95s]
19:54:13.657898 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Tiers
19:54:13.658193 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserAlerts
19:54:13.658994 [info ] [Thread-4  ]: 96 of 105 START table model dbo_dbo.AH_UserAlerts............................... [RUN]
19:54:13.660423 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserAlerts"
19:54:13.661851 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserAlerts
19:54:13.662458 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserAlerts
19:54:13.666865 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserAlerts"
19:54:13.667370 [debug] [Thread-4  ]: finished collecting timing info
19:54:13.667607 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserAlerts
19:54:13.679557 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserAlerts"
19:54:13.680214 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
19:54:13.680421 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
  
  if object_id ('"dbo_dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_UserAlerts__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserAlerts__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_UserAlerts__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([MakeID] as int) [MakeID],
	cast([ModelID] as int) [ModelID],
	cast([YearFrom] as int) [YearFrom],
	cast([Yearto] as int) [Yearto],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_UserAlerts_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_UserAlerts__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_UserAlerts__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end



19:54:13.680576 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:13.680749 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:13.779694 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:15.951538 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.54 seconds
19:54:15.962796 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
19:54:15.963184 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: rename object "dbo_dbo"."AH_UnProcessedQueueMessages__dbt_tmp" to AH_UnProcessedQueueMessages
19:54:15.993584 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:15.995682 [debug] [Thread-2  ]: On model.Shawn.AH_UnProcessedQueueMessages: COMMIT
19:54:15.997926 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
19:54:15.998169 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
    
  if object_id ('"dbo_dbo"."AH_UnProcessedQueueMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UnProcessedQueueMessages__dbt_backup"
    end

19:54:16.035416 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:16.044994 [debug] [Thread-2  ]: finished collecting timing info
19:54:16.045378 [debug] [Thread-2  ]: On model.Shawn.AH_UnProcessedQueueMessages: Close
19:54:16.046161 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2d93be0>]}
19:54:16.046711 [info ] [Thread-2  ]: 95 of 105 OK created table model dbo_dbo.AH_UnProcessedQueueMessages............ [[32mOK[0m in 2.65s]
19:54:16.048135 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages
19:54:16.048427 [debug] [Thread-2  ]: Began running node model.Shawn.AH_UserLogins
19:54:16.048857 [info ] [Thread-2  ]: 97 of 105 START table model dbo_dbo.AH_UserLogins............................... [RUN]
19:54:16.049790 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins"
19:54:16.049999 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_UserLogins
19:54:16.050175 [debug] [Thread-2  ]: Compiling model.Shawn.AH_UserLogins
19:54:16.053448 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins"
19:54:16.054156 [debug] [Thread-2  ]: finished collecting timing info
19:54:16.054355 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_UserLogins
19:54:16.067821 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins"
19:54:16.068597 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
19:54:16.068828 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
  
  if object_id ('"dbo_dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_UserLogins__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserLogins__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_UserLogins__dbt_tmp_temp_view as
    
Select
	cast([LoginprovIDEr] as nvarchar(4000)) [LoginprovIDEr],
	cast([ProvIDErKey] as nvarchar(4000)) [ProvIDErKey],
	cast([UserID] as int) [UserID] 
From stg.[AH_UserLogins_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_UserLogins__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_UserLogins__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end



19:54:16.068986 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:16.069165 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:16.344408 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:16.558795 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.88 seconds
19:54:16.570591 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
19:54:16.570960 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: rename object "dbo_dbo"."AH_UserAlerts__dbt_tmp" to AH_UserAlerts
19:54:16.618393 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:54:16.620371 [debug] [Thread-4  ]: On model.Shawn.AH_UserAlerts: COMMIT
19:54:16.622719 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
19:54:16.622958 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
    
  if object_id ('"dbo_dbo"."AH_UserAlerts__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserAlerts__dbt_backup"
    end

19:54:16.662879 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:16.673229 [debug] [Thread-4  ]: finished collecting timing info
19:54:16.673674 [debug] [Thread-4  ]: On model.Shawn.AH_UserAlerts: Close
19:54:16.674482 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d114f0>]}
19:54:16.675053 [info ] [Thread-4  ]: 96 of 105 OK created table model dbo_dbo.AH_UserAlerts.......................... [[32mOK[0m in 3.01s]
19:54:16.676128 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserAlerts
19:54:16.677270 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserMessages
19:54:16.677730 [info ] [Thread-4  ]: 98 of 105 START table model dbo_dbo.AH_UserMessages............................. [RUN]
19:54:16.678900 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserMessages"
19:54:16.679117 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserMessages
19:54:16.679297 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserMessages
19:54:16.682685 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserMessages"
19:54:16.683185 [debug] [Thread-4  ]: finished collecting timing info
19:54:16.683376 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserMessages
19:54:16.694229 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserMessages"
19:54:16.694895 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
19:54:16.695091 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
  
  if object_id ('"dbo_dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_UserMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserMessages__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_UserMessages__dbt_tmp_temp_view as
    
Select
	cast([SEnderID] as int) [SEnderID],
	cast([RecipientID] as int) [RecipientID],
	cast([MasTerMessageID] as int) [MasTerMessageID],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([Sent] as datetime) [Sent],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([SuBJect] as nvarchar(4000)) [SuBJect],
	cast([Body] as nvarchar(4000)) [Body],
	cast([SEnderStatus] as nvarchar(4000)) [SEnderStatus],
	cast([RecipientStatus] as nvarchar(4000)) [RecipientStatus],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_UserMessages_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_UserMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_UserMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end



19:54:16.695258 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:16.695428 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:16.809555 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:18.589643 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.52 seconds
19:54:18.688084 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
19:54:18.688501 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: rename object "dbo_dbo"."AH_UserLogins__dbt_tmp" to AH_UserLogins
19:54:18.751587 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:54:18.753521 [debug] [Thread-2  ]: On model.Shawn.AH_UserLogins: COMMIT
19:54:18.755663 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
19:54:18.755905 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
    
  if object_id ('"dbo_dbo"."AH_UserLogins__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserLogins__dbt_backup"
    end

19:54:18.792419 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:18.805017 [debug] [Thread-2  ]: finished collecting timing info
19:54:18.805516 [debug] [Thread-2  ]: On model.Shawn.AH_UserLogins: Close
19:54:18.806359 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0c1ed60>]}
19:54:18.806957 [info ] [Thread-2  ]: 97 of 105 OK created table model dbo_dbo.AH_UserLogins.......................... [[32mOK[0m in 2.76s]
19:54:18.808112 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_UserLogins
19:54:18.808401 [debug] [Thread-2  ]: Began running node model.Shawn.AH_UserOptOut
19:54:18.808835 [info ] [Thread-2  ]: 99 of 105 START table model dbo_dbo.AH_UserOptOut............................... [RUN]
19:54:18.810183 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_UserOptOut"
19:54:18.810397 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_UserOptOut
19:54:18.810602 [debug] [Thread-2  ]: Compiling model.Shawn.AH_UserOptOut
19:54:18.814044 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_UserOptOut"
19:54:18.814637 [debug] [Thread-2  ]: finished collecting timing info
19:54:18.814877 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_UserOptOut
19:54:18.826387 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_UserOptOut"
19:54:18.827170 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
19:54:18.827399 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
  
  if object_id ('"dbo_dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_UserOptOut__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserOptOut__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_UserOptOut__dbt_tmp_temp_view as
    
Select
	cast([EmailName] as nvarchar(4000)) [EmailName],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID] 
From stg.[AH_UserOptOut_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_UserOptOut__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_UserOptOut__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end



19:54:18.827568 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:18.827753 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:18.931437 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:19.478473 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.78 seconds
19:54:19.489484 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
19:54:19.489846 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: rename object "dbo_dbo"."AH_UserMessages__dbt_tmp" to AH_UserMessages
19:54:19.521306 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:19.523585 [debug] [Thread-4  ]: On model.Shawn.AH_UserMessages: COMMIT
19:54:19.525831 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
19:54:19.526082 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
    
  if object_id ('"dbo_dbo"."AH_UserMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserMessages__dbt_backup"
    end

19:54:19.566059 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:19.575817 [debug] [Thread-4  ]: finished collecting timing info
19:54:19.576274 [debug] [Thread-4  ]: On model.Shawn.AH_UserMessages: Close
19:54:19.577114 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0b1dbe0>]}
19:54:19.577635 [info ] [Thread-4  ]: 98 of 105 OK created table model dbo_dbo.AH_UserMessages........................ [[32mOK[0m in 2.90s]
19:54:19.578755 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserMessages
19:54:19.579040 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserRoles
19:54:19.579470 [info ] [Thread-4  ]: 100 of 105 START table model dbo_dbo.AH_UserRoles............................... [RUN]
19:54:19.580763 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserRoles"
19:54:19.580976 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserRoles
19:54:19.581159 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserRoles
19:54:19.584402 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserRoles"
19:54:19.585062 [debug] [Thread-4  ]: finished collecting timing info
19:54:19.585259 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserRoles
19:54:19.596518 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserRoles"
19:54:19.597225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
19:54:19.597441 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
  
  if object_id ('"dbo_dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_UserRoles__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserRoles__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_UserRoles__dbt_tmp_temp_view as
    
Select
	cast([RoleID] as int) [RoleID],
	cast([ID] as int) [ID_RWXUserRoles],
	cast([UserID] as int) [UserID] 
From stg.[AH_UserRoles_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_UserRoles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_UserRoles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end



19:54:19.597595 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:19.597789 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:19.698441 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:21.891814 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.06 seconds
19:54:21.903545 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
19:54:21.903960 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: rename object "dbo_dbo"."AH_UserOptOut__dbt_tmp" to AH_UserOptOut
19:54:21.979711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:54:21.983080 [debug] [Thread-2  ]: On model.Shawn.AH_UserOptOut: COMMIT
19:54:21.986323 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
19:54:21.986598 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
    
  if object_id ('"dbo_dbo"."AH_UserOptOut__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserOptOut__dbt_backup"
    end

19:54:22.060249 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:54:22.073130 [debug] [Thread-2  ]: finished collecting timing info
19:54:22.073631 [debug] [Thread-2  ]: On model.Shawn.AH_UserOptOut: Close
19:54:22.074475 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2db18b0>]}
19:54:22.075044 [info ] [Thread-2  ]: 99 of 105 OK created table model dbo_dbo.AH_UserOptOut.......................... [[32mOK[0m in 3.26s]
19:54:22.076150 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_UserOptOut
19:54:22.076423 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Userclaims
19:54:22.076844 [info ] [Thread-2  ]: 101 of 105 START table model dbo_dbo.AH_Userclaims.............................. [RUN]
19:54:22.078276 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Userclaims"
19:54:22.078490 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Userclaims
19:54:22.078715 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Userclaims
19:54:22.082032 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Userclaims"
19:54:22.082576 [debug] [Thread-2  ]: finished collecting timing info
19:54:22.082780 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Userclaims
19:54:22.094369 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Userclaims"
19:54:22.095243 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
19:54:22.095488 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
  
  if object_id ('"dbo_dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Userclaims__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Userclaims__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Userclaims__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([ClaimType] as nvarchar(4000)) [ClaimType],
	cast([ClaimValue] as nvarchar(4000)) [ClaimValue] 
From stg.[AH_Userclaims_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Userclaims__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Userclaims__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end



19:54:22.095652 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:22.095834 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:22.202502 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:22.295529 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.70 seconds
19:54:22.307218 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
19:54:22.307619 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: rename object "dbo_dbo"."AH_UserRoles__dbt_tmp" to AH_UserRoles
19:54:22.346008 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:22.347971 [debug] [Thread-4  ]: On model.Shawn.AH_UserRoles: COMMIT
19:54:22.350070 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
19:54:22.350307 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
    
  if object_id ('"dbo_dbo"."AH_UserRoles__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_UserRoles__dbt_backup"
    end

19:54:22.386511 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:22.397344 [debug] [Thread-4  ]: finished collecting timing info
19:54:22.397848 [debug] [Thread-4  ]: On model.Shawn.AH_UserRoles: Close
19:54:22.398736 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d0d1fb80>]}
19:54:22.399279 [info ] [Thread-4  ]: 100 of 105 OK created table model dbo_dbo.AH_UserRoles.......................... [[32mOK[0m in 2.82s]
19:54:22.400400 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserRoles
19:54:22.400677 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Userproperties
19:54:22.401090 [info ] [Thread-4  ]: 102 of 105 START table model dbo_dbo.AH_Userproperties.......................... [RUN]
19:54:22.402485 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Userproperties"
19:54:22.402723 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Userproperties
19:54:22.402903 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Userproperties
19:54:22.406170 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Userproperties"
19:54:22.406874 [debug] [Thread-4  ]: finished collecting timing info
19:54:22.407069 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Userproperties
19:54:22.418018 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Userproperties"
19:54:22.418729 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
19:54:22.418936 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
  
  if object_id ('"dbo_dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Userproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Userproperties__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Userproperties__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID_RWXUserProperties],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([UserID] as int) [UserID],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([BoolnativeValue] as bit) [HasBoolNativeValue],
	cast([CreatedOn] as datetime) [Created_RWXUserProperties],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXUserProperties],
	cast([DeletedOn] as datetime) [DeletedDate_RWXUserProperties],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXUserProperties],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue] 
From stg.[AH_Userproperties_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Userproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Userproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end



19:54:22.419110 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:54:22.419285 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:22.521981 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:24.424222 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.33 seconds
19:54:24.435786 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
19:54:24.436203 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: rename object "dbo_dbo"."AH_Userclaims__dbt_tmp" to AH_Userclaims
19:54:24.469254 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:54:24.471357 [debug] [Thread-2  ]: On model.Shawn.AH_Userclaims: COMMIT
19:54:24.473447 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
19:54:24.473667 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
    
  if object_id ('"dbo_dbo"."AH_Userclaims__dbt_backup"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Userclaims__dbt_backup"
    end

19:54:24.513119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:54:24.524427 [debug] [Thread-2  ]: finished collecting timing info
19:54:24.524950 [debug] [Thread-2  ]: On model.Shawn.AH_Userclaims: Close
19:54:24.525835 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36430c4c-bbd0-4e8b-842e-9137413ee482', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70d2dfa3d0>]}
19:54:24.526393 [info ] [Thread-2  ]: 101 of 105 OK created table model dbo_dbo.AH_Userclaims......................... [[32mOK[0m in 2.45s]
19:54:24.527554 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Userclaims
19:54:24.527833 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Users
19:54:24.528278 [info ] [Thread-2  ]: 103 of 105 START table model dbo_dbo.AH_Users................................... [RUN]
19:54:24.531789 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Users"
19:54:24.532072 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Users
19:54:24.532286 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Users
19:54:24.535916 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Users"
19:54:24.536518 [debug] [Thread-2  ]: finished collecting timing info
19:54:24.536726 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Users
19:54:24.548513 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Users"
19:54:24.549249 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
19:54:24.549484 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Users: 
  
  if object_id ('"dbo_dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Users__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo_dbo"."AH_Users__dbt_tmp"','U') is not null
    begin
    drop table "dbo_dbo"."AH_Users__dbt_tmp"
    end


   EXEC('create view dbo_dbo.AH_Users__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [UserID],
	cast([BillingAddressID] as int) [BilingAddressID],
	cast([BillingCreditCardID] as int) [BillingCreditCardID],
	cast([PrimaryAddressID] as int) [PrimaryAddressID],
	cast([AccessfailedCount] as int) [AccessFailedCount],
	cast([IsApproved] as bit) [IsApproved],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([NewsLetter] as bit) [IsNewsletter],
	cast([IsVerified] as bit) [IsVerified],
	cast([IsActive] as bit) [IsActive],
	cast([EmailConfirmed] as bit) [HasEmailConfirmed],
	cast([PhoneNumberConfirmed] as bit) [HasPhoneNumberConfirmed],
	cast([TwoFactorEnabled] as bit) [HasTwoFactorEnabled],
	cast([LockOutEnabled] as bit) [HasLockoutEnabled],
	cast([WebapiEnabled] as bit) [HasWebAPIEnabled],
	cast([CreationDate] as datetime) [CreatedDate],
	cast([LastLoginDate] as datetime) [LastLoginDateTime],
	cast([LastActivityDate] as datetime) [LastActivityDateTime],
	cast([CreatedOn] as datetime) [Created_RWXUsers],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXUsers],
	cast([DeletedOn] as datetime) [DeletedDate_RWXUsers],
	cast([LockOutEndDateUTC] as datetime) [LockoutEndDateTimeUTC],
	cast([UserName] as nvarchar(500)) [UserName],
	cast([Email] as nvarchar(320)) [Email],
	cast([Password] as varchar(128)) [Password],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXUsers],
	cast([Culture] as nvarchar(10)) [Culture],
	cast([Lastip] as nvarchar(50)) [LastIPAddress],
	cast([VerificationToken] as nvarchar(100)) [VerificationToken],
	cast([PasswordResetToken] as varchar(128)) [PasswordResetToken],
	cast([ServiceAuthorizationToken] as nvarchar(100)) [ServiceAuthorizationToken],
	cast([PasswordHash] as nvarchar(4000)) [PasswordHash],
	cast([SecURItyStamp] as nvarchar(4000)) [SecurityStamp],
	cast([PhoneNumber] as nvarchar(40)) [PhoneNumber] 
From stg.[AH_Users_FinalView]
    ');

  CREATE TABLE "dbo_dbo"."AH_Users__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo_dbo.AH_Users__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo_dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo_dbo"."AH_Users__dbt_tmp_temp_view"
    end



19:54:24.549659 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:54:24.549848 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:54:24.654873 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:54:30.968981 [debug] [MainThread]: Acquiring new synapse connection "master"
19:54:30.969806 [debug] [MainThread]: SQLServer adapter: Cancel query
19:54:30.970736 [debug] [MainThread]: SQLServer adapter: Cancel query
19:54:30.970945 [debug] [MainThread]: SQLServer adapter: Cancel query
19:54:30.971094 [debug] [MainThread]: SQLServer adapter: Cancel query
19:54:30.971266 [error] [MainThread]: CANCEL query model.Shawn.AH_Mediaassets......................................... [[31mCANCEL[0m]
19:54:30.972230 [error] [MainThread]: CANCEL query model.Shawn.AH_Users............................................... [[31mCANCEL[0m]
19:54:30.973051 [error] [MainThread]: CANCEL query model.Shawn.AH_MediaMetaData....................................... [[31mCANCEL[0m]
19:54:30.973665 [error] [MainThread]: CANCEL query model.Shawn.AH_Userproperties...................................... [[31mCANCEL[0m]
19:54:31.364647 [debug] [MainThread]: Connection 'master' was properly closed.
19:54:31.365154 [debug] [MainThread]: Connection 'model.Shawn.AH_Mediaassets' was left open.
19:54:31.365738 [debug] [MainThread]: On model.Shawn.AH_Mediaassets: ROLLBACK
19:54:31.366000 [debug] [MainThread]: On model.Shawn.AH_Mediaassets: Close
19:54:33.875488 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.33 seconds


============================== 2022-09-16 19:55:57.500675 | b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e ==============================
19:55:57.500675 [info ] [MainThread]: Running with dbt=1.0.0
19:55:57.507737 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step4_dboSingle'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
19:55:57.508184 [debug] [MainThread]: Tracking: tracking
19:55:57.508603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcbf33d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcbf33dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcbf33e20>]}
19:55:57.741926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
19:55:57.743571 [debug] [MainThread]: Partial parsing: added file: Shawn://macros/generate_schema_name.sql
19:55:57.743926 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
19:55:57.746475 [info ] [MainThread]: Change detected to override macro used during parsing. Starting full parse.
19:55:57.747612 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
19:55:57.749254 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:55:57.755486 [debug] [MainThread]: Parsing macros/materializations/seeds/str_replace.sql
19:55:57.756517 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:55:57.762125 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:55:57.763829 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:55:57.766669 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:55:57.767469 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:55:57.769751 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:55:57.774379 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:55:57.777423 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:55:57.783873 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:55:57.785067 [debug] [MainThread]: Parsing macros/adapters.sql
19:55:57.785394 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:55:57.790278 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:55:57.791737 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:55:57.799241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:55:57.801331 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:55:57.802219 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:55:57.803823 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:55:57.808471 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:55:57.811101 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:55:57.812613 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:55:57.813130 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:55:57.813367 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:55:57.818059 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:55:57.822838 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:55:57.828352 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:55:57.837447 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:55:57.840787 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
19:55:57.844920 [debug] [MainThread]: Parsing macros/materializations/configs.sql
19:55:57.847538 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
19:55:57.849552 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
19:55:57.854319 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
19:55:57.856307 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
19:55:57.862426 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
19:55:57.879141 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
19:55:57.891170 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
19:55:57.893328 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
19:55:57.911071 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
19:55:57.922717 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
19:55:57.927632 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
19:55:57.940006 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
19:55:57.950382 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
19:55:57.952371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
19:55:57.968063 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
19:55:57.976033 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
19:55:57.979395 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
19:55:57.982030 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
19:55:57.985048 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
19:55:57.992475 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
19:55:57.994097 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
19:55:57.994988 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
19:55:57.996462 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
19:55:57.997127 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
19:55:57.998089 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
19:55:58.001095 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
19:55:58.005599 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
19:55:58.013151 [debug] [MainThread]: Parsing macros/adapters/columns.sql
19:55:58.023144 [debug] [MainThread]: Parsing macros/adapters/relation.sql
19:55:58.033143 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
19:55:58.036250 [debug] [MainThread]: Parsing macros/adapters/schema.sql
19:55:58.038740 [debug] [MainThread]: Parsing macros/etc/datetime.sql
19:55:58.047385 [debug] [MainThread]: Parsing macros/etc/statement.sql
19:55:58.052048 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
19:55:58.053892 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
19:55:58.056571 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
19:55:58.058247 [debug] [MainThread]: Parsing tests/generic/builtin.sql
19:55:58.284473 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
19:55:58.295744 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Categories.sql
19:55:58.298336 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Events.sql
19:55:58.300676 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Locations.sql
19:55:58.302777 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingsReserveHistory.sql
19:55:58.305063 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingPaymentCharge.sql
19:55:58.307118 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserMessages.sql
19:55:58.309165 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ReListHistory.sql
19:55:58.311191 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeproperties.sql
19:55:58.313197 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UnProcessedQueueMessages.sql
19:55:58.315232 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCustomFields.sql
19:55:58.318030 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeschedules.sql
19:55:58.320101 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListings.sql
19:55:58.322128 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LogentriesBuffer.sql
19:55:58.324178 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
19:55:58.326189 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Languages.sql
19:55:58.328545 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Reports.sql
19:55:58.330637 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserAlerts.sql
19:55:58.332703 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Propertybags.sql
19:55:58.334718 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingQuestions.sql
19:55:58.336684 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Countries.sql
19:55:58.338674 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingMedias.sql
19:55:58.340884 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feedbacks.sql
19:55:58.342943 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Invoices.sql
19:55:58.344918 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ExternalUserIDs.sql
19:55:58.346945 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listings.sql
19:55:58.348917 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaassetMetaData.sql
19:55:58.351210 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingOptions.sql
19:55:58.353188 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingLocations.sql
19:55:58.355209 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Siteproperties.sql
19:55:58.357176 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplates.sql
19:55:58.359169 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedCategoryMap.sql
19:55:58.361162 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentprovIDErs.sql
19:55:58.363987 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_States.sql
19:55:58.366030 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Increments.sql
19:55:58.368086 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ThReadTracking.sql
19:55:58.370096 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserOptOut.sql
19:55:58.372337 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Attributes.sql
19:55:58.374683 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingEnddttmAudit.sql
19:55:58.376675 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingMethods.sql
19:55:58.378710 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActions.sql
19:55:58.380700 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannerCategories.sql
19:55:58.382729 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logentries.sql
19:55:58.384737 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Properties.sql
19:55:58.387166 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BiddingTransactions.sql
19:55:58.389179 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Banners.sql
19:55:58.391218 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contents.sql
19:55:58.393241 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedUserMap.sql
19:55:58.395303 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SalesTaxRates.sql
19:55:58.397615 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Notifications.sql
19:55:58.399651 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeproperties.sql
19:55:58.401665 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
19:55:58.403702 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEventMedias.sql
19:55:58.405706 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEvents.sql
19:55:58.407812 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplates.sql
19:55:58.410134 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Addresses.sql
19:55:58.412213 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Media.sql
19:55:58.414242 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SubmittedListingPayment.sql
19:55:58.416267 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFields.sql
19:55:58.418282 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaMetaData.sql
19:55:58.420628 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SysDiagrams.sql
19:55:58.422634 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Lots.sql
19:55:58.424627 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardTypes.sql
19:55:58.426656 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingdecorations.sql
19:55:58.428648 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_KeyTable.sql
19:55:58.430680 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Watches.sql
19:55:58.433053 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_StripeCustomers.sql
19:55:58.435143 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PropertybagItems.sql
19:55:58.437217 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Version.sql
19:55:58.439288 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserLogins.sql
19:55:58.441356 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userclaims.sql
19:55:58.443729 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logstats.sql
19:55:58.445726 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Customcurrencies.sql
19:55:58.447790 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userproperties.sql
19:55:58.449846 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LineItems.sql
19:55:58.451906 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActionproperties.sql
19:55:58.453973 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCount.sql
19:55:58.456605 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedregionMap.sql
19:55:58.458655 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_NewSalestoInvoice.sql
19:55:58.460672 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Offers.sql
19:55:58.462762 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediaassets.sql
19:55:58.464828 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Currencies.sql
19:55:58.467242 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Users.sql
19:55:58.469291 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserRoles.sql
19:55:58.471347 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListingTypes.sql
19:55:58.473390 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingCommentsMedias.sql
19:55:58.475461 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeMedia.sql
19:55:58.477494 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplatecontents.sql
19:55:58.479845 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentResponses.sql
19:55:58.481860 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFieldenums.sql
19:55:58.483922 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Decorations.sql
19:55:58.485947 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypes.sql
19:55:58.488013 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplatecontents.sql
19:55:58.490384 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
19:55:58.492445 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Mediavariations.sql
19:55:58.494467 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Roles.sql
19:55:58.496503 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingComments.sql
19:55:58.498498 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contactus.sql
19:55:58.500555 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Model.sql
19:55:58.503091 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentConfigurationTable.sql
19:55:58.505111 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedListingsMap.sql
19:55:58.507172 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingproperties.sql
19:55:58.509173 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Eventproperties.sql
19:55:58.511216 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardsExtraInFormation.sql
19:55:58.513521 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannedUsers.sql
19:55:58.515886 [debug] [MainThread]: 1603: static parser failed on tmp/SZ_AH_Properties_Pivot_Full.sql
19:55:58.532753 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/SZ_AH_Properties_Pivot_Full.sql
19:55:58.534590 [debug] [MainThread]: 1699: static parser successfully parsed step8_4_FT/AH_Listings_FT.sql
19:55:58.538112 [debug] [MainThread]: 1603: static parser failed on step7_3/SZ_AH_AllProperties_One_Column.sql
19:55:58.546525 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_3/SZ_AH_AllProperties_One_Column.sql
19:55:58.548169 [debug] [MainThread]: 1699: static parser successfully parsed step7_3/SZ_AH_Properties_CustomFields_Lookup.sql
19:55:58.550981 [debug] [MainThread]: 1699: static parser successfully parsed step8_2_FT_stg/AH_Listings_FT_stg.sql
19:55:58.553470 [debug] [MainThread]: 1603: static parser failed on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
19:55:58.559409 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
19:55:58.560860 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldType.sql
19:55:58.563152 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldIDs.sql
19:55:58.565390 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UserLogins_Incr.sql
19:55:58.573905 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UserLogins_Incr.sql
19:55:58.575524 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_CreditCards_Incr.sql
19:55:58.579936 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_CreditCards_Incr.sql
19:55:58.581339 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_Logstats_Incr.sql
19:55:58.586418 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_Logstats_Incr.sql
19:55:58.587872 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
19:55:58.592020 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
19:55:58.593509 [debug] [MainThread]: 1603: static parser failed on step7_4/SZ_AH_Properties_Pivot.sql
19:55:58.601834 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_4/SZ_AH_Properties_Pivot.sql
19:55:58.603450 [debug] [MainThread]: 1699: static parser successfully parsed step8_1_DM/AH_Cars_DM.sql
19:55:58.605769 [debug] [MainThread]: 1699: static parser successfully parsed step8_3_FT_tmp/AH_Listings_FT_tmp.sql
19:55:58.608705 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingActions_FT_stg.sql
19:55:58.611246 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Watches_FT_stg.sql
19:55:58.613351 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Invoices_FT_stg.sql
19:55:58.615456 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_LineItems_FT_stg.sql
19:55:58.617478 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingPaymentCharge_FT_stg.sql
19:55:58.619562 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_SubmittedListingPayment_FT_stg.sql
19:55:58.621910 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_LineItems_FT_tmp.sql
19:55:58.623950 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_SubmittedListingPayment_FT_tmp.sql
19:55:58.625964 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Invoices_FT_tmp.sql
19:55:58.627990 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Watches_FT_tmp.sql
19:55:58.630015 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingActions_FT_tmp.sql
19:55:58.632055 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingPaymentCharge_FT_tmp.sql
19:55:58.634392 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Users_InterView.sql
19:55:58.636428 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannerCategories_InterView.sql
19:55:58.638434 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Events_InterView.sql
19:55:58.640479 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logstats_InterView.sql
19:55:58.642476 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Attributes_InterView.sql
19:55:58.644807 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserRoles_InterView.sql
19:55:58.646832 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Locations_InterView.sql
19:55:58.648837 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediavariations_InterView.sql
19:55:58.650892 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SalesTaxRates_InterView.sql
19:55:58.652885 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFieldenums_InterView.sql
19:55:58.654908 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedUserMap_InterView.sql
19:55:58.657264 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Increments_InterView.sql
19:55:58.659328 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Customcurrencies_InterView.sql
19:55:58.661348 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Lots_InterView.sql
19:55:58.663393 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contactus_InterView.sql
19:55:58.665396 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplates_InterView.sql
19:55:58.667738 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannedUsers_InterView.sql
19:55:58.669739 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userproperties_InterView.sql
19:55:58.671791 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCards_InterView.sql
19:55:58.673815 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Offers_InterView.sql
19:55:58.675828 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PropertybagItems_InterView.sql
19:55:58.677796 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActionproperties_InterView.sql
19:55:58.680101 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_States_InterView.sql
19:55:58.682088 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCustomFields_InterView.sql
19:55:58.684217 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingComments_InterView.sql
19:55:58.686219 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFields_InterView.sql
19:55:58.688231 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Version_InterView.sql
19:55:58.690514 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Categories_InterView.sql
19:55:58.692547 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaMetaData_InterView.sql
19:55:58.694611 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingsReserveHistory_InterView.sql
19:55:58.696598 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypes_InterView.sql
19:55:58.698599 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeFeeprovIDErs_InterView.sql
19:55:58.700782 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardsExtraInFormation_InterView.sql
19:55:58.703139 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentprovIDErs_InterView.sql
19:55:58.705138 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingLocations_InterView.sql
19:55:58.707192 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Banners_InterView.sql
19:55:58.709189 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Eventproperties_InterView.sql
19:55:58.711310 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingCommentsMedias_InterView.sql
19:55:58.714230 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Languages_InterView.sql
19:55:58.716300 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplatecontents_InterView.sql
19:55:58.718322 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feedbacks_InterView.sql
19:55:58.720395 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEvents_InterView.sql
19:55:58.722431 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SubmittedListingPayment_InterView.sql
19:55:58.724509 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEventMedias_InterView.sql
19:55:58.726875 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingQuestions_InterView.sql
19:55:58.728875 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingOptions_InterView.sql
19:55:58.730910 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contents_InterView.sql
19:55:58.732930 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedListingsMap_InterView.sql
19:55:58.734963 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Properties_InterView.sql
19:55:58.737280 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingdecorations_InterView.sql
19:55:58.739321 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeschedules_InterView.sql
19:55:58.741319 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedCategoryMap_InterView.sql
19:55:58.743343 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplates_InterView.sql
19:55:58.745315 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Reports_InterView.sql
19:55:58.747319 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardTypes_InterView.sql
19:55:58.749579 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserAlerts_InterView.sql
19:55:58.751648 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeMedia_InterView.sql
19:55:58.753649 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ExternalUserIDs_InterView.sql
19:55:58.755649 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ThReadTracking_InterView.sql
19:55:58.757735 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingMethods_InterView.sql
19:55:58.760088 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Invoices_InterView.sql
19:55:58.762045 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaassetMetaData_InterView.sql
19:55:58.764074 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Propertybags_InterView.sql
19:55:58.766114 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingPaymentCharge_InterView.sql
19:55:58.768216 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeproperties_InterView.sql
19:55:58.770497 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logentries_InterView.sql
19:55:58.772914 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listings_InterView.sql
19:55:58.774998 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Notifications_InterView.sql
19:55:58.777047 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActions_InterView.sql
19:55:58.779083 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_KeyTable_InterView.sql
19:55:58.781117 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Watches_InterView.sql
19:55:58.783461 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Siteproperties_InterView.sql
19:55:58.785468 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserOptOut_InterView.sql
19:55:58.787504 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BiddingTransactions_InterView.sql
19:55:58.789513 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SysDiagrams_InterView.sql
19:55:58.791536 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Tiers_InterView.sql
19:55:58.793555 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentConfigurationTable_InterView.sql
19:55:58.795819 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userclaims_InterView.sql
19:55:58.797787 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserLogins_InterView.sql
19:55:58.801725 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedregionMap_InterView.sql
19:55:58.806198 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Countries_InterView.sql
19:55:58.809108 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LineItems_InterView.sql
19:55:58.816741 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UnProcessedQueueMessages_InterView.sql
19:55:58.819858 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCount_InterView.sql
19:55:58.822183 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_StripeCustomers_InterView.sql
19:55:58.829076 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserMessages_InterView.sql
19:55:58.833327 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Decorations_InterView.sql
19:55:58.839465 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Model_InterView.sql
19:55:58.844580 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Addresses_InterView.sql
19:55:58.849279 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediaassets_InterView.sql
19:55:58.853502 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Roles_InterView.sql
19:55:58.856634 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_NewSalestoInvoice_InterView.sql
19:55:58.860146 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListingTypes_InterView.sql
19:55:58.863312 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ReListHistory_InterView.sql
19:55:58.867242 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingproperties_InterView.sql
19:55:58.869536 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeproperties_InterView.sql
19:55:58.872628 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Currencies_InterView.sql
19:55:58.875030 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingMedias_InterView.sql
19:55:58.877292 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Media_InterView.sql
19:55:58.879932 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingEnddttmAudit_InterView.sql
19:55:58.882110 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentResponses_InterView.sql
19:55:58.884313 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListings_InterView.sql
19:55:58.886426 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LogentriesBuffer_InterView.sql
19:55:58.888556 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_DailyhuntEmailSubscribers_InterView.sql
19:55:58.891235 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplatecontents_InterView.sql
19:55:58.893344 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Siteproperties_FinalView.sql
19:55:58.895439 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeschedules_FinalView.sql
19:55:58.897476 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Properties_FinalView.sql
19:55:58.899561 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logentries_FinalView.sql
19:55:58.901822 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userclaims_FinalView.sql
19:55:58.972096 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserOptOut_FinalView.sql
19:55:58.974638 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardTypes_FinalView.sql
19:55:58.976906 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_KeyTable_FinalView.sql
19:55:58.980076 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Invoices_FinalView.sql
19:55:58.982896 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LineItems_FinalView.sql
19:55:58.986534 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Propertybags_FinalView.sql
19:55:58.988877 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contactus_FinalView.sql
19:55:58.991128 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Currencies_FinalView.sql
19:55:58.993336 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Users_FinalView.sql
19:55:58.995836 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserMessages_FinalView.sql
19:55:58.997952 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Addresses_FinalView.sql
19:55:59.000103 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingdecorations_FinalView.sql
19:55:59.002228 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Roles_FinalView.sql
19:55:59.004358 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Watches_FinalView.sql
19:55:59.006413 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeMedia_FinalView.sql
19:55:59.008810 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentResponses_FinalView.sql
19:55:59.010912 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SubmittedListingPayment_FinalView.sql
19:55:59.012965 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ExternalUserIDs_FinalView.sql
19:55:59.015034 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SalesTaxRates_FinalView.sql
19:55:59.017060 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserLogins_FinalView.sql
19:55:59.019451 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFields_FinalView.sql
19:55:59.021463 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BiddingTransactions_FinalView.sql
19:55:59.023512 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplates_FinalView.sql
19:55:59.025544 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedregionMap_FinalView.sql
19:55:59.027579 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannerCategories_FinalView.sql
19:55:59.029576 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActions_FinalView.sql
19:55:59.031856 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingOptions_FinalView.sql
19:55:59.033867 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contents_FinalView.sql
19:55:59.035910 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActionproperties_FinalView.sql
19:55:59.037883 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ReListHistory_FinalView.sql
19:55:59.039919 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingMethods_FinalView.sql
19:55:59.042205 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Offers_FinalView.sql
19:55:59.044208 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFieldenums_FinalView.sql
19:55:59.046195 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplatecontents_FinalView.sql
19:55:59.048215 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediavariations_FinalView.sql
19:55:59.050242 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListingTypes_FinalView.sql
19:55:59.052345 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCustomFields_FinalView.sql
19:55:59.054716 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingPaymentCharge_FinalView.sql
19:55:59.056725 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userproperties_FinalView.sql
19:55:59.058785 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeproperties_FinalView.sql
19:55:59.060814 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedCategoryMap_FinalView.sql
19:55:59.062878 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeFeeprovIDErs_FinalView.sql
19:55:59.065204 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingEnddttmAudit_FinalView.sql
19:55:59.067306 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaassetMetaData_FinalView.sql
19:55:59.069379 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listings_FinalView.sql
19:55:59.071459 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediaassets_FinalView.sql
19:55:59.073544 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Media_FinalView.sql
19:55:59.075586 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEvents_FinalView.sql
19:55:59.077850 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Locations_FinalView.sql
19:55:59.079922 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCount_FinalView.sql
19:55:59.081931 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingLocations_FinalView.sql
19:55:59.083982 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplatecontents_FinalView.sql
19:55:59.085981 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingQuestions_FinalView.sql
19:55:59.088300 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListings_FinalView.sql
19:55:59.090282 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feedbacks_FinalView.sql
19:55:59.092321 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Lots_FinalView.sql
19:55:59.094318 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplates_FinalView.sql
19:55:59.096500 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Reports_FinalView.sql
19:55:59.098610 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Countries_FinalView.sql
19:55:59.101157 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Eventproperties_FinalView.sql
19:55:59.103267 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingCommentsMedias_FinalView.sql
19:55:59.105323 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_States_FinalView.sql
19:55:59.107413 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentConfigurationTable_FinalView.sql
19:55:59.109437 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SysDiagrams_FinalView.sql
19:55:59.112119 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserRoles_FinalView.sql
19:55:59.114150 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEventMedias_FinalView.sql
19:55:59.116189 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingproperties_FinalView.sql
19:55:59.118183 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserAlerts_FinalView.sql
19:55:59.120213 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeproperties_FinalView.sql
19:55:59.122236 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardsExtraInFormation_FinalView.sql
19:55:59.124558 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_NewSalestoInvoice_FinalView.sql
19:55:59.126591 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Customcurrencies_FinalView.sql
19:55:59.128601 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_DailyhuntEmailSubscribers_FinalView.sql
19:55:59.130633 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Events_FinalView.sql
19:55:59.132645 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedListingsMap_FinalView.sql
19:55:59.135002 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannedUsers_FinalView.sql
19:55:59.137007 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaMetaData_FinalView.sql
19:55:59.139039 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Notifications_FinalView.sql
19:55:59.141051 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingsReserveHistory_FinalView.sql
19:55:59.143117 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Decorations_FinalView.sql
19:55:59.145141 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Attributes_FinalView.sql
19:55:59.147652 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Tiers_FinalView.sql
19:55:59.149718 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Model_FinalView.sql
19:55:59.151835 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentprovIDErs_FinalView.sql
19:55:59.153893 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingMedias_FinalView.sql
19:55:59.155975 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedUserMap_FinalView.sql
19:55:59.158310 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingComments_FinalView.sql
19:55:59.160381 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logstats_FinalView.sql
19:55:59.162416 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UnProcessedQueueMessages_FinalView.sql
19:55:59.164458 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ThReadTracking_FinalView.sql
19:55:59.166517 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PropertybagItems_FinalView.sql
19:55:59.168601 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCards_FinalView.sql
19:55:59.171233 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Version_FinalView.sql
19:55:59.173324 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LogentriesBuffer_FinalView.sql
19:55:59.175438 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypes_FinalView.sql
19:55:59.177499 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Increments_FinalView.sql
19:55:59.179615 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Categories_FinalView.sql
19:55:59.181946 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Banners_FinalView.sql
19:55:59.184113 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Languages_FinalView.sql
19:55:59.186161 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_StripeCustomers_FinalView.sql
19:55:59.188319 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingPaymentCharge_FT.sql
19:55:59.190344 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Watches_FT.sql
19:55:59.192453 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_LineItems_FT.sql
19:55:59.194831 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Invoice_FT.sql
19:55:59.196931 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingActions_FT.sql
19:55:59.198986 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_SubmittedListingPayment_FT.sql
19:55:59.201087 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Currencies_DM.sql
19:55:59.203195 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_ShippingOptions_DM.sql
19:55:59.205680 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Buyers_DM.sql
19:55:59.207780 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Categories_DM.sql
19:55:59.209906 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Consignors_DM.sql
19:55:59.817294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcb4a4370>]}
19:55:59.959904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcbed73a0>]}
19:55:59.960570 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
19:55:59.976762 [info ] [MainThread]: 
19:55:59.978626 [debug] [MainThread]: Acquiring new synapse connection "master"
19:55:59.985569 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
19:55:59.991746 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
19:55:59.992187 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
19:55:59.992375 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:55:59.992562 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:00.511069 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:00.558980 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.57 seconds
19:56:00.561059 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
19:56:00.583451 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
19:56:00.589849 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
19:56:00.590350 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
19:56:00.592436 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
19:56:00.592596 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
19:56:00.592699 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:56:00.592808 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:00.590751 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
19:56:00.594253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:56:00.594851 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:00.710489 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:00.711575 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:00.778000 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
19:56:00.780882 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
19:56:00.854731 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
19:56:00.855219 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
19:56:00.915815 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
19:56:00.927784 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
19:56:22.181076 [debug] [MainThread]: On master: COMMIT
19:56:22.181859 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
19:56:22.183011 [info ] [MainThread]: 
19:56:22.189366 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Addresses
19:56:22.189732 [info ] [Thread-1  ]: 1 of 105 START table model dbo.AH_Addresses..................................... [RUN]
19:56:22.189964 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Attributes
19:56:22.190131 [info ] [Thread-2  ]: 2 of 105 START table model dbo.AH_Attributes.................................... [RUN]
19:56:22.190390 [debug] [Thread-3  ]: Began running node model.Shawn.AH_AuctionEventMedias
19:56:22.191140 [info ] [Thread-3  ]: 3 of 105 START table model dbo.AH_AuctionEventMedias............................ [RUN]
19:56:22.191385 [debug] [Thread-4  ]: Began running node model.Shawn.AH_AuctionEvents
19:56:22.191552 [info ] [Thread-4  ]: 4 of 105 START table model dbo.AH_AuctionEvents................................. [RUN]
19:56:22.192546 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Addresses"
19:56:22.194047 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Addresses
19:56:22.194286 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Addresses
19:56:22.193481 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEvents"
19:56:22.197590 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_AuctionEvents
19:56:22.197699 [debug] [Thread-4  ]: Compiling model.Shawn.AH_AuctionEvents
19:56:22.192983 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Attributes"
19:56:22.200587 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Attributes
19:56:22.200695 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Attributes
19:56:22.193248 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_AuctionEventMedias"
19:56:22.203262 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_AuctionEventMedias
19:56:22.203363 [debug] [Thread-3  ]: Compiling model.Shawn.AH_AuctionEventMedias
19:56:22.206024 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEventMedias"
19:56:22.206406 [debug] [Thread-3  ]: finished collecting timing info
19:56:22.203098 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Attributes"
19:56:22.207135 [debug] [Thread-2  ]: finished collecting timing info
19:56:22.207318 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Attributes
19:56:22.197418 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Addresses"
19:56:22.200412 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_AuctionEvents"
19:56:22.213465 [debug] [Thread-4  ]: finished collecting timing info
19:56:22.213701 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_AuctionEvents
19:56:22.206705 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_AuctionEventMedias
19:56:22.213079 [debug] [Thread-1  ]: finished collecting timing info
19:56:22.238734 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Addresses
19:56:22.389471 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEventMedias"
19:56:22.404983 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
19:56:22.405355 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
  
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEventMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_AuctionEventMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([EventID] as int) [EventID] 
From stg.[AH_AuctionEventMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_AuctionEventMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_AuctionEventMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEventMedias__dbt_tmp_temp_view"
    end



19:56:22.405495 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:56:22.405621 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:22.394599 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Addresses"
19:56:22.396304 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Attributes"
19:56:22.407295 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
19:56:22.406851 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
19:56:22.407642 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
  
  if object_id ('"dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Addresses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Addresses__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Addresses__dbt_tmp"
    end


   EXEC('create view dbo.AH_Addresses__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXAddresses],
	cast([DeletedOn] as datetime) [DeletedDate_RWXAddresses],
	cast([CreatedOn] as datetime) [Created_RWXAddresses],
	cast([UserID] as int) [UserID],
	cast([ID] as int) [AddressID],
	cast([CountryID] as int) [CountryID],
	cast([Street1] as varchar(128)) [Street1],
	cast([Street2] as varchar(128)) [Street2],
	cast([City] as nvarchar(100)) [City],
	cast([Stateregion] as nvarchar(50)) [State],
	cast([ZipPostal] as nvarchar(50)) [PostalCode],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXAddresses],
	cast([Description] as nvarchar(4000)) [Description],
	cast([FirstName] as nvarchar(500)) [FirstName],
	cast([LastName] as nvarchar(500)) [LastName] 
From stg.[AH_Addresses_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Addresses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Addresses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Addresses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Addresses__dbt_tmp_temp_view"
    end



19:56:22.407751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:22.407857 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:22.407421 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
  
  if object_id ('"dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Attributes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Attributes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Attributes__dbt_tmp"
    end


   EXEC('create view dbo.AH_Attributes__dbt_tmp_temp_view as
    
Select
	cast([ConText] as nvarchar(4000)) [ConText],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([EditMode] as nvarchar(4000)) [EditMode],
	cast([Type] as nvarchar(4000)) [Type],
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Attributes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Attributes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Attributes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Attributes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Attributes__dbt_tmp_temp_view"
    end



19:56:22.408985 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:22.409120 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:22.420004 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_AuctionEvents"
19:56:22.420643 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
19:56:22.420894 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
  
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEvents__dbt_tmp"
    end


   EXEC('create view dbo.AH_AuctionEvents__dbt_tmp_temp_view as
    
Select
	cast([SoftclosingGroupIncrementseconds] as int) [SoftclosingGroupIncrementseconds],
	cast([LotCount] as int) [LotCount],
	cast([CategoryID] as int) [CategoryID],
	cast([CurrencyID] as int) [CurrencyID],
	cast([ID] as int) [ID],
	cast([ClosingGroupIncrementseconds] as int) [ClosingGroupIncrementseconds],
	cast([CurrentclosingGroup] as int) [CurrentclosingGroup],
	cast([CurrentSoftclosingGroup] as int) [CurrentSoftclosingGroup],
	cast([CurrentLotOrder] as int) [CurrentLotOrder],
	cast([OwnerID] as int) [OwnerID],
	cast([ProxyBidding] as bit) [ProxyBidding],
	cast([Published] as bit) [Published],
	cast([PreviewLots] as bit) [PreviewLots],
	cast([LotsTaxable] as bit) [LotsTaxable],
	cast([FollowLiveEnabled] as bit) [FollowLiveEnabled],
	cast([BuyersPremiumPercent] as numeric(19,4)) [BuyersPremiumPercent],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Startdttm] as datetime) [Startdttm],
	cast([Enddttm] as datetime) [Enddttm],
	cast([EstimatedLastEnddttm] as datetime) [EstimatedLastEnddttm],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([Timezone] as nvarchar(4000)) [Timezone],
	cast([TermsandConditions] as nvarchar(4000)) [TermsandConditions],
	cast([PrimaryImageURI] as nvarchar(4000)) [PrimaryImageURI],
	cast([Title] as nvarchar(4000)) [Title],
	cast([SecondaryImageURI] as nvarchar(4000)) [SecondaryImageURI],
	cast([OwnerUserName] as nvarchar(4000)) [OwnerUserName],
	cast([ShippingInfo] as nvarchar(4000)) [ShippingInfo],
	cast([SubTitle] as nvarchar(4000)) [SubTitle],
	cast([ManagedByName] as nvarchar(4000)) [ManagedByName] 
From stg.[AH_AuctionEvents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_AuctionEvents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_AuctionEvents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_AuctionEvents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_AuctionEvents__dbt_tmp_temp_view"
    end



19:56:22.421061 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:56:22.421229 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:22.586870 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:22.590085 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:22.595915 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:22.596211 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:25.911507 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.51 seconds
19:56:25.993883 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.57 seconds
19:56:26.016064 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
19:56:26.016351 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: rename object "dbo"."AH_AuctionEventMedias__dbt_tmp" to AH_AuctionEventMedias
19:56:26.019602 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
19:56:26.019911 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: rename object "dbo"."AH_AuctionEvents__dbt_tmp" to AH_AuctionEvents
19:56:26.081880 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.67 seconds
19:56:26.098423 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
19:56:26.098874 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: rename object "dbo"."AH_Attributes__dbt_tmp" to AH_Attributes
19:56:26.123657 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.72 seconds
19:56:26.138599 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
19:56:26.139039 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: rename object "dbo"."AH_Addresses__dbt_tmp" to AH_Addresses
19:56:26.346664 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
19:56:26.354401 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
19:56:26.361109 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: COMMIT
19:56:26.361370 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
19:56:26.369658 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: COMMIT
19:56:26.362853 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: COMMIT
19:56:26.373718 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEvents".
19:56:26.373872 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_AuctionEvents: 
    
  if object_id ('"dbo"."AH_AuctionEvents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEvents__dbt_backup"
    end

19:56:26.361459 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
19:56:26.375470 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: COMMIT
19:56:26.377091 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Addresses".
19:56:26.377231 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Addresses: 
    
  if object_id ('"dbo"."AH_Addresses__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Addresses__dbt_backup"
    end

19:56:26.377505 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_AuctionEventMedias".
19:56:26.377681 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_AuctionEventMedias: 
    
  if object_id ('"dbo"."AH_AuctionEventMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_AuctionEventMedias__dbt_backup"
    end

19:56:26.371991 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Attributes".
19:56:26.378003 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Attributes: 
    
  if object_id ('"dbo"."AH_Attributes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Attributes__dbt_backup"
    end

19:56:26.411270 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:26.420629 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:26.427748 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:26.429667 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:26.443220 [debug] [Thread-4  ]: finished collecting timing info
19:56:26.450318 [debug] [Thread-4  ]: On model.Shawn.AH_AuctionEvents: Close
19:56:26.449928 [debug] [Thread-3  ]: finished collecting timing info
19:56:26.457345 [debug] [Thread-3  ]: On model.Shawn.AH_AuctionEventMedias: Close
19:56:26.458020 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc879efa0>]}
19:56:26.457073 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98aa970>]}
19:56:26.469414 [info ] [Thread-4  ]: 4 of 105 OK created table model dbo.AH_AuctionEvents............................ [[32mOK[0m in 4.26s]
19:56:26.458452 [info ] [Thread-3  ]: 3 of 105 OK created table model dbo.AH_AuctionEventMedias....................... [[32mOK[0m in 4.26s]
19:56:26.456402 [debug] [Thread-1  ]: finished collecting timing info
19:56:26.470130 [debug] [Thread-1  ]: On model.Shawn.AH_Addresses: Close
19:56:26.471628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8799b50>]}
19:56:26.473267 [info ] [Thread-1  ]: 1 of 105 OK created table model dbo.AH_Addresses................................ [[32mOK[0m in 4.28s]
19:56:26.472642 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_AuctionEventMedias
19:56:26.473683 [debug] [Thread-3  ]: Began running node model.Shawn.AH_BannedUsers
19:56:26.473881 [info ] [Thread-3  ]: 5 of 105 START table model dbo.AH_BannedUsers................................... [RUN]
19:56:26.472480 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_AuctionEvents
19:56:26.474731 [debug] [Thread-4  ]: Began running node model.Shawn.AH_BannerCategories
19:56:26.475126 [info ] [Thread-4  ]: 6 of 105 START table model dbo.AH_BannerCategories.............................. [RUN]
19:56:26.476024 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Addresses
19:56:26.476482 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_BannedUsers"
19:56:26.478132 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_BannedUsers
19:56:26.478253 [debug] [Thread-3  ]: Compiling model.Shawn.AH_BannedUsers
19:56:26.481067 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_BannedUsers"
19:56:26.481456 [debug] [Thread-3  ]: finished collecting timing info
19:56:26.477870 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Banners
19:56:26.482321 [info ] [Thread-1  ]: 7 of 105 START table model dbo.AH_Banners....................................... [RUN]
19:56:26.477671 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_BannerCategories"
19:56:26.483094 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_BannerCategories
19:56:26.483233 [debug] [Thread-4  ]: Compiling model.Shawn.AH_BannerCategories
19:56:26.481589 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_BannedUsers
19:56:26.487662 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Banners"
19:56:26.494726 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Banners
19:56:26.494934 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Banners
19:56:26.497856 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Banners"
19:56:26.498331 [debug] [Thread-1  ]: finished collecting timing info
19:56:26.489168 [debug] [Thread-2  ]: finished collecting timing info
19:56:26.498914 [debug] [Thread-2  ]: On model.Shawn.AH_Attributes: Close
19:56:26.499609 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8799b80>]}
19:56:26.499996 [info ] [Thread-2  ]: 2 of 105 OK created table model dbo.AH_Attributes............................... [[32mOK[0m in 4.31s]
19:56:26.487267 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_BannerCategories"
19:56:26.500525 [debug] [Thread-4  ]: finished collecting timing info
19:56:26.501255 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_BannerCategories
19:56:26.503982 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Attributes
19:56:26.504258 [debug] [Thread-2  ]: Began running node model.Shawn.AH_BiddingTransactions
19:56:26.504548 [info ] [Thread-2  ]: 8 of 105 START table model dbo.AH_BiddingTransactions........................... [RUN]
19:56:26.498698 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Banners
19:56:26.520753 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_BiddingTransactions"
19:56:26.521043 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_BiddingTransactions
19:56:26.521164 [debug] [Thread-2  ]: Compiling model.Shawn.AH_BiddingTransactions
19:56:26.525316 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_BiddingTransactions"
19:56:26.556619 [debug] [Thread-2  ]: finished collecting timing info
19:56:26.557041 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_BiddingTransactions
19:56:26.611871 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_BannedUsers"
19:56:26.618951 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_BannerCategories"
19:56:26.628809 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
19:56:26.629080 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
  
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BannerCategories__dbt_tmp"
    end


   EXEC('create view dbo.AH_BannerCategories__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([BannerID] as int) [BannerID],
	cast([CategoryID] as int) [CategoryID] 
From stg.[AH_BannerCategories_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BannerCategories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BannerCategories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BannerCategories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannerCategories__dbt_tmp_temp_view"
    end



19:56:26.629194 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:26.629317 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:26.628164 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
19:56:26.647173 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
  
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BannedUsers__dbt_tmp"
    end


   EXEC('create view dbo.AH_BannedUsers__dbt_tmp_temp_view as
    
Select
	cast([Lastip] as nvarchar(4000)) [Lastip],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([FName] as nvarchar(4000)) [FName],
	cast([LName] as nvarchar(4000)) [LName],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID] 
From stg.[AH_BannedUsers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BannedUsers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BannedUsers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BannedUsers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BannedUsers__dbt_tmp_temp_view"
    end



19:56:26.647399 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:26.647523 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:26.661053 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Banners"
19:56:26.661672 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
19:56:26.662046 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
  
  if object_id ('"dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Banners__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Banners__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Banners__dbt_tmp"
    end


   EXEC('create view dbo.AH_Banners__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([LinkURI] as nvarchar(4000)) [LinkURI],
	cast([BannerLocation] as nvarchar(4000)) [BannerLocation] 
From stg.[AH_Banners_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Banners__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Banners__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Banners__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Banners__dbt_tmp_temp_view"
    end



19:56:26.662160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:26.662280 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:26.678062 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_BiddingTransactions"
19:56:26.678958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
19:56:26.679253 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
  
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_BiddingTransactions__dbt_tmp"
    end


   EXEC('create view dbo.AH_BiddingTransactions__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionID],
	cast([Maxmindscore] as decimal(5,2)) [MaxMindScore],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ID] as int) [ID],
	cast([ListingActionID] as int) [ListingActionID],
	cast([CreditCardID] as int) [CreditCardID],
	cast([Active] as bit) [IsActive] 
From stg.[AH_BiddingTransactions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_BiddingTransactions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_BiddingTransactions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_BiddingTransactions__dbt_tmp_temp_view"
    end



19:56:26.679413 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:26.679589 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:26.752274 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:26.780154 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:26.790861 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:26.795687 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:29.533445 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.87 seconds
19:56:29.541100 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.91 seconds
19:56:29.549220 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.90 seconds
19:56:29.550314 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.87 seconds
19:56:29.559397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
19:56:29.569942 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Banners: rename object "dbo"."AH_Banners__dbt_tmp" to AH_Banners
19:56:29.577189 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
19:56:29.591842 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: rename object "dbo"."AH_BannerCategories__dbt_tmp" to AH_BannerCategories
19:56:29.584219 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
19:56:29.592343 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: rename object "dbo"."AH_BiddingTransactions__dbt_tmp" to AH_BiddingTransactions
19:56:29.591544 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
19:56:29.592689 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: rename object "dbo"."AH_BannedUsers__dbt_tmp" to AH_BannedUsers
19:56:29.609486 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:29.611287 [debug] [Thread-1  ]: On model.Shawn.AH_Banners: COMMIT
19:56:29.613442 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Banners".
19:56:29.613672 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Banners: 
    
  if object_id ('"dbo"."AH_Banners__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Banners__dbt_backup"
    end

19:56:29.624705 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:29.626429 [debug] [Thread-4  ]: On model.Shawn.AH_BannerCategories: COMMIT
19:56:29.626779 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:29.630207 [debug] [Thread-2  ]: On model.Shawn.AH_BiddingTransactions: COMMIT
19:56:29.626882 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:29.633336 [debug] [Thread-3  ]: On model.Shawn.AH_BannedUsers: COMMIT
19:56:29.628878 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannerCategories".
19:56:29.635364 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_BannerCategories: 
    
  if object_id ('"dbo"."AH_BannerCategories__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BannerCategories__dbt_backup"
    end

19:56:29.635141 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BannedUsers".
19:56:29.635721 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_BannedUsers: 
    
  if object_id ('"dbo"."AH_BannedUsers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BannedUsers__dbt_backup"
    end

19:56:29.632079 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_BiddingTransactions".
19:56:29.636040 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_BiddingTransactions: 
    
  if object_id ('"dbo"."AH_BiddingTransactions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_BiddingTransactions__dbt_backup"
    end

19:56:29.651761 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:29.745727 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
19:56:29.746984 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
19:56:29.748326 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
19:56:29.771030 [debug] [Thread-1  ]: finished collecting timing info
19:56:29.786840 [debug] [Thread-1  ]: On model.Shawn.AH_Banners: Close
19:56:29.787601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8770f40>]}
19:56:29.788029 [info ] [Thread-1  ]: 7 of 105 OK created table model dbo.AH_Banners.................................. [[32mOK[0m in 3.30s]
19:56:29.776348 [debug] [Thread-3  ]: finished collecting timing info
19:56:29.788448 [debug] [Thread-3  ]: On model.Shawn.AH_BannedUsers: Close
19:56:29.788963 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8739d60>]}
19:56:29.789291 [info ] [Thread-3  ]: 5 of 105 OK created table model dbo.AH_BannedUsers.............................. [[32mOK[0m in 3.31s]
19:56:29.781408 [debug] [Thread-2  ]: finished collecting timing info
19:56:29.790273 [debug] [Thread-2  ]: On model.Shawn.AH_BiddingTransactions: Close
19:56:29.790859 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8781820>]}
19:56:29.795592 [info ] [Thread-2  ]: 8 of 105 OK created table model dbo.AH_BiddingTransactions...................... [[32mOK[0m in 3.27s]
19:56:29.794838 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_BannedUsers
19:56:29.796141 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Categories
19:56:29.796978 [info ] [Thread-3  ]: 9 of 105 START table model dbo.AH_Categories.................................... [RUN]
19:56:29.794671 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Banners
19:56:29.797901 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CategoryCount
19:56:29.798298 [info ] [Thread-1  ]: 10 of 105 START table model dbo.AH_CategoryCount................................ [RUN]
19:56:29.799140 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_BiddingTransactions
19:56:29.799591 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Categories"
19:56:29.801899 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Categories
19:56:29.802096 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Categories
19:56:29.801566 [debug] [Thread-2  ]: Began running node model.Shawn.AH_CategoryCustomFields
19:56:29.805938 [info ] [Thread-2  ]: 11 of 105 START table model dbo.AH_CategoryCustomFields......................... [RUN]
19:56:29.801355 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCount"
19:56:29.806632 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CategoryCount
19:56:29.806784 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CategoryCount
19:56:29.786469 [debug] [Thread-4  ]: finished collecting timing info
19:56:29.810684 [debug] [Thread-4  ]: On model.Shawn.AH_BannerCategories: Close
19:56:29.811339 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98326a0>]}
19:56:29.811696 [info ] [Thread-4  ]: 6 of 105 OK created table model dbo.AH_BannerCategories......................... [[32mOK[0m in 3.33s]
19:56:29.812285 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryCustomFields"
19:56:29.812427 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_CategoryCustomFields
19:56:29.812527 [debug] [Thread-2  ]: Compiling model.Shawn.AH_CategoryCustomFields
19:56:29.815363 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCustomFields"
19:56:29.805655 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Categories"
19:56:29.816808 [debug] [Thread-3  ]: finished collecting timing info
19:56:29.816072 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_BannerCategories
19:56:29.817641 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CategoryListingTypes
19:56:29.818117 [info ] [Thread-4  ]: 12 of 105 START table model dbo.AH_CategoryListingTypes......................... [RUN]
19:56:29.819272 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListingTypes"
19:56:29.819515 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CategoryListingTypes
19:56:29.819691 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CategoryListingTypes
19:56:29.810406 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CategoryCount"
19:56:29.817358 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Categories
19:56:29.823235 [debug] [Thread-1  ]: finished collecting timing info
19:56:29.822832 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListingTypes"
19:56:29.832643 [debug] [Thread-4  ]: finished collecting timing info
19:56:29.832767 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CategoryListingTypes
19:56:29.832319 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CategoryCount
19:56:29.831932 [debug] [Thread-2  ]: finished collecting timing info
19:56:29.840105 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_CategoryCustomFields
19:56:29.939369 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Categories"
19:56:29.963448 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
19:56:29.976031 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
  
  if object_id ('"dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Categories__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Categories__dbt_tmp"
    end


   EXEC('create view dbo.AH_Categories__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [PrimaryCategoryID],
	cast([ParentCategoryID] as int) [ParentCategoryID],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Lft] as int) [lft],
	cast([Rgt] as int) [rgt],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([RolesAllowed] as nvarchar(100)) [RolesAllowed],
	cast([EnabledCustomProperty] as nvarchar(100)) [EnabledCustomProperty],
	cast([MetaKeyWords] as nvarchar(4000)) [MetaKeyWords],
	cast([MetaDescription] as nvarchar(4000)) [MetaDescription],
	cast([PageTitle] as nvarchar(4000)) [PageTitle],
	cast([Pagecontent] as nvarchar(4000)) [Pagecontent],
	cast([Name] as nvarchar(500)) [Name],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Type] as nvarchar(50)) [Type],
	cast([MvcAction] as nvarchar(100)) [MVCAction] 
From stg.[AH_Categories_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Categories__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Categories__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Categories__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories__dbt_tmp_temp_view"
    end



19:56:29.976284 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:29.976419 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:29.969213 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListingTypes"
19:56:29.985543 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
19:56:29.985927 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
  
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListingTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CategoryID] as int) [CategoryID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryListingTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListingTypes__dbt_tmp_temp_view"
    end



19:56:29.986056 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:29.986176 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:29.984597 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCustomFields"
19:56:29.988016 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
19:56:29.988270 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
  
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCustomFields__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryCustomFields__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([CategoryID] as int) [CategoryID],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_CategoryCustomFields_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryCustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryCustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCustomFields__dbt_tmp_temp_view"
    end



19:56:29.988443 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:29.988625 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:29.991516 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryCount"
19:56:29.992204 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
19:56:29.992470 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
  
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCount__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryCount__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Count] as int) [Count],
	cast([CategoryID] as int) [CategoryID] 
From stg.[AH_CategoryCount_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryCount__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryCount__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryCount__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryCount__dbt_tmp_temp_view"
    end



19:56:29.992633 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:29.992813 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:30.099756 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:30.102436 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:30.103221 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:30.117230 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:32.761455 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.77 seconds
19:56:32.777759 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
19:56:32.778208 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: rename object "dbo"."AH_CategoryCount__dbt_tmp" to AH_CategoryCount
19:56:32.808439 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:32.810822 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCount: COMMIT
19:56:32.813143 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCount".
19:56:32.813423 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryCount: 
    
  if object_id ('"dbo"."AH_CategoryCount__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCount__dbt_backup"
    end

19:56:32.850420 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.87 seconds
19:56:32.859922 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:32.867193 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
19:56:32.875898 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: rename object "dbo"."AH_Categories__dbt_tmp" to AH_Categories
19:56:32.879750 [debug] [Thread-1  ]: finished collecting timing info
19:56:32.880237 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryCount: Close
19:56:32.881099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc87828b0>]}
19:56:32.881661 [info ] [Thread-1  ]: 10 of 105 OK created table model dbo.AH_CategoryCount........................... [[32mOK[0m in 3.08s]
19:56:32.883174 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CategoryCount
19:56:32.883464 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CategoryListings
19:56:32.883963 [info ] [Thread-1  ]: 13 of 105 START table model dbo.AH_CategoryListings............................. [RUN]
19:56:32.884988 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CategoryListings"
19:56:32.885206 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CategoryListings
19:56:32.885385 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CategoryListings
19:56:32.889240 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CategoryListings"
19:56:32.889823 [debug] [Thread-1  ]: finished collecting timing info
19:56:32.890075 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CategoryListings
19:56:32.897319 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.91 seconds
19:56:32.907861 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:32.909570 [debug] [Thread-3  ]: On model.Shawn.AH_Categories: COMMIT
19:56:32.921188 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
19:56:32.931853 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: rename object "dbo"."AH_CategoryListingTypes__dbt_tmp" to AH_CategoryListingTypes
19:56:32.923033 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories".
19:56:32.932445 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Categories: 
    
  if object_id ('"dbo"."AH_Categories__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Categories__dbt_backup"
    end

19:56:32.948961 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CategoryListings"
19:56:32.949856 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
19:56:32.950159 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
  
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListings__dbt_tmp"
    end


   EXEC('create view dbo.AH_CategoryListings__dbt_tmp_temp_view as
    
Select
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([CategoryID] as int) [CategoryID] 
From stg.[AH_CategoryListings_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CategoryListings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CategoryListings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CategoryListings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CategoryListings__dbt_tmp_temp_view"
    end



19:56:32.950338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:32.950527 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:32.960628 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:32.962378 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryListingTypes: COMMIT
19:56:32.964928 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListingTypes".
19:56:32.965293 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CategoryListingTypes: 
    
  if object_id ('"dbo"."AH_CategoryListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListingTypes__dbt_backup"
    end

19:56:32.970053 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:32.987855 [debug] [Thread-3  ]: finished collecting timing info
19:56:32.988384 [debug] [Thread-3  ]: On model.Shawn.AH_Categories: Close
19:56:32.989241 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8699160>]}
19:56:32.989796 [info ] [Thread-3  ]: 9 of 105 OK created table model dbo.AH_Categories............................... [[32mOK[0m in 3.19s]
19:56:32.991429 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Categories
19:56:32.991720 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Contactus
19:56:32.992220 [info ] [Thread-3  ]: 14 of 105 START table model dbo.AH_Contactus.................................... [RUN]
19:56:32.993247 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Contactus"
19:56:32.993466 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Contactus
19:56:32.993660 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Contactus
19:56:32.998348 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Contactus"
19:56:32.999030 [debug] [Thread-3  ]: finished collecting timing info
19:56:32.999306 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Contactus
19:56:33.025646 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:56:33.043772 [debug] [Thread-4  ]: finished collecting timing info
19:56:33.055884 [debug] [Thread-4  ]: On model.Shawn.AH_CategoryListingTypes: Close
19:56:33.056790 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9832910>]}
19:56:33.057237 [info ] [Thread-4  ]: 12 of 105 OK created table model dbo.AH_CategoryListingTypes.................... [[32mOK[0m in 3.24s]
19:56:33.058396 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CategoryListingTypes
19:56:33.058729 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Contents
19:56:33.059196 [info ] [Thread-4  ]: 15 of 105 START table model dbo.AH_Contents..................................... [RUN]
19:56:33.060509 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Contents"
19:56:33.062424 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Contents
19:56:33.062649 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Contents
19:56:33.062286 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Contactus"
19:56:33.066471 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:33.067096 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
19:56:33.067548 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
  
  if object_id ('"dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contactus__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Contactus__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Contactus__dbt_tmp"
    end


   EXEC('create view dbo.AH_Contactus__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([ID] as int) [ID] 
From stg.[AH_Contactus_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Contactus__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Contactus__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Contactus__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contactus__dbt_tmp_temp_view"
    end



19:56:33.067732 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:33.067912 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:33.066282 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Contents"
19:56:33.069536 [debug] [Thread-4  ]: finished collecting timing info
19:56:33.069805 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Contents
19:56:33.112794 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Contents"
19:56:33.113672 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
19:56:33.113974 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
  
  if object_id ('"dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Contents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Contents__dbt_tmp"
    end


   EXEC('create view dbo.AH_Contents__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([Usehtmleditor] as bit) [Usehtmleditor],
	cast([Userdefined] as bit) [Userdefined],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Text] as nvarchar(4000)) [Text],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([PageTitle] as nvarchar(4000)) [PageTitle] 
From stg.[AH_Contents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Contents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Contents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Contents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Contents__dbt_tmp_temp_view"
    end



19:56:33.114142 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:33.114322 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:33.174444 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:33.212619 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:35.758407 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.69 seconds
19:56:35.767804 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.82 seconds
19:56:35.776315 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
19:56:35.787850 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contactus: rename object "dbo"."AH_Contactus__dbt_tmp" to AH_Contactus
19:56:35.790265 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
19:56:35.790665 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: rename object "dbo"."AH_CategoryListings__dbt_tmp" to AH_CategoryListings
19:56:35.820554 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:35.822973 [debug] [Thread-3  ]: On model.Shawn.AH_Contactus: COMMIT
19:56:35.825252 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contactus".
19:56:35.825562 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:35.827273 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryListings: COMMIT
19:56:35.829359 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryListings".
19:56:35.825722 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Contactus: 
    
  if object_id ('"dbo"."AH_Contactus__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Contactus__dbt_backup"
    end

19:56:35.829610 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CategoryListings: 
    
  if object_id ('"dbo"."AH_CategoryListings__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryListings__dbt_backup"
    end

19:56:35.871013 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:35.871580 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:35.974433 [debug] [Thread-3  ]: finished collecting timing info
19:56:35.983912 [debug] [Thread-3  ]: On model.Shawn.AH_Contactus: Close
19:56:35.984790 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc87671f0>]}
19:56:35.985260 [info ] [Thread-3  ]: 14 of 105 OK created table model dbo.AH_Contactus............................... [[32mOK[0m in 2.99s]
19:56:35.986470 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Contactus
19:56:35.986823 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Countries
19:56:35.987317 [info ] [Thread-3  ]: 16 of 105 START table model dbo.AH_Countries.................................... [RUN]
19:56:35.988760 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Countries"
19:56:35.991762 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Countries
19:56:35.991967 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Countries
19:56:35.995172 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Countries"
19:56:35.991413 [debug] [Thread-1  ]: finished collecting timing info
19:56:35.995572 [debug] [Thread-1  ]: On model.Shawn.AH_CategoryListings: Close
19:56:35.996307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8711e20>]}
19:56:35.996766 [info ] [Thread-1  ]: 13 of 105 OK created table model dbo.AH_CategoryListings........................ [[32mOK[0m in 3.11s]
19:56:35.998205 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CategoryListings
19:56:35.997241 [debug] [Thread-3  ]: finished collecting timing info
19:56:35.998859 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Countries
19:56:35.998462 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCardTypes
19:56:36.004889 [info ] [Thread-1  ]: 17 of 105 START table model dbo.AH_CreditCardTypes.............................. [RUN]
19:56:36.006408 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardTypes"
19:56:36.006715 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCardTypes
19:56:36.006918 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCardTypes
19:56:36.009862 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardTypes"
19:56:36.017608 [debug] [Thread-1  ]: finished collecting timing info
19:56:36.018049 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCardTypes
19:56:36.049606 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.94 seconds
19:56:36.071658 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
19:56:36.091517 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Contents: rename object "dbo"."AH_Contents__dbt_tmp" to AH_Contents
19:56:36.096037 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Countries"
19:56:36.099685 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
19:56:36.099989 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
  
  if object_id ('"dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Countries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Countries__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Countries__dbt_tmp"
    end


   EXEC('create view dbo.AH_Countries__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Country],
	cast([Code] as char(5)) [Code],
	cast([CreatedOn] as datetime) [Created_RWXCountries],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXCountries],
	cast([DeletedOn] as datetime) [DeletedDate_RWXCountries],
	cast([ID] as int) [CountryID],
	cast([Enabled] as bit) [IsEnabled],
	cast([StateRequired] as bit) [IsStateRequired] 
From stg.[AH_Countries_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Countries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Countries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Countries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Countries__dbt_tmp_temp_view"
    end



19:56:36.100158 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:36.100339 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:36.098978 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardTypes"
19:56:36.102054 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
19:56:36.102319 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
  
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCardTypes__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_CreditCardTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCardTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCardTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardTypes__dbt_tmp_temp_view"
    end



19:56:36.102481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:36.102695 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:36.123112 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:36.124906 [debug] [Thread-4  ]: On model.Shawn.AH_Contents: COMMIT
19:56:36.131486 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Contents".
19:56:36.132757 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Contents: 
    
  if object_id ('"dbo"."AH_Contents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Contents__dbt_backup"
    end

19:56:36.170359 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:36.184969 [debug] [Thread-4  ]: finished collecting timing info
19:56:36.185490 [debug] [Thread-4  ]: On model.Shawn.AH_Contents: Close
19:56:36.186315 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983e130>]}
19:56:36.186916 [info ] [Thread-4  ]: 15 of 105 OK created table model dbo.AH_Contents................................ [[32mOK[0m in 3.13s]
19:56:36.188300 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Contents
19:56:36.188594 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CreditCards
19:56:36.189067 [info ] [Thread-4  ]: 18 of 105 START table model dbo.AH_CreditCards.................................. [RUN]
19:56:36.190307 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards"
19:56:36.190574 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CreditCards
19:56:36.190773 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CreditCards
19:56:36.194128 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards"
19:56:36.194760 [debug] [Thread-4  ]: finished collecting timing info
19:56:36.195008 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CreditCards
19:56:36.208208 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:36.208853 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:36.234978 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards"
19:56:36.235857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
19:56:36.236166 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCards__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([ExpirationMonth] as int) [ExpirationMonth],
	cast([ExpirationYear] as int) [ExpirationYear],
	cast([CreditCardTypeID] as int) [CreditCardTypeID],
	cast([UserID] as int) [UserID],
	cast([AddressID] as int) [AddressID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CardNumber] as nvarchar(4000)) [CardNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([LastFourdigits] as nvarchar(4000)) [LastFourdigits],
	cast([Description] as nvarchar(4000)) [Description] 
From stg.[AH_CreditCards_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCards__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCards__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end



19:56:36.236331 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:36.236513 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:36.335102 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:38.611662 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.51 seconds
19:56:38.628086 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
19:56:38.628533 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Countries: rename object "dbo"."AH_Countries__dbt_tmp" to AH_Countries
19:56:38.663980 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:38.666116 [debug] [Thread-3  ]: On model.Shawn.AH_Countries: COMMIT
19:56:38.668594 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Countries".
19:56:38.668927 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Countries: 
    
  if object_id ('"dbo"."AH_Countries__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Countries__dbt_backup"
    end

19:56:38.703880 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:38.718058 [debug] [Thread-3  ]: finished collecting timing info
19:56:38.718619 [debug] [Thread-3  ]: On model.Shawn.AH_Countries: Close
19:56:38.719505 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983e3d0>]}
19:56:38.720059 [info ] [Thread-3  ]: 16 of 105 OK created table model dbo.AH_Countries............................... [[32mOK[0m in 2.73s]
19:56:38.721302 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Countries
19:56:38.721583 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CreditCardsExtraInFormation
19:56:38.722075 [info ] [Thread-3  ]: 19 of 105 START table model dbo.AH_CreditCardsExtraInFormation.................. [RUN]
19:56:38.723582 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCardsExtraInFormation"
19:56:38.723805 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CreditCardsExtraInFormation
19:56:38.723985 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CreditCardsExtraInFormation
19:56:38.727790 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
19:56:38.728371 [debug] [Thread-3  ]: finished collecting timing info
19:56:38.728584 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CreditCardsExtraInFormation
19:56:38.765963 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCardsExtraInFormation"
19:56:38.766930 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
19:56:38.767354 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
  
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view as
    
Select
	cast([Cvv] as nvarchar(4000)) [Cvv],
	cast([ID] as int) [ID],
	cast([CreditCardID] as int) [CreditCardID] 
From stg.[AH_CreditCardsExtraInFormation_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCardsExtraInFormation__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp_temp_view"
    end



19:56:38.767526 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:38.767716 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:38.814709 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.71 seconds
19:56:38.832314 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
19:56:38.832762 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: rename object "dbo"."AH_CreditCardTypes__dbt_tmp" to AH_CreditCardTypes
19:56:38.863872 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:38.865861 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCardTypes: COMMIT
19:56:38.868210 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardTypes".
19:56:38.868509 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCardTypes: 
    
  if object_id ('"dbo"."AH_CreditCardTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardTypes__dbt_backup"
    end

19:56:38.886049 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:38.906287 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:38.920303 [debug] [Thread-1  ]: finished collecting timing info
19:56:38.920835 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCardTypes: Close
19:56:38.921739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc97d9a90>]}
19:56:38.922292 [info ] [Thread-1  ]: 17 of 105 OK created table model dbo.AH_CreditCardTypes......................... [[32mOK[0m in 2.92s]
19:56:38.923430 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCardTypes
19:56:38.923706 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Currencies
19:56:38.924169 [info ] [Thread-1  ]: 20 of 105 START table model dbo.AH_Currencies................................... [RUN]
19:56:38.925574 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies"
19:56:38.925792 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Currencies
19:56:38.925972 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Currencies
19:56:38.929639 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Currencies"
19:56:38.930211 [debug] [Thread-1  ]: finished collecting timing info
19:56:38.930422 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Currencies
19:56:38.968252 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies"
19:56:38.969078 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
19:56:38.969367 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
  
  if object_id ('"dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Currencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Currencies__dbt_tmp"
    end


   EXEC('create view dbo.AH_Currencies__dbt_tmp_temp_view as
    
Select
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([ConVersiontousd] as numeric(19,4)) [ConVersiontousd] 
From stg.[AH_Currencies_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Currencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Currencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Currencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies__dbt_tmp_temp_view"
    end



19:56:38.969556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:38.969741 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:39.070359 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:40.129087 [debug] [Thread-4  ]: SQLServer adapter: Database error: ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conversion failed when converting the nvarchar value '9f076b7eb7fdc0311cd3208cdbbebbf8014dd3a05e35191c96947b358a362b40' to data type int.  (245) (SQLExecDirectW)")
19:56:40.129511 [debug] [Thread-4  ]: On model.Shawn.AH_CreditCards: ROLLBACK
19:56:40.129687 [debug] [Thread-4  ]: On model.Shawn.AH_CreditCards: Close
19:56:40.130158 [debug] [Thread-4  ]: finished collecting timing info
19:56:40.131143 [debug] [Thread-4  ]: Database Error in model AH_CreditCards (models/step4_dboSingle/AH_CreditCards.sql)
  ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conversion failed when converting the nvarchar value '9f076b7eb7fdc0311cd3208cdbbebbf8014dd3a05e35191c96947b358a362b40' to data type int.  (245) (SQLExecDirectW)")
  compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_CreditCards.sql
19:56:40.131614 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85f6790>]}
19:56:40.132112 [error] [Thread-4  ]: 18 of 105 ERROR creating table model dbo.AH_CreditCards......................... [[31mERROR[0m in 3.94s]
19:56:40.133284 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CreditCards
19:56:40.133571 [debug] [Thread-4  ]: Began running node model.Shawn.AH_CustomFieldenums
19:56:40.134118 [info ] [Thread-4  ]: 21 of 105 START table model dbo.AH_CustomFieldenums............................. [RUN]
19:56:40.135746 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFieldenums"
19:56:40.135966 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_CustomFieldenums
19:56:40.136141 [debug] [Thread-4  ]: Compiling model.Shawn.AH_CustomFieldenums
19:56:40.139837 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_CustomFieldenums"
19:56:40.140426 [debug] [Thread-4  ]: finished collecting timing info
19:56:40.140677 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_CustomFieldenums
19:56:40.178502 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFieldenums"
19:56:40.179428 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
19:56:40.179684 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
  
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CustomFieldenums__dbt_tmp"
    end


   EXEC('create view dbo.AH_CustomFieldenums__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_CustomFieldenums_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CustomFieldenums__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CustomFieldenums__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFieldenums__dbt_tmp_temp_view"
    end



19:56:40.179853 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:40.180095 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:40.279874 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:41.018213 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.25 seconds
19:56:41.033757 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
19:56:41.034205 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: rename object "dbo"."AH_CreditCardsExtraInFormation__dbt_tmp" to AH_CreditCardsExtraInFormation
19:56:41.083884 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:41.086968 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCardsExtraInFormation: COMMIT
19:56:41.089285 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCardsExtraInFormation".
19:56:41.089523 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CreditCardsExtraInFormation: 
    
  if object_id ('"dbo"."AH_CreditCardsExtraInFormation__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCardsExtraInFormation__dbt_backup"
    end

19:56:41.127008 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:41.139918 [debug] [Thread-3  ]: finished collecting timing info
19:56:41.140448 [debug] [Thread-3  ]: On model.Shawn.AH_CreditCardsExtraInFormation: Close
19:56:41.141300 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983e670>]}
19:56:41.141826 [info ] [Thread-3  ]: 19 of 105 OK created table model dbo.AH_CreditCardsExtraInFormation............. [[32mOK[0m in 2.42s]
19:56:41.143254 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CreditCardsExtraInFormation
19:56:41.143527 [debug] [Thread-3  ]: Began running node model.Shawn.AH_CustomFields
19:56:41.143974 [info ] [Thread-3  ]: 22 of 105 START table model dbo.AH_CustomFields................................. [RUN]
19:56:41.144940 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_CustomFields"
19:56:41.145153 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_CustomFields
19:56:41.145328 [debug] [Thread-3  ]: Compiling model.Shawn.AH_CustomFields
19:56:41.148764 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_CustomFields"
19:56:41.149488 [debug] [Thread-3  ]: finished collecting timing info
19:56:41.149727 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_CustomFields
19:56:41.183607 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
19:56:41.195219 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_CustomFields"
19:56:41.202788 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
19:56:41.203055 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
  
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CustomFields__dbt_tmp"
    end


   EXEC('create view dbo.AH_CustomFields__dbt_tmp_temp_view as
    
Select
	cast([Required] as bit) [IsRequired],
	cast([Deferred] as bit) [IsDeferred],
	cast([Encrypted] as bit) [IsEncrypted],
	cast([IncludeonInvoice] as bit) [IsIncludeOnInvoice],
	cast([IncludeinSalesReport] as bit) [IsIncludeInSalesReport],
	cast([IncludeonInvoiceasSeller] as bit) [IsIncludeOnInvoiceAsSeller],
	cast([IncludeonInvoiceasBuyer] as bit) [IsIncludeOnInvoiceAsBuyer],
	cast([IncludeinSalesReportasSeller] as bit) [IsIncludeInSalesReportAsSeller],
	cast([IncludeinSalesReportasBuyer] as bit) [IsIncludeInSalesReportAsBuyer],
	cast([ID] as int) [CustomFieldID],
	cast([Type] as int) [Type],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([VisiBIlity] as int) [Visibility],
	cast([MutaBIlity] as int) [Mutability],
	cast([CreatedOn] as datetime) [Created_RWXCustomFields],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXCustomFields],
	cast([DeletedOn] as datetime) [DeletedDate_RWXCustomFields],
	cast([Name] as nvarchar(500)) [Name],
	cast([DefaultValue] as nvarchar(300)) [DefaultValue],
	cast([GroupName] as nvarchar(500)) [GroupName],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXCustomFields] 
From stg.[AH_CustomFields_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CustomFields__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CustomFields__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CustomFields__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CustomFields__dbt_tmp_temp_view"
    end



19:56:41.203229 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:41.203410 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:41.201972 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
19:56:41.204763 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Currencies: rename object "dbo"."AH_Currencies__dbt_tmp" to AH_Currencies
19:56:41.275087 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:56:41.277097 [debug] [Thread-1  ]: On model.Shawn.AH_Currencies: COMMIT
19:56:41.279802 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies".
19:56:41.280176 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Currencies: 
    
  if object_id ('"dbo"."AH_Currencies__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Currencies__dbt_backup"
    end

19:56:41.297605 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:41.318988 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:41.332241 [debug] [Thread-1  ]: finished collecting timing info
19:56:41.332754 [debug] [Thread-1  ]: On model.Shawn.AH_Currencies: Close
19:56:41.333587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85e53a0>]}
19:56:41.334133 [info ] [Thread-1  ]: 20 of 105 OK created table model dbo.AH_Currencies.............................. [[32mOK[0m in 2.41s]
19:56:41.335245 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Currencies
19:56:41.335528 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Customcurrencies
19:56:41.335978 [info ] [Thread-1  ]: 23 of 105 START table model dbo.AH_Customcurrencies............................. [RUN]
19:56:41.337957 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Customcurrencies"
19:56:41.338174 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Customcurrencies
19:56:41.338351 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Customcurrencies
19:56:41.341836 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Customcurrencies"
19:56:41.342380 [debug] [Thread-1  ]: finished collecting timing info
19:56:41.342649 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Customcurrencies
19:56:41.379402 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Customcurrencies"
19:56:41.380242 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
19:56:41.380542 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
  
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Customcurrencies__dbt_tmp"
    end


   EXEC('create view dbo.AH_Customcurrencies__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Isocurrencysymbol] as nvarchar(4000)) [Isocurrencysymbol],
	cast([Currencysymbol] as nvarchar(4000)) [Currencysymbol],
	cast([CurrencyenglishName] as nvarchar(4000)) [CurrencyenglishName],
	cast([CurrencynativeName] as nvarchar(4000)) [CurrencynativeName] 
From stg.[AH_Customcurrencies_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Customcurrencies__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Customcurrencies__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Customcurrencies__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Customcurrencies__dbt_tmp_temp_view"
    end



19:56:41.380723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:41.380900 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:41.477296 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:42.775912 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.60 seconds
19:56:42.878202 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
19:56:42.878726 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: rename object "dbo"."AH_CustomFieldenums__dbt_tmp" to AH_CustomFieldenums
19:56:42.910669 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:42.912621 [debug] [Thread-4  ]: On model.Shawn.AH_CustomFieldenums: COMMIT
19:56:42.915022 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFieldenums".
19:56:42.915350 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_CustomFieldenums: 
    
  if object_id ('"dbo"."AH_CustomFieldenums__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CustomFieldenums__dbt_backup"
    end

19:56:42.961168 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:42.975781 [debug] [Thread-4  ]: finished collecting timing info
19:56:42.976305 [debug] [Thread-4  ]: On model.Shawn.AH_CustomFieldenums: Close
19:56:42.977187 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc86063a0>]}
19:56:42.977740 [info ] [Thread-4  ]: 21 of 105 OK created table model dbo.AH_CustomFieldenums........................ [[32mOK[0m in 2.84s]
19:56:42.979282 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_CustomFieldenums
19:56:42.979578 [debug] [Thread-4  ]: Began running node model.Shawn.AH_DailyhuntEmailSubscribers
19:56:42.980086 [info ] [Thread-4  ]: 24 of 105 START table model dbo.AH_DailyhuntEmailSubscribers.................... [RUN]
19:56:42.981421 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers"
19:56:42.981643 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_DailyhuntEmailSubscribers
19:56:42.981840 [debug] [Thread-4  ]: Compiling model.Shawn.AH_DailyhuntEmailSubscribers
19:56:42.985306 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
19:56:42.985925 [debug] [Thread-4  ]: finished collecting timing info
19:56:42.986141 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_DailyhuntEmailSubscribers
19:56:43.024057 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_DailyhuntEmailSubscribers"
19:56:43.025022 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
19:56:43.025309 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
  
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    end


   EXEC('create view dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view as
    
Select
	cast([Email] as nvarchar(4000)) [Email],
	cast([FirstName] as nvarchar(4000)) [FirstName],
	cast([LastName] as nvarchar(4000)) [LastName],
	cast([ID] as int) [ID],
	cast([ZipCode] as int) [ZipCode],
	cast([ASenthusiast] as bit) [ASenthusiast],
	cast([AsBidder] as bit) [AsBidder],
	cast([AsConsignor] as bit) [AsConsignor] 
From stg.[AH_DailyhuntEmailSubscribers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp_temp_view"
    end



19:56:43.025490 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:43.025685 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:43.148935 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:43.446846 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.24 seconds
19:56:43.462096 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
19:56:43.462514 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: rename object "dbo"."AH_CustomFields__dbt_tmp" to AH_CustomFields
19:56:43.502599 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:43.505487 [debug] [Thread-3  ]: On model.Shawn.AH_CustomFields: COMMIT
19:56:43.508367 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CustomFields".
19:56:43.508645 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_CustomFields: 
    
  if object_id ('"dbo"."AH_CustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CustomFields__dbt_backup"
    end

19:56:43.545446 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:43.558714 [debug] [Thread-3  ]: finished collecting timing info
19:56:43.559814 [debug] [Thread-3  ]: On model.Shawn.AH_CustomFields: Close
19:56:43.560702 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983ea60>]}
19:56:43.561226 [info ] [Thread-3  ]: 22 of 105 OK created table model dbo.AH_CustomFields............................ [[32mOK[0m in 2.42s]
19:56:43.562410 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_CustomFields
19:56:43.562768 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Decorations
19:56:43.563230 [info ] [Thread-3  ]: 25 of 105 START table model dbo.AH_Decorations.................................. [RUN]
19:56:43.564564 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Decorations"
19:56:43.564778 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Decorations
19:56:43.564955 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Decorations
19:56:43.568652 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Decorations"
19:56:43.569222 [debug] [Thread-3  ]: finished collecting timing info
19:56:43.569456 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Decorations
19:56:43.606784 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Decorations"
19:56:43.607633 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
19:56:43.607929 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
  
  if object_id ('"dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Decorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Decorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Decorations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Decorations__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToproceed],
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ValIDFields] as nvarchar(4000)) [ValIDFields],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name],
	cast([FormatString] as nvarchar(4000)) [FormatString],
	cast([Amount] as numeric(19,4)) [Amount] 
From stg.[AH_Decorations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Decorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Decorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Decorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Decorations__dbt_tmp_temp_view"
    end



19:56:43.608106 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:43.608291 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:43.682578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.30 seconds
19:56:43.698430 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
19:56:43.698903 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: rename object "dbo"."AH_Customcurrencies__dbt_tmp" to AH_Customcurrencies
19:56:43.721095 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:43.731309 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:43.733258 [debug] [Thread-1  ]: On model.Shawn.AH_Customcurrencies: COMMIT
19:56:43.735420 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Customcurrencies".
19:56:43.735656 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Customcurrencies: 
    
  if object_id ('"dbo"."AH_Customcurrencies__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Customcurrencies__dbt_backup"
    end

19:56:43.777511 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:43.791201 [debug] [Thread-1  ]: finished collecting timing info
19:56:43.791737 [debug] [Thread-1  ]: On model.Shawn.AH_Customcurrencies: Close
19:56:43.792588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983ebb0>]}
19:56:43.793110 [info ] [Thread-1  ]: 23 of 105 OK created table model dbo.AH_Customcurrencies........................ [[32mOK[0m in 2.45s]
19:56:43.795343 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Customcurrencies
19:56:43.795645 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Emailtemplatecontents
19:56:43.796125 [info ] [Thread-1  ]: 26 of 105 START table model dbo.AH_Emailtemplatecontents........................ [RUN]
19:56:43.797367 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplatecontents"
19:56:43.797584 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Emailtemplatecontents
19:56:43.797824 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Emailtemplatecontents
19:56:43.803273 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplatecontents"
19:56:43.803865 [debug] [Thread-1  ]: finished collecting timing info
19:56:43.804114 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Emailtemplatecontents
19:56:43.841229 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplatecontents"
19:56:43.842081 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
19:56:43.842328 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
  
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Culture] as nvarchar(4000)) [Culture],
	cast([SuBJect] as nvarchar(4000)) [SuBJect],
	cast([Body] as nvarchar(4000)) [Body],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID] 
From stg.[AH_Emailtemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Emailtemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Emailtemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplatecontents__dbt_tmp_temp_view"
    end



19:56:43.842574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:43.842772 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:43.939131 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:45.392093 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.37 seconds
19:56:45.407466 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
19:56:45.407919 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: rename object "dbo"."AH_DailyhuntEmailSubscribers__dbt_tmp" to AH_DailyhuntEmailSubscribers
19:56:45.452439 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:45.454462 [debug] [Thread-4  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: COMMIT
19:56:45.456712 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_DailyhuntEmailSubscribers".
19:56:45.456971 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_DailyhuntEmailSubscribers: 
    
  if object_id ('"dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_DailyhuntEmailSubscribers__dbt_backup"
    end

19:56:45.514216 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:56:45.527531 [debug] [Thread-4  ]: finished collecting timing info
19:56:45.528035 [debug] [Thread-4  ]: On model.Shawn.AH_DailyhuntEmailSubscribers: Close
19:56:45.528894 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b1be0>]}
19:56:45.529423 [info ] [Thread-4  ]: 24 of 105 OK created table model dbo.AH_DailyhuntEmailSubscribers............... [[32mOK[0m in 2.55s]
19:56:45.530504 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_DailyhuntEmailSubscribers
19:56:45.530815 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Emailtemplates
19:56:45.531284 [info ] [Thread-4  ]: 27 of 105 START table model dbo.AH_Emailtemplates............................... [RUN]
19:56:45.533406 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Emailtemplates"
19:56:45.533963 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Emailtemplates
19:56:45.534482 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Emailtemplates
19:56:45.538585 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Emailtemplates"
19:56:45.539498 [debug] [Thread-4  ]: finished collecting timing info
19:56:45.539744 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Emailtemplates
19:56:45.577690 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Emailtemplates"
19:56:45.578735 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
19:56:45.579030 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
  
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplates__dbt_tmp"
    end


   EXEC('create view dbo.AH_Emailtemplates__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Emailtemplates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Emailtemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Emailtemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Emailtemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Emailtemplates__dbt_tmp_temp_view"
    end



19:56:45.579200 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:45.579380 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:45.601046 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 15.61 seconds
19:56:45.612110 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.00 seconds
19:56:45.619177 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
19:56:45.631928 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: rename object "dbo"."AH_CategoryCustomFields__dbt_tmp" to AH_CategoryCustomFields
19:56:45.634037 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
19:56:45.634381 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: rename object "dbo"."AH_Decorations__dbt_tmp" to AH_Decorations
19:56:45.664633 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:45.666868 [debug] [Thread-3  ]: On model.Shawn.AH_Decorations: COMMIT
19:56:45.669153 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Decorations".
19:56:45.669437 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Decorations: 
    
  if object_id ('"dbo"."AH_Decorations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Decorations__dbt_backup"
    end

19:56:45.686367 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:45.688112 [debug] [Thread-2  ]: On model.Shawn.AH_CategoryCustomFields: COMMIT
19:56:45.690096 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CategoryCustomFields".
19:56:45.690257 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_CategoryCustomFields: 
    
  if object_id ('"dbo"."AH_CategoryCustomFields__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CategoryCustomFields__dbt_backup"
    end

19:56:45.699778 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:45.707422 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:45.720624 [debug] [Thread-3  ]: finished collecting timing info
19:56:45.721148 [debug] [Thread-3  ]: On model.Shawn.AH_Decorations: Close
19:56:45.721984 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983ee50>]}
19:56:45.722496 [info ] [Thread-3  ]: 25 of 105 OK created table model dbo.AH_Decorations............................. [[32mOK[0m in 2.16s]
19:56:45.723642 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Decorations
19:56:45.723912 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Eventproperties
19:56:45.724360 [info ] [Thread-3  ]: 28 of 105 START table model dbo.AH_Eventproperties.............................. [RUN]
19:56:45.725660 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Eventproperties"
19:56:45.725875 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Eventproperties
19:56:45.726051 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Eventproperties
19:56:45.729488 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Eventproperties"
19:56:45.729809 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:45.740080 [debug] [Thread-3  ]: finished collecting timing info
19:56:45.740371 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Eventproperties
19:56:45.745311 [debug] [Thread-2  ]: finished collecting timing info
19:56:45.755901 [debug] [Thread-2  ]: On model.Shawn.AH_CategoryCustomFields: Close
19:56:45.756816 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc86a21c0>]}
19:56:45.757257 [info ] [Thread-2  ]: 11 of 105 OK created table model dbo.AH_CategoryCustomFields.................... [[32mOK[0m in 15.94s]
19:56:45.758365 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_CategoryCustomFields
19:56:45.758703 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Events
19:56:45.759163 [info ] [Thread-2  ]: 29 of 105 START table model dbo.AH_Events....................................... [RUN]
19:56:45.760526 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Events"
19:56:45.766734 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Events
19:56:45.766978 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Events
19:56:45.769981 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Events"
19:56:45.770423 [debug] [Thread-2  ]: finished collecting timing info
19:56:45.779808 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Events
19:56:45.803579 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Eventproperties"
19:56:45.814253 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
19:56:45.814521 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
  
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Eventproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Eventproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([CustomFieldID] as int) [CustomFieldID] 
From stg.[AH_Eventproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Eventproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Eventproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Eventproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Eventproperties__dbt_tmp_temp_view"
    end



19:56:45.814755 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:45.814886 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:45.832825 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Events"
19:56:45.833662 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
19:56:45.833944 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: 
  
  if object_id ('"dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Events__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Events__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Events__dbt_tmp"
    end


   EXEC('create view dbo.AH_Events__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Events_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Events__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Events__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Events__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Events__dbt_tmp_temp_view"
    end



19:56:45.834116 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:45.834293 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:45.914415 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:45.930285 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:46.641810 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
19:56:46.656875 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
19:56:46.657300 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: rename object "dbo"."AH_Emailtemplatecontents__dbt_tmp" to AH_Emailtemplatecontents
19:56:46.720776 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:56:46.722778 [debug] [Thread-1  ]: On model.Shawn.AH_Emailtemplatecontents: COMMIT
19:56:46.724895 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplatecontents".
19:56:46.725132 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplatecontents: 
    
  if object_id ('"dbo"."AH_Emailtemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplatecontents__dbt_backup"
    end

19:56:47.006819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
19:56:47.020070 [debug] [Thread-1  ]: finished collecting timing info
19:56:47.020588 [debug] [Thread-1  ]: On model.Shawn.AH_Emailtemplatecontents: Close
19:56:47.021452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98bc0d0>]}
19:56:47.021977 [info ] [Thread-1  ]: 26 of 105 OK created table model dbo.AH_Emailtemplatecontents................... [[32mOK[0m in 3.22s]
19:56:47.023094 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Emailtemplatecontents
19:56:47.023373 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ExternalUserIDs
19:56:47.023829 [info ] [Thread-1  ]: 30 of 105 START table model dbo.AH_ExternalUserIDs.............................. [RUN]
19:56:47.025221 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ExternalUserIDs"
19:56:47.025442 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ExternalUserIDs
19:56:47.025635 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ExternalUserIDs
19:56:47.029239 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ExternalUserIDs"
19:56:47.029811 [debug] [Thread-1  ]: finished collecting timing info
19:56:47.030021 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ExternalUserIDs
19:56:47.067867 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ExternalUserIDs"
19:56:47.068802 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
19:56:47.069072 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
  
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ExternalUserIDs__dbt_tmp"
    end


   EXEC('create view dbo.AH_ExternalUserIDs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProvIDErName],
	cast([ProvIDErUserID] as nvarchar(4000)) [ProvIDErUserID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([LocalUserID] as int) [LocalUserID] 
From stg.[AH_ExternalUserIDs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ExternalUserIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ExternalUserIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ExternalUserIDs__dbt_tmp_temp_view"
    end



19:56:47.069237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:47.069421 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:47.168432 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:48.062658 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.48 seconds
19:56:48.166125 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
19:56:48.166610 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: rename object "dbo"."AH_Emailtemplates__dbt_tmp" to AH_Emailtemplates
19:56:48.202934 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:48.204654 [debug] [Thread-4  ]: On model.Shawn.AH_Emailtemplates: COMMIT
19:56:48.207256 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Emailtemplates".
19:56:48.207532 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Emailtemplates: 
    
  if object_id ('"dbo"."AH_Emailtemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Emailtemplates__dbt_backup"
    end

19:56:48.246054 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:48.260172 [debug] [Thread-4  ]: finished collecting timing info
19:56:48.260709 [debug] [Thread-4  ]: On model.Shawn.AH_Emailtemplates: Close
19:56:48.261582 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98bc130>]}
19:56:48.335101 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.52 seconds
19:56:48.354581 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
19:56:48.355031 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: rename object "dbo"."AH_Eventproperties__dbt_tmp" to AH_Eventproperties
19:56:48.403100 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:48.405310 [debug] [Thread-3  ]: On model.Shawn.AH_Eventproperties: COMMIT
19:56:48.409284 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Eventproperties".
19:56:48.406693 [info ] [Thread-4  ]: 27 of 105 OK created table model dbo.AH_Emailtemplates.......................... [[32mOK[0m in 2.73s]
19:56:48.411184 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Emailtemplates
19:56:48.411562 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Feedbacks
19:56:48.411856 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.58 seconds
19:56:48.412191 [info ] [Thread-4  ]: 31 of 105 START table model dbo.AH_Feedbacks.................................... [RUN]
19:56:48.409580 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Eventproperties: 
    
  if object_id ('"dbo"."AH_Eventproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Eventproperties__dbt_backup"
    end

19:56:48.419766 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Feedbacks"
19:56:48.419948 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Feedbacks
19:56:48.420066 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Feedbacks
19:56:48.423556 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Feedbacks"
19:56:48.434019 [debug] [Thread-4  ]: finished collecting timing info
19:56:48.434442 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Feedbacks
19:56:48.433402 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
19:56:48.443856 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: rename object "dbo"."AH_Events__dbt_tmp" to AH_Events
19:56:48.463223 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:48.483502 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Feedbacks"
19:56:48.483798 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:48.490791 [debug] [Thread-2  ]: On model.Shawn.AH_Events: COMMIT
19:56:48.492884 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Events".
19:56:48.493427 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
19:56:48.493797 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
  
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feedbacks__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feedbacks__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([SEndingUserID] as int) [SEndingUserID],
	cast([ReceivINgUserID] as int) [ReceivINgUserID],
	cast([Rating] as int) [Rating],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([ListingOwnerUserName] as nvarchar(4000)) [ListingOwnerUserName] 
From stg.[AH_Feedbacks_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feedbacks__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feedbacks__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feedbacks__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feedbacks__dbt_tmp_temp_view"
    end



19:56:48.493958 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:48.494131 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:48.493575 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Events: 
    
  if object_id ('"dbo"."AH_Events__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Events__dbt_backup"
    end

19:56:48.488736 [debug] [Thread-3  ]: finished collecting timing info
19:56:48.495748 [debug] [Thread-3  ]: On model.Shawn.AH_Eventproperties: Close
19:56:48.496474 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98bc280>]}
19:56:48.496965 [info ] [Thread-3  ]: 28 of 105 OK created table model dbo.AH_Eventproperties......................... [[32mOK[0m in 2.77s]
19:56:48.498065 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Eventproperties
19:56:48.498639 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Feeproperties
19:56:48.499517 [info ] [Thread-3  ]: 32 of 105 START table model dbo.AH_Feeproperties................................ [RUN]
19:56:48.500548 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Feeproperties"
19:56:48.500759 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Feeproperties
19:56:48.500936 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Feeproperties
19:56:48.504695 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Feeproperties"
19:56:48.505240 [debug] [Thread-3  ]: finished collecting timing info
19:56:48.505447 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Feeproperties
19:56:48.549524 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Feeproperties"
19:56:48.549823 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:56:48.565339 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
19:56:48.565775 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
  
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feeproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feeproperties__dbt_tmp_temp_view as
    
Select
	cast([Processor] as nvarchar(4000)) [Processor],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([EventID] as int) [EventID] 
From stg.[AH_Feeproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeproperties__dbt_tmp_temp_view"
    end



19:56:48.565888 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:48.566014 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:48.570750 [debug] [Thread-2  ]: finished collecting timing info
19:56:48.571164 [debug] [Thread-2  ]: On model.Shawn.AH_Events: Close
19:56:48.571962 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983e0d0>]}
19:56:48.572483 [info ] [Thread-2  ]: 29 of 105 OK created table model dbo.AH_Events.................................. [[32mOK[0m in 2.81s]
19:56:48.573597 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Events
19:56:48.573868 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Feeschedules
19:56:48.574346 [info ] [Thread-2  ]: 33 of 105 START table model dbo.AH_Feeschedules................................. [RUN]
19:56:48.575941 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Feeschedules"
19:56:48.576158 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Feeschedules
19:56:48.576336 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Feeschedules
19:56:48.580081 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Feeschedules"
19:56:48.580632 [debug] [Thread-2  ]: finished collecting timing info
19:56:48.580839 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Feeschedules
19:56:48.604877 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:48.626117 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Feeschedules"
19:56:48.630059 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
19:56:48.630408 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
  
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Feeschedules__dbt_tmp"
    end


   EXEC('create view dbo.AH_Feeschedules__dbt_tmp_temp_view as
    
Select
	cast([PayToproceed] as bit) [PayToproceed],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([EventID] as int) [EventID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_Feeschedules_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Feeschedules__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Feeschedules__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Feeschedules__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Feeschedules__dbt_tmp_temp_view"
    end



19:56:48.630615 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:48.630821 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:48.664390 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:48.735011 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:48.993332 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
19:56:49.008605 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
19:56:49.009039 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: rename object "dbo"."AH_ExternalUserIDs__dbt_tmp" to AH_ExternalUserIDs
19:56:49.057013 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:49.059194 [debug] [Thread-1  ]: On model.Shawn.AH_ExternalUserIDs: COMMIT
19:56:49.061592 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ExternalUserIDs".
19:56:49.061860 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ExternalUserIDs: 
    
  if object_id ('"dbo"."AH_ExternalUserIDs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ExternalUserIDs__dbt_backup"
    end

19:56:49.106963 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:49.120945 [debug] [Thread-1  ]: finished collecting timing info
19:56:49.121417 [debug] [Thread-1  ]: On model.Shawn.AH_ExternalUserIDs: Close
19:56:49.122280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98bc3d0>]}
19:56:49.122836 [info ] [Thread-1  ]: 30 of 105 OK created table model dbo.AH_ExternalUserIDs......................... [[32mOK[0m in 2.10s]
19:56:49.124229 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ExternalUserIDs
19:56:49.124512 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ImportedCategoryMap
19:56:49.124972 [info ] [Thread-1  ]: 34 of 105 START table model dbo.AH_ImportedCategoryMap.......................... [RUN]
19:56:49.125928 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedCategoryMap"
19:56:49.126138 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ImportedCategoryMap
19:56:49.126313 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ImportedCategoryMap
19:56:49.129598 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ImportedCategoryMap"
19:56:49.130286 [debug] [Thread-1  ]: finished collecting timing info
19:56:49.130484 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ImportedCategoryMap
19:56:49.167223 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedCategoryMap"
19:56:49.168112 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
19:56:49.168363 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
  
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedCategoryMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view as
    
Select
	cast([LocalCategoryID] as int) [LocalCategoryID],
	cast([ForeignCategoryID] as int) [ForeignCategoryID] 
From stg.[AH_ImportedCategoryMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedCategoryMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedCategoryMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedCategoryMap__dbt_tmp_temp_view"
    end



19:56:49.168530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:49.168715 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:49.269697 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:51.439300 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.95 seconds
19:56:51.454243 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
19:56:51.454670 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: rename object "dbo"."AH_Feedbacks__dbt_tmp" to AH_Feedbacks
19:56:51.506812 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:51.509156 [debug] [Thread-4  ]: On model.Shawn.AH_Feedbacks: COMMIT
19:56:51.511310 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feedbacks".
19:56:51.511534 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Feedbacks: 
    
  if object_id ('"dbo"."AH_Feedbacks__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feedbacks__dbt_backup"
    end

19:56:51.549217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:51.563700 [debug] [Thread-4  ]: finished collecting timing info
19:56:51.564127 [debug] [Thread-4  ]: On model.Shawn.AH_Feedbacks: Close
19:56:51.564966 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8730040>]}
19:56:51.565500 [info ] [Thread-4  ]: 31 of 105 OK created table model dbo.AH_Feedbacks............................... [[32mOK[0m in 3.15s]
19:56:51.566519 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Feedbacks
19:56:51.566814 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ImportedListingsMap
19:56:51.567256 [info ] [Thread-4  ]: 35 of 105 START table model dbo.AH_ImportedListingsMap.......................... [RUN]
19:56:51.568546 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedListingsMap"
19:56:51.568758 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ImportedListingsMap
19:56:51.568935 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ImportedListingsMap
19:56:51.572147 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ImportedListingsMap"
19:56:51.572833 [debug] [Thread-4  ]: finished collecting timing info
19:56:51.573071 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ImportedListingsMap
19:56:51.609420 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedListingsMap"
19:56:51.610242 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
19:56:51.610521 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
  
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedListingsMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedListingsMap__dbt_tmp_temp_view as
    
Select
	cast([ForeignListingID] as int) [ForeignListingID],
	cast([LoCallistingID] as int) [LoCallistingID] 
From stg.[AH_ImportedListingsMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedListingsMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedListingsMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedListingsMap__dbt_tmp_temp_view"
    end



19:56:51.610718 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:51.610900 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:51.613420 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
19:56:51.620921 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.99 seconds
19:56:51.636518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
19:56:51.647843 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: rename object "dbo"."AH_Feeschedules__dbt_tmp" to AH_Feeschedules
19:56:51.647557 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
19:56:51.648258 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: rename object "dbo"."AH_ImportedCategoryMap__dbt_tmp" to AH_ImportedCategoryMap
19:56:51.679003 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:51.681042 [debug] [Thread-2  ]: On model.Shawn.AH_Feeschedules: COMMIT
19:56:51.683418 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeschedules".
19:56:51.683690 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:51.685182 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedCategoryMap: COMMIT
19:56:51.683934 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Feeschedules: 
    
  if object_id ('"dbo"."AH_Feeschedules__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feeschedules__dbt_backup"
    end

19:56:51.687035 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedCategoryMap".
19:56:51.687435 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedCategoryMap: 
    
  if object_id ('"dbo"."AH_ImportedCategoryMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedCategoryMap__dbt_backup"
    end

19:56:51.710377 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:51.723534 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:51.810054 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.24 seconds
19:56:51.811209 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
19:56:51.828526 [debug] [Thread-1  ]: finished collecting timing info
19:56:51.840045 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedCategoryMap: Close
19:56:51.840765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc86a2340>]}
19:56:51.841162 [info ] [Thread-1  ]: 34 of 105 OK created table model dbo.AH_ImportedCategoryMap..................... [[32mOK[0m in 2.71s]
19:56:51.834719 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
19:56:51.842127 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: rename object "dbo"."AH_Feeproperties__dbt_tmp" to AH_Feeproperties
19:56:51.842801 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ImportedCategoryMap
19:56:51.843059 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ImportedUserMap
19:56:51.843495 [info ] [Thread-1  ]: 36 of 105 START table model dbo.AH_ImportedUserMap.............................. [RUN]
19:56:51.844678 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedUserMap"
19:56:51.844888 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ImportedUserMap
19:56:51.845073 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ImportedUserMap
19:56:51.839737 [debug] [Thread-2  ]: finished collecting timing info
19:56:51.848905 [debug] [Thread-2  ]: On model.Shawn.AH_Feeschedules: Close
19:56:51.849474 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98bc7c0>]}
19:56:51.849811 [info ] [Thread-2  ]: 33 of 105 OK created table model dbo.AH_Feeschedules............................ [[32mOK[0m in 3.27s]
19:56:51.852059 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Feeschedules
19:56:51.852319 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ImportedregionMap
19:56:51.852717 [info ] [Thread-2  ]: 37 of 105 START table model dbo.AH_ImportedregionMap............................ [RUN]
19:56:51.853797 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ImportedregionMap"
19:56:51.854004 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ImportedregionMap
19:56:51.854173 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ImportedregionMap
19:56:51.848691 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ImportedUserMap"
19:56:51.857776 [debug] [Thread-1  ]: finished collecting timing info
19:56:51.857912 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ImportedUserMap
19:56:51.857373 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ImportedregionMap"
19:56:51.867983 [debug] [Thread-2  ]: finished collecting timing info
19:56:51.868160 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ImportedregionMap
19:56:51.877639 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:51.879162 [debug] [Thread-3  ]: On model.Shawn.AH_Feeproperties: COMMIT
19:56:51.880962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Feeproperties".
19:56:51.881108 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Feeproperties: 
    
  if object_id ('"dbo"."AH_Feeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Feeproperties__dbt_backup"
    end

19:56:51.931963 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedUserMap"
19:56:51.932234 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:51.934561 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ImportedregionMap"
19:56:51.944111 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
19:56:51.944275 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
  
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedregionMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedregionMap__dbt_tmp_temp_view as
    
Select
	cast([LocalregionID] as int) [LocalregionID],
	cast([ForeignregionID] as int) [ForeignregionID],
	cast([Foreignregiontier] as int) [Foreignregiontier] 
From stg.[AH_ImportedregionMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedregionMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedregionMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedregionMap__dbt_tmp_temp_view"
    end



19:56:51.944823 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:51.944969 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:51.944647 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
19:56:51.945238 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
  
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ImportedUserMap__dbt_tmp"
    end


   EXEC('create view dbo.AH_ImportedUserMap__dbt_tmp_temp_view as
    
Select
	cast([LocalUserID] as int) [LocalUserID],
	cast([ForeignUserID] as int) [ForeignUserID],
	cast([ImportedUserName] as nvarchar(4000)) [ImportedUserName] 
From stg.[AH_ImportedUserMap_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ImportedUserMap__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ImportedUserMap__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ImportedUserMap__dbt_tmp_temp_view"
    end



19:56:51.945339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:51.945433 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:51.951523 [debug] [Thread-3  ]: finished collecting timing info
19:56:51.951830 [debug] [Thread-3  ]: On model.Shawn.AH_Feeproperties: Close
19:56:51.952556 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc86b5550>]}
19:56:51.953021 [info ] [Thread-3  ]: 32 of 105 OK created table model dbo.AH_Feeproperties........................... [[32mOK[0m in 3.45s]
19:56:51.954019 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Feeproperties
19:56:51.954493 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Increments
19:56:51.954975 [info ] [Thread-3  ]: 38 of 105 START table model dbo.AH_Increments................................... [RUN]
19:56:51.956194 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Increments"
19:56:51.956402 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Increments
19:56:51.956573 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Increments
19:56:51.960520 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Increments"
19:56:51.961030 [debug] [Thread-3  ]: finished collecting timing info
19:56:51.961259 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Increments
19:56:52.013266 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Increments"
19:56:52.014830 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
19:56:52.015128 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
  
  if object_id ('"dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Increments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Increments__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Increments__dbt_tmp"
    end


   EXEC('create view dbo.AH_Increments__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([PriceLevel] as numeric(19,4)) [PriceLevel],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Increments_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Increments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Increments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Increments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Increments__dbt_tmp_temp_view"
    end



19:56:52.015294 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:52.015474 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:52.047895 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:52.048384 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:52.119811 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:53.477776 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
19:56:53.492731 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
19:56:53.493159 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: rename object "dbo"."AH_ImportedListingsMap__dbt_tmp" to AH_ImportedListingsMap
19:56:53.525905 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:53.527968 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedListingsMap: COMMIT
19:56:53.530092 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedListingsMap".
19:56:53.530311 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ImportedListingsMap: 
    
  if object_id ('"dbo"."AH_ImportedListingsMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedListingsMap__dbt_backup"
    end

19:56:53.568234 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:53.581436 [debug] [Thread-4  ]: finished collecting timing info
19:56:53.581898 [debug] [Thread-4  ]: On model.Shawn.AH_ImportedListingsMap: Close
19:56:53.582764 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9807c40>]}
19:56:53.583298 [info ] [Thread-4  ]: 35 of 105 OK created table model dbo.AH_ImportedListingsMap..................... [[32mOK[0m in 2.01s]
19:56:53.584471 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ImportedListingsMap
19:56:53.584735 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Invoices
19:56:53.585174 [info ] [Thread-4  ]: 39 of 105 START table model dbo.AH_Invoices..................................... [RUN]
19:56:53.586493 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices"
19:56:53.586731 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Invoices
19:56:53.586912 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Invoices
19:56:53.590842 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Invoices"
19:56:53.591380 [debug] [Thread-4  ]: finished collecting timing info
19:56:53.591617 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Invoices
19:56:53.629239 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices"
19:56:53.629988 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
19:56:53.630232 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
  
  if object_id ('"dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoices__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Invoices__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Invoices__dbt_tmp"
    end


   EXEC('create view dbo.AH_Invoices__dbt_tmp_temp_view as
    
Select
	cast([Paiddttm] as datetime) [PaidDTTM],
	cast([CreatedOn] as datetime) [Created_RWXInvoices],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXInvoices],
	cast([DeletedOn] as datetime) [DeletedDate_RWXInvoices],
	cast([Createddttm] as datetime) [CreatedDTTM],
	cast([Fulfilleddttm] as datetime) [FulfilledDTTM],
	cast([PropertybagID] as int) [PropertybagID],
	cast([ID] as int) [InvoiceID_RWXInvoices],
	cast([ShippingOptionID] as int) [ShippingOptionID],
	cast([PayerID] as int) [PayerID],
	cast([OwnerID] as int) [OwnerID_RWXInvoices],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([SalesTax] as decimal(24,2)) [SalesTax],
	cast([BuyersPremiumPercent] as numeric(24,2)) [BuyerPremiumPct],
	cast([BuyersPremiumAmount] as decimal(24,2)) [BuyerPremiumAmount],
	cast([ShippingAmount] as decimal(24,2)) [ShippingAmount],
	cast([SubTotal] as decimal(24,2)) [Subtotal],
	cast([Total] as decimal(24,2)) [Total],
	cast([IsPayerLocked] as bit) [IsPayerLocked],
	cast([Shipped] as bit) [HasShipped],
	cast([IsArchived] as bit) [IsArchived_RWXInvoices],
	cast([Status] as nvarchar(100)) [Status_RWXInvoices],
	cast([ShippingLastName] as nvarchar(500)) [ShippingLastName],
	cast([BillingLastName] as nvarchar(500)) [BillingLastName],
	cast([OwnerName] as nvarchar(200)) [OwnerName],
	cast([Shippingdetails] as nvarchar(500)) [ShippingDetails],
	cast([OwnerCity] as nvarchar(200)) [OwnerCity],
	cast([OwnerStateregion] as nvarchar(200)) [OwnerStateRegion],
	cast([OwnerzipPostal] as varchar(128)) [OwnerPostalCode],
	cast([OwnerCountry] as nvarchar(200)) [OwnerCountry],
	cast([ShippingFirstName] as nvarchar(500)) [ShippingFirstName],
	cast([BillingFirstName] as nvarchar(500)) [BIllingFirstName],
	cast([BillingCity] as nvarchar(40)) [BillingCity],
	cast([BillingStateregion] as nvarchar(40)) [BillingState],
	cast([BillingzipPostal] as varchar(128)) [BillingPostalCode],
	cast([BillingCountry] as nvarchar(40)) [BillingCountry],
	cast([OwnerStreet1] as varchar(128)) [OwnerStreet1],
	cast([OwnerStreet2] as varchar(128)) [OwnerStreet2],
	cast([ShippingCity] as nvarchar(100)) [ShippingCity],
	cast([ShippingStateregion] as nvarchar(50)) [ShippingState],
	cast([ShippingzipPostal] as varchar(128)) [ShippingPostalCode],
	cast([ShippingCountry] as nvarchar(100)) [ShippingCountry],
	cast([BillingStreet1] as varchar(128)) [BillingStreet1],
	cast([BillingStreet2] as varchar(128)) [BillingStreet2],
	cast([Comments] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXInvoices],
	cast([Currency] as nvarchar(10)) [CurrencyID],
	cast([Type] as nvarchar(50)) [Type_RWXInvoices],
	cast([ShippingStreet1] as varchar(128)) [ShippingStreet1],
	cast([ShippingStreet2] as varchar(128)) [ShippingStreet2] 
From stg.[AH_Invoices_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Invoices__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Invoices__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Invoices__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoices__dbt_tmp_temp_view"
    end



19:56:53.630460 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:53.630691 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:53.754811 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:55.062224 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.12 seconds
19:56:55.077238 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
19:56:55.077663 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: rename object "dbo"."AH_ImportedregionMap__dbt_tmp" to AH_ImportedregionMap
19:56:55.121432 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:55.123566 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedregionMap: COMMIT
19:56:55.125895 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedregionMap".
19:56:55.126153 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ImportedregionMap: 
    
  if object_id ('"dbo"."AH_ImportedregionMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedregionMap__dbt_backup"
    end

19:56:55.176239 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:56:55.191877 [debug] [Thread-2  ]: finished collecting timing info
19:56:55.192361 [debug] [Thread-2  ]: On model.Shawn.AH_ImportedregionMap: Close
19:56:55.193363 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98bcdf0>]}
19:56:55.193875 [info ] [Thread-2  ]: 37 of 105 OK created table model dbo.AH_ImportedregionMap....................... [[32mOK[0m in 3.34s]
19:56:55.195246 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ImportedregionMap
19:56:55.195531 [debug] [Thread-2  ]: Began running node model.Shawn.AH_KeyTable
19:56:55.195980 [info ] [Thread-2  ]: 40 of 105 START table model dbo.AH_KeyTable..................................... [RUN]
19:56:55.196938 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_KeyTable"
19:56:55.197151 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_KeyTable
19:56:55.197325 [debug] [Thread-2  ]: Compiling model.Shawn.AH_KeyTable
19:56:55.201529 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_KeyTable"
19:56:55.202107 [debug] [Thread-2  ]: finished collecting timing info
19:56:55.202665 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_KeyTable
19:56:55.240101 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_KeyTable"
19:56:55.240958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
19:56:55.241257 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
  
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_KeyTable__dbt_tmp"
    end


   EXEC('create view dbo.AH_KeyTable__dbt_tmp_temp_view as
    
Select
	cast([NextID] as int) [NextID] 
From stg.[AH_KeyTable_FinalView]
    ');

  CREATE TABLE "dbo"."AH_KeyTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_KeyTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_KeyTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_KeyTable__dbt_tmp_temp_view"
    end



19:56:55.241448 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:55.241638 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:55.335288 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:56.262124 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 4.32 seconds
19:56:56.271791 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.26 seconds
19:56:56.279259 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
19:56:56.287848 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: rename object "dbo"."AH_ImportedUserMap__dbt_tmp" to AH_ImportedUserMap
19:56:56.293501 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
19:56:56.293917 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: rename object "dbo"."AH_Increments__dbt_tmp" to AH_Increments
19:56:56.327114 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.329318 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedUserMap: COMMIT
19:56:56.331933 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ImportedUserMap".
19:56:56.332289 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ImportedUserMap: 
    
  if object_id ('"dbo"."AH_ImportedUserMap__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ImportedUserMap__dbt_backup"
    end

19:56:56.332719 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.334277 [debug] [Thread-3  ]: On model.Shawn.AH_Increments: COMMIT
19:56:56.336507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Increments".
19:56:56.336756 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Increments: 
    
  if object_id ('"dbo"."AH_Increments__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Increments__dbt_backup"
    end

19:56:56.370596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.379865 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.387234 [debug] [Thread-1  ]: finished collecting timing info
19:56:56.395936 [debug] [Thread-1  ]: On model.Shawn.AH_ImportedUserMap: Close
19:56:56.396817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc869b040>]}
19:56:56.397252 [info ] [Thread-1  ]: 36 of 105 OK created table model dbo.AH_ImportedUserMap......................... [[32mOK[0m in 4.55s]
19:56:56.398349 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ImportedUserMap
19:56:56.398679 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Languages
19:56:56.399150 [info ] [Thread-1  ]: 41 of 105 START table model dbo.AH_Languages.................................... [RUN]
19:56:56.400548 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Languages"
19:56:56.404999 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Languages
19:56:56.405136 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Languages
19:56:56.408032 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Languages"
19:56:56.404844 [debug] [Thread-3  ]: finished collecting timing info
19:56:56.408509 [debug] [Thread-3  ]: On model.Shawn.AH_Increments: Close
19:56:56.409229 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc97f8160>]}
19:56:56.410113 [info ] [Thread-3  ]: 38 of 105 OK created table model dbo.AH_Increments.............................. [[32mOK[0m in 4.45s]
19:56:56.409673 [debug] [Thread-1  ]: finished collecting timing info
19:56:56.410942 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Languages
19:56:56.417629 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Increments
19:56:56.417916 [debug] [Thread-3  ]: Began running node model.Shawn.AH_LineItems
19:56:56.418151 [info ] [Thread-3  ]: 42 of 105 START table model dbo.AH_LineItems.................................... [RUN]
19:56:56.419429 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems"
19:56:56.419694 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_LineItems
19:56:56.419872 [debug] [Thread-3  ]: Compiling model.Shawn.AH_LineItems
19:56:56.423389 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_LineItems"
19:56:56.436107 [debug] [Thread-3  ]: finished collecting timing info
19:56:56.436560 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_LineItems
19:56:56.462059 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.83 seconds
19:56:56.492496 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Languages"
19:56:56.508137 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
19:56:56.499290 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
19:56:56.508855 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: rename object "dbo"."AH_Invoices__dbt_tmp" to AH_Invoices
19:56:56.508587 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
  
  if object_id ('"dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Languages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Languages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Languages__dbt_tmp"
    end


   EXEC('create view dbo.AH_Languages__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Code] as nvarchar(4000)) [Code],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Languages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Languages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Languages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Languages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Languages__dbt_tmp_temp_view"
    end



19:56:56.509181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:56.509344 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:56.517170 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems"
19:56:56.518135 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
19:56:56.518424 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
  
  if object_id ('"dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LineItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LineItems__dbt_tmp"
    end


   EXEC('create view dbo.AH_LineItems__dbt_tmp_temp_view as
    
Select
	cast([Currency] as nvarchar(10)) [Currency],
	cast([Status] as nvarchar(100)) [Status_RWXLineItems],
	cast([Type] as nvarchar(50)) [Type_RWXLineItems],
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXLineItems],
	cast([CreatedOn] as datetime) [Created_RWXLineItems],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXLineItems],
	cast([DeletedOn] as datetime) [DeletedDate_RWXLineItems],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [LineItemsID],
	cast([InvoiceID] as int) [InvoiceID_RWXLineItems],
	cast([ListingID] as int) [ListingID],
	cast([Quantity] as int) [QTY],
	cast([OwnerID] as int) [OwnerID_RWXLineItems],
	cast([PayerID] as int) [UserID],
	cast([ReListiteration] as int) [ReListiteration],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([TotalAmount] as decimal(24,2)) [TotalAmount],
	cast([PeRunitAmount] as decimal(24,2)) [PerUnitAmount],
	cast([Taxable] as bit) [IsTaxable],
	cast([IsArchived] as bit) [IsArchived_RWXLineItems],
	cast([BuyersPremiuMapplies] as bit) [HasBuyerPremiumApplies],
	cast([IsPayerArchived] as bit) [IsPayerArchived] 
From stg.[AH_LineItems_FinalView]
    ');

  CREATE TABLE "dbo"."AH_LineItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LineItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LineItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems__dbt_tmp_temp_view"
    end



19:56:56.518632 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:56:56.518828 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:56.545660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.547894 [debug] [Thread-4  ]: On model.Shawn.AH_Invoices: COMMIT
19:56:56.550235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices".
19:56:56.550701 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Invoices: 
    
  if object_id ('"dbo"."AH_Invoices__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Invoices__dbt_backup"
    end

19:56:56.595306 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.690102 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:56.690644 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:56.697949 [debug] [Thread-4  ]: finished collecting timing info
19:56:56.698456 [debug] [Thread-4  ]: On model.Shawn.AH_Invoices: Close
19:56:56.699346 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b7070>]}
19:56:56.699895 [info ] [Thread-4  ]: 39 of 105 OK created table model dbo.AH_Invoices................................ [[32mOK[0m in 3.11s]
19:56:56.702339 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Invoices
19:56:56.702674 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingActionproperties
19:56:56.703465 [info ] [Thread-4  ]: 43 of 105 START table model dbo.AH_ListingActionproperties...................... [RUN]
19:56:56.704622 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActionproperties"
19:56:56.704842 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingActionproperties
19:56:56.705023 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingActionproperties
19:56:56.708834 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingActionproperties"
19:56:56.709439 [debug] [Thread-4  ]: finished collecting timing info
19:56:56.710769 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingActionproperties
19:56:56.749037 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActionproperties"
19:56:56.749949 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
19:56:56.750247 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
  
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActionproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActionproperties__dbt_tmp_temp_view as
    
Select
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([ListingActionID] as int) [ListingActionID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingActionproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingActionproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActionproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActionproperties__dbt_tmp_temp_view"
    end



19:56:56.750420 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:56:56.750636 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:56.837659 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
19:56:56.851482 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:56.854175 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
19:56:56.854571 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: rename object "dbo"."AH_KeyTable__dbt_tmp" to AH_KeyTable
19:56:56.883351 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:56.885330 [debug] [Thread-2  ]: On model.Shawn.AH_KeyTable: COMMIT
19:56:56.887578 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_KeyTable".
19:56:56.887851 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_KeyTable: 
    
  if object_id ('"dbo"."AH_KeyTable__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_KeyTable__dbt_backup"
    end

19:56:56.924816 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:56.938337 [debug] [Thread-2  ]: finished collecting timing info
19:56:56.938899 [debug] [Thread-2  ]: On model.Shawn.AH_KeyTable: Close
19:56:56.939776 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b7280>]}
19:56:56.940308 [info ] [Thread-2  ]: 40 of 105 OK created table model dbo.AH_KeyTable................................ [[32mOK[0m in 1.74s]
19:56:56.941431 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_KeyTable
19:56:56.941709 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingActions
19:56:56.942168 [info ] [Thread-2  ]: 44 of 105 START table model dbo.AH_ListingActions............................... [RUN]
19:56:56.943619 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions"
19:56:56.943849 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingActions
19:56:56.944029 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingActions
19:56:56.947715 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions"
19:56:56.948298 [debug] [Thread-2  ]: finished collecting timing info
19:56:56.948507 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingActions
19:56:56.986315 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions"
19:56:56.987235 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
19:56:56.987506 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
  
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActions__dbt_tmp_temp_view as
    
Select
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([Reason] as nvarchar(4000)) [Reason],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([Actiondttm] as datetime) [ActionDTTM],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([ProxyAmount] as decimal(24,2)) [ProxyAmount],
	cast([Userentered] as bit) [HasUserEntered],
	cast([ID] as int) [ListingActionID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([Quantity] as int) [QTY] 
From stg.[AH_ListingActions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingActions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions__dbt_tmp_temp_view"
    end



19:56:56.987673 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:56:56.987853 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:57.092749 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:56:58.816730 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.31 seconds
19:56:58.832070 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
19:56:58.832510 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Languages: rename object "dbo"."AH_Languages__dbt_tmp" to AH_Languages
19:56:58.865201 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:56:58.867328 [debug] [Thread-1  ]: On model.Shawn.AH_Languages: COMMIT
19:56:58.869689 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Languages".
19:56:58.869959 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Languages: 
    
  if object_id ('"dbo"."AH_Languages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Languages__dbt_backup"
    end

19:56:58.905789 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:56:58.919873 [debug] [Thread-1  ]: finished collecting timing info
19:56:58.920396 [debug] [Thread-1  ]: On model.Shawn.AH_Languages: Close
19:56:58.921247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b7130>]}
19:56:58.921777 [info ] [Thread-1  ]: 41 of 105 OK created table model dbo.AH_Languages............................... [[32mOK[0m in 2.52s]
19:56:58.923321 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Languages
19:56:58.923606 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingComments
19:56:58.924058 [info ] [Thread-1  ]: 45 of 105 START table model dbo.AH_ListingComments.............................. [RUN]
19:56:58.925018 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingComments"
19:56:58.925230 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingComments
19:56:58.925406 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingComments
19:56:58.929149 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingComments"
19:56:58.929714 [debug] [Thread-1  ]: finished collecting timing info
19:56:58.929959 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingComments
19:56:58.967988 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingComments"
19:56:58.968868 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
19:56:58.969155 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
  
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingComments__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingComments__dbt_tmp_temp_view as
    
Select
	cast([IsBID] as bit) [IsBid],
	cast([Approved] as bit) [IsApproved],
	cast([ParentID] as int) [ParentID],
	cast([ReportCount] as int) [ReportCount],
	cast([ID] as int) [CommentID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([UserName] as nvarchar(500)) [Name],
	cast([Comment] as nvarchar(4000)) [Comment] 
From stg.[AH_ListingComments_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingComments__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingComments__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingComments__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingComments__dbt_tmp_temp_view"
    end



19:56:58.969320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:56:58.969503 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:56:59.067072 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:00.050850 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.53 seconds
19:57:00.067114 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
19:57:00.067569 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: rename object "dbo"."AH_LineItems__dbt_tmp" to AH_LineItems
19:57:00.101787 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:00.103979 [debug] [Thread-3  ]: On model.Shawn.AH_LineItems: COMMIT
19:57:00.106446 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems".
19:57:00.106792 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LineItems: 
    
  if object_id ('"dbo"."AH_LineItems__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LineItems__dbt_backup"
    end

19:57:00.151497 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:00.164718 [debug] [Thread-3  ]: finished collecting timing info
19:57:00.165255 [debug] [Thread-3  ]: On model.Shawn.AH_LineItems: Close
19:57:00.166156 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85e2430>]}
19:57:00.166761 [info ] [Thread-3  ]: 42 of 105 OK created table model dbo.AH_LineItems............................... [[32mOK[0m in 3.75s]
19:57:00.168185 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_LineItems
19:57:00.168479 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingCommentsMedias
19:57:00.168940 [info ] [Thread-3  ]: 46 of 105 START table model dbo.AH_ListingCommentsMedias........................ [RUN]
19:57:00.169938 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingCommentsMedias"
19:57:00.170146 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingCommentsMedias
19:57:00.170319 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingCommentsMedias
19:57:00.174029 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingCommentsMedias"
19:57:00.174641 [debug] [Thread-3  ]: finished collecting timing info
19:57:00.174859 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingCommentsMedias
19:57:00.212708 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingCommentsMedias"
19:57:00.213583 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
19:57:00.213889 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
  
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingCommentsMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view as
    
Select
	cast([UpdatedOn] as datetime) [UpdatedDate_AHListingCommentsMedias],
	cast([DeletedOn] as datetime) [DeletedDate_AHListingCommentsMedias],
	cast([CreatedOn] as datetime) [Created_AHListingCommentsMedias],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([CommentID] as int) [CommentID],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingCommentsMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingCommentsMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingCommentsMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingCommentsMedias__dbt_tmp_temp_view"
    end



19:57:00.214066 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:00.214251 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:00.314971 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:02.644730 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
19:57:02.659955 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
19:57:02.660387 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: rename object "dbo"."AH_ListingCommentsMedias__dbt_tmp" to AH_ListingCommentsMedias
19:57:02.695343 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:02.697474 [debug] [Thread-3  ]: On model.Shawn.AH_ListingCommentsMedias: COMMIT
19:57:02.699937 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingCommentsMedias".
19:57:02.700253 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingCommentsMedias: 
    
  if object_id ('"dbo"."AH_ListingCommentsMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingCommentsMedias__dbt_backup"
    end

19:57:02.737191 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:02.751026 [debug] [Thread-3  ]: finished collecting timing info
19:57:02.751558 [debug] [Thread-3  ]: On model.Shawn.AH_ListingCommentsMedias: Close
19:57:02.752453 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b7910>]}
19:57:02.752972 [info ] [Thread-3  ]: 46 of 105 OK created table model dbo.AH_ListingCommentsMedias................... [[32mOK[0m in 2.58s]
19:57:02.754060 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingCommentsMedias
19:57:02.754335 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingEnddttmAudit
19:57:02.754830 [info ] [Thread-3  ]: 47 of 105 START table model dbo.AH_ListingEnddttmAudit.......................... [RUN]
19:57:02.756212 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingEnddttmAudit"
19:57:02.756432 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingEnddttmAudit
19:57:02.756613 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingEnddttmAudit
19:57:02.760261 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingEnddttmAudit"
19:57:02.760816 [debug] [Thread-3  ]: finished collecting timing info
19:57:02.761023 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingEnddttmAudit
19:57:02.799063 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingEnddttmAudit"
19:57:02.799973 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
19:57:02.800280 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
  
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view as
    
Select
	cast([SqlDaTestamp] as datetime) [SqlDaTestamp],
	cast([Enddttm] as datetime) [Enddttm],
	cast([SourceListingID] as int) [SourceListingID],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([Origin] as nvarchar(4000)) [Origin] 
From stg.[AH_ListingEnddttmAudit_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingEnddttmAudit__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingEnddttmAudit__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingEnddttmAudit__dbt_tmp_temp_view"
    end



19:57:02.800448 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:02.800628 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:02.894912 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:05.012660 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.04 seconds
19:57:05.020685 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.22 seconds
19:57:05.034618 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
19:57:05.042116 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: rename object "dbo"."AH_ListingComments__dbt_tmp" to AH_ListingComments
19:57:05.041816 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
19:57:05.042608 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: rename object "dbo"."AH_ListingEnddttmAudit__dbt_tmp" to AH_ListingEnddttmAudit
19:57:05.072403 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:05.074745 [debug] [Thread-1  ]: On model.Shawn.AH_ListingComments: COMMIT
19:57:05.076993 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingComments".
19:57:05.077243 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:05.078810 [debug] [Thread-3  ]: On model.Shawn.AH_ListingEnddttmAudit: COMMIT
19:57:05.080718 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingEnddttmAudit".
19:57:05.077398 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingComments: 
    
  if object_id ('"dbo"."AH_ListingComments__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingComments__dbt_backup"
    end

19:57:05.080953 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingEnddttmAudit: 
    
  if object_id ('"dbo"."AH_ListingEnddttmAudit__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingEnddttmAudit__dbt_backup"
    end

19:57:05.132785 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:05.146859 [debug] [Thread-1  ]: finished collecting timing info
19:57:05.147379 [debug] [Thread-1  ]: On model.Shawn.AH_ListingComments: Close
19:57:05.148245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b77c0>]}
19:57:05.148542 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:57:05.160066 [info ] [Thread-1  ]: 45 of 105 OK created table model dbo.AH_ListingComments......................... [[32mOK[0m in 6.22s]
19:57:05.161353 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingComments
19:57:05.161682 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingLocations
19:57:05.162152 [info ] [Thread-1  ]: 48 of 105 START table model dbo.AH_ListingLocations............................. [RUN]
19:57:05.163480 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingLocations"
19:57:05.163698 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingLocations
19:57:05.163875 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingLocations
19:57:05.168567 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingLocations"
19:57:05.171313 [debug] [Thread-3  ]: finished collecting timing info
19:57:05.171835 [debug] [Thread-3  ]: On model.Shawn.AH_ListingEnddttmAudit: Close
19:57:05.172188 [debug] [Thread-1  ]: finished collecting timing info
19:57:05.173138 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingLocations
19:57:05.172902 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b7e50>]}
19:57:05.180130 [info ] [Thread-3  ]: 47 of 105 OK created table model dbo.AH_ListingEnddttmAudit..................... [[32mOK[0m in 2.42s]
19:57:05.181307 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingEnddttmAudit
19:57:05.181612 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingMedias
19:57:05.182059 [info ] [Thread-3  ]: 49 of 105 START table model dbo.AH_ListingMedias................................ [RUN]
19:57:05.183448 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingMedias"
19:57:05.183666 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingMedias
19:57:05.183842 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingMedias
19:57:05.187436 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingMedias"
19:57:05.196047 [debug] [Thread-3  ]: finished collecting timing info
19:57:05.196239 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingMedias
19:57:05.242658 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingLocations"
19:57:05.252345 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
19:57:05.252625 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
  
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingLocations__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingLocations__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([LocationID] as int) [LocationID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_ListingLocations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingLocations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingLocations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingLocations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingLocations__dbt_tmp_temp_view"
    end



19:57:05.252724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:05.252843 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:05.260016 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.51 seconds
19:57:05.363306 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingMedias"
19:57:05.363588 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:05.364569 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
19:57:05.364809 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
  
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingMedias__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingMedias__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([ID] as int) [ID],
	cast([MediaID] as int) [MediaID],
	cast([ListingID] as int) [ListingID],
	cast([DisplayOrder] as int) [DisplayOrder] 
From stg.[AH_ListingMedias_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingMedias__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingMedias__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingMedias__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingMedias__dbt_tmp_temp_view"
    end



19:57:05.364962 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:05.365189 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:05.375092 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
19:57:05.375450 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: rename object "dbo"."AH_ListingActionproperties__dbt_tmp" to AH_ListingActionproperties
19:57:05.406578 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:05.408789 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActionproperties: COMMIT
19:57:05.411137 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActionproperties".
19:57:05.411437 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingActionproperties: 
    
  if object_id ('"dbo"."AH_ListingActionproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActionproperties__dbt_backup"
    end

19:57:05.449802 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:05.464702 [debug] [Thread-4  ]: finished collecting timing info
19:57:05.465000 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:05.465337 [debug] [Thread-4  ]: On model.Shawn.AH_ListingActionproperties: Close
19:57:05.466381 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8734160>]}
19:57:05.466927 [info ] [Thread-4  ]: 43 of 105 OK created table model dbo.AH_ListingActionproperties................. [[32mOK[0m in 8.76s]
19:57:05.468264 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingActionproperties
19:57:05.468534 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge
19:57:05.468969 [info ] [Thread-4  ]: 50 of 105 START table model dbo.AH_ListingPaymentCharge......................... [RUN]
19:57:05.469925 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge"
19:57:05.470137 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge
19:57:05.470315 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge
19:57:05.473770 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge"
19:57:05.474474 [debug] [Thread-4  ]: finished collecting timing info
19:57:05.474749 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge
19:57:05.512698 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge"
19:57:05.513664 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
19:57:05.513951 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
  
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view as
    
Select
	cast([BuyerID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([ID] as int) [ID],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([CreatedOn] as datetime) [Created],
	cast([TransactionID] as nvarchar(30)) [TransactionID],
	cast([ChargeAmount] as decimal(24,2)) [ChargeAmount],
	cast([TotalBID] as decimal(24,2)) [TotalBid],
	cast([BidHoldPercentage] as decimal(24,3)) [BidHoldPercentage],
	cast([MaximumBidCharge] as decimal(24,2)) [MaximumBidCharge] 
From stg.[AH_ListingPaymentCharge_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingPaymentCharge__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingPaymentCharge__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge__dbt_tmp_temp_view"
    end



19:57:05.514517 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:57:05.514806 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:05.589430 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.60 seconds
19:57:05.606745 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
19:57:05.607198 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: rename object "dbo"."AH_ListingActions__dbt_tmp" to AH_ListingActions
19:57:05.614614 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:05.640182 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:05.642152 [debug] [Thread-2  ]: On model.Shawn.AH_ListingActions: COMMIT
19:57:05.644366 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions".
19:57:05.644619 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingActions: 
    
  if object_id ('"dbo"."AH_ListingActions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions__dbt_backup"
    end

19:57:05.689743 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:05.703640 [debug] [Thread-2  ]: finished collecting timing info
19:57:05.704159 [debug] [Thread-2  ]: On model.Shawn.AH_ListingActions: Close
19:57:05.705016 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc97ecf40>]}
19:57:05.705556 [info ] [Thread-2  ]: 44 of 105 OK created table model dbo.AH_ListingActions.......................... [[32mOK[0m in 8.76s]
19:57:05.706644 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingActions
19:57:05.706916 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingQuestions
19:57:05.707362 [info ] [Thread-2  ]: 51 of 105 START table model dbo.AH_ListingQuestions............................. [RUN]
19:57:05.708723 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingQuestions"
19:57:05.708936 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingQuestions
19:57:05.709113 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingQuestions
19:57:05.712773 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingQuestions"
19:57:05.713325 [debug] [Thread-2  ]: finished collecting timing info
19:57:05.713531 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingQuestions
19:57:05.751953 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingQuestions"
19:57:05.752826 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
19:57:05.753127 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
  
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingQuestions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingQuestions__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([UserName] as nvarchar(4000)) [UserName],
	cast([Question] as nvarchar(4000)) [Question],
	cast([Answer] as nvarchar(4000)) [Answer] 
From stg.[AH_ListingQuestions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingQuestions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingQuestions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingQuestions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingQuestions__dbt_tmp_temp_view"
    end



19:57:05.753298 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:57:05.753478 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:05.867289 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:07.442519 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.19 seconds
19:57:07.457388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
19:57:07.457842 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: rename object "dbo"."AH_ListingLocations__dbt_tmp" to AH_ListingLocations
19:57:07.491234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:07.493339 [debug] [Thread-1  ]: On model.Shawn.AH_ListingLocations: COMMIT
19:57:07.495727 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingLocations".
19:57:07.496006 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingLocations: 
    
  if object_id ('"dbo"."AH_ListingLocations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingLocations__dbt_backup"
    end

19:57:07.535142 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:07.548653 [debug] [Thread-1  ]: finished collecting timing info
19:57:07.549191 [debug] [Thread-1  ]: On model.Shawn.AH_ListingLocations: Close
19:57:07.550076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9808d90>]}
19:57:07.550643 [info ] [Thread-1  ]: 48 of 105 OK created table model dbo.AH_ListingLocations........................ [[32mOK[0m in 2.39s]
19:57:07.551747 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingLocations
19:57:07.552017 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ListingTypeFeeprovIDErs
19:57:07.552465 [info ] [Thread-1  ]: 52 of 105 START table model dbo.AH_ListingTypeFeeprovIDErs...................... [RUN]
19:57:07.553833 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs"
19:57:07.554051 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ListingTypeFeeprovIDErs
19:57:07.554235 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ListingTypeFeeprovIDErs
19:57:07.557822 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
19:57:07.558472 [debug] [Thread-1  ]: finished collecting timing info
19:57:07.558751 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ListingTypeFeeprovIDErs
19:57:07.597466 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeFeeprovIDErs"
19:57:07.598364 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
19:57:07.598710 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
  
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([ProvIDErName] as nvarchar(4000)) [ProvIDErName],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([Enabled] as bit) [Enabled] 
From stg.[AH_ListingTypeFeeprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp_temp_view"
    end



19:57:07.598882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:07.599082 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:07.699742 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:08.091918 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.58 seconds
19:57:08.106374 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
19:57:08.106828 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: rename object "dbo"."AH_ListingPaymentCharge__dbt_tmp" to AH_ListingPaymentCharge
19:57:08.143504 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:08.145575 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge: COMMIT
19:57:08.148056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge".
19:57:08.148222 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.39 seconds
19:57:08.148442 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge: 
    
  if object_id ('"dbo"."AH_ListingPaymentCharge__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge__dbt_backup"
    end

19:57:08.163478 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
19:57:08.163843 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: rename object "dbo"."AH_ListingQuestions__dbt_tmp" to AH_ListingQuestions
19:57:08.215043 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:08.217020 [debug] [Thread-2  ]: On model.Shawn.AH_ListingQuestions: COMMIT
19:57:08.220805 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingQuestions".
19:57:08.221139 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingQuestions: 
    
  if object_id ('"dbo"."AH_ListingQuestions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingQuestions__dbt_backup"
    end

19:57:08.268753 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:08.283177 [debug] [Thread-2  ]: finished collecting timing info
19:57:08.283703 [debug] [Thread-2  ]: On model.Shawn.AH_ListingQuestions: Close
19:57:08.284571 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8695d60>]}
19:57:08.285094 [info ] [Thread-2  ]: 51 of 105 OK created table model dbo.AH_ListingQuestions........................ [[32mOK[0m in 2.58s]
19:57:08.286263 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingQuestions
19:57:08.286576 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ListingTypeMedia
19:57:08.287039 [info ] [Thread-2  ]: 53 of 105 START table model dbo.AH_ListingTypeMedia............................. [RUN]
19:57:08.288415 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeMedia"
19:57:08.288628 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ListingTypeMedia
19:57:08.288805 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ListingTypeMedia
19:57:08.292540 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeMedia"
19:57:08.293099 [debug] [Thread-2  ]: finished collecting timing info
19:57:08.293303 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ListingTypeMedia
19:57:08.315330 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
19:57:08.332299 [debug] [Thread-4  ]: finished collecting timing info
19:57:08.343889 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge: Close
19:57:08.344805 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc97f18b0>]}
19:57:08.345257 [info ] [Thread-4  ]: 50 of 105 OK created table model dbo.AH_ListingPaymentCharge.................... [[32mOK[0m in 2.87s]
19:57:08.346344 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge
19:57:08.346670 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingTypeproperties
19:57:08.347127 [info ] [Thread-4  ]: 54 of 105 START table model dbo.AH_ListingTypeproperties........................ [RUN]
19:57:08.348561 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypeproperties"
19:57:08.351495 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingTypeproperties
19:57:08.351696 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingTypeproperties
19:57:08.355105 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypeproperties"
19:57:08.351336 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeMedia"
19:57:08.355829 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
19:57:08.356068 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
  
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeMedia__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeMedia__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([MediaassetName] as nvarchar(4000)) [MediaassetName],
	cast([Scope] as nvarchar(4000)) [Scope] 
From stg.[AH_ListingTypeMedia_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeMedia__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeMedia__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeMedia__dbt_tmp_temp_view"
    end



19:57:08.356226 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:57:08.356393 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:08.357885 [debug] [Thread-4  ]: finished collecting timing info
19:57:08.358107 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingTypeproperties
19:57:08.402840 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypeproperties"
19:57:08.403869 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
19:57:08.404157 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
  
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypeproperties__dbt_tmp_temp_view as
    
Select
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Scope] as nvarchar(4000)) [Scope],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([BoolnativeValue] as bit) [BoolnativeValue] 
From stg.[AH_ListingTypeproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypeproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypeproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypeproperties__dbt_tmp_temp_view"
    end



19:57:08.404345 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:57:08.404532 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:08.452916 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:08.505159 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:08.636148 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.27 seconds
19:57:08.652911 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
19:57:08.653322 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: rename object "dbo"."AH_ListingMedias__dbt_tmp" to AH_ListingMedias
19:57:08.691954 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:08.694059 [debug] [Thread-3  ]: On model.Shawn.AH_ListingMedias: COMMIT
19:57:08.696421 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingMedias".
19:57:08.696681 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingMedias: 
    
  if object_id ('"dbo"."AH_ListingMedias__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingMedias__dbt_backup"
    end

19:57:08.760615 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:57:08.775272 [debug] [Thread-3  ]: finished collecting timing info
19:57:08.775759 [debug] [Thread-3  ]: On model.Shawn.AH_ListingMedias: Close
19:57:08.776652 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c80d0>]}
19:57:08.777191 [info ] [Thread-3  ]: 49 of 105 OK created table model dbo.AH_ListingMedias........................... [[32mOK[0m in 3.59s]
19:57:08.778215 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingMedias
19:57:08.778482 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingTypes
19:57:08.778944 [info ] [Thread-3  ]: 55 of 105 START table model dbo.AH_ListingTypes................................. [RUN]
19:57:08.780227 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingTypes"
19:57:08.781337 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingTypes
19:57:08.781598 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingTypes
19:57:08.785084 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingTypes"
19:57:08.785633 [debug] [Thread-3  ]: finished collecting timing info
19:57:08.785836 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingTypes
19:57:08.823935 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingTypes"
19:57:08.824817 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
19:57:08.825107 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
  
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypes__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingTypes__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_ListingTypes_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingTypes__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingTypes__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingTypes__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingTypes__dbt_tmp_temp_view"
    end



19:57:08.825297 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:08.825487 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:08.933387 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:10.067587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
19:57:10.165793 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
19:57:10.166248 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: rename object "dbo"."AH_ListingTypeFeeprovIDErs__dbt_tmp" to AH_ListingTypeFeeprovIDErs
19:57:10.203336 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:10.205297 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: COMMIT
19:57:10.207554 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeFeeprovIDErs".
19:57:10.207811 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeFeeprovIDErs: 
    
  if object_id ('"dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeFeeprovIDErs__dbt_backup"
    end

19:57:10.257086 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:10.271006 [debug] [Thread-1  ]: finished collecting timing info
19:57:10.271488 [debug] [Thread-1  ]: On model.Shawn.AH_ListingTypeFeeprovIDErs: Close
19:57:10.272337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8130>]}
19:57:10.272859 [info ] [Thread-1  ]: 52 of 105 OK created table model dbo.AH_ListingTypeFeeprovIDErs................. [[32mOK[0m in 2.72s]
19:57:10.274264 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ListingTypeFeeprovIDErs
19:57:10.274565 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listingdecorations
19:57:10.275041 [info ] [Thread-1  ]: 56 of 105 START table model dbo.AH_Listingdecorations........................... [RUN]
19:57:10.276013 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listingdecorations"
19:57:10.276223 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listingdecorations
19:57:10.276404 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listingdecorations
19:57:10.279774 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listingdecorations"
19:57:10.280542 [debug] [Thread-1  ]: finished collecting timing info
19:57:10.280796 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listingdecorations
19:57:10.319176 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listingdecorations"
19:57:10.320040 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
19:57:10.320316 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
  
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listingdecorations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listingdecorations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([DecorationID] as int) [DecorationID],
	cast([ListingID] as int) [ListingID] 
From stg.[AH_Listingdecorations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listingdecorations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listingdecorations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listingdecorations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingdecorations__dbt_tmp_temp_view"
    end



19:57:10.320503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:10.320682 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:10.422859 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:10.537779 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
19:57:10.552157 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
19:57:10.552575 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: rename object "dbo"."AH_ListingTypeproperties__dbt_tmp" to AH_ListingTypeproperties
19:57:10.581580 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:10.583528 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypeproperties: COMMIT
19:57:10.585618 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeproperties".
19:57:10.585838 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeproperties: 
    
  if object_id ('"dbo"."AH_ListingTypeproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeproperties__dbt_backup"
    end

19:57:10.623923 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:10.638595 [debug] [Thread-4  ]: finished collecting timing info
19:57:10.639079 [debug] [Thread-4  ]: On model.Shawn.AH_ListingTypeproperties: Close
19:57:10.639941 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85f87c0>]}
19:57:10.640479 [info ] [Thread-4  ]: 54 of 105 OK created table model dbo.AH_ListingTypeproperties................... [[32mOK[0m in 2.29s]
19:57:10.641578 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingTypeproperties
19:57:10.641850 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Listingproperties
19:57:10.642293 [info ] [Thread-4  ]: 57 of 105 START table model dbo.AH_Listingproperties............................ [RUN]
19:57:10.644863 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Listingproperties"
19:57:10.645096 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Listingproperties
19:57:10.645274 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Listingproperties
19:57:10.648588 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Listingproperties"
19:57:10.649119 [debug] [Thread-4  ]: finished collecting timing info
19:57:10.649356 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Listingproperties
19:57:10.686438 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Listingproperties"
19:57:10.687298 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
19:57:10.687586 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
  
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listingproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listingproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as decimal(29,14)) [DecimalNativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(200)) [EnumNativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXListingProperties],
	cast([CreatedOn] as datetime) [Created_RWXListingProperties],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXListingProperties],
	cast([DeletedOn] as datetime) [DeletedDate_RWXListingProperties],
	cast([DateTimenativeValue] as datetime) [DateTimeNativeValue],
	cast([BoolnativeValue] as bit) [HasBoolNativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntNativeValue],
	cast([ListingID] as int) [ListingID],
	cast([CustomFieldID] as int) [CustomFieldID] 
From stg.[AH_Listingproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listingproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listingproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listingproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listingproperties__dbt_tmp_temp_view"
    end



19:57:10.687762 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:57:10.687938 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:10.790387 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:10.823207 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
19:57:10.838209 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
19:57:10.838657 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: rename object "dbo"."AH_ListingTypeMedia__dbt_tmp" to AH_ListingTypeMedia
19:57:10.867352 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:10.869420 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeMedia: COMMIT
19:57:10.871808 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypeMedia".
19:57:10.872063 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ListingTypeMedia: 
    
  if object_id ('"dbo"."AH_ListingTypeMedia__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypeMedia__dbt_backup"
    end

19:57:10.929633 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:57:10.943399 [debug] [Thread-2  ]: finished collecting timing info
19:57:10.943899 [debug] [Thread-2  ]: On model.Shawn.AH_ListingTypeMedia: Close
19:57:10.944737 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8520>]}
19:57:10.945255 [info ] [Thread-2  ]: 53 of 105 OK created table model dbo.AH_ListingTypeMedia........................ [[32mOK[0m in 2.66s]
19:57:10.946311 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ListingTypeMedia
19:57:10.946612 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Listings
19:57:10.947050 [info ] [Thread-2  ]: 58 of 105 START table model dbo.AH_Listings..................................... [RUN]
19:57:10.949754 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Listings"
19:57:10.950275 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Listings
19:57:10.950751 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Listings
19:57:10.955218 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Listings"
19:57:10.955817 [debug] [Thread-2  ]: finished collecting timing info
19:57:10.956080 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Listings
19:57:10.993727 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Listings"
19:57:10.994625 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
19:57:10.994925 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
  
  if object_id ('"dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listings__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listings__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listings__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([PrimaryImageURI] as nvarchar(2048)) [PrimaryImageURL],
	cast([OwnerUserName] as nvarchar(500)) [OwnerUserName],
	cast([CurrentListingActionUserName] as nvarchar(500)) [CurrentListingActionUserName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([Description] as nvarchar(4000)) [Description],
	cast([SubTitle] as nvarchar(4000)) [Subtitle],
	cast([Location] as nvarchar(4000)) [Location],
	cast([Status] as nvarchar(100)) [Status],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([Enddttm] as datetime) [EndDTTM],
	cast([Startdttm] as datetime) [StartDTTM],
	cast([AutoreListrEMAining] as int) [AutoreListrEMAining],
	cast([CurrentQuantity] as int) [CurrentQuantity],
	cast([OriginalQuantity] as int) [OriginalQuantity],
	cast([ReListiteration] as int) [ReListiteration],
	cast([LotID] as int) [LotID],
	cast([AcceptedActionCount] as int) [AcceptedActionCount],
	cast([OwnerID] as int) [OwnerID],
	cast([ListingTypeID] as int) [ListingTypeID],
	cast([Duration] as int) [Duration],
	cast([Version] as int) [Version],
	cast([CurrencyID] as money) [CurrencyID],
	cast([PrimaryCategoryID] as int) [PrimaryCategoryId],
	cast([CurrentListingActionID] as int) [CurrentListingActionId],
	cast([OfferCount] as int) [OfferCount],
	cast([ID] as int) [ListingID],
	cast([OriginalreListCount] as int) [OriginalreListCount],
	cast([Hits] as int) [Hits],
	cast([CurrentPrice] as decimal(24,2)) [CurrentPrice],
	cast([Increment] as decimal(24,2)) [Increment],
	cast([OriginalPrice] as money) [OriginalPrice] 
From stg.[AH_Listings_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Listings__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listings__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listings__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings__dbt_tmp_temp_view"
    end



19:57:10.995097 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:57:10.995279 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:11.093871 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:11.884753 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.06 seconds
19:57:11.899575 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
19:57:11.899973 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: rename object "dbo"."AH_ListingTypes__dbt_tmp" to AH_ListingTypes
19:57:11.940436 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:11.942513 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypes: COMMIT
19:57:11.944653 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingTypes".
19:57:11.944892 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingTypes: 
    
  if object_id ('"dbo"."AH_ListingTypes__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingTypes__dbt_backup"
    end

19:57:12.038527 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
19:57:12.052023 [debug] [Thread-3  ]: finished collecting timing info
19:57:12.052512 [debug] [Thread-3  ]: On model.Shawn.AH_ListingTypes: Close
19:57:12.053366 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8280>]}
19:57:12.053879 [info ] [Thread-3  ]: 55 of 105 OK created table model dbo.AH_ListingTypes............................ [[32mOK[0m in 3.27s]
19:57:12.055259 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingTypes
19:57:12.055533 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingsReserveHistory
19:57:12.055991 [info ] [Thread-3  ]: 59 of 105 START table model dbo.AH_ListingsReserveHistory....................... [RUN]
19:57:12.056902 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingsReserveHistory"
19:57:12.057116 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingsReserveHistory
19:57:12.057293 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingsReserveHistory
19:57:12.060781 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingsReserveHistory"
19:57:12.061330 [debug] [Thread-3  ]: finished collecting timing info
19:57:12.061564 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingsReserveHistory
19:57:12.100357 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingsReserveHistory"
19:57:12.101210 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
19:57:12.101501 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
  
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingsReserveHistory__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([OldReserve] as numeric(19,4)) [OldReserve],
	cast([NewReserve] as numeric(19,4)) [NewReserve] 
From stg.[AH_ListingsReserveHistory_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ListingsReserveHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingsReserveHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingsReserveHistory__dbt_tmp_temp_view"
    end



19:57:12.101674 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:12.101855 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:12.205745 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:12.505223 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.18 seconds
19:57:12.520870 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
19:57:12.521285 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: rename object "dbo"."AH_Listingdecorations__dbt_tmp" to AH_Listingdecorations
19:57:12.555053 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:12.557089 [debug] [Thread-1  ]: On model.Shawn.AH_Listingdecorations: COMMIT
19:57:12.559223 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingdecorations".
19:57:12.559456 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listingdecorations: 
    
  if object_id ('"dbo"."AH_Listingdecorations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listingdecorations__dbt_backup"
    end

19:57:12.606924 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:12.621452 [debug] [Thread-1  ]: finished collecting timing info
19:57:12.621932 [debug] [Thread-1  ]: On model.Shawn.AH_Listingdecorations: Close
19:57:12.622818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8670>]}
19:57:12.623364 [info ] [Thread-1  ]: 56 of 105 OK created table model dbo.AH_Listingdecorations...................... [[32mOK[0m in 2.35s]
19:57:12.624433 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listingdecorations
19:57:12.624712 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Locations
19:57:12.625149 [info ] [Thread-1  ]: 60 of 105 START table model dbo.AH_Locations.................................... [RUN]
19:57:12.626365 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Locations"
19:57:12.626602 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Locations
19:57:12.626790 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Locations
19:57:12.630036 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Locations"
19:57:12.630774 [debug] [Thread-1  ]: finished collecting timing info
19:57:12.631012 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Locations
19:57:12.669685 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Locations"
19:57:12.670499 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
19:57:12.670812 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
  
  if object_id ('"dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Locations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Locations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Locations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Locations__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Description] as nvarchar(4000)) [Description],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([PayToproceed] as bit) [PayToproceed],
	cast([ID] as int) [ID] 
From stg.[AH_Locations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Locations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Locations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Locations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Locations__dbt_tmp_temp_view"
    end



19:57:12.670979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:12.671159 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:12.774788 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:13.474289 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.48 seconds
19:57:13.489220 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
19:57:13.489644 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: rename object "dbo"."AH_Listings__dbt_tmp" to AH_Listings
19:57:13.568019 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
19:57:13.570825 [debug] [Thread-2  ]: On model.Shawn.AH_Listings: COMMIT
19:57:13.574011 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings".
19:57:13.574298 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Listings: 
    
  if object_id ('"dbo"."AH_Listings__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listings__dbt_backup"
    end

19:57:13.611873 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:13.704955 [debug] [Thread-2  ]: finished collecting timing info
19:57:13.705445 [debug] [Thread-2  ]: On model.Shawn.AH_Listings: Close
19:57:13.706271 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c87c0>]}
19:57:13.790391 [info ] [Thread-2  ]: 58 of 105 OK created table model dbo.AH_Listings................................ [[32mOK[0m in 2.76s]
19:57:13.792237 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Listings
19:57:13.792549 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logentries
19:57:13.792988 [info ] [Thread-2  ]: 61 of 105 START table model dbo.AH_Logentries................................... [RUN]
19:57:13.793920 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logentries"
19:57:13.794133 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logentries
19:57:13.794314 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logentries
19:57:13.797684 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logentries"
19:57:13.798433 [debug] [Thread-2  ]: finished collecting timing info
19:57:13.798662 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logentries
19:57:13.836481 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logentries"
19:57:13.837346 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
19:57:13.837597 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
  
  if object_id ('"dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logentries__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Logentries__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Logentries__dbt_tmp"
    end


   EXEC('create view dbo.AH_Logentries__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID],
	cast([SqlDaTestamp] as datetime) [SqlDaTestamp],
	cast([EntryDaTestamp] as datetime) [EntryDaTestamp],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Message] as nvarchar(4000)) [Message],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [Stacktrace],
	cast([Properties] as nvarchar(4000)) [Properties] 
From stg.[AH_Logentries_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Logentries__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Logentries__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Logentries__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logentries__dbt_tmp_temp_view"
    end



19:57:13.837757 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:57:13.837938 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:13.965470 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:14.574521 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
19:57:14.590343 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
19:57:14.590825 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: rename object "dbo"."AH_ListingsReserveHistory__dbt_tmp" to AH_ListingsReserveHistory
19:57:14.648896 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:57:14.650940 [debug] [Thread-3  ]: On model.Shawn.AH_ListingsReserveHistory: COMMIT
19:57:14.653170 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingsReserveHistory".
19:57:14.653458 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingsReserveHistory: 
    
  if object_id ('"dbo"."AH_ListingsReserveHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingsReserveHistory__dbt_backup"
    end

19:57:14.705109 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:14.719634 [debug] [Thread-3  ]: finished collecting timing info
19:57:14.720098 [debug] [Thread-3  ]: On model.Shawn.AH_ListingsReserveHistory: Close
19:57:14.720912 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8a60>]}
19:57:14.721419 [info ] [Thread-3  ]: 59 of 105 OK created table model dbo.AH_ListingsReserveHistory.................. [[32mOK[0m in 2.66s]
19:57:14.722447 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingsReserveHistory
19:57:14.722740 [debug] [Thread-3  ]: Began running node model.Shawn.AH_LogentriesBuffer
19:57:14.723167 [info ] [Thread-3  ]: 62 of 105 START table model dbo.AH_LogentriesBuffer............................. [RUN]
19:57:14.724414 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_LogentriesBuffer"
19:57:14.724624 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_LogentriesBuffer
19:57:14.724797 [debug] [Thread-3  ]: Compiling model.Shawn.AH_LogentriesBuffer
19:57:14.728120 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_LogentriesBuffer"
19:57:14.729519 [debug] [Thread-3  ]: finished collecting timing info
19:57:14.729779 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_LogentriesBuffer
19:57:14.768982 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_LogentriesBuffer"
19:57:14.769844 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
19:57:14.770122 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
  
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LogentriesBuffer__dbt_tmp"
    end


   EXEC('create view dbo.AH_LogentriesBuffer__dbt_tmp_temp_view as
    
Select
	cast([Message] as nvarchar(4000)) [Message],
	cast([Properties] as nvarchar(4000)) [Properties],
	cast([MachineName] as nvarchar(4000)) [MachineName],
	cast([Title] as nvarchar(4000)) [Title],
	cast([FunctionalArea] as nvarchar(4000)) [FunctionalArea],
	cast([Severity] as nvarchar(4000)) [Severity],
	cast([Actor] as nvarchar(4000)) [Actor],
	cast([ExceptionClass] as nvarchar(4000)) [ExceptionClass],
	cast([Stacktrace] as nvarchar(4000)) [Stacktrace],
	cast([SqlDaTestamp] as datetime) [SqlDaTestamp],
	cast([EntryDaTestamp] as datetime) [EntryDaTestamp],
	cast([ID] as int) [ID],
	cast([Priority] as int) [Priority],
	cast([EventID] as int) [EventID] 
From stg.[AH_LogentriesBuffer_FinalView]
    ');

  CREATE TABLE "dbo"."AH_LogentriesBuffer__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LogentriesBuffer__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LogentriesBuffer__dbt_tmp_temp_view"
    end



19:57:14.770299 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:14.770481 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:14.866909 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:14.985481 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.31 seconds
19:57:15.001924 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
19:57:15.002325 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Locations: rename object "dbo"."AH_Locations__dbt_tmp" to AH_Locations
19:57:15.065121 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:57:15.067161 [debug] [Thread-1  ]: On model.Shawn.AH_Locations: COMMIT
19:57:15.069556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Locations".
19:57:15.069791 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Locations: 
    
  if object_id ('"dbo"."AH_Locations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Locations__dbt_backup"
    end

19:57:15.122790 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:15.136249 [debug] [Thread-1  ]: finished collecting timing info
19:57:15.136730 [debug] [Thread-1  ]: On model.Shawn.AH_Locations: Close
19:57:15.137553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc97ec670>]}
19:57:15.138067 [info ] [Thread-1  ]: 60 of 105 OK created table model dbo.AH_Locations............................... [[32mOK[0m in 2.51s]
19:57:15.139158 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Locations
19:57:15.139431 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Logstats
19:57:15.139863 [info ] [Thread-1  ]: 63 of 105 START table model dbo.AH_Logstats..................................... [RUN]
19:57:15.141289 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats"
19:57:15.141500 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Logstats
19:57:15.141676 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Logstats
19:57:15.144816 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Logstats"
19:57:15.145341 [debug] [Thread-1  ]: finished collecting timing info
19:57:15.145539 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Logstats
19:57:15.185172 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats"
19:57:15.186032 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
19:57:15.186285 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
  
  if object_id ('"dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logstats__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Logstats__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Logstats__dbt_tmp"
    end


   EXEC('create view dbo.AH_Logstats__dbt_tmp_temp_view as
    
Select
	cast([FromDate] as datetime) [FromDate],
	cast([RangeMinutes] as int) [RangeMinutes],
	cast([EntryCount] as int) [EntryCount],
	cast([IsArchived] as bit) [IsArchived],
	cast([Severity] as nvarchar(4000)) [Severity] 
From stg.[AH_Logstats_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Logstats__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Logstats__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Logstats__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Logstats__dbt_tmp_temp_view"
    end



19:57:15.186447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:15.186705 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:15.290681 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:17.303836 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
19:57:17.319160 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
19:57:17.319554 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: rename object "dbo"."AH_LogentriesBuffer__dbt_tmp" to AH_LogentriesBuffer
19:57:17.356534 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:17.358648 [debug] [Thread-3  ]: On model.Shawn.AH_LogentriesBuffer: COMMIT
19:57:17.360999 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LogentriesBuffer".
19:57:17.361266 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_LogentriesBuffer: 
    
  if object_id ('"dbo"."AH_LogentriesBuffer__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LogentriesBuffer__dbt_backup"
    end

19:57:17.398628 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:17.411775 [debug] [Thread-3  ]: finished collecting timing info
19:57:17.412220 [debug] [Thread-3  ]: On model.Shawn.AH_LogentriesBuffer: Close
19:57:17.412999 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b60d0>]}
19:57:17.413491 [info ] [Thread-3  ]: 62 of 105 OK created table model dbo.AH_LogentriesBuffer........................ [[32mOK[0m in 2.69s]
19:57:17.414569 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_LogentriesBuffer
19:57:17.414842 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Lots
19:57:17.415253 [info ] [Thread-3  ]: 64 of 105 START table model dbo.AH_Lots......................................... [RUN]
19:57:17.417489 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Lots"
19:57:17.417706 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Lots
19:57:17.417885 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Lots
19:57:17.421376 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Lots"
19:57:17.421920 [debug] [Thread-3  ]: finished collecting timing info
19:57:17.422119 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Lots
19:57:17.459606 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Lots"
19:57:17.460464 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
19:57:17.460757 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
  
  if object_id ('"dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Lots__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Lots__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Lots__dbt_tmp"
    end


   EXEC('create view dbo.AH_Lots__dbt_tmp_temp_view as
    
Select
	cast([LotNumber] as nvarchar(4000)) [LotNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([IsSoftclosing] as bit) [IsSoftclosing],
	cast([SoftclosingGroup] as int) [SoftclosingGroup],
	cast([LotOrder] as int) [LotOrder],
	cast([AuctionEventID] as int) [AuctionEventID],
	cast([ID] as int) [ID],
	cast([ClosingGroup] as int) [ClosingGroup],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Lots_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Lots__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Lots__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Lots__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Lots__dbt_tmp_temp_view"
    end



19:57:17.460935 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:17.461122 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:17.573580 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:18.227218 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.04 seconds
19:57:18.241517 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
19:57:18.241914 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Logstats: rename object "dbo"."AH_Logstats__dbt_tmp" to AH_Logstats
19:57:18.280292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:18.282215 [debug] [Thread-1  ]: On model.Shawn.AH_Logstats: COMMIT
19:57:18.284409 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats".
19:57:18.284644 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Logstats: 
    
  if object_id ('"dbo"."AH_Logstats__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Logstats__dbt_backup"
    end

19:57:18.344334 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:57:18.357413 [debug] [Thread-1  ]: finished collecting timing info
19:57:18.357881 [debug] [Thread-1  ]: On model.Shawn.AH_Logstats: Close
19:57:18.358731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b6130>]}
19:57:18.359229 [info ] [Thread-1  ]: 63 of 105 OK created table model dbo.AH_Logstats................................ [[32mOK[0m in 3.22s]
19:57:18.361041 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Logstats
19:57:18.361614 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Media
19:57:18.362429 [info ] [Thread-1  ]: 65 of 105 START table model dbo.AH_Media........................................ [RUN]
19:57:18.363399 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Media"
19:57:18.363649 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Media
19:57:18.363842 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Media
19:57:18.369150 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Media"
19:57:18.369707 [debug] [Thread-1  ]: finished collecting timing info
19:57:18.369917 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Media
19:57:18.407142 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Media"
19:57:18.407994 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
19:57:18.408286 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Media: 
  
  if object_id ('"dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Media__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Media__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Media__dbt_tmp"
    end


   EXEC('create view dbo.AH_Media__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created_RWXMedia],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMedia],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMedia],
	cast([ID] as int) [MediaID],
	cast([GUID] as uniqueidentifier) [GUID],
	cast([DefaultvariationName] as nvarchar(500)) [DefaultVariationName],
	cast([Loader] as nvarchar(500)) [Loader],
	cast([Saver] as nvarchar(500)) [Saver],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser],
	cast([ConText] as nvarchar(4000)) [Context],
	cast([Status] as nvarchar(100)) [Status] 
From stg.[AH_Media_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Media__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Media__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Media__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Media__dbt_tmp_temp_view"
    end



19:57:18.408460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:18.408641 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:18.520212 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:19.672184 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.83 seconds
19:57:19.687724 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
19:57:19.688101 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: rename object "dbo"."AH_Logentries__dbt_tmp" to AH_Logentries
19:57:19.723814 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:19.725873 [debug] [Thread-2  ]: On model.Shawn.AH_Logentries: COMMIT
19:57:19.728165 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logentries".
19:57:19.728406 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logentries: 
    
  if object_id ('"dbo"."AH_Logentries__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Logentries__dbt_backup"
    end

19:57:19.781121 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:57:19.794517 [debug] [Thread-2  ]: finished collecting timing info
19:57:19.794981 [debug] [Thread-2  ]: On model.Shawn.AH_Logentries: Close
19:57:19.795809 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85f8b80>]}
19:57:19.796324 [info ] [Thread-2  ]: 61 of 105 OK created table model dbo.AH_Logentries.............................. [[32mOK[0m in 6.00s]
19:57:19.797385 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logentries
19:57:19.797654 [debug] [Thread-2  ]: Began running node model.Shawn.AH_MediaMetaData
19:57:19.798083 [info ] [Thread-2  ]: 66 of 105 START table model dbo.AH_MediaMetaData................................ [RUN]
19:57:19.799405 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_MediaMetaData"
19:57:19.799616 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_MediaMetaData
19:57:19.799788 [debug] [Thread-2  ]: Compiling model.Shawn.AH_MediaMetaData
19:57:19.803020 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_MediaMetaData"
19:57:19.804479 [debug] [Thread-2  ]: finished collecting timing info
19:57:19.804741 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_MediaMetaData
19:57:19.843992 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_MediaMetaData"
19:57:19.844836 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
19:57:19.845082 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
  
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_MediaMetaData__dbt_tmp"
    end


   EXEC('create view dbo.AH_MediaMetaData__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(500)) [Name_RWXMediaMetaData],
	cast([Value] as nvarchar(4000)) [Value],
	cast([ID] as int) [MediaMetaDataID_RWXMediaMetaData],
	cast([CreatedOn] as datetime) [Created_RWXMediaMetaData],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaMetaData],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaMetaData] 
From stg.[AH_MediaMetaData_FinalView]
    ');

  CREATE TABLE "dbo"."AH_MediaMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_MediaMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_MediaMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaMetaData__dbt_tmp_temp_view"
    end



19:57:19.845255 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:57:19.845479 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:19.944809 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:20.780632 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.32 seconds
19:57:20.880464 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
19:57:20.880902 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Lots: rename object "dbo"."AH_Lots__dbt_tmp" to AH_Lots
19:57:20.914433 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:20.916481 [debug] [Thread-3  ]: On model.Shawn.AH_Lots: COMMIT
19:57:20.918790 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Lots".
19:57:20.919024 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Lots: 
    
  if object_id ('"dbo"."AH_Lots__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Lots__dbt_backup"
    end

19:57:20.956467 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:20.969676 [debug] [Thread-3  ]: finished collecting timing info
19:57:20.970194 [debug] [Thread-3  ]: On model.Shawn.AH_Lots: Close
19:57:20.971109 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc983edf0>]}
19:57:20.971669 [info ] [Thread-3  ]: 64 of 105 OK created table model dbo.AH_Lots.................................... [[32mOK[0m in 3.55s]
19:57:20.972779 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Lots
19:57:20.973060 [debug] [Thread-3  ]: Began running node model.Shawn.AH_MediaassetMetaData
19:57:20.973495 [info ] [Thread-3  ]: 67 of 105 START table model dbo.AH_MediaassetMetaData........................... [RUN]
19:57:20.974800 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_MediaassetMetaData"
19:57:20.975013 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_MediaassetMetaData
19:57:20.975189 [debug] [Thread-3  ]: Compiling model.Shawn.AH_MediaassetMetaData
19:57:20.978439 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_MediaassetMetaData"
19:57:20.979134 [debug] [Thread-3  ]: finished collecting timing info
19:57:20.979335 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_MediaassetMetaData
19:57:21.022327 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_MediaassetMetaData"
19:57:21.023108 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
19:57:21.023383 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
  
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_MediaassetMetaData__dbt_tmp"
    end


   EXEC('create view dbo.AH_MediaassetMetaData__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID_RWXMediaAssetMetaData],
	cast([MediaassetID] as int) [MediaAssetID],
	cast([MediaMetaDataID] as int) [MediaMetaDataID_RWXMediaAssetMetaData],
	cast([CreatedOn] as datetime) [Created_RWXMediaAssetMetaData],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaAssetMetaData],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaAssetMetaData] 
From stg.[AH_MediaassetMetaData_FinalView]
    ');

  CREATE TABLE "dbo"."AH_MediaassetMetaData__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_MediaassetMetaData__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_MediaassetMetaData__dbt_tmp_temp_view"
    end



19:57:21.023568 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:21.023751 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:21.122716 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:30.988702 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.97 seconds
19:57:31.004261 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
19:57:31.004701 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: rename object "dbo"."AH_MediaassetMetaData__dbt_tmp" to AH_MediaassetMetaData
19:57:31.037925 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:57:31.039978 [debug] [Thread-3  ]: On model.Shawn.AH_MediaassetMetaData: COMMIT
19:57:31.042219 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaassetMetaData".
19:57:31.042502 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_MediaassetMetaData: 
    
  if object_id ('"dbo"."AH_MediaassetMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_MediaassetMetaData__dbt_backup"
    end

19:57:31.079929 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:31.094263 [debug] [Thread-3  ]: finished collecting timing info
19:57:31.094829 [debug] [Thread-3  ]: On model.Shawn.AH_MediaassetMetaData: Close
19:57:31.095702 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9803e20>]}
19:57:31.096235 [info ] [Thread-3  ]: 67 of 105 OK created table model dbo.AH_MediaassetMetaData...................... [[32mOK[0m in 10.12s]
19:57:31.097539 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_MediaassetMetaData
19:57:31.097823 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Mediaassets
19:57:31.098276 [info ] [Thread-3  ]: 68 of 105 START table model dbo.AH_Mediaassets.................................. [RUN]
19:57:31.099744 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Mediaassets"
19:57:31.099961 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Mediaassets
19:57:31.100141 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Mediaassets
19:57:31.103941 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Mediaassets"
19:57:31.104547 [debug] [Thread-3  ]: finished collecting timing info
19:57:31.104807 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Mediaassets
19:57:31.143923 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Mediaassets"
19:57:31.144811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
19:57:31.145110 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
  
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Mediaassets__dbt_tmp"
    end


   EXEC('create view dbo.AH_Mediaassets__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created_RWXMediaAssets],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaAssets],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaAssets],
	cast([DaTestamp] as datetime) [DateStamp],
	cast([ID] as int) [MediaAssetID_RWX_MediaAssets],
	cast([Type] as nvarchar(500)) [Type],
	cast([Reference] as nvarchar(4000)) [Reference],
	cast([Sha1] as nvarchar(4000)) [Sha1] 
From stg.[AH_Mediaassets_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Mediaassets__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Mediaassets__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Mediaassets__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediaassets__dbt_tmp_temp_view"
    end



19:57:31.145288 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:57:31.145471 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:31.263718 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:57:55.905630 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 37.50 seconds
19:57:55.920380 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
19:57:55.920799 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Media: rename object "dbo"."AH_Media__dbt_tmp" to AH_Media
19:57:55.989973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:57:55.991949 [debug] [Thread-1  ]: On model.Shawn.AH_Media: COMMIT
19:57:55.994119 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Media".
19:57:55.994353 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Media: 
    
  if object_id ('"dbo"."AH_Media__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Media__dbt_backup"
    end

19:57:56.033198 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:57:56.046571 [debug] [Thread-1  ]: finished collecting timing info
19:57:56.047093 [debug] [Thread-1  ]: On model.Shawn.AH_Media: Close
19:57:56.047936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b6520>]}
19:57:56.048488 [info ] [Thread-1  ]: 65 of 105 OK created table model dbo.AH_Media................................... [[32mOK[0m in 37.68s]
19:57:56.049673 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Media
19:57:56.049951 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Mediavariations
19:57:56.050407 [info ] [Thread-1  ]: 69 of 105 START table model dbo.AH_Mediavariations.............................. [RUN]
19:57:56.051812 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Mediavariations"
19:57:56.052028 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Mediavariations
19:57:56.052208 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Mediavariations
19:57:56.055552 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Mediavariations"
19:57:56.056353 [debug] [Thread-1  ]: finished collecting timing info
19:57:56.056595 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Mediavariations
19:57:56.094934 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Mediavariations"
19:57:56.095845 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
19:57:56.096125 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
  
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Mediavariations__dbt_tmp"
    end


   EXEC('create view dbo.AH_Mediavariations__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created_RWXMediaVariations],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXMediaVariations],
	cast([DeletedOn] as datetime) [DeletedDate_RWXMediaVariations],
	cast([ID] as int) [ID],
	cast([MediaassetID] as int) [MediaAssetID_RWX_MediaVariations],
	cast([MediaID] as int) [MediaID],
	cast([Name] as nvarchar(500)) [Name_RWXMediaVariations] 
From stg.[AH_Mediavariations_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Mediavariations__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Mediavariations__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Mediavariations__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Mediavariations__dbt_tmp_temp_view"
    end



19:57:56.096314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:57:56.096503 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:57:56.211295 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:10.609853 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 14.51 seconds
19:58:10.624339 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
19:58:10.624745 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: rename object "dbo"."AH_Mediavariations__dbt_tmp" to AH_Mediavariations
19:58:10.694378 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
19:58:10.696470 [debug] [Thread-1  ]: On model.Shawn.AH_Mediavariations: COMMIT
19:58:10.698730 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediavariations".
19:58:10.698997 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Mediavariations: 
    
  if object_id ('"dbo"."AH_Mediavariations__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Mediavariations__dbt_backup"
    end

19:58:10.745619 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:58:10.758470 [debug] [Thread-1  ]: finished collecting timing info
19:58:10.758962 [debug] [Thread-1  ]: On model.Shawn.AH_Mediavariations: Close
19:58:10.759758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b67c0>]}
19:58:10.760253 [info ] [Thread-1  ]: 69 of 105 OK created table model dbo.AH_Mediavariations......................... [[32mOK[0m in 14.71s]
19:58:10.761385 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Mediavariations
19:58:10.761647 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Model
19:58:10.762055 [info ] [Thread-1  ]: 70 of 105 START table model dbo.AH_Model........................................ [RUN]
19:58:10.763443 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Model"
19:58:10.763656 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Model
19:58:10.763830 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Model
19:58:10.767094 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Model"
19:58:10.767863 [debug] [Thread-1  ]: finished collecting timing info
19:58:10.768108 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Model
19:58:10.805958 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Model"
19:58:10.806858 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
19:58:10.807103 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Model: 
  
  if object_id ('"dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Model__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Model__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Model__dbt_tmp"
    end


   EXEC('create view dbo.AH_Model__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_Model_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Model__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Model__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Model__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Model__dbt_tmp_temp_view"
    end



19:58:10.807324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:10.807510 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:10.925720 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:13.152163 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.34 seconds
19:58:13.167185 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
19:58:13.167632 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Model: rename object "dbo"."AH_Model__dbt_tmp" to AH_Model
19:58:13.200133 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:13.202215 [debug] [Thread-1  ]: On model.Shawn.AH_Model: COMMIT
19:58:13.204578 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Model".
19:58:13.204834 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Model: 
    
  if object_id ('"dbo"."AH_Model__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Model__dbt_backup"
    end

19:58:13.242020 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:13.255631 [debug] [Thread-1  ]: finished collecting timing info
19:58:13.256117 [debug] [Thread-1  ]: On model.Shawn.AH_Model: Close
19:58:13.256956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b6d00>]}
19:58:13.257473 [info ] [Thread-1  ]: 70 of 105 OK created table model dbo.AH_Model................................... [[32mOK[0m in 2.49s]
19:58:13.258624 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Model
19:58:13.258895 [debug] [Thread-1  ]: Began running node model.Shawn.AH_NewSalestoInvoice
19:58:13.259315 [info ] [Thread-1  ]: 71 of 105 START table model dbo.AH_NewSalestoInvoice............................ [RUN]
19:58:13.260623 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_NewSalestoInvoice"
19:58:13.260833 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_NewSalestoInvoice
19:58:13.261007 [debug] [Thread-1  ]: Compiling model.Shawn.AH_NewSalestoInvoice
19:58:13.264270 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_NewSalestoInvoice"
19:58:13.265042 [debug] [Thread-1  ]: finished collecting timing info
19:58:13.265284 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_NewSalestoInvoice
19:58:13.303037 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_NewSalestoInvoice"
19:58:13.303890 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
19:58:13.304173 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
  
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_NewSalestoInvoice__dbt_tmp"
    end


   EXEC('create view dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view as
    
Select
	cast([LineItemID] as int) [LineItemID] 
From stg.[AH_NewSalestoInvoice_FinalView]
    ');

  CREATE TABLE "dbo"."AH_NewSalestoInvoice__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_NewSalestoInvoice__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_NewSalestoInvoice__dbt_tmp_temp_view"
    end



19:58:13.304355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:13.304540 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:13.417527 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:16.911401 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.61 seconds
19:58:16.926421 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
19:58:16.926869 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: rename object "dbo"."AH_NewSalestoInvoice__dbt_tmp" to AH_NewSalestoInvoice
19:58:16.963270 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:16.965331 [debug] [Thread-1  ]: On model.Shawn.AH_NewSalestoInvoice: COMMIT
19:58:16.967640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_NewSalestoInvoice".
19:58:16.967889 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_NewSalestoInvoice: 
    
  if object_id ('"dbo"."AH_NewSalestoInvoice__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_NewSalestoInvoice__dbt_backup"
    end

19:58:17.006038 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:17.019036 [debug] [Thread-1  ]: finished collecting timing info
19:58:17.019500 [debug] [Thread-1  ]: On model.Shawn.AH_NewSalestoInvoice: Close
19:58:17.020321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b6e50>]}
19:58:17.020836 [info ] [Thread-1  ]: 71 of 105 OK created table model dbo.AH_NewSalestoInvoice....................... [[32mOK[0m in 3.76s]
19:58:17.022267 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_NewSalestoInvoice
19:58:17.022581 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Notifications
19:58:17.023024 [info ] [Thread-1  ]: 72 of 105 START table model dbo.AH_Notifications................................ [RUN]
19:58:17.023946 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Notifications"
19:58:17.024155 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Notifications
19:58:17.024330 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Notifications
19:58:17.027647 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Notifications"
19:58:17.028389 [debug] [Thread-1  ]: finished collecting timing info
19:58:17.028628 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Notifications
19:58:17.065065 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Notifications"
19:58:17.065921 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
19:58:17.066206 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
  
  if object_id ('"dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Notifications__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Notifications__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Notifications__dbt_tmp"
    end


   EXEC('create view dbo.AH_Notifications__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([DetailID] as int) [DetailID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Queueddttm] as datetime) [Queueddttm],
	cast([Statusdttm] as datetime) [Statusdttm],
	cast([RecipientEmail] as nvarchar(4000)) [RecipientEmail],
	cast([CcEmail] as nvarchar(4000)) [CcEmail],
	cast([BCcEmail] as nvarchar(4000)) [BCcEmail],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Status] as nvarchar(4000)) [Status],
	cast([StatusMessage] as nvarchar(4000)) [StatusMessage],
	cast([Message] as nvarchar(4000)) [Message],
	cast([DetailType] as nvarchar(4000)) [DetailType],
	cast([ReplytoEmail] as nvarchar(4000)) [ReplytoEmail],
	cast([SEnderUserName] as nvarchar(4000)) [SEnderUserName],
	cast([ReceiverUserName] as nvarchar(4000)) [ReceiverUserName],
	cast([Template] as nvarchar(4000)) [Template] 
From stg.[AH_Notifications_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Notifications__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Notifications__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Notifications__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Notifications__dbt_tmp_temp_view"
    end



19:58:17.066381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:17.066588 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:17.164640 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:20.410400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.34 seconds
19:58:20.425269 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
19:58:20.425687 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Notifications: rename object "dbo"."AH_Notifications__dbt_tmp" to AH_Notifications
19:58:20.459054 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:20.461097 [debug] [Thread-1  ]: On model.Shawn.AH_Notifications: COMMIT
19:58:20.463477 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Notifications".
19:58:20.463948 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Notifications: 
    
  if object_id ('"dbo"."AH_Notifications__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Notifications__dbt_backup"
    end

19:58:20.505066 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:20.518160 [debug] [Thread-1  ]: finished collecting timing info
19:58:20.518763 [debug] [Thread-1  ]: On model.Shawn.AH_Notifications: Close
19:58:20.519642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98990d0>]}
19:58:20.520496 [info ] [Thread-1  ]: 72 of 105 OK created table model dbo.AH_Notifications........................... [[32mOK[0m in 3.50s]
19:58:20.521552 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Notifications
19:58:20.521820 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Offers
19:58:20.522239 [info ] [Thread-1  ]: 73 of 105 START table model dbo.AH_Offers....................................... [RUN]
19:58:20.523511 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Offers"
19:58:20.523724 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Offers
19:58:20.523899 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Offers
19:58:20.527303 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Offers"
19:58:20.527998 [debug] [Thread-1  ]: finished collecting timing info
19:58:20.528237 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Offers
19:58:20.565484 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Offers"
19:58:20.566372 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
19:58:20.566716 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
  
  if object_id ('"dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Offers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Offers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Offers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Offers__dbt_tmp_temp_view as
    
Select
	cast([Amount] as numeric(19,4)) [Amount],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([OfferMessage] as nvarchar(4000)) [OfferMessage],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DecLineMessage] as nvarchar(4000)) [DecLineMessage],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Expirationdttm] as datetime) [Expirationdttm],
	cast([ID] as int) [ID],
	cast([SEndingUserID] as int) [SEndingUserID],
	cast([ReceivINgUserID] as int) [ReceivINgUserID],
	cast([BuyerID] as int) [BuyerID],
	cast([Quantity] as int) [Quantity],
	cast([ListingID] as int) [ListingID] 
From stg.[AH_Offers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Offers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Offers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Offers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Offers__dbt_tmp_temp_view"
    end



19:58:20.566898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:20.567084 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:20.681291 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:23.075972 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.51 seconds
19:58:23.091566 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
19:58:23.092001 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Offers: rename object "dbo"."AH_Offers__dbt_tmp" to AH_Offers
19:58:23.125308 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:23.127392 [debug] [Thread-1  ]: On model.Shawn.AH_Offers: COMMIT
19:58:23.129478 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Offers".
19:58:23.129702 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Offers: 
    
  if object_id ('"dbo"."AH_Offers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Offers__dbt_backup"
    end

19:58:23.166802 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:23.179744 [debug] [Thread-1  ]: finished collecting timing info
19:58:23.180237 [debug] [Thread-1  ]: On model.Shawn.AH_Offers: Close
19:58:23.181074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899130>]}
19:58:23.181600 [info ] [Thread-1  ]: 73 of 105 OK created table model dbo.AH_Offers.................................. [[32mOK[0m in 2.66s]
19:58:23.182765 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Offers
19:58:23.183030 [debug] [Thread-1  ]: Began running node model.Shawn.AH_PaymentConfigurationTable
19:58:23.183446 [info ] [Thread-1  ]: 74 of 105 START table model dbo.AH_PaymentConfigurationTable.................... [RUN]
19:58:23.184701 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentConfigurationTable"
19:58:23.184914 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_PaymentConfigurationTable
19:58:23.185096 [debug] [Thread-1  ]: Compiling model.Shawn.AH_PaymentConfigurationTable
19:58:23.188484 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_PaymentConfigurationTable"
19:58:23.189240 [debug] [Thread-1  ]: finished collecting timing info
19:58:23.189483 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_PaymentConfigurationTable
19:58:23.227166 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentConfigurationTable"
19:58:23.228032 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
19:58:23.228327 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
  
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Active] as bit) [Active],
	cast([MinimumBidHold] as numeric(19,4)) [MinimumBidHold],
	cast([BasicplanPrice] as numeric(19,4)) [BasicplanPrice],
	cast([ProPhotographyPrice] as numeric(19,4)) [ProPhotographyPrice],
	cast([ProMarketingPrice] as numeric(19,4)) [ProMarketingPrice],
	cast([Minfraudscore] as numeric(19,4)) [Minfraudscore],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([MaximumBidCharge] as numeric(19,4)) [MaximumBidCharge],
	cast([BidHoldPercentage] as numeric(19,4)) [BidHoldPercentage] 
From stg.[AH_PaymentConfigurationTable_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentConfigurationTable__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentConfigurationTable__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentConfigurationTable__dbt_tmp_temp_view"
    end



19:58:23.228492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:23.228671 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:23.326333 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:25.818030 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.59 seconds
19:58:25.832699 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
19:58:25.833129 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: rename object "dbo"."AH_PaymentConfigurationTable__dbt_tmp" to AH_PaymentConfigurationTable
19:58:25.868254 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:25.870337 [debug] [Thread-1  ]: On model.Shawn.AH_PaymentConfigurationTable: COMMIT
19:58:25.872472 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentConfigurationTable".
19:58:25.872687 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentConfigurationTable: 
    
  if object_id ('"dbo"."AH_PaymentConfigurationTable__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentConfigurationTable__dbt_backup"
    end

19:58:25.909841 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:25.922997 [debug] [Thread-1  ]: finished collecting timing info
19:58:25.923483 [debug] [Thread-1  ]: On model.Shawn.AH_PaymentConfigurationTable: Close
19:58:25.924313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899280>]}
19:58:25.924845 [info ] [Thread-1  ]: 74 of 105 OK created table model dbo.AH_PaymentConfigurationTable............... [[32mOK[0m in 2.74s]
19:58:25.926212 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_PaymentConfigurationTable
19:58:25.926504 [debug] [Thread-1  ]: Began running node model.Shawn.AH_PaymentResponses
19:58:25.926994 [info ] [Thread-1  ]: 75 of 105 START table model dbo.AH_PaymentResponses............................. [RUN]
19:58:25.928011 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentResponses"
19:58:25.928222 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_PaymentResponses
19:58:25.928398 [debug] [Thread-1  ]: Compiling model.Shawn.AH_PaymentResponses
19:58:25.932077 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_PaymentResponses"
19:58:25.932656 [debug] [Thread-1  ]: finished collecting timing info
19:58:25.932907 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_PaymentResponses
19:58:25.971198 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentResponses"
19:58:25.972079 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
19:58:25.972327 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
  
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentResponses__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentResponses__dbt_tmp_temp_view as
    
Select
	cast([Approved] as bit) [Approved],
	cast([ID] as int) [ID],
	cast([InvoiceID] as int) [InvoiceID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([Amount] as numeric(19,4)) [Amount],
	cast([AuthorizationCode] as nvarchar(4000)) [AuthorizationCode],
	cast([AvsResponseCode] as nvarchar(4000)) [AvsResponseCode],
	cast([Cvv2ResponseCode] as nvarchar(4000)) [Cvv2ResponseCode],
	cast([CavResponseCode] as nvarchar(4000)) [CavResponseCode],
	cast([BuyerStreet] as nvarchar(4000)) [BuyerStreet],
	cast([BuyerCity] as nvarchar(4000)) [BuyerCity],
	cast([ResponseStatus] as nvarchar(4000)) [ResponseStatus],
	cast([ProvIDEr] as nvarchar(4000)) [ProvIDEr],
	cast([RawResponseCode] as nvarchar(4000)) [RawResponseCode],
	cast([Description] as nvarchar(4000)) [Description],
	cast([TransactionID] as nvarchar(4000)) [TransactionID],
	cast([Method] as nvarchar(4000)) [Method],
	cast([BuyerStateregion] as nvarchar(4000)) [BuyerStateregion],
	cast([BuyerzipPostal] as nvarchar(4000)) [BuyerzipPostal],
	cast([BuyerEmail] as nvarchar(4000)) [BuyerEmail],
	cast([AllFields] as nvarchar(4000)) [AllFields],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_PaymentResponses_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentResponses__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentResponses__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentResponses__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentResponses__dbt_tmp_temp_view"
    end



19:58:25.972540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:25.972723 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:26.092017 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:28.526587 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.55 seconds
19:58:28.542657 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
19:58:28.543085 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: rename object "dbo"."AH_PaymentResponses__dbt_tmp" to AH_PaymentResponses
19:58:28.576729 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:28.578836 [debug] [Thread-1  ]: On model.Shawn.AH_PaymentResponses: COMMIT
19:58:28.581137 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentResponses".
19:58:28.581420 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentResponses: 
    
  if object_id ('"dbo"."AH_PaymentResponses__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentResponses__dbt_backup"
    end

19:58:28.618698 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:28.632499 [debug] [Thread-1  ]: finished collecting timing info
19:58:28.633028 [debug] [Thread-1  ]: On model.Shawn.AH_PaymentResponses: Close
19:58:28.633942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98993d0>]}
19:58:28.634510 [info ] [Thread-1  ]: 75 of 105 OK created table model dbo.AH_PaymentResponses........................ [[32mOK[0m in 2.71s]
19:58:28.635738 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_PaymentResponses
19:58:28.636022 [debug] [Thread-1  ]: Began running node model.Shawn.AH_PaymentprovIDErs
19:58:28.636464 [info ] [Thread-1  ]: 76 of 105 START table model dbo.AH_PaymentprovIDErs............................. [RUN]
19:58:28.637904 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_PaymentprovIDErs"
19:58:28.638118 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_PaymentprovIDErs
19:58:28.638296 [debug] [Thread-1  ]: Compiling model.Shawn.AH_PaymentprovIDErs
19:58:28.642168 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_PaymentprovIDErs"
19:58:28.642844 [debug] [Thread-1  ]: finished collecting timing info
19:58:28.643112 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_PaymentprovIDErs
19:58:28.682384 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_PaymentprovIDErs"
19:58:28.684027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
19:58:28.684332 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
  
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PaymentprovIDErs__dbt_tmp"
    end


   EXEC('create view dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([Batchcapable] as bit) [Batchcapable],
	cast([ID] as int) [ID] 
From stg.[AH_PaymentprovIDErs_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PaymentprovIDErs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PaymentprovIDErs__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PaymentprovIDErs__dbt_tmp_temp_view"
    end



19:58:28.684502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:28.684694 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:28.803696 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:31.135404 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
19:58:31.151845 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
19:58:31.152306 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: rename object "dbo"."AH_PaymentprovIDErs__dbt_tmp" to AH_PaymentprovIDErs
19:58:31.185356 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:31.187506 [debug] [Thread-1  ]: On model.Shawn.AH_PaymentprovIDErs: COMMIT
19:58:31.189885 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PaymentprovIDErs".
19:58:31.190197 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PaymentprovIDErs: 
    
  if object_id ('"dbo"."AH_PaymentprovIDErs__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PaymentprovIDErs__dbt_backup"
    end

19:58:31.227207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:31.241759 [debug] [Thread-1  ]: finished collecting timing info
19:58:31.242267 [debug] [Thread-1  ]: On model.Shawn.AH_PaymentprovIDErs: Close
19:58:31.243158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899520>]}
19:58:31.243673 [info ] [Thread-1  ]: 76 of 105 OK created table model dbo.AH_PaymentprovIDErs........................ [[32mOK[0m in 2.61s]
19:58:31.244751 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_PaymentprovIDErs
19:58:31.245017 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Properties
19:58:31.245432 [info ] [Thread-1  ]: 77 of 105 START table model dbo.AH_Properties................................... [RUN]
19:58:31.246706 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Properties"
19:58:31.246925 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Properties
19:58:31.247098 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Properties
19:58:31.250497 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Properties"
19:58:31.251353 [debug] [Thread-1  ]: finished collecting timing info
19:58:31.251618 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Properties
19:58:31.290210 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Properties"
19:58:31.291113 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
19:58:31.291355 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
  
  if object_id ('"dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Properties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Properties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Properties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Properties__dbt_tmp_temp_view as
    
Select
	cast([Value] as nvarchar(4000)) [Value],
	cast([Name] as nvarchar(4000)) [Name],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([LineItemID] as int) [LineItemID] 
From stg.[AH_Properties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Properties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Properties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Properties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Properties__dbt_tmp_temp_view"
    end



19:58:31.291515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:31.291692 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:31.405919 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:33.720904 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.43 seconds
19:58:33.736002 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
19:58:33.736455 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Properties: rename object "dbo"."AH_Properties__dbt_tmp" to AH_Properties
19:58:33.770656 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:33.772761 [debug] [Thread-1  ]: On model.Shawn.AH_Properties: COMMIT
19:58:33.775194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Properties".
19:58:33.775517 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Properties: 
    
  if object_id ('"dbo"."AH_Properties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Properties__dbt_backup"
    end

19:58:33.812832 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:33.826990 [debug] [Thread-1  ]: finished collecting timing info
19:58:33.827497 [debug] [Thread-1  ]: On model.Shawn.AH_Properties: Close
19:58:33.828375 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899670>]}
19:58:33.828923 [info ] [Thread-1  ]: 77 of 105 OK created table model dbo.AH_Properties.............................. [[32mOK[0m in 2.58s]
19:58:33.830071 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Properties
19:58:33.830346 [debug] [Thread-1  ]: Began running node model.Shawn.AH_PropertybagItems
19:58:33.830828 [info ] [Thread-1  ]: 78 of 105 START table model dbo.AH_PropertybagItems............................. [RUN]
19:58:33.832265 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_PropertybagItems"
19:58:33.832479 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_PropertybagItems
19:58:33.832656 [debug] [Thread-1  ]: Compiling model.Shawn.AH_PropertybagItems
19:58:33.836362 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_PropertybagItems"
19:58:33.836953 [debug] [Thread-1  ]: finished collecting timing info
19:58:33.837203 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_PropertybagItems
19:58:33.876562 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_PropertybagItems"
19:58:33.877434 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
19:58:33.877680 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
  
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_PropertybagItems__dbt_tmp"
    end


   EXEC('create view dbo.AH_PropertybagItems__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([PropertybagID] as int) [PropertybagID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name],
	cast([Value] as nvarchar(4000)) [Value] 
From stg.[AH_PropertybagItems_FinalView]
    ');

  CREATE TABLE "dbo"."AH_PropertybagItems__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_PropertybagItems__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_PropertybagItems__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_PropertybagItems__dbt_tmp_temp_view"
    end



19:58:33.877892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:33.878075 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:33.998758 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:36.287439 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.41 seconds
19:58:36.304092 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
19:58:36.304554 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: rename object "dbo"."AH_PropertybagItems__dbt_tmp" to AH_PropertybagItems
19:58:36.337973 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:36.340155 [debug] [Thread-1  ]: On model.Shawn.AH_PropertybagItems: COMMIT
19:58:36.342651 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_PropertybagItems".
19:58:36.342970 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_PropertybagItems: 
    
  if object_id ('"dbo"."AH_PropertybagItems__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_PropertybagItems__dbt_backup"
    end

19:58:36.378894 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:36.393665 [debug] [Thread-1  ]: finished collecting timing info
19:58:36.394178 [debug] [Thread-1  ]: On model.Shawn.AH_PropertybagItems: Close
19:58:36.395091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98997c0>]}
19:58:36.395629 [info ] [Thread-1  ]: 78 of 105 OK created table model dbo.AH_PropertybagItems........................ [[32mOK[0m in 2.56s]
19:58:36.396751 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_PropertybagItems
19:58:36.397019 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Propertybags
19:58:36.397450 [info ] [Thread-1  ]: 79 of 105 START table model dbo.AH_Propertybags................................. [RUN]
19:58:36.398819 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Propertybags"
19:58:36.399033 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Propertybags
19:58:36.399209 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Propertybags
19:58:36.402834 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Propertybags"
19:58:36.403469 [debug] [Thread-1  ]: finished collecting timing info
19:58:36.403729 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Propertybags
19:58:36.443476 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Propertybags"
19:58:36.444374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
19:58:36.444680 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
  
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Propertybags__dbt_tmp"
    end


   EXEC('create view dbo.AH_Propertybags__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID] 
From stg.[AH_Propertybags_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Propertybags__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Propertybags__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Propertybags__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Propertybags__dbt_tmp_temp_view"
    end



19:58:36.444852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:36.445037 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:36.558987 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:38.930018 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.49 seconds
19:58:38.946019 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
19:58:38.946455 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: rename object "dbo"."AH_Propertybags__dbt_tmp" to AH_Propertybags
19:58:38.979692 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:38.981816 [debug] [Thread-1  ]: On model.Shawn.AH_Propertybags: COMMIT
19:58:38.984388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Propertybags".
19:58:38.984796 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Propertybags: 
    
  if object_id ('"dbo"."AH_Propertybags__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Propertybags__dbt_backup"
    end

19:58:39.021880 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:39.036415 [debug] [Thread-1  ]: finished collecting timing info
19:58:39.036932 [debug] [Thread-1  ]: On model.Shawn.AH_Propertybags: Close
19:58:39.037808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899910>]}
19:58:39.038338 [info ] [Thread-1  ]: 79 of 105 OK created table model dbo.AH_Propertybags............................ [[32mOK[0m in 2.64s]
19:58:39.040472 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Propertybags
19:58:39.040780 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ReListHistory
19:58:39.041249 [info ] [Thread-1  ]: 80 of 105 START table model dbo.AH_ReListHistory................................ [RUN]
19:58:39.042340 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ReListHistory"
19:58:39.042592 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ReListHistory
19:58:39.042783 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ReListHistory
19:58:39.046729 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ReListHistory"
19:58:39.047382 [debug] [Thread-1  ]: finished collecting timing info
19:58:39.047608 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ReListHistory
19:58:39.087345 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ReListHistory"
19:58:39.088260 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
19:58:39.088572 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
  
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ReListHistory__dbt_tmp"
    end


   EXEC('create view dbo.AH_ReListHistory__dbt_tmp_temp_view as
    
Select
	cast([CurrentPrice_Old] as numeric(19,4)) [CurrentPrice_Old],
	cast([CurrentPrice_New] as numeric(19,4)) [CurrentPrice_New],
	cast([ReservePrice] as numeric(19,4)) [ReservePrice],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([NewreListiteration] as int) [NewreListiteration],
	cast([Duration_Old] as int) [Duration_Old],
	cast([Duration_New] as int) [Duration_New],
	cast([HighBidderID] as int) [HighBidderID],
	cast([BidCount] as int) [BidCount],
	cast([Startdttm_New] as datetime) [Startdttm_New],
	cast([Enddttm_Old] as datetime) [Enddttm_Old],
	cast([Enddttm_New] as datetime) [Enddttm_New],
	cast([ReListdttm] as datetime) [ReListdttm],
	cast([Startdttm_Old] as datetime) [Startdttm_Old],
	cast([MaxBidAmount] as numeric(19,4)) [MaxBidAmount],
	cast([ProxyBidAmount] as numeric(19,4)) [ProxyBidAmount],
	cast([BidIncrement] as numeric(19,4)) [BidIncrement],
	cast([ListingTitle] as nvarchar(4000)) [ListingTitle] 
From stg.[AH_ReListHistory_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ReListHistory__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ReListHistory__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ReListHistory__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ReListHistory__dbt_tmp_temp_view"
    end



19:58:39.088738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:39.088923 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:39.201502 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:41.535894 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
19:58:41.552184 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
19:58:41.552662 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: rename object "dbo"."AH_ReListHistory__dbt_tmp" to AH_ReListHistory
19:58:41.587266 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:41.589401 [debug] [Thread-1  ]: On model.Shawn.AH_ReListHistory: COMMIT
19:58:41.592045 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ReListHistory".
19:58:41.592449 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ReListHistory: 
    
  if object_id ('"dbo"."AH_ReListHistory__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ReListHistory__dbt_backup"
    end

19:58:41.631829 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:41.646347 [debug] [Thread-1  ]: finished collecting timing info
19:58:41.646955 [debug] [Thread-1  ]: On model.Shawn.AH_ReListHistory: Close
19:58:41.648482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899a60>]}
19:58:41.649154 [info ] [Thread-1  ]: 80 of 105 OK created table model dbo.AH_ReListHistory........................... [[32mOK[0m in 2.61s]
19:58:41.650291 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ReListHistory
19:58:41.650630 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Reports
19:58:41.651132 [info ] [Thread-1  ]: 81 of 105 START table model dbo.AH_Reports...................................... [RUN]
19:58:41.652677 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Reports"
19:58:41.652907 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Reports
19:58:41.653091 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Reports
19:58:41.656976 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Reports"
19:58:41.657706 [debug] [Thread-1  ]: finished collecting timing info
19:58:41.657957 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Reports
19:58:41.698813 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Reports"
19:58:41.699633 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
19:58:41.699917 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
  
  if object_id ('"dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Reports__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Reports__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Reports__dbt_tmp"
    end


   EXEC('create view dbo.AH_Reports__dbt_tmp_temp_view as
    
Select
	cast([SecondstogeneRate] as numeric(19,4)) [SecondstogeneRate],
	cast([ReportName] as nvarchar(4000)) [ReportName],
	cast([Data] as nvarchar(4000)) [Data],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID] 
From stg.[AH_Reports_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Reports__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Reports__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Reports__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Reports__dbt_tmp_temp_view"
    end



19:58:41.700081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:41.700256 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:41.800629 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:44.047357 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.35 seconds
19:58:44.063907 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
19:58:44.064352 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Reports: rename object "dbo"."AH_Reports__dbt_tmp" to AH_Reports
19:58:44.097945 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:44.100340 [debug] [Thread-1  ]: On model.Shawn.AH_Reports: COMMIT
19:58:44.103093 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Reports".
19:58:44.103551 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Reports: 
    
  if object_id ('"dbo"."AH_Reports__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Reports__dbt_backup"
    end

19:58:44.140928 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:44.155590 [debug] [Thread-1  ]: finished collecting timing info
19:58:44.156103 [debug] [Thread-1  ]: On model.Shawn.AH_Reports: Close
19:58:44.156980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899bb0>]}
19:58:44.157503 [info ] [Thread-1  ]: 81 of 105 OK created table model dbo.AH_Reports................................. [[32mOK[0m in 2.50s]
19:58:44.158672 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Reports
19:58:44.158947 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Roles
19:58:44.159382 [info ] [Thread-1  ]: 82 of 105 START table model dbo.AH_Roles........................................ [RUN]
19:58:44.160766 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Roles"
19:58:44.160980 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Roles
19:58:44.161158 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Roles
19:58:44.164888 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Roles"
19:58:44.165476 [debug] [Thread-1  ]: finished collecting timing info
19:58:44.165682 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Roles
19:58:44.204769 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Roles"
19:58:44.205657 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
19:58:44.205910 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
  
  if object_id ('"dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Roles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Roles__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Roles__dbt_tmp"
    end


   EXEC('create view dbo.AH_Roles__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [RoleID],
	cast([CreatedOn] as datetime) [Created_RWXRoles],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXRoles],
	cast([DeletedOn] as datetime) [DeletedDate_RWXRoles],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXRoles],
	cast([Name] as nvarchar(500)) [Role] 
From stg.[AH_Roles_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Roles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Roles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Roles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Roles__dbt_tmp_temp_view"
    end



19:58:44.206074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:44.206259 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:44.318257 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:47.286357 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.08 seconds
19:58:47.302018 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
19:58:47.302455 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: rename object "dbo"."AH_Roles__dbt_tmp" to AH_Roles
19:58:47.337018 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:47.339110 [debug] [Thread-1  ]: On model.Shawn.AH_Roles: COMMIT
19:58:47.341436 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Roles".
19:58:47.341721 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Roles: 
    
  if object_id ('"dbo"."AH_Roles__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Roles__dbt_backup"
    end

19:58:47.379044 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:47.485045 [debug] [Thread-1  ]: finished collecting timing info
19:58:47.485600 [debug] [Thread-1  ]: On model.Shawn.AH_Roles: Close
19:58:47.486495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8f10>]}
19:58:47.487088 [info ] [Thread-1  ]: 82 of 105 OK created table model dbo.AH_Roles................................... [[32mOK[0m in 3.33s]
19:58:47.488271 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Roles
19:58:47.488552 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SMStemplatecontents
19:58:47.488997 [info ] [Thread-1  ]: 83 of 105 START table model dbo.AH_SMStemplatecontents.......................... [RUN]
19:58:47.490391 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplatecontents"
19:58:47.490649 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SMStemplatecontents
19:58:47.490837 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SMStemplatecontents
19:58:47.494821 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplatecontents"
19:58:47.495488 [debug] [Thread-1  ]: finished collecting timing info
19:58:47.495710 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SMStemplatecontents
19:58:47.535132 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplatecontents"
19:58:47.536025 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
19:58:47.536324 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
  
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplatecontents__dbt_tmp"
    end


   EXEC('create view dbo.AH_SMStemplatecontents__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Body] as nvarchar(4000)) [Body],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [ID] 
From stg.[AH_SMStemplatecontents_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SMStemplatecontents__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SMStemplatecontents__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplatecontents__dbt_tmp_temp_view"
    end



19:58:47.536494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:47.536680 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:47.698104 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:49.979564 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
19:58:49.995240 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
19:58:49.995755 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: rename object "dbo"."AH_SMStemplatecontents__dbt_tmp" to AH_SMStemplatecontents
19:58:50.121642 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
19:58:50.123816 [debug] [Thread-1  ]: On model.Shawn.AH_SMStemplatecontents: COMMIT
19:58:50.126250 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplatecontents".
19:58:50.126595 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplatecontents: 
    
  if object_id ('"dbo"."AH_SMStemplatecontents__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplatecontents__dbt_backup"
    end

19:58:50.168444 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:50.183918 [debug] [Thread-1  ]: finished collecting timing info
19:58:50.184420 [debug] [Thread-1  ]: On model.Shawn.AH_SMStemplatecontents: Close
19:58:50.185310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc9899e50>]}
19:58:50.185842 [info ] [Thread-1  ]: 83 of 105 OK created table model dbo.AH_SMStemplatecontents..................... [[32mOK[0m in 2.70s]
19:58:50.187303 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SMStemplatecontents
19:58:50.187597 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SMStemplates
19:58:50.188059 [info ] [Thread-1  ]: 84 of 105 START table model dbo.AH_SMStemplates................................. [RUN]
19:58:50.189038 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SMStemplates"
19:58:50.189258 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SMStemplates
19:58:50.189433 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SMStemplates
19:58:50.193172 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SMStemplates"
19:58:50.193793 [debug] [Thread-1  ]: finished collecting timing info
19:58:50.194051 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SMStemplates
19:58:50.233590 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SMStemplates"
19:58:50.234476 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
19:58:50.234805 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
  
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplates__dbt_tmp"
    end


   EXEC('create view dbo.AH_SMStemplates__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([Enabled] as bit) [Enabled],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_SMStemplates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SMStemplates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SMStemplates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SMStemplates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SMStemplates__dbt_tmp_temp_view"
    end



19:58:50.234975 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:50.235156 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:50.350146 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:52.641264 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.41 seconds
19:58:52.656938 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
19:58:52.657375 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: rename object "dbo"."AH_SMStemplates__dbt_tmp" to AH_SMStemplates
19:58:52.692263 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:52.694378 [debug] [Thread-1  ]: On model.Shawn.AH_SMStemplates: COMMIT
19:58:52.696719 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SMStemplates".
19:58:52.696989 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SMStemplates: 
    
  if object_id ('"dbo"."AH_SMStemplates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SMStemplates__dbt_backup"
    end

19:58:52.734045 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:52.748409 [debug] [Thread-1  ]: finished collecting timing info
19:58:52.748931 [debug] [Thread-1  ]: On model.Shawn.AH_SMStemplates: Close
19:58:52.749813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a60d0>]}
19:58:52.750348 [info ] [Thread-1  ]: 84 of 105 OK created table model dbo.AH_SMStemplates............................ [[32mOK[0m in 2.56s]
19:58:52.751602 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SMStemplates
19:58:52.751875 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SalesTaxRates
19:58:52.752310 [info ] [Thread-1  ]: 85 of 105 START table model dbo.AH_SalesTaxRates................................ [RUN]
19:58:52.753705 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SalesTaxRates"
19:58:52.753923 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SalesTaxRates
19:58:52.754102 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SalesTaxRates
19:58:52.757883 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SalesTaxRates"
19:58:52.758462 [debug] [Thread-1  ]: finished collecting timing info
19:58:52.758743 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SalesTaxRates
19:58:52.801268 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SalesTaxRates"
19:58:52.803731 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
19:58:52.804071 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
  
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SalesTaxRates__dbt_tmp"
    end


   EXEC('create view dbo.AH_SalesTaxRates__dbt_tmp_temp_view as
    
Select
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([Shipping] as nvarchar(4000)) [Shipping],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([StateID] as int) [StateID],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([TaxRate] as numeric(19,4)) [TaxRate] 
From stg.[AH_SalesTaxRates_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SalesTaxRates__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SalesTaxRates__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SalesTaxRates__dbt_tmp_temp_view"
    end



19:58:52.804243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:52.804432 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:52.903606 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:55.124161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.32 seconds
19:58:55.139976 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
19:58:55.140403 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: rename object "dbo"."AH_SalesTaxRates__dbt_tmp" to AH_SalesTaxRates
19:58:55.177155 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:55.179254 [debug] [Thread-1  ]: On model.Shawn.AH_SalesTaxRates: COMMIT
19:58:55.181376 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SalesTaxRates".
19:58:55.181602 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SalesTaxRates: 
    
  if object_id ('"dbo"."AH_SalesTaxRates__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SalesTaxRates__dbt_backup"
    end

19:58:55.221295 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:55.235156 [debug] [Thread-1  ]: finished collecting timing info
19:58:55.235671 [debug] [Thread-1  ]: On model.Shawn.AH_SalesTaxRates: Close
19:58:55.236543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6130>]}
19:58:55.237092 [info ] [Thread-1  ]: 85 of 105 OK created table model dbo.AH_SalesTaxRates........................... [[32mOK[0m in 2.48s]
19:58:55.238180 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SalesTaxRates
19:58:55.238465 [debug] [Thread-1  ]: Began running node model.Shawn.AH_ShippingMethods
19:58:55.238928 [info ] [Thread-1  ]: 86 of 105 START table model dbo.AH_ShippingMethods.............................. [RUN]
19:58:55.240280 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingMethods"
19:58:55.240491 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_ShippingMethods
19:58:55.240664 [debug] [Thread-1  ]: Compiling model.Shawn.AH_ShippingMethods
19:58:55.244239 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_ShippingMethods"
19:58:55.244909 [debug] [Thread-1  ]: finished collecting timing info
19:58:55.245112 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_ShippingMethods
19:58:55.283765 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingMethods"
19:58:55.284628 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
19:58:55.284883 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
  
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingMethods__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingMethods__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([DisplayOrder] as int) [DisplayOrder],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_ShippingMethods_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ShippingMethods__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingMethods__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingMethods__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingMethods__dbt_tmp_temp_view"
    end



19:58:55.285085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:55.285283 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:55.397110 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:57.289040 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 106.60 seconds
19:58:57.305174 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
19:58:57.305632 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: rename object "dbo"."AH_Listingproperties__dbt_tmp" to AH_Listingproperties
19:58:57.349007 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:57.351187 [debug] [Thread-4  ]: On model.Shawn.AH_Listingproperties: COMMIT
19:58:57.354876 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listingproperties".
19:58:57.355182 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Listingproperties: 
    
  if object_id ('"dbo"."AH_Listingproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listingproperties__dbt_backup"
    end

19:58:57.392063 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:57.406390 [debug] [Thread-4  ]: finished collecting timing info
19:58:57.406965 [debug] [Thread-4  ]: On model.Shawn.AH_Listingproperties: Close
19:58:57.407856 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8910>]}
19:58:57.408390 [info ] [Thread-4  ]: 57 of 105 OK created table model dbo.AH_Listingproperties....................... [[32mOK[0m in 106.76s]
19:58:57.409544 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Listingproperties
19:58:57.409817 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ShippingOptions
19:58:57.410234 [info ] [Thread-4  ]: 87 of 105 START table model dbo.AH_ShippingOptions.............................. [RUN]
19:58:57.411564 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions"
19:58:57.411796 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ShippingOptions
19:58:57.411978 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ShippingOptions
19:58:57.415638 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions"
19:58:57.416256 [debug] [Thread-4  ]: finished collecting timing info
19:58:57.416515 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ShippingOptions
19:58:57.456025 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions"
19:58:57.456875 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
19:58:57.457171 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
  
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingOptions__dbt_tmp_temp_view as
    
Select
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([ID] as int) [ShippingOptionID],
	cast([ShippingMethodID] as int) [ShippingMethodID],
	cast([ListingID] as int) [ListingID],
	cast([FirstItEMAmount] as decimal(24,2)) [FirstItemAmount],
	cast([AdditionalItEMAmount] as decimal(24,2)) [AdditionalItemAmount] 
From stg.[AH_ShippingOptions_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ShippingOptions__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingOptions__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingOptions__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions__dbt_tmp_temp_view"
    end



19:58:57.457362 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:58:57.457550 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:57.515397 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
19:58:57.535148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
19:58:57.535568 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: rename object "dbo"."AH_ShippingMethods__dbt_tmp" to AH_ShippingMethods
19:58:57.557983 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:58:57.568524 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:58:57.570496 [debug] [Thread-1  ]: On model.Shawn.AH_ShippingMethods: COMMIT
19:58:57.572723 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingMethods".
19:58:57.572997 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_ShippingMethods: 
    
  if object_id ('"dbo"."AH_ShippingMethods__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingMethods__dbt_backup"
    end

19:58:57.613581 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:58:57.628623 [debug] [Thread-1  ]: finished collecting timing info
19:58:57.629066 [debug] [Thread-1  ]: On model.Shawn.AH_ShippingMethods: Close
19:58:57.629930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6280>]}
19:58:57.630453 [info ] [Thread-1  ]: 86 of 105 OK created table model dbo.AH_ShippingMethods......................... [[32mOK[0m in 2.39s]
19:58:57.631578 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_ShippingMethods
19:58:57.631848 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Siteproperties
19:58:57.632288 [info ] [Thread-1  ]: 88 of 105 START table model dbo.AH_Siteproperties............................... [RUN]
19:58:57.633687 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Siteproperties"
19:58:57.633921 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Siteproperties
19:58:57.634105 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Siteproperties
19:58:57.637964 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Siteproperties"
19:58:57.638660 [debug] [Thread-1  ]: finished collecting timing info
19:58:57.638916 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Siteproperties
19:58:57.679008 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Siteproperties"
19:58:57.679915 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
19:58:57.680216 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
  
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Siteproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Siteproperties__dbt_tmp_temp_view as
    
Select
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue],
	cast([BoolnativeValue] as bit) [BoolnativeValue],
	cast([ID] as int) [ID],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringnativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Siteproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Siteproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Siteproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Siteproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Siteproperties__dbt_tmp_temp_view"
    end



19:58:57.680393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:58:57.680581 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:58:57.777518 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:00.137098 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.68 seconds
19:59:00.153891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
19:59:00.154349 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: rename object "dbo"."AH_ShippingOptions__dbt_tmp" to AH_ShippingOptions
19:59:00.187988 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:00.190220 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions: COMMIT
19:59:00.192995 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions".
19:59:00.193326 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions: 
    
  if object_id ('"dbo"."AH_ShippingOptions__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions__dbt_backup"
    end

19:59:00.230603 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:00.244775 [debug] [Thread-4  ]: finished collecting timing info
19:59:00.245268 [debug] [Thread-4  ]: On model.Shawn.AH_ShippingOptions: Close
19:59:00.246127 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98c8d00>]}
19:59:00.246675 [info ] [Thread-4  ]: 87 of 105 OK created table model dbo.AH_ShippingOptions......................... [[32mOK[0m in 2.83s]
19:59:00.247735 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ShippingOptions
19:59:00.248002 [debug] [Thread-4  ]: Began running node model.Shawn.AH_States
19:59:00.248411 [info ] [Thread-4  ]: 89 of 105 START table model dbo.AH_States....................................... [RUN]
19:59:00.249714 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_States"
19:59:00.249927 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_States
19:59:00.250102 [debug] [Thread-4  ]: Compiling model.Shawn.AH_States
19:59:00.253394 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_States"
19:59:00.254086 [debug] [Thread-4  ]: finished collecting timing info
19:59:00.254289 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_States
19:59:00.293486 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_States"
19:59:00.294346 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
19:59:00.294626 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: 
  
  if object_id ('"dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_States__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_States__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_States__dbt_tmp"
    end


   EXEC('create view dbo.AH_States__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([Code] as nvarchar(4000)) [Code],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([CountryID] as int) [CountryID] 
From stg.[AH_States_FinalView]
    ');

  CREATE TABLE "dbo"."AH_States__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_States__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_States__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_States__dbt_tmp_temp_view"
    end



19:59:00.294816 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:00.295050 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:00.393123 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:00.599098 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.92 seconds
19:59:00.614957 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
19:59:00.615409 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: rename object "dbo"."AH_Siteproperties__dbt_tmp" to AH_Siteproperties
19:59:00.644017 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:00.646108 [debug] [Thread-1  ]: On model.Shawn.AH_Siteproperties: COMMIT
19:59:00.648454 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Siteproperties".
19:59:00.648724 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Siteproperties: 
    
  if object_id ('"dbo"."AH_Siteproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Siteproperties__dbt_backup"
    end

19:59:00.692932 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:00.708430 [debug] [Thread-1  ]: finished collecting timing info
19:59:00.708950 [debug] [Thread-1  ]: On model.Shawn.AH_Siteproperties: Close
19:59:00.709848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a63d0>]}
19:59:00.710385 [info ] [Thread-1  ]: 88 of 105 OK created table model dbo.AH_Siteproperties.......................... [[32mOK[0m in 3.08s]
19:59:00.711508 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Siteproperties
19:59:00.711780 [debug] [Thread-1  ]: Began running node model.Shawn.AH_StripeCustomers
19:59:00.712220 [info ] [Thread-1  ]: 90 of 105 START table model dbo.AH_StripeCustomers.............................. [RUN]
19:59:00.713571 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_StripeCustomers"
19:59:00.713787 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_StripeCustomers
19:59:00.713970 [debug] [Thread-1  ]: Compiling model.Shawn.AH_StripeCustomers
19:59:00.717681 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_StripeCustomers"
19:59:00.718280 [debug] [Thread-1  ]: finished collecting timing info
19:59:00.718531 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_StripeCustomers
19:59:00.757581 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_StripeCustomers"
19:59:00.758465 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
19:59:00.758808 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
  
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_StripeCustomers__dbt_tmp"
    end


   EXEC('create view dbo.AH_StripeCustomers__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([SellerID] as int) [SellerID],
	cast([BuyerID] as int) [BuyerID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CustomerID] as nvarchar(4000)) [CustomerID] 
From stg.[AH_StripeCustomers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_StripeCustomers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_StripeCustomers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_StripeCustomers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_StripeCustomers__dbt_tmp_temp_view"
    end



19:59:00.759244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:00.759444 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:00.860218 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:02.682760 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.39 seconds
19:59:02.699306 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
19:59:02.699752 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: rename object "dbo"."AH_States__dbt_tmp" to AH_States
19:59:02.735952 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:02.738075 [debug] [Thread-4  ]: On model.Shawn.AH_States: COMMIT
19:59:02.740516 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_States".
19:59:02.740806 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_States: 
    
  if object_id ('"dbo"."AH_States__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_States__dbt_backup"
    end

19:59:02.778968 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:02.793909 [debug] [Thread-4  ]: finished collecting timing info
19:59:02.796019 [debug] [Thread-4  ]: On model.Shawn.AH_States: Close
19:59:02.797714 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6520>]}
19:59:02.992718 [info ] [Thread-4  ]: 89 of 105 OK created table model dbo.AH_States.................................. [[32mOK[0m in 2.55s]
19:59:02.996910 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_States
19:59:02.997337 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment
19:59:02.997847 [info ] [Thread-4  ]: 91 of 105 START table model dbo.AH_SubmittedListingPayment...................... [RUN]
19:59:03.003685 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment"
19:59:03.004036 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment
19:59:03.004243 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment
19:59:03.015907 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment"
19:59:03.017785 [debug] [Thread-4  ]: finished collecting timing info
19:59:03.019011 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment
19:59:03.090529 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment"
19:59:03.091434 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
19:59:03.091686 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
  
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment__dbt_tmp"
    end


   EXEC('create view dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view as
    
Select
	cast([TransactionID] as nvarchar(30)) [TransactionID],
	cast([Amount] as decimal(24,2)) [Amount],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([ListingID] as int) [ListingID],
	cast([ID] as int) [ID],
	cast([ConsignorID] as int) [UserID],
	cast([HasproMarketing] as bit) [HasProMarketing],
	cast([HasproPhotography] as bit) [HasProPhotography] 
From stg.[AH_SubmittedListingPayment_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SubmittedListingPayment__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SubmittedListingPayment__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment__dbt_tmp_temp_view"
    end



19:59:03.091864 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:03.092050 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:03.198335 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:03.892814 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.13 seconds
19:59:03.909007 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
19:59:03.909454 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: rename object "dbo"."AH_StripeCustomers__dbt_tmp" to AH_StripeCustomers
19:59:03.945245 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:03.947372 [debug] [Thread-1  ]: On model.Shawn.AH_StripeCustomers: COMMIT
19:59:03.949754 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_StripeCustomers".
19:59:03.950018 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_StripeCustomers: 
    
  if object_id ('"dbo"."AH_StripeCustomers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_StripeCustomers__dbt_backup"
    end

19:59:03.987199 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:04.002097 [debug] [Thread-1  ]: finished collecting timing info
19:59:04.002644 [debug] [Thread-1  ]: On model.Shawn.AH_StripeCustomers: Close
19:59:04.003526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6670>]}
19:59:04.004062 [info ] [Thread-1  ]: 90 of 105 OK created table model dbo.AH_StripeCustomers......................... [[32mOK[0m in 3.29s]
19:59:04.005137 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_StripeCustomers
19:59:04.005401 [debug] [Thread-1  ]: Began running node model.Shawn.AH_SysDiagrams
19:59:04.005813 [info ] [Thread-1  ]: 92 of 105 START table model dbo.AH_SysDiagrams.................................. [RUN]
19:59:04.007318 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_SysDiagrams"
19:59:04.007534 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_SysDiagrams
19:59:04.007710 [debug] [Thread-1  ]: Compiling model.Shawn.AH_SysDiagrams
19:59:04.011004 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_SysDiagrams"
19:59:04.011566 [debug] [Thread-1  ]: finished collecting timing info
19:59:04.011775 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_SysDiagrams
19:59:04.050965 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_SysDiagrams"
19:59:04.051885 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
19:59:04.052154 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
  
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SysDiagrams__dbt_tmp"
    end


   EXEC('create view dbo.AH_SysDiagrams__dbt_tmp_temp_view as
    
Select
	cast([Diagram_ID] as int) [Diagram_ID],
	cast([Version] as int) [Version],
	cast([Principal_ID] as int) [Principal_ID],
	cast([Definition] as varbinary(8000)) [Definition],
	cast([Name] as nvarchar(4000)) [Name] 
From stg.[AH_SysDiagrams_FinalView]
    ');

  CREATE TABLE "dbo"."AH_SysDiagrams__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SysDiagrams__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SysDiagrams__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SysDiagrams__dbt_tmp_temp_view"
    end



19:59:04.052331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:04.052516 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:04.156266 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:05.631611 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.54 seconds
19:59:05.647798 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
19:59:05.648247 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: rename object "dbo"."AH_SubmittedListingPayment__dbt_tmp" to AH_SubmittedListingPayment
19:59:05.683227 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:05.685343 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment: COMMIT
19:59:05.687747 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment".
19:59:05.688018 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment: 
    
  if object_id ('"dbo"."AH_SubmittedListingPayment__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment__dbt_backup"
    end

19:59:05.725019 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:05.740427 [debug] [Thread-4  ]: finished collecting timing info
19:59:05.741019 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment: Close
19:59:05.742013 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a67c0>]}
19:59:05.742667 [info ] [Thread-4  ]: 91 of 105 OK created table model dbo.AH_SubmittedListingPayment................. [[32mOK[0m in 2.74s]
19:59:05.743813 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment
19:59:05.744097 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ThReadTracking
19:59:05.744521 [info ] [Thread-4  ]: 93 of 105 START table model dbo.AH_ThReadTracking............................... [RUN]
19:59:05.745805 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ThReadTracking"
19:59:05.746019 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ThReadTracking
19:59:05.746195 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ThReadTracking
19:59:05.749522 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ThReadTracking"
19:59:05.750211 [debug] [Thread-4  ]: finished collecting timing info
19:59:05.750415 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ThReadTracking
19:59:05.790100 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ThReadTracking"
19:59:05.791081 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
19:59:05.791379 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
  
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ThReadTracking__dbt_tmp"
    end


   EXEC('create view dbo.AH_ThReadTracking__dbt_tmp_temp_view as
    
Select
	cast([Name] as nvarchar(4000)) [Name],
	cast([ThReadGUID] as nvarchar(4000)) [ThReadGUID],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([PrimarythRead] as bit) [PrimarythRead] 
From stg.[AH_ThReadTracking_FinalView]
    ');

  CREATE TABLE "dbo"."AH_ThReadTracking__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ThReadTracking__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ThReadTracking__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ThReadTracking__dbt_tmp_temp_view"
    end



19:59:05.791557 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:05.791742 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:05.924324 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:06.148729 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
19:59:06.164666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
19:59:06.165104 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: rename object "dbo"."AH_SysDiagrams__dbt_tmp" to AH_SysDiagrams
19:59:06.199894 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:06.202005 [debug] [Thread-1  ]: On model.Shawn.AH_SysDiagrams: COMMIT
19:59:06.204656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SysDiagrams".
19:59:06.205044 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_SysDiagrams: 
    
  if object_id ('"dbo"."AH_SysDiagrams__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SysDiagrams__dbt_backup"
    end

19:59:06.242947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:06.257474 [debug] [Thread-1  ]: finished collecting timing info
19:59:06.257993 [debug] [Thread-1  ]: On model.Shawn.AH_SysDiagrams: Close
19:59:06.258900 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6910>]}
19:59:06.259430 [info ] [Thread-1  ]: 92 of 105 OK created table model dbo.AH_SysDiagrams............................. [[32mOK[0m in 2.25s]
19:59:06.260569 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_SysDiagrams
19:59:06.260848 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Tiers
19:59:06.261279 [info ] [Thread-1  ]: 94 of 105 START table model dbo.AH_Tiers........................................ [RUN]
19:59:06.262644 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Tiers"
19:59:06.262861 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Tiers
19:59:06.263039 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Tiers
19:59:06.266802 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Tiers"
19:59:06.267406 [debug] [Thread-1  ]: finished collecting timing info
19:59:06.267619 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Tiers
19:59:06.307569 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Tiers"
19:59:06.308448 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
19:59:06.308742 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Tiers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Tiers__dbt_tmp_temp_view as
    
Select
	cast([Upperboundexclusive] as numeric(19,4)) [Upperboundexclusive],
	cast([Value] as numeric(19,4)) [Value],
	cast([Lowerboundinclusive] as numeric(19,4)) [Lowerboundinclusive],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([FeescheduleID] as int) [FeescheduleID],
	cast([ValueType] as nvarchar(4000)) [ValueType],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Tiers_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Tiers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Tiers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end



19:59:06.308922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:06.309105 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:06.427711 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:08.124054 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.33 seconds
19:59:08.140129 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
19:59:08.140563 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: rename object "dbo"."AH_ThReadTracking__dbt_tmp" to AH_ThReadTracking
19:59:08.175800 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:08.178048 [debug] [Thread-4  ]: On model.Shawn.AH_ThReadTracking: COMMIT
19:59:08.180874 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ThReadTracking".
19:59:08.181256 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ThReadTracking: 
    
  if object_id ('"dbo"."AH_ThReadTracking__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ThReadTracking__dbt_backup"
    end

19:59:08.228057 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:59:08.242465 [debug] [Thread-4  ]: finished collecting timing info
19:59:08.242994 [debug] [Thread-4  ]: On model.Shawn.AH_ThReadTracking: Close
19:59:08.243866 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6a60>]}
19:59:08.244391 [info ] [Thread-4  ]: 93 of 105 OK created table model dbo.AH_ThReadTracking.......................... [[32mOK[0m in 2.50s]
19:59:08.245491 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ThReadTracking
19:59:08.245759 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages
19:59:08.246162 [info ] [Thread-4  ]: 95 of 105 START table model dbo.AH_UnProcessedQueueMessages..................... [RUN]
19:59:08.247577 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages"
19:59:08.247809 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages
19:59:08.247988 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages
19:59:08.251354 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
19:59:08.252102 [debug] [Thread-4  ]: finished collecting timing info
19:59:08.252346 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages
19:59:08.292371 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages"
19:59:08.293275 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
19:59:08.293580 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
  
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    end


   EXEC('create view dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view as
    
Select
	cast([QueueName] as nvarchar(4000)) [QueueName],
	cast([QueueData] as nvarchar(4000)) [QueueData],
	cast([QueueOrder] as int) [QueueOrder] 
From stg.[AH_UnProcessedQueueMessages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UnProcessedQueueMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UnProcessedQueueMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UnProcessedQueueMessages__dbt_tmp_temp_view"
    end



19:59:08.293757 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:08.293943 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:08.393893 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:08.632556 [debug] [Thread-1  ]: SQLServer adapter: Database error: ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
19:59:08.632907 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: ROLLBACK
19:59:08.633032 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: Close
19:59:08.633480 [debug] [Thread-1  ]: finished collecting timing info
19:59:08.634270 [debug] [Thread-1  ]: Database Error in model AH_Tiers (models/step4_dboSingle/AH_Tiers.sql)
  ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
  compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_Tiers.sql
19:59:08.634770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc855e790>]}
19:59:08.635272 [error] [Thread-1  ]: 94 of 105 ERROR creating table model dbo.AH_Tiers............................... [[31mERROR[0m in 2.37s]
19:59:08.636371 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Tiers
19:59:08.636663 [debug] [Thread-1  ]: Began running node model.Shawn.AH_UserAlerts
19:59:08.637136 [info ] [Thread-1  ]: 96 of 105 START table model dbo.AH_UserAlerts................................... [RUN]
19:59:08.638594 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_UserAlerts"
19:59:08.638822 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_UserAlerts
19:59:08.639011 [debug] [Thread-1  ]: Compiling model.Shawn.AH_UserAlerts
19:59:08.642783 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_UserAlerts"
19:59:08.643514 [debug] [Thread-1  ]: finished collecting timing info
19:59:08.643782 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_UserAlerts
19:59:08.683447 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_UserAlerts"
19:59:08.684298 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
19:59:08.684540 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
  
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserAlerts__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserAlerts__dbt_tmp_temp_view as
    
Select
	cast([Enabled] as bit) [Enabled],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([MakeID] as int) [MakeID],
	cast([ModelID] as int) [ModelID],
	cast([YearFrom] as int) [YearFrom],
	cast([Yearto] as int) [Yearto],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn] 
From stg.[AH_UserAlerts_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserAlerts__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserAlerts__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserAlerts__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserAlerts__dbt_tmp_temp_view"
    end



19:59:08.684712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:08.684891 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:08.800249 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:10.790848 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.50 seconds
19:59:10.806988 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
19:59:10.807400 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: rename object "dbo"."AH_UnProcessedQueueMessages__dbt_tmp" to AH_UnProcessedQueueMessages
19:59:10.843309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:10.845374 [debug] [Thread-4  ]: On model.Shawn.AH_UnProcessedQueueMessages: COMMIT
19:59:10.847662 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages".
19:59:10.847908 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages: 
    
  if object_id ('"dbo"."AH_UnProcessedQueueMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UnProcessedQueueMessages__dbt_backup"
    end

19:59:10.887330 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:10.901105 [debug] [Thread-4  ]: finished collecting timing info
19:59:10.901564 [debug] [Thread-4  ]: On model.Shawn.AH_UnProcessedQueueMessages: Close
19:59:10.902388 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98a6d00>]}
19:59:10.902925 [info ] [Thread-4  ]: 95 of 105 OK created table model dbo.AH_UnProcessedQueueMessages................ [[32mOK[0m in 2.65s]
19:59:10.904256 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages
19:59:10.904538 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserLogins
19:59:10.904957 [info ] [Thread-4  ]: 97 of 105 START table model dbo.AH_UserLogins................................... [RUN]
19:59:10.905892 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins"
19:59:10.906110 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserLogins
19:59:10.906286 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserLogins
19:59:10.909581 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins"
19:59:10.910256 [debug] [Thread-4  ]: finished collecting timing info
19:59:10.910460 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserLogins
19:59:10.948696 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins"
19:59:10.949524 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
19:59:10.949813 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
  
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserLogins__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserLogins__dbt_tmp_temp_view as
    
Select
	cast([LoginprovIDEr] as nvarchar(4000)) [LoginprovIDEr],
	cast([ProvIDErKey] as nvarchar(4000)) [ProvIDErKey],
	cast([UserID] as int) [UserID] 
From stg.[AH_UserLogins_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserLogins__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserLogins__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserLogins__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserLogins__dbt_tmp_temp_view"
    end



19:59:10.949993 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:10.950176 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:11.048615 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:11.158856 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.47 seconds
19:59:11.260386 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
19:59:11.260823 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: rename object "dbo"."AH_UserAlerts__dbt_tmp" to AH_UserAlerts
19:59:11.293964 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:11.296025 [debug] [Thread-1  ]: On model.Shawn.AH_UserAlerts: COMMIT
19:59:11.298302 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserAlerts".
19:59:11.298592 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserAlerts: 
    
  if object_id ('"dbo"."AH_UserAlerts__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserAlerts__dbt_backup"
    end

19:59:11.339767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:11.354400 [debug] [Thread-1  ]: finished collecting timing info
19:59:11.354880 [debug] [Thread-1  ]: On model.Shawn.AH_UserAlerts: Close
19:59:11.355715 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc857b2e0>]}
19:59:11.356264 [info ] [Thread-1  ]: 96 of 105 OK created table model dbo.AH_UserAlerts.............................. [[32mOK[0m in 2.72s]
19:59:11.362879 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_UserAlerts
19:59:11.363190 [debug] [Thread-1  ]: Began running node model.Shawn.AH_UserMessages
19:59:11.363786 [info ] [Thread-1  ]: 98 of 105 START table model dbo.AH_UserMessages................................. [RUN]
19:59:11.364755 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_UserMessages"
19:59:11.365865 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_UserMessages
19:59:11.366081 [debug] [Thread-1  ]: Compiling model.Shawn.AH_UserMessages
19:59:11.369949 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_UserMessages"
19:59:11.370493 [debug] [Thread-1  ]: finished collecting timing info
19:59:11.370871 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_UserMessages
19:59:11.408472 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_UserMessages"
19:59:11.409461 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
19:59:11.409716 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
  
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserMessages__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserMessages__dbt_tmp_temp_view as
    
Select
	cast([SEnderID] as int) [SEnderID],
	cast([RecipientID] as int) [RecipientID],
	cast([MasTerMessageID] as int) [MasTerMessageID],
	cast([ID] as int) [ID],
	cast([ListingID] as int) [ListingID],
	cast([Sent] as datetime) [Sent],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([SuBJect] as nvarchar(4000)) [SuBJect],
	cast([Body] as nvarchar(4000)) [Body],
	cast([SEnderStatus] as nvarchar(4000)) [SEnderStatus],
	cast([RecipientStatus] as nvarchar(4000)) [RecipientStatus],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_UserMessages_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserMessages__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserMessages__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserMessages__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserMessages__dbt_tmp_temp_view"
    end



19:59:11.409887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:11.410065 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:11.513414 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:13.163529 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
19:59:13.178206 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
19:59:13.178616 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: rename object "dbo"."AH_UserLogins__dbt_tmp" to AH_UserLogins
19:59:13.216174 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:13.218159 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins: COMMIT
19:59:13.220293 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins".
19:59:13.220520 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins: 
    
  if object_id ('"dbo"."AH_UserLogins__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserLogins__dbt_backup"
    end

19:59:13.257823 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:13.273059 [debug] [Thread-4  ]: finished collecting timing info
19:59:13.273564 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins: Close
19:59:13.274415 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc988f0d0>]}
19:59:13.274954 [info ] [Thread-4  ]: 97 of 105 OK created table model dbo.AH_UserLogins.............................. [[32mOK[0m in 2.37s]
19:59:13.276051 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserLogins
19:59:13.276313 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserOptOut
19:59:13.276703 [info ] [Thread-4  ]: 99 of 105 START table model dbo.AH_UserOptOut................................... [RUN]
19:59:13.277946 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserOptOut"
19:59:13.278158 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserOptOut
19:59:13.278335 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserOptOut
19:59:13.282056 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserOptOut"
19:59:13.282638 [debug] [Thread-4  ]: finished collecting timing info
19:59:13.282907 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserOptOut
19:59:13.321483 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserOptOut"
19:59:13.322339 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
19:59:13.322658 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
  
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserOptOut__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserOptOut__dbt_tmp_temp_view as
    
Select
	cast([EmailName] as nvarchar(4000)) [EmailName],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID] 
From stg.[AH_UserOptOut_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserOptOut__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserOptOut__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserOptOut__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserOptOut__dbt_tmp_temp_view"
    end



19:59:13.322852 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:13.323042 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:13.435661 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:14.096929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.69 seconds
19:59:14.113193 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
19:59:14.113615 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: rename object "dbo"."AH_UserMessages__dbt_tmp" to AH_UserMessages
19:59:14.157525 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:14.159692 [debug] [Thread-1  ]: On model.Shawn.AH_UserMessages: COMMIT
19:59:14.162120 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserMessages".
19:59:14.162404 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserMessages: 
    
  if object_id ('"dbo"."AH_UserMessages__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserMessages__dbt_backup"
    end

19:59:14.200794 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:14.215418 [debug] [Thread-1  ]: finished collecting timing info
19:59:14.215868 [debug] [Thread-1  ]: On model.Shawn.AH_UserMessages: Close
19:59:14.216695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc988f130>]}
19:59:14.217203 [info ] [Thread-1  ]: 98 of 105 OK created table model dbo.AH_UserMessages............................ [[32mOK[0m in 2.85s]
19:59:14.218229 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_UserMessages
19:59:14.218494 [debug] [Thread-1  ]: Began running node model.Shawn.AH_UserRoles
19:59:14.218923 [info ] [Thread-1  ]: 100 of 105 START table model dbo.AH_UserRoles................................... [RUN]
19:59:14.220387 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_UserRoles"
19:59:14.220602 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_UserRoles
19:59:14.220779 [debug] [Thread-1  ]: Compiling model.Shawn.AH_UserRoles
19:59:14.223904 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_UserRoles"
19:59:14.224427 [debug] [Thread-1  ]: finished collecting timing info
19:59:14.224664 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_UserRoles
19:59:14.262791 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_UserRoles"
19:59:14.263649 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
19:59:14.263941 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
  
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_UserRoles__dbt_tmp"
    end


   EXEC('create view dbo.AH_UserRoles__dbt_tmp_temp_view as
    
Select
	cast([RoleID] as int) [RoleID],
	cast([ID] as int) [ID_RWXUserRoles],
	cast([UserID] as int) [UserID] 
From stg.[AH_UserRoles_FinalView]
    ');

  CREATE TABLE "dbo"."AH_UserRoles__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_UserRoles__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_UserRoles__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_UserRoles__dbt_tmp_temp_view"
    end



19:59:14.264122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:14.264306 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:14.363330 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:15.785518 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.46 seconds
19:59:15.803556 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
19:59:15.803971 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: rename object "dbo"."AH_UserOptOut__dbt_tmp" to AH_UserOptOut
19:59:15.837480 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:15.839624 [debug] [Thread-4  ]: On model.Shawn.AH_UserOptOut: COMMIT
19:59:15.841937 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserOptOut".
19:59:15.842197 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserOptOut: 
    
  if object_id ('"dbo"."AH_UserOptOut__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserOptOut__dbt_backup"
    end

19:59:15.883415 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:15.898166 [debug] [Thread-4  ]: finished collecting timing info
19:59:15.898682 [debug] [Thread-4  ]: On model.Shawn.AH_UserOptOut: Close
19:59:15.899540 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc988f280>]}
19:59:15.900063 [info ] [Thread-4  ]: 99 of 105 OK created table model dbo.AH_UserOptOut.............................. [[32mOK[0m in 2.62s]
19:59:15.901164 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserOptOut
19:59:15.901434 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Userclaims
19:59:15.901838 [info ] [Thread-4  ]: 101 of 105 START table model dbo.AH_Userclaims.................................. [RUN]
19:59:15.903309 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Userclaims"
19:59:15.903535 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Userclaims
19:59:15.903718 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Userclaims
19:59:15.906924 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Userclaims"
19:59:15.907454 [debug] [Thread-4  ]: finished collecting timing info
19:59:15.907686 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Userclaims
19:59:15.946117 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Userclaims"
19:59:15.946992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
19:59:15.947286 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
  
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Userclaims__dbt_tmp"
    end


   EXEC('create view dbo.AH_Userclaims__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([ClaimType] as nvarchar(4000)) [ClaimType],
	cast([ClaimValue] as nvarchar(4000)) [ClaimValue] 
From stg.[AH_Userclaims_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Userclaims__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Userclaims__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Userclaims__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userclaims__dbt_tmp_temp_view"
    end



19:59:15.947470 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:15.947654 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:16.053033 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:16.470628 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
19:59:16.487140 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
19:59:16.487556 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: rename object "dbo"."AH_UserRoles__dbt_tmp" to AH_UserRoles
19:59:16.535124 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
19:59:16.537155 [debug] [Thread-1  ]: On model.Shawn.AH_UserRoles: COMMIT
19:59:16.539381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserRoles".
19:59:16.539636 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_UserRoles: 
    
  if object_id ('"dbo"."AH_UserRoles__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_UserRoles__dbt_backup"
    end

19:59:16.577889 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:16.592591 [debug] [Thread-1  ]: finished collecting timing info
19:59:16.593059 [debug] [Thread-1  ]: On model.Shawn.AH_UserRoles: Close
19:59:16.593887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc86c6820>]}
19:59:16.594394 [info ] [Thread-1  ]: 100 of 105 OK created table model dbo.AH_UserRoles.............................. [[32mOK[0m in 2.37s]
19:59:16.595494 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_UserRoles
19:59:16.595763 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Userproperties
19:59:16.596159 [info ] [Thread-1  ]: 102 of 105 START table model dbo.AH_Userproperties.............................. [RUN]
19:59:16.597531 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Userproperties"
19:59:16.597754 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Userproperties
19:59:16.597931 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Userproperties
19:59:16.601144 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Userproperties"
19:59:16.601845 [debug] [Thread-1  ]: finished collecting timing info
19:59:16.602088 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Userproperties
19:59:16.640624 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Userproperties"
19:59:16.641420 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
19:59:16.641699 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
  
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Userproperties__dbt_tmp"
    end


   EXEC('create view dbo.AH_Userproperties__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID_RWXUserProperties],
	cast([IntnativeValue] as int) [IntnativeValue],
	cast([UserID] as int) [UserID],
	cast([CustomFieldID] as int) [CustomFieldID],
	cast([BoolnativeValue] as bit) [HasBoolNativeValue],
	cast([CreatedOn] as datetime) [Created_RWXUserProperties],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXUserProperties],
	cast([DeletedOn] as datetime) [DeletedDate_RWXUserProperties],
	cast([DateTimenativeValue] as datetime) [DateTimenativeValue],
	cast([StringnativeValue] as nvarchar(4000)) [StringNativeValue],
	cast([EnumnativeValue] as nvarchar(4000)) [EnumnativeValue],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXUserProperties],
	cast([DecimalnativeValue] as numeric(19,4)) [DecimalnativeValue] 
From stg.[AH_Userproperties_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Userproperties__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Userproperties__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Userproperties__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Userproperties__dbt_tmp_temp_view"
    end



19:59:16.641872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:16.642051 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:16.745213 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:18.239284 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.29 seconds
19:59:18.254889 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
19:59:18.255307 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: rename object "dbo"."AH_Userclaims__dbt_tmp" to AH_Userclaims
19:59:18.289581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:18.291678 [debug] [Thread-4  ]: On model.Shawn.AH_Userclaims: COMMIT
19:59:18.294006 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userclaims".
19:59:18.294232 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Userclaims: 
    
  if object_id ('"dbo"."AH_Userclaims__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Userclaims__dbt_backup"
    end

19:59:18.332002 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:18.429591 [debug] [Thread-4  ]: finished collecting timing info
19:59:18.430096 [debug] [Thread-4  ]: On model.Shawn.AH_Userclaims: Close
19:59:18.430963 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc988f520>]}
19:59:18.431485 [info ] [Thread-4  ]: 101 of 105 OK created table model dbo.AH_Userclaims............................. [[32mOK[0m in 2.53s]
19:59:18.432560 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Userclaims
19:59:18.432825 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Users
19:59:18.433228 [info ] [Thread-4  ]: 103 of 105 START table model dbo.AH_Users....................................... [RUN]
19:59:18.434520 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Users"
19:59:18.434754 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Users
19:59:18.434930 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Users
19:59:18.438768 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Users"
19:59:18.439305 [debug] [Thread-4  ]: finished collecting timing info
19:59:18.439549 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Users
19:59:18.478211 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Users"
19:59:18.479060 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
19:59:18.479300 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: 
  
  if object_id ('"dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Users__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Users__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Users__dbt_tmp"
    end


   EXEC('create view dbo.AH_Users__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [UserID],
	cast([BillingAddressID] as int) [BilingAddressID],
	cast([BillingCreditCardID] as int) [BillingCreditCardID],
	cast([PrimaryAddressID] as int) [PrimaryAddressID],
	cast([AccessfailedCount] as int) [AccessFailedCount],
	cast([IsApproved] as bit) [IsApproved],
	cast([IsLockedOut] as bit) [IsLockedOut],
	cast([NewsLetter] as bit) [IsNewsletter],
	cast([IsVerified] as bit) [IsVerified],
	cast([IsActive] as bit) [IsActive],
	cast([EmailConfirmed] as bit) [HasEmailConfirmed],
	cast([PhoneNumberConfirmed] as bit) [HasPhoneNumberConfirmed],
	cast([TwoFactorEnabled] as bit) [HasTwoFactorEnabled],
	cast([LockOutEnabled] as bit) [HasLockoutEnabled],
	cast([WebapiEnabled] as bit) [HasWebAPIEnabled],
	cast([CreationDate] as datetime) [CreatedDate],
	cast([LastLoginDate] as datetime) [LastLoginDateTime],
	cast([LastActivityDate] as datetime) [LastActivityDateTime],
	cast([CreatedOn] as datetime) [Created_RWXUsers],
	cast([UpdatedOn] as datetime) [UpdatedDate_RWXUsers],
	cast([DeletedOn] as datetime) [DeletedDate_RWXUsers],
	cast([LockOutEndDateUTC] as datetime) [LockoutEndDateTimeUTC],
	cast([UserName] as nvarchar(500)) [UserName],
	cast([Email] as nvarchar(320)) [Email],
	cast([Password] as varchar(128)) [Password],
	cast([Comment] as nvarchar(4000)) [Comment],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser_RWXUsers],
	cast([Culture] as nvarchar(10)) [Culture],
	cast([Lastip] as nvarchar(50)) [LastIPAddress],
	cast([VerificationToken] as nvarchar(100)) [VerificationToken],
	cast([PasswordResetToken] as varchar(128)) [PasswordResetToken],
	cast([ServiceAuthorizationToken] as nvarchar(100)) [ServiceAuthorizationToken],
	cast([PasswordHash] as nvarchar(4000)) [PasswordHash],
	cast([SecURItyStamp] as nvarchar(4000)) [SecurityStamp],
	cast([PhoneNumber] as nvarchar(40)) [PhoneNumber] 
From stg.[AH_Users_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Users__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Users__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Users__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Users__dbt_tmp_temp_view"
    end



19:59:18.479523 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:18.479707 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:18.585612 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:28.103249 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 9.62 seconds
19:59:28.119174 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
19:59:28.119603 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: rename object "dbo"."AH_Users__dbt_tmp" to AH_Users
19:59:28.218650 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
19:59:28.220723 [debug] [Thread-4  ]: On model.Shawn.AH_Users: COMMIT
19:59:28.224486 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Users".
19:59:28.224800 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Users: 
    
  if object_id ('"dbo"."AH_Users__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Users__dbt_backup"
    end

19:59:28.280258 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
19:59:28.294345 [debug] [Thread-4  ]: finished collecting timing info
19:59:28.294866 [debug] [Thread-4  ]: On model.Shawn.AH_Users: Close
19:59:28.295738 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc988f7c0>]}
19:59:28.296275 [info ] [Thread-4  ]: 103 of 105 OK created table model dbo.AH_Users.................................. [[32mOK[0m in 9.86s]
19:59:28.297440 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Users
19:59:28.297714 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Version
19:59:28.298125 [info ] [Thread-4  ]: 104 of 105 START table model dbo.AH_Version..................................... [RUN]
19:59:28.300369 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Version"
19:59:28.300884 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Version
19:59:28.301074 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Version
19:59:28.305422 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Version"
19:59:28.305949 [debug] [Thread-4  ]: finished collecting timing info
19:59:28.306149 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Version
19:59:28.346085 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Version"
19:59:28.346948 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
19:59:28.347177 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: 
  
  if object_id ('"dbo"."AH_Version__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Version__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Version__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Version__dbt_tmp"
    end


   EXEC('create view dbo.AH_Version__dbt_tmp_temp_view as
    
Select
	cast([VersionNumber] as nvarchar(4000)) [VersionNumber],
	cast([Status] as nvarchar(4000)) [Status],
	cast([DaTestamp] as datetime) [DaTestamp],
	cast([ID] as int) [ID] 
From stg.[AH_Version_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Version__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Version__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Version__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Version__dbt_tmp_temp_view"
    end



19:59:28.347343 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:28.347526 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:28.462820 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:30.702623 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.36 seconds
19:59:30.723555 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
19:59:30.723994 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: rename object "dbo"."AH_Version__dbt_tmp" to AH_Version
19:59:30.757731 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
19:59:30.759905 [debug] [Thread-4  ]: On model.Shawn.AH_Version: COMMIT
19:59:30.762382 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Version".
19:59:30.763743 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Version: 
    
  if object_id ('"dbo"."AH_Version__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Version__dbt_backup"
    end

19:59:30.800615 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:30.815818 [debug] [Thread-4  ]: finished collecting timing info
19:59:30.816365 [debug] [Thread-4  ]: On model.Shawn.AH_Version: Close
19:59:30.817283 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc988fa60>]}
19:59:30.818812 [info ] [Thread-4  ]: 104 of 105 OK created table model dbo.AH_Version................................ [[32mOK[0m in 2.52s]
19:59:30.820451 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Version
19:59:30.820744 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Watches
19:59:30.821204 [info ] [Thread-4  ]: 105 of 105 START table model dbo.AH_Watches..................................... [RUN]
19:59:30.822598 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Watches"
19:59:30.822821 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Watches
19:59:30.823002 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Watches
19:59:30.826766 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Watches"
19:59:30.827315 [debug] [Thread-4  ]: finished collecting timing info
19:59:30.827522 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Watches
19:59:30.869569 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Watches"
19:59:30.870433 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
19:59:30.870723 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: 
  
  if object_id ('"dbo"."AH_Watches__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Watches__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Watches__dbt_tmp"
    end


   EXEC('create view dbo.AH_Watches__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([UserID] as int) [UserID],
	cast([ListingID] as int) [ListingID],
	cast([DeletedOn] as datetime) [DeletedDate],
	cast([CreatedOn] as datetime) [Created],
	cast([UpdatedOn] as datetime) [UpdatedDate],
	cast([LastUpdatedUser] as nvarchar(500)) [LastUpdatedUser] 
From stg.[AH_Watches_FinalView]
    ');

  CREATE TABLE "dbo"."AH_Watches__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Watches__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Watches__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches__dbt_tmp_temp_view"
    end



19:59:30.870893 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
19:59:30.871078 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
19:59:30.982755 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
19:59:34.386463 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.52 seconds
19:59:34.402334 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
19:59:34.402791 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: rename object "dbo"."AH_Watches__dbt_tmp" to AH_Watches
19:59:34.442498 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:34.444690 [debug] [Thread-4  ]: On model.Shawn.AH_Watches: COMMIT
19:59:34.447337 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches".
19:59:34.447710 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Watches: 
    
  if object_id ('"dbo"."AH_Watches__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Watches__dbt_backup"
    end

19:59:34.486961 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
19:59:34.501966 [debug] [Thread-4  ]: finished collecting timing info
19:59:34.502475 [debug] [Thread-4  ]: On model.Shawn.AH_Watches: Close
19:59:34.503393 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc855e130>]}
19:59:34.503936 [info ] [Thread-4  ]: 105 of 105 OK created table model dbo.AH_Watches................................ [[32mOK[0m in 3.68s]
19:59:34.505118 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Watches
20:00:32.214696 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 75.57 seconds
20:00:32.232096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
20:00:32.232519 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: rename object "dbo"."AH_Userproperties__dbt_tmp" to AH_Userproperties
20:00:32.519223 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
20:00:32.521358 [debug] [Thread-1  ]: On model.Shawn.AH_Userproperties: COMMIT
20:00:32.523703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Userproperties".
20:00:32.524018 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Userproperties: 
    
  if object_id ('"dbo"."AH_Userproperties__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Userproperties__dbt_backup"
    end

20:00:32.566499 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:00:32.582217 [debug] [Thread-1  ]: finished collecting timing info
20:00:32.582761 [debug] [Thread-1  ]: On model.Shawn.AH_Userproperties: Close
20:00:32.583656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc86ffca0>]}
20:00:32.584199 [info ] [Thread-1  ]: 102 of 105 OK created table model dbo.AH_Userproperties......................... [[32mOK[0m in 75.99s]
20:00:32.585384 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Userproperties
20:01:16.478156 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 225.33 seconds
20:01:16.493424 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
20:01:16.493858 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: rename object "dbo"."AH_Mediaassets__dbt_tmp" to AH_Mediaassets
20:01:16.760104 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:01:16.762184 [debug] [Thread-3  ]: On model.Shawn.AH_Mediaassets: COMMIT
20:01:16.764531 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Mediaassets".
20:01:16.764798 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Mediaassets: 
    
  if object_id ('"dbo"."AH_Mediaassets__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Mediaassets__dbt_backup"
    end

20:01:16.807448 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:01:16.822572 [debug] [Thread-3  ]: finished collecting timing info
20:01:16.823097 [debug] [Thread-3  ]: On model.Shawn.AH_Mediaassets: Close
20:01:16.823953 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc870ec10>]}
20:01:16.824485 [info ] [Thread-3  ]: 68 of 105 OK created table model dbo.AH_Mediaassets............................. [[32mOK[0m in 225.72s]
20:01:16.825671 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Mediaassets
20:01:51.802790 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 271.96 seconds
20:01:51.818647 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
20:01:51.819048 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: rename object "dbo"."AH_MediaMetaData__dbt_tmp" to AH_MediaMetaData
20:01:52.077845 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
20:01:52.079956 [debug] [Thread-2  ]: On model.Shawn.AH_MediaMetaData: COMMIT
20:01:52.082193 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_MediaMetaData".
20:01:52.082451 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_MediaMetaData: 
    
  if object_id ('"dbo"."AH_MediaMetaData__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_MediaMetaData__dbt_backup"
    end

20:01:52.125545 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:01:52.139948 [debug] [Thread-2  ]: finished collecting timing info
20:01:52.140455 [debug] [Thread-2  ]: On model.Shawn.AH_MediaMetaData: Close
20:01:52.141374 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8d97d7d-e7ba-4c5d-bcb6-ac4dff25900e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc98b6280>]}
20:01:52.141957 [info ] [Thread-2  ]: 66 of 105 OK created table model dbo.AH_MediaMetaData........................... [[32mOK[0m in 272.34s]
20:01:52.143170 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_MediaMetaData
20:01:52.145712 [debug] [MainThread]: Acquiring new synapse connection "master"
20:01:52.146071 [debug] [MainThread]: On master: COMMIT
20:01:52.146858 [info ] [MainThread]: 
20:01:52.147776 [info ] [MainThread]: Finished running 105 table models in 352.17s.
20:01:52.148898 [debug] [MainThread]: Connection 'master' was properly closed.
20:01:52.149096 [debug] [MainThread]: Connection 'model.Shawn.AH_MediaMetaData' was properly closed.
20:01:52.149249 [debug] [MainThread]: Connection 'model.Shawn.AH_Userproperties' was properly closed.
20:01:52.149387 [debug] [MainThread]: Connection 'model.Shawn.AH_Mediaassets' was properly closed.
20:01:52.149516 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches' was properly closed.
20:01:52.268547 [info ] [MainThread]: 
20:01:52.269639 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
20:01:52.270761 [info ] [MainThread]: 
20:01:52.271590 [error] [MainThread]: [33mDatabase Error in model AH_CreditCards (models/step4_dboSingle/AH_CreditCards.sql)[0m
20:01:52.272419 [error] [MainThread]:   ('22018', "[22018] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Conversion failed when converting the nvarchar value '9f076b7eb7fdc0311cd3208cdbbebbf8014dd3a05e35191c96947b358a362b40' to data type int.  (245) (SQLExecDirectW)")
20:01:52.273337 [error] [MainThread]:   compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_CreditCards.sql
20:01:52.274171 [info ] [MainThread]: 
20:01:52.274779 [error] [MainThread]: [33mDatabase Error in model AH_Tiers (models/step4_dboSingle/AH_Tiers.sql)[0m
20:01:52.275718 [error] [MainThread]:   ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
20:01:52.276515 [error] [MainThread]:   compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_Tiers.sql
20:01:52.277423 [info ] [MainThread]: 
20:01:52.278174 [info ] [MainThread]: Done. PASS=103 WARN=0 ERROR=2 SKIP=0 TOTAL=105
20:01:52.278932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcbde54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcb395250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc8631a30>]}


============================== 2022-09-16 20:10:36.823341 | 951186ba-1fe4-41f5-ad1b-1cb6a93d7d25 ==============================
20:10:36.823341 [info ] [MainThread]: Running with dbt=1.0.0
20:10:36.825464 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['tag:update'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:10:36.826051 [debug] [MainThread]: Tracking: tracking
20:10:36.826889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd80ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd80ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd80ed90>]}
20:10:37.085852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:10:37.087511 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCards.sql
20:10:37.099442 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
20:10:37.159789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '951186ba-1fe4-41f5-ad1b-1cb6a93d7d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd79dac0>]}
20:10:37.209771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '951186ba-1fe4-41f5-ad1b-1cb6a93d7d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fe2cb430>]}
20:10:37.210404 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:10:37.219704 [info ] [MainThread]: 
20:10:37.221460 [debug] [MainThread]: Acquiring new synapse connection "master"
20:10:37.222708 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:10:37.232312 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:10:37.232717 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:10:37.232917 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:10:37.233114 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:10:37.635376 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:10:37.667753 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.43 seconds
20:10:37.669422 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:10:37.704089 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:10:37.710074 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:10:37.710709 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:10:37.712545 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:10:37.712701 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:10:37.712792 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:10:37.712896 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:10:37.710993 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:10:37.714596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:10:37.714824 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:10:37.818290 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:10:37.819003 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:10:37.891145 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
20:10:38.019557 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.30 seconds
20:10:38.190660 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:10:38.199807 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:10:38.217458 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:10:38.227761 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:11:00.991316 [debug] [MainThread]: On master: COMMIT
20:11:00.992060 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:11:00.993123 [info ] [MainThread]: 
20:11:00.997117 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCards
20:11:00.997448 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_CreditCards..................................... [RUN]
20:11:00.998430 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards"
20:11:00.998696 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCards
20:11:00.998899 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCards
20:11:01.002480 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards"
20:11:01.003093 [debug] [Thread-1  ]: finished collecting timing info
20:11:01.003344 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCards
20:11:01.079738 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards"
20:11:01.080633 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:11:01.080907 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_tmp"
    end


   EXEC('create view dbo.AH_CreditCards__dbt_tmp_temp_view as
    
Select
	cast([ID] as int) [ID],
	cast([ExpirationMonth] as nvarchar(4000)) [ExpirationMonth],
	cast([ExpirationYear] as nvarchar(4000)) [ExpirationYear],
	cast([CreditCardTypeID] as int) [CreditCardTypeID],
	cast([UserID] as int) [UserID],
	cast([AddressID] as int) [AddressID],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([CardNumber] as nvarchar(4000)) [CardNumber],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser],
	cast([LastFourdigits] as nvarchar(4000)) [LastFourdigits],
	cast([Description] as nvarchar(4000)) [Description] 
From stg.[AH_CreditCards_FinalView]
    ');

  CREATE TABLE "dbo"."AH_CreditCards__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_CreditCards__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_CreditCards__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_CreditCards__dbt_tmp_temp_view"
    end



20:11:01.081068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:11:01.081252 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:11:01.277881 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:11:04.159767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.08 seconds
20:11:04.177248 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:11:04.177668 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: rename object "dbo"."AH_CreditCards__dbt_tmp" to AH_CreditCards
20:11:04.213561 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:11:04.225402 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards: COMMIT
20:11:04.230477 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards".
20:11:04.230889 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards: 
    
  if object_id ('"dbo"."AH_CreditCards__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_CreditCards__dbt_backup"
    end

20:11:04.267187 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:11:04.281071 [debug] [Thread-1  ]: finished collecting timing info
20:11:04.281538 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards: Close
20:11:04.282348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '951186ba-1fe4-41f5-ad1b-1cb6a93d7d25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f708f580>]}
20:11:04.282899 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_CreditCards................................ [[32mOK[0m in 3.28s]
20:11:04.284228 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCards
20:11:04.285527 [debug] [MainThread]: Acquiring new synapse connection "master"
20:11:04.285783 [debug] [MainThread]: On master: COMMIT
20:11:04.286076 [info ] [MainThread]: 
20:11:04.287060 [info ] [MainThread]: Finished running 1 table model in 27.06s.
20:11:04.287700 [debug] [MainThread]: Connection 'master' was properly closed.
20:11:04.287891 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:11:04.288034 [debug] [MainThread]: Connection 'model.Shawn.AH_CreditCards' was properly closed.
20:11:04.326884 [info ] [MainThread]: 
20:11:04.328331 [info ] [MainThread]: [32mCompleted successfully[0m
20:11:04.329404 [info ] [MainThread]: 
20:11:04.330224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:11:04.331196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd1b1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93fd7c8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f70c7640>]}


============================== 2022-09-16 20:14:08.993410 | 436bed84-085e-4f8c-93a2-6d75c13755c3 ==============================
20:14:08.993410 [info ] [MainThread]: Running with dbt=1.0.0
20:14:08.999688 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['tag:update'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:14:09.000101 [debug] [MainThread]: Tracking: tracking
20:14:09.000509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacb0d9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacb0d9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacb0d9dc0>]}
20:14:09.233496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
20:14:09.235344 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Tiers.sql
20:14:09.235835 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_CreditCards.sql
20:14:09.247854 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
20:14:09.259555 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
20:14:09.310608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '436bed84-085e-4f8c-93a2-6d75c13755c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacb03c0a0>]}
20:14:09.362464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '436bed84-085e-4f8c-93a2-6d75c13755c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacaab47f0>]}
20:14:09.363157 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:14:09.372227 [info ] [MainThread]: 
20:14:09.373600 [debug] [MainThread]: Acquiring new synapse connection "master"
20:14:09.375256 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:14:09.384942 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:14:09.385303 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:14:09.385484 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:14:09.385687 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:09.771621 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:09.816605 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.43 seconds
20:14:09.818777 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:14:09.841499 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:14:09.847668 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:14:09.848095 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:14:09.849950 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:14:09.850103 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:14:09.850192 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:14:09.850297 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:09.848437 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:14:09.851959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:14:09.852196 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:09.975172 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:09.977307 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:10.042869 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:14:10.043449 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
20:14:10.192293 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:14:10.201067 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:14:10.220447 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:14:10.231763 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:14:32.095876 [debug] [MainThread]: On master: COMMIT
20:14:32.096656 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:14:32.097738 [info ] [MainThread]: 
20:14:32.102599 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Tiers
20:14:32.102952 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Tiers........................................... [RUN]
20:14:32.103974 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Tiers"
20:14:32.104212 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Tiers
20:14:32.104415 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Tiers
20:14:32.108655 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Tiers"
20:14:32.109335 [debug] [Thread-1  ]: finished collecting timing info
20:14:32.109782 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Tiers
20:14:32.176160 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Tiers"
20:14:32.177015 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:14:32.177254 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Tiers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Tiers__dbt_tmp_temp_view as
    
Select
	cast([Upperboundexclusive] as numeric(24,4)) [Upperboundexclusive],
	cast([Value] as numeric(19,4)) [Value],
	cast([Lowerboundinclusive] as numeric(19,4)) [Lowerboundinclusive],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([FeescheduleID] as int) [FeescheduleID],
	cast([ValueType] as nvarchar(4000)) [ValueType],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Tiers_FinalView]

\
    ');

  CREATE TABLE "dbo"."AH_Tiers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Tiers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end



20:14:32.177462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:14:32.177646 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:32.307865 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:35.038499 [debug] [Thread-1  ]: SQLServer adapter: Database error: ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
20:14:35.038953 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: ROLLBACK
20:14:35.039112 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: Close
20:14:35.039560 [debug] [Thread-1  ]: finished collecting timing info
20:14:35.040003 [debug] [Thread-1  ]: Database Error in model AH_Tiers (models/step4_dboSingle/AH_Tiers.sql)
  ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
  compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_Tiers.sql
20:14:35.040367 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '436bed84-085e-4f8c-93a2-6d75c13755c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac8a15a60>]}
20:14:35.040790 [error] [Thread-1  ]: 1 of 1 ERROR creating table model dbo.AH_Tiers.................................. [[31mERROR[0m in 2.94s]
20:14:35.041255 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Tiers
20:14:35.043812 [debug] [MainThread]: Acquiring new synapse connection "master"
20:14:35.044114 [debug] [MainThread]: On master: COMMIT
20:14:35.044447 [info ] [MainThread]: 
20:14:35.044811 [info ] [MainThread]: Finished running 1 table model in 25.67s.
20:14:35.045105 [debug] [MainThread]: Connection 'master' was properly closed.
20:14:35.045260 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:14:35.045409 [debug] [MainThread]: Connection 'model.Shawn.AH_Tiers' was properly closed.
20:14:35.077565 [info ] [MainThread]: 
20:14:35.078676 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:14:35.079752 [info ] [MainThread]: 
20:14:35.080594 [error] [MainThread]: [33mDatabase Error in model AH_Tiers (models/step4_dboSingle/AH_Tiers.sql)[0m
20:14:35.081404 [error] [MainThread]:   ('22003', '[22003] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server][Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Arithmetic overflow error converting numeric to data type numeric.  (8115) (SQLExecDirectW)')
20:14:35.082242 [error] [MainThread]:   compiled SQL at target/run/Shawn/models/step4_dboSingle/AH_Tiers.sql
20:14:35.083068 [info ] [MainThread]: 
20:14:35.083672 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
20:14:35.086100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacd0e5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacb01b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac89affd0>]}


============================== 2022-09-16 20:14:54.703727 | 322a813b-820b-436d-867e-2ed50bf71ef4 ==============================
20:14:54.703727 [info ] [MainThread]: Running with dbt=1.0.0
20:14:54.707540 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['tag:update'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
20:14:54.709062 [debug] [MainThread]: Tracking: tracking
20:14:54.709536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d8794d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d8794df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d8794e50>]}
20:14:54.932752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:14:54.934270 [debug] [MainThread]: Partial parsing: updated file: Shawn://models/step4_dboSingle/AH_Tiers.sql
20:14:54.946159 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
20:14:55.004426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '322a813b-820b-436d-867e-2ed50bf71ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d871fb80>]}
20:14:55.052708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '322a813b-820b-436d-867e-2ed50bf71ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d9245220>]}
20:14:55.053320 [info ] [MainThread]: Found 353 models, 0 tests, 101 snapshots, 0 analyses, 212 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
20:14:55.061742 [info ] [MainThread]: 
20:14:55.062983 [debug] [MainThread]: Acquiring new synapse connection "master"
20:14:55.064973 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
20:14:55.074403 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
20:14:55.074697 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
20:14:55.074874 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:14:55.075058 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:55.430057 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:55.477942 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.40 seconds
20:14:55.479992 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
20:14:55.502447 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
20:14:55.508514 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
20:14:55.508902 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
20:14:55.510650 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
20:14:55.510795 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
20:14:55.510885 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:14:55.510988 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:55.509201 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
20:14:55.512578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:14:55.512777 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:14:55.612788 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:55.613302 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:14:55.684813 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:14:55.686032 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
20:14:55.820118 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
20:14:55.820455 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
20:14:55.857697 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
20:14:55.867771 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
20:15:18.145192 [debug] [MainThread]: On master: COMMIT
20:15:18.145978 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
20:15:18.147092 [info ] [MainThread]: 
20:15:18.153648 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Tiers
20:15:18.154006 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Tiers........................................... [RUN]
20:15:18.154996 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Tiers"
20:15:18.156042 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Tiers
20:15:18.156309 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Tiers
20:15:18.159907 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Tiers"
20:15:18.160449 [debug] [Thread-1  ]: finished collecting timing info
20:15:18.160695 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Tiers
20:15:18.227822 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Tiers"
20:15:18.228679 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:15:18.229017 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Tiers__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_tmp"
    end


   EXEC('create view dbo.AH_Tiers__dbt_tmp_temp_view as
    
Select
	cast([Upperboundexclusive] as numeric(26,4)) [Upperboundexclusive],
	cast([Value] as numeric(19,4)) [Value],
	cast([Lowerboundinclusive] as numeric(19,4)) [Lowerboundinclusive],
	cast([CreatedOn] as datetime) [CreatedOn],
	cast([UpdatedOn] as datetime) [UpdatedOn],
	cast([DeletedOn] as datetime) [DeletedOn],
	cast([ID] as int) [ID],
	cast([FeescheduleID] as int) [FeescheduleID],
	cast([ValueType] as nvarchar(4000)) [ValueType],
	cast([LastUpdatedUser] as nvarchar(4000)) [LastUpdatedUser] 
From stg.[AH_Tiers_FinalView]

\
    ');

  CREATE TABLE "dbo"."AH_Tiers__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Tiers__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Tiers__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Tiers__dbt_tmp_temp_view"
    end



20:15:18.229189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:15:18.229370 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
20:15:18.355563 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
20:15:19.900098 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
20:15:19.919220 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:15:19.919644 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: rename object "dbo"."AH_Tiers__dbt_tmp" to AH_Tiers
20:15:20.194137 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
20:15:20.205057 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: COMMIT
20:15:20.209992 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Tiers".
20:15:20.210344 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Tiers: 
    
  if object_id ('"dbo"."AH_Tiers__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Tiers__dbt_backup"
    end

20:15:20.250298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
20:15:20.263312 [debug] [Thread-1  ]: finished collecting timing info
20:15:20.263751 [debug] [Thread-1  ]: On model.Shawn.AH_Tiers: Close
20:15:20.264537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322a813b-820b-436d-867e-2ed50bf71ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d60539a0>]}
20:15:20.265053 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Tiers...................................... [[32mOK[0m in 2.11s]
20:15:20.266066 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Tiers
20:15:20.267868 [debug] [MainThread]: Acquiring new synapse connection "master"
20:15:20.268126 [debug] [MainThread]: On master: COMMIT
20:15:20.268408 [info ] [MainThread]: 
20:15:20.269034 [info ] [MainThread]: Finished running 1 table model in 25.21s.
20:15:20.269692 [debug] [MainThread]: Connection 'master' was properly closed.
20:15:20.269885 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
20:15:20.270028 [debug] [MainThread]: Connection 'model.Shawn.AH_Tiers' was properly closed.
20:15:20.300177 [info ] [MainThread]: 
20:15:20.301173 [info ] [MainThread]: [32mCompleted successfully[0m
20:15:20.302139 [info ] [MainThread]: 
20:15:20.302774 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:15:20.303748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d6051e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d871fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6d6065f40>]}
