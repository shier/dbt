

============================== 2022-09-14 21:50:29.684250 | 250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e ==============================
21:50:29.684250 [info ] [MainThread]: Running with dbt=1.0.0
21:50:29.684851 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step2_Incr'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
21:50:29.685086 [debug] [MainThread]: Tracking: tracking
21:50:29.685416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9b3ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9b3edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9b3ee20>]}
21:50:29.717595 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
21:50:29.720411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9afa160>]}
21:50:29.836226 [debug] [MainThread]: Parsing macros/macro_practice.sql
21:50:29.838190 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
21:50:29.839306 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:50:29.844607 [debug] [MainThread]: Parsing macros/materializations/seeds/str_replace.sql
21:50:29.845375 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:50:29.850849 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:50:29.852349 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:50:29.855141 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:50:29.855860 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:50:29.857792 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:50:29.862208 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:50:29.865201 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:50:29.871213 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:50:29.872157 [debug] [MainThread]: Parsing macros/adapters.sql
21:50:29.872366 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:50:29.877231 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:50:29.878450 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:50:29.885446 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:50:29.887281 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:50:29.887967 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:50:29.889380 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:50:29.893640 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:50:29.896156 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:50:29.897575 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:50:29.898043 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:50:29.898245 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:50:29.902813 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:50:29.907355 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:50:29.912638 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:50:29.921369 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:50:29.924526 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:50:29.928911 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:50:29.931547 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:50:29.933429 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:50:29.937919 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:50:29.939796 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:50:29.945929 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:50:29.962001 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:50:29.973629 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:50:29.975373 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:50:29.992071 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:50:30.003171 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:50:30.007658 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:50:30.018972 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:50:30.029045 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:50:30.030769 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:50:30.046241 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:50:30.053651 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:50:30.056621 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:50:30.059023 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:50:30.061705 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:50:30.068807 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:50:30.070226 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:50:30.071018 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:50:30.072426 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:50:30.073042 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:50:30.073950 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:50:30.076872 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:50:30.081310 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:50:30.088937 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:50:30.098673 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:50:30.108167 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:50:30.110971 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:50:30.113197 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:50:30.121621 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:50:30.125987 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:50:30.127837 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:50:30.130524 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:50:30.132117 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:50:30.350989 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Tiers.sql
21:50:30.361438 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Categories.sql
21:50:30.363705 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Events.sql
21:50:30.365797 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Locations.sql
21:50:30.367798 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingsReserveHistory.sql
21:50:30.370055 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingPaymentCharge.sql
21:50:30.372002 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserMessages.sql
21:50:30.373954 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ReListHistory.sql
21:50:30.375921 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeproperties.sql
21:50:30.377873 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UnProcessedQueueMessages.sql
21:50:30.380108 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCustomFields.sql
21:50:30.382041 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeschedules.sql
21:50:30.383981 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListings.sql
21:50:30.385915 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_LogentriesBuffer.sql
21:50:30.387876 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_DailyhuntEmailSubscribers.sql
21:50:30.389830 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Languages.sql
21:50:30.392025 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Reports.sql
21:50:30.393949 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserAlerts.sql
21:50:30.395933 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Propertybags.sql
21:50:30.397857 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingQuestions.sql
21:50:30.399831 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingMedias.sql
21:50:30.402001 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feedbacks.sql
21:50:30.403961 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ExternalUserIDs.sql
21:50:30.405899 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listings.sql
21:50:30.407854 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_MediaassetMetaData.sql
21:50:30.409803 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingOptions.sql
21:50:30.411760 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingLocations.sql
21:50:30.414375 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Siteproperties.sql
21:50:30.416305 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplates.sql
21:50:30.418228 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedCategoryMap.sql
21:50:30.420192 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentprovIDErs.sql
21:50:30.422137 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_States.sql
21:50:30.424330 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Increments.sql
21:50:30.426367 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ThReadTracking.sql
21:50:30.428330 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserOptOut.sql
21:50:30.430276 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Attributes.sql
21:50:30.432253 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingEnddttmAudit.sql
21:50:30.434224 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ShippingMethods.sql
21:50:30.436520 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActions.sql
21:50:30.438472 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannerCategories.sql
21:50:30.440473 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logentries.sql
21:50:30.442427 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Properties.sql
21:50:30.444412 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BiddingTransactions.sql
21:50:30.446668 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Banners.sql
21:50:30.448617 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contents.sql
21:50:30.450610 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedUserMap.sql
21:50:30.452569 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SalesTaxRates.sql
21:50:30.454572 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Notifications.sql
21:50:30.456543 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Feeproperties.sql
21:50:30.458796 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeFeeprovIDErs.sql
21:50:30.460745 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEventMedias.sql
21:50:30.462763 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_AuctionEvents.sql
21:50:30.464725 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplates.sql
21:50:30.466714 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SubmittedListingPayment.sql
21:50:30.468958 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SysDiagrams.sql
21:50:30.470956 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Lots.sql
21:50:30.472909 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardTypes.sql
21:50:30.474902 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Listingdecorations.sql
21:50:30.476858 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_KeyTable.sql
21:50:30.478841 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Watches.sql
21:50:30.481050 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_StripeCustomers.sql
21:50:30.483017 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PropertybagItems.sql
21:50:30.484972 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Version.sql
21:50:30.486937 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_UserLogins.sql
21:50:30.488909 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Userclaims.sql
21:50:30.491223 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Logstats.sql
21:50:30.493174 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Customcurrencies.sql
21:50:30.495194 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingActionproperties.sql
21:50:30.497179 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryCount.sql
21:50:30.499177 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedregionMap.sql
21:50:30.501153 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_NewSalestoInvoice.sql
21:50:30.503405 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Offers.sql
21:50:30.505339 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Currencies.sql
21:50:30.507309 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CategoryListingTypes.sql
21:50:30.509264 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypeMedia.sql
21:50:30.511235 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_SMStemplatecontents.sql
21:50:30.513590 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentResponses.sql
21:50:30.515545 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CustomFieldenums.sql
21:50:30.517486 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Decorations.sql
21:50:30.519458 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingTypes.sql
21:50:30.521393 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Emailtemplatecontents.sql
21:50:30.523361 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCards.sql
21:50:30.525553 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ListingComments.sql
21:50:30.527708 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Contactus.sql
21:50:30.529823 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Model.sql
21:50:30.531974 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_PaymentConfigurationTable.sql
21:50:30.533937 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_ImportedListingsMap.sql
21:50:30.536218 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_Eventproperties.sql
21:50:30.538158 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_CreditCardsExtraInFormation.sql
21:50:30.540126 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboSingle/AH_BannedUsers.sql
21:50:30.542113 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Invoice.sql
21:50:30.544090 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Media.sql
21:50:30.546061 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_MediaAssetMetaData.sql
21:50:30.548564 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Customer.sql
21:50:30.550504 [debug] [MainThread]: 1699: static parser successfully parsed step4_dboJoin/AH_Car.sql
21:50:30.552715 [debug] [MainThread]: 1603: static parser failed on tmp/SZ_AH_Properties_Pivot_Full.sql
21:50:30.569090 [debug] [MainThread]: 1602: parser fallback to jinja rendering on tmp/SZ_AH_Properties_Pivot_Full.sql
21:50:30.570770 [debug] [MainThread]: 1699: static parser successfully parsed step8_4_FT/AH_Listings_FT.sql
21:50:30.573366 [debug] [MainThread]: 1603: static parser failed on step7_3/SZ_AH_AllProperties_One_Column.sql
21:50:30.580287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_3/SZ_AH_AllProperties_One_Column.sql
21:50:30.581695 [debug] [MainThread]: 1699: static parser successfully parsed step7_3/SZ_AH_Properties_CustomFields_Lookup.sql
21:50:30.583868 [debug] [MainThread]: 1699: static parser successfully parsed step8_2_FT_stg/AH_Listings_FT_stg.sql
21:50:30.586001 [debug] [MainThread]: 1603: static parser failed on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
21:50:30.591466 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_2/SZ_AH_Properties_Value_ColumnMapping.sql
21:50:30.592593 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldType.sql
21:50:30.594524 [debug] [MainThread]: 1699: static parser successfully parsed step7_1/SZ_AH_Properties_FieldIDs.sql
21:50:30.596533 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UserLogins_Incr.sql
21:50:30.604726 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UserLogins_Incr.sql
21:50:30.605930 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_CreditCards_Incr.sql
21:50:30.609723 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_CreditCards_Incr.sql
21:50:30.610915 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_Logstats_Incr.sql
21:50:30.614692 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_Logstats_Incr.sql
21:50:30.615924 [debug] [MainThread]: 1603: static parser failed on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
21:50:30.619568 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step2_Incr/AH_UnProcessedQueueMessages_Incr.sql
21:50:30.620816 [debug] [MainThread]: 1603: static parser failed on step7_4/SZ_AH_Properties_Pivot.sql
21:50:30.628281 [debug] [MainThread]: 1602: parser fallback to jinja rendering on step7_4/SZ_AH_Properties_Pivot.sql
21:50:30.629465 [debug] [MainThread]: 1699: static parser successfully parsed step8_1_DM/AH_Cars_DM.sql
21:50:30.631517 [debug] [MainThread]: 1699: static parser successfully parsed step8_3_FT_tmp/AH_Listings_FT_tmp.sql
21:50:30.633498 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingActions_FT_stg.sql
21:50:30.635480 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Watches_FT_stg.sql
21:50:30.637638 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_Invoices_FT_stg.sql
21:50:30.639603 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_LineItems_FT_stg.sql
21:50:30.641529 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_ListingPaymentCharge_FT_stg.sql
21:50:30.643457 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_1_stg/AH_SubmittedListingPayment_FT_stg.sql
21:50:30.645379 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_LineItems_FT_tmp.sql
21:50:30.648776 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_SubmittedListingPayment_FT_tmp.sql
21:50:30.650740 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Invoices_FT_tmp.sql
21:50:30.652640 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_Watches_FT_tmp.sql
21:50:30.654643 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingActions_FT_tmp.sql
21:50:30.656561 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_2_tmp/AH_ListingPaymentCharge_FT_tmp.sql
21:50:30.658485 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Users_InterView.sql
21:50:30.660655 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannerCategories_InterView.sql
21:50:30.662584 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Events_InterView.sql
21:50:30.664502 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logstats_InterView.sql
21:50:30.666414 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Attributes_InterView.sql
21:50:30.668371 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserRoles_InterView.sql
21:50:30.670583 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Locations_InterView.sql
21:50:30.672500 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediavariations_InterView.sql
21:50:30.674424 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SalesTaxRates_InterView.sql
21:50:30.676371 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFieldenums_InterView.sql
21:50:30.678287 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedUserMap_InterView.sql
21:50:30.680232 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Increments_InterView.sql
21:50:30.682435 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Customcurrencies_InterView.sql
21:50:30.684393 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Lots_InterView.sql
21:50:30.686319 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contactus_InterView.sql
21:50:30.688327 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplates_InterView.sql
21:50:30.690289 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BannedUsers_InterView.sql
21:50:30.693045 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userproperties_InterView.sql
21:50:30.695031 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCards_InterView.sql
21:50:30.696975 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Offers_InterView.sql
21:50:30.698933 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PropertybagItems_InterView.sql
21:50:30.700871 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActionproperties_InterView.sql
21:50:30.702841 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_States_InterView.sql
21:50:30.705031 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCustomFields_InterView.sql
21:50:30.706983 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingComments_InterView.sql
21:50:30.708918 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CustomFields_InterView.sql
21:50:30.710887 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Version_InterView.sql
21:50:30.712810 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Categories_InterView.sql
21:50:30.715051 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaMetaData_InterView.sql
21:50:30.716976 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingsReserveHistory_InterView.sql
21:50:30.718941 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypes_InterView.sql
21:50:30.720908 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeFeeprovIDErs_InterView.sql
21:50:30.722867 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardsExtraInFormation_InterView.sql
21:50:30.724796 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentprovIDErs_InterView.sql
21:50:30.727015 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingLocations_InterView.sql
21:50:30.729328 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Banners_InterView.sql
21:50:30.731526 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Eventproperties_InterView.sql
21:50:30.733463 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingCommentsMedias_InterView.sql
21:50:30.735430 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Languages_InterView.sql
21:50:30.737649 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplatecontents_InterView.sql
21:50:30.739623 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feedbacks_InterView.sql
21:50:30.741555 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEvents_InterView.sql
21:50:30.743534 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SubmittedListingPayment_InterView.sql
21:50:30.745479 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_AuctionEventMedias_InterView.sql
21:50:30.747438 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingQuestions_InterView.sql
21:50:30.749667 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingOptions_InterView.sql
21:50:30.751645 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Contents_InterView.sql
21:50:30.753570 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedListingsMap_InterView.sql
21:50:30.755561 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Properties_InterView.sql
21:50:30.757494 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingdecorations_InterView.sql
21:50:30.759776 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeschedules_InterView.sql
21:50:30.761706 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedCategoryMap_InterView.sql
21:50:30.763692 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Emailtemplates_InterView.sql
21:50:30.765624 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Reports_InterView.sql
21:50:30.767571 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CreditCardTypes_InterView.sql
21:50:30.769501 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserAlerts_InterView.sql
21:50:30.771715 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeMedia_InterView.sql
21:50:30.773642 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ExternalUserIDs_InterView.sql
21:50:30.775607 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ThReadTracking_InterView.sql
21:50:30.777541 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ShippingMethods_InterView.sql
21:50:30.779500 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Invoices_InterView.sql
21:50:30.781886 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_MediaassetMetaData_InterView.sql
21:50:30.783805 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Propertybags_InterView.sql
21:50:30.785719 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingPaymentCharge_InterView.sql
21:50:30.787670 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingTypeproperties_InterView.sql
21:50:30.789612 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Logentries_InterView.sql
21:50:30.791573 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listings_InterView.sql
21:50:30.793751 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Notifications_InterView.sql
21:50:30.795692 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingActions_InterView.sql
21:50:30.797595 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_KeyTable_InterView.sql
21:50:30.799542 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Watches_InterView.sql
21:50:30.801461 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Siteproperties_InterView.sql
21:50:30.803720 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserOptOut_InterView.sql
21:50:30.805639 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_BiddingTransactions_InterView.sql
21:50:30.807616 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SysDiagrams_InterView.sql
21:50:30.809575 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Tiers_InterView.sql
21:50:30.811552 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentConfigurationTable_InterView.sql
21:50:30.813476 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Userclaims_InterView.sql
21:50:30.815700 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserLogins_InterView.sql
21:50:30.817623 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ImportedregionMap_InterView.sql
21:50:30.819600 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Countries_InterView.sql
21:50:30.821562 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LineItems_InterView.sql
21:50:30.823525 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UnProcessedQueueMessages_InterView.sql
21:50:30.825722 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryCount_InterView.sql
21:50:30.827673 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_StripeCustomers_InterView.sql
21:50:30.829620 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_UserMessages_InterView.sql
21:50:30.831588 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Decorations_InterView.sql
21:50:30.833539 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Model_InterView.sql
21:50:30.835519 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Addresses_InterView.sql
21:50:30.837700 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Mediaassets_InterView.sql
21:50:30.839644 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Roles_InterView.sql
21:50:30.841570 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_NewSalestoInvoice_InterView.sql
21:50:30.843521 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListingTypes_InterView.sql
21:50:30.845452 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ReListHistory_InterView.sql
21:50:30.847695 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Listingproperties_InterView.sql
21:50:30.849628 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Feeproperties_InterView.sql
21:50:30.851578 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Currencies_InterView.sql
21:50:30.853516 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingMedias_InterView.sql
21:50:30.855547 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_Media_InterView.sql
21:50:30.857495 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_ListingEnddttmAudit_InterView.sql
21:50:30.859696 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_PaymentResponses_InterView.sql
21:50:30.861619 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_CategoryListings_InterView.sql
21:50:30.863578 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_LogentriesBuffer_InterView.sql
21:50:30.865502 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_DailyhuntEmailSubscribers_InterView.sql
21:50:30.867522 [debug] [MainThread]: 1699: static parser successfully parsed step1_InterView/AH_SMStemplatecontents_InterView.sql
21:50:30.869696 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Siteproperties_FinalView.sql
21:50:30.871611 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeschedules_FinalView.sql
21:50:30.873517 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Properties_FinalView.sql
21:50:30.875473 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logentries_FinalView.sql
21:50:30.877396 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userclaims_FinalView.sql
21:50:30.879358 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserOptOut_FinalView.sql
21:50:30.881528 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardTypes_FinalView.sql
21:50:30.883470 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_KeyTable_FinalView.sql
21:50:30.885414 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Invoices_FinalView.sql
21:50:30.887356 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LineItems_FinalView.sql
21:50:30.889288 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Propertybags_FinalView.sql
21:50:30.891486 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contactus_FinalView.sql
21:50:30.893389 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Currencies_FinalView.sql
21:50:30.895322 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Users_FinalView.sql
21:50:30.897248 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserMessages_FinalView.sql
21:50:30.899238 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Addresses_FinalView.sql
21:50:30.901187 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingdecorations_FinalView.sql
21:50:30.903397 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Roles_FinalView.sql
21:50:30.905336 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Watches_FinalView.sql
21:50:30.907283 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeMedia_FinalView.sql
21:50:30.909205 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentResponses_FinalView.sql
21:50:30.911161 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SubmittedListingPayment_FinalView.sql
21:50:30.913575 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ExternalUserIDs_FinalView.sql
21:50:30.915512 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SalesTaxRates_FinalView.sql
21:50:30.917407 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserLogins_FinalView.sql
21:50:30.919344 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFields_FinalView.sql
21:50:30.921263 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BiddingTransactions_FinalView.sql
21:50:30.923206 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplates_FinalView.sql
21:50:30.925366 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedregionMap_FinalView.sql
21:50:30.927505 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannerCategories_FinalView.sql
21:50:30.929590 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActions_FinalView.sql
21:50:30.931736 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingOptions_FinalView.sql
21:50:30.933672 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Contents_FinalView.sql
21:50:30.935883 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingActionproperties_FinalView.sql
21:50:30.937783 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ReListHistory_FinalView.sql
21:50:30.939744 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ShippingMethods_FinalView.sql
21:50:30.941655 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Offers_FinalView.sql
21:50:30.943595 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CustomFieldenums_FinalView.sql
21:50:30.945580 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Emailtemplatecontents_FinalView.sql
21:50:30.947744 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediavariations_FinalView.sql
21:50:30.949663 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListingTypes_FinalView.sql
21:50:30.951621 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCustomFields_FinalView.sql
21:50:30.953531 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingPaymentCharge_FinalView.sql
21:50:30.955475 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Userproperties_FinalView.sql
21:50:30.957628 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feeproperties_FinalView.sql
21:50:30.959554 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedCategoryMap_FinalView.sql
21:50:30.961450 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeFeeprovIDErs_FinalView.sql
21:50:30.963398 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingEnddttmAudit_FinalView.sql
21:50:30.965320 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaassetMetaData_FinalView.sql
21:50:30.967271 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listings_FinalView.sql
21:50:30.969399 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Mediaassets_FinalView.sql
21:50:30.971334 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Media_FinalView.sql
21:50:30.973249 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEvents_FinalView.sql
21:50:30.975172 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Locations_FinalView.sql
21:50:30.977084 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryCount_FinalView.sql
21:50:30.979268 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingLocations_FinalView.sql
21:50:30.981160 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplatecontents_FinalView.sql
21:50:30.983087 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingQuestions_FinalView.sql
21:50:30.985006 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CategoryListings_FinalView.sql
21:50:30.986927 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Feedbacks_FinalView.sql
21:50:30.988854 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Lots_FinalView.sql
21:50:30.991005 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SMStemplates_FinalView.sql
21:50:30.992910 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Reports_FinalView.sql
21:50:30.994836 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Countries_FinalView.sql
21:50:30.996739 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Eventproperties_FinalView.sql
21:50:30.998674 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingCommentsMedias_FinalView.sql
21:50:31.000846 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_States_FinalView.sql
21:50:31.002758 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentConfigurationTable_FinalView.sql
21:50:31.004675 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_SysDiagrams_FinalView.sql
21:50:31.006634 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserRoles_FinalView.sql
21:50:31.008575 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_AuctionEventMedias_FinalView.sql
21:50:31.010520 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Listingproperties_FinalView.sql
21:50:31.012722 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UserAlerts_FinalView.sql
21:50:31.014653 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypeproperties_FinalView.sql
21:50:31.016597 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCardsExtraInFormation_FinalView.sql
21:50:31.018496 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_NewSalestoInvoice_FinalView.sql
21:50:31.020455 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Customcurrencies_FinalView.sql
21:50:31.022626 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_DailyhuntEmailSubscribers_FinalView.sql
21:50:31.024511 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Events_FinalView.sql
21:50:31.026413 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedListingsMap_FinalView.sql
21:50:31.028351 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_BannedUsers_FinalView.sql
21:50:31.030260 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_MediaMetaData_FinalView.sql
21:50:31.032195 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Notifications_FinalView.sql
21:50:31.034402 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingsReserveHistory_FinalView.sql
21:50:31.036347 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Decorations_FinalView.sql
21:50:31.038263 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Attributes_FinalView.sql
21:50:31.040201 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Tiers_FinalView.sql
21:50:31.042117 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Model_FinalView.sql
21:50:31.044552 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PaymentprovIDErs_FinalView.sql
21:50:31.046461 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingMedias_FinalView.sql
21:50:31.048387 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ImportedUserMap_FinalView.sql
21:50:31.050293 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingComments_FinalView.sql
21:50:31.052210 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Logstats_FinalView.sql
21:50:31.054111 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_UnProcessedQueueMessages_FinalView.sql
21:50:31.056267 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ThReadTracking_FinalView.sql
21:50:31.058164 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_PropertybagItems_FinalView.sql
21:50:31.060111 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_CreditCards_FinalView.sql
21:50:31.061991 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Version_FinalView.sql
21:50:31.063929 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_LogentriesBuffer_FinalView.sql
21:50:31.066109 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_ListingTypes_FinalView.sql
21:50:31.068021 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Increments_FinalView.sql
21:50:31.070033 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Categories_FinalView.sql
21:50:31.071981 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Banners_FinalView.sql
21:50:31.073903 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_Languages_FinalView.sql
21:50:31.075840 [debug] [MainThread]: 1699: static parser successfully parsed step3_FinalView/AH_StripeCustomers_FinalView.sql
21:50:31.078012 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingPaymentCharge_FT.sql
21:50:31.080037 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Watches_FT.sql
21:50:31.081959 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_LineItems_FT.sql
21:50:31.083914 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_Invoice_FT.sql
21:50:31.085862 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_ListingActions_FT.sql
21:50:31.088039 [debug] [MainThread]: 1699: static parser successfully parsed step6_FT_3/AH_SubmittedListingPayment_FT.sql
21:50:31.089944 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Currencies_DM.sql
21:50:31.091864 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_ShippingOptions_DM.sql
21:50:31.093877 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Buyers_DM.sql
21:50:31.095828 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Categories_DM.sql
21:50:31.097813 [debug] [MainThread]: 1699: static parser successfully parsed step5_DM/AH_Consignors_DM.sql
21:50:31.690003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec96d6610>]}
21:50:31.742458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9735670>]}
21:50:31.743013 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:50:31.751255 [info ] [MainThread]: 
21:50:31.752026 [debug] [MainThread]: Acquiring new synapse connection "master"
21:50:31.753365 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:50:31.758974 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:50:31.759249 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:50:31.759395 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:50:31.759566 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:32.144621 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:32.181450 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:50:32.183496 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:50:32.205585 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:50:32.212838 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:50:32.213344 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:50:32.215452 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:50:32.215689 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:50:32.215824 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:50:32.215971 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:32.213704 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:50:32.217376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:50:32.217893 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:32.327009 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:32.330884 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:32.390234 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:50:32.392209 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:50:32.418715 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:50:32.419121 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:50:32.518686 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:50:32.527707 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:50:46.974893 [debug] [MainThread]: On master: COMMIT
21:50:46.975636 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:50:46.976003 [info ] [MainThread]: 
21:50:46.979273 [debug] [Thread-1  ]: Began running node model.Shawn.AH_CreditCards_Incr
21:50:46.979971 [info ] [Thread-1  ]: 1 of 4 START incremental model stg.AH_CreditCards_Incr.......................... [RUN]
21:50:46.980512 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_CreditCards_Incr"
21:50:46.980692 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_CreditCards_Incr
21:50:46.979532 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Logstats_Incr
21:50:46.981107 [info ] [Thread-2  ]: 2 of 4 START incremental model stg.AH_Logstats_Incr............................. [RUN]
21:50:46.981695 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Logstats_Incr"
21:50:46.981869 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Logstats_Incr
21:50:46.982006 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Logstats_Incr
21:50:46.979637 [debug] [Thread-3  ]: Began running node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:50:46.987439 [info ] [Thread-3  ]: 3 of 4 START incremental model stg.AH_UnProcessedQueueMessages_Incr............. [RUN]
21:50:46.987980 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr"
21:50:46.988155 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:50:46.988296 [debug] [Thread-3  ]: Compiling model.Shawn.AH_UnProcessedQueueMessages_Incr
21:50:46.979720 [debug] [Thread-4  ]: Began running node model.Shawn.AH_UserLogins_Incr
21:50:46.991819 [info ] [Thread-4  ]: 4 of 4 START incremental model stg.AH_UserLogins_Incr........................... [RUN]
21:50:46.992323 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_UserLogins_Incr"
21:50:46.992489 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_UserLogins_Incr
21:50:46.992625 [debug] [Thread-4  ]: Compiling model.Shawn.AH_UserLogins_Incr
21:50:46.980862 [debug] [Thread-1  ]: Compiling model.Shawn.AH_CreditCards_Incr
21:50:47.068483 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Logstats_Incr"
21:50:47.081311 [debug] [Thread-2  ]: finished collecting timing info
21:50:47.081569 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Logstats_Incr
21:50:47.080561 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
21:50:47.079175 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_UserLogins_Incr"
21:50:47.090531 [debug] [Thread-4  ]: finished collecting timing info
21:50:47.090977 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_UserLogins_Incr
21:50:47.090853 [debug] [Thread-3  ]: finished collecting timing info
21:50:47.119224 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:50:47.089800 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_CreditCards_Incr"
21:50:47.204971 [debug] [Thread-1  ]: finished collecting timing info
21:50:47.205317 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_CreditCards_Incr
21:50:47.367895 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:47.399744 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([QueueName], [QueueData], Cast([QueueOrder] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UnProcessedQueueMessages_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_temp_view"
    end



  
21:50:47.401695 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:50:47.401910 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:47.374773 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:47.403365 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserLogins_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserLogins_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserLogins_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat([LoginprovIDEr], [ProvIDErKey], Cast([UserID] as varchar))) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_UserLogins_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_UserLogins_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserLogins_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserLogins_Incr__dbt_tmp_temp_view"
    end



  
21:50:47.403566 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:50:47.403716 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:47.401507 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:47.404809 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logstats_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logstats_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logstats_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([FromDate] as varchar), Cast([RangeMinutes] as varchar), Cast([EntryCount] as varchar), Cast([IsArchived] as varchar), [Severity])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at, 
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_Logstats_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_Logstats_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_Logstats_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logstats_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logstats_Incr__dbt_tmp_temp_view"
    end



  
21:50:47.405142 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:50:47.405317 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:47.410020 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:50:47.410251 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCards_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCards_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCards_Incr__dbt_tmp_temp_view as
    
With hashData as (
		Select
			*, HASHBYTES(''SHA2_256'', concat(Cast([ID] as varchar), [ExpirationMonth], [ExpirationYear], Cast([CreditCardTypeID] as varchar), Cast([UserID] as varchar), Cast([AddressID] as varchar), Cast([CreatedOn] as varchar), Cast([UpdatedOn] as varchar), Cast([DeletedOn] as varchar), [CardNumber], [LastUpdatedUser], [LastFourdigits], [Description])) as dbt_scd_id,
			CURRENT_TIMESTAMP as dbt_updated_at,
			CURRENT_TIMESTAMP as dbt_valid_from, 
			NULL as dbt_valid_to
		From stg.[AH_CreditCards_InterView]
	)
Select * From hashData

	where not exists 
	(
		select dbt_scd_id 
		from "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr" compareData
		where hashData.dbt_scd_id=compareData.dbt_scd_id
	)

    ');

  CREATE TABLE "stg"."#AH_CreditCards_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCards_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCards_Incr__dbt_tmp_temp_view"
    end



  
21:50:47.410388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:50:47.410565 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:50:47.541449 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:47.549097 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:47.552030 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:47.552305 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:50:52.054183 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.65 seconds
21:50:52.068823 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:52.069197 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:50:52.142843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.74 seconds
21:50:52.146661 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:52.147095 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:50:52.146977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:50:52.148142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:52.148431 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
    
21:50:52.319404 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:50:52.320990 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:52.321233 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
    
21:50:53.046338 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.64 seconds
21:50:53.049977 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:53.050203 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:50:53.098867 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:50:53.100534 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:53.100781 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
    
21:50:53.734972 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:50:53.737048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:53.737309 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:50:53.766996 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
21:50:53.768699 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:53.768964 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:50:53.908102 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:50:53.913493 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:53.908594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:50:53.915929 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:53.916156 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    
  if object_id ('"stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserLogins_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:50:53.913835 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    
  if object_id ('"stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UnProcessedQueueMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:50:54.052640 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:50:54.054391 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:54.054718 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:50:54.116047 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:50:54.119163 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:54.119457 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'stg'
  
21:50:54.134714 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:50:54.137170 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:54.137428 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    
  if object_id ('"stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logstats_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:50:54.138553 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:50:54.140982 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:54.141176 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'stg'
  
21:50:54.188599 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:50:54.196997 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:54.197344 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserLogins_Incr'
      and table_schema = 'stg'
  
21:50:54.210908 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:50:54.214604 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:54.214907 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UnProcessedQueueMessages_Incr'
      and table_schema = 'stg'
  
21:50:54.233933 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:50:54.246253 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_UserLogins_Incr"
21:50:54.246521 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:50:54.248853 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_UnProcessedQueueMessages_Incr"
21:50:54.249919 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UnProcessedQueueMessages_Incr".
21:50:54.250098 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_UnProcessedQueueMessages_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_UnProcessedQueueMessages_Incr" ("QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "QueueName", "QueueData", "QueueOrder", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_UnProcessedQueueMessages_Incr__dbt_tmp"
          )


  
21:50:54.250505 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_UserLogins_Incr".
21:50:54.250700 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_UserLogins_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_UserLogins_Incr" ("LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "LoginprovIDEr", "ProvIDErKey", "UserID", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_UserLogins_Incr__dbt_tmp"
          )


  
21:50:54.331917 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:50:54.335184 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:54.335425 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'stg'
  
21:50:54.409234 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:50:54.413143 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:54.413416 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logstats_Incr'
      and table_schema = 'stg'
  
21:50:54.462219 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:50:54.467223 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Logstats_Incr"
21:50:54.467841 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Logstats_Incr".
21:50:54.468047 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Logstats_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_Logstats_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_Logstats_Incr" ("FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "FromDate", "RangeMinutes", "EntryCount", "IsArchived", "Severity", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_Logstats_Incr__dbt_tmp"
          )


  
21:50:55.882085 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:50:55.889930 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: COMMIT
21:50:55.899653 [debug] [Thread-4  ]: finished collecting timing info
21:50:55.900008 [debug] [Thread-4  ]: On model.Shawn.AH_UserLogins_Incr: Close
21:50:55.900745 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec0dc0820>]}
21:50:55.901227 [info ] [Thread-4  ]: 4 of 4 OK created incremental model stg.AH_UserLogins_Incr...................... [[32mOK[0m in 8.91s]
21:50:55.901604 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_UserLogins_Incr
21:50:56.051709 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
21:50:56.053840 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: COMMIT
21:50:56.052231 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
21:50:56.060634 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: COMMIT
21:50:56.069861 [debug] [Thread-2  ]: finished collecting timing info
21:50:56.074600 [debug] [Thread-2  ]: On model.Shawn.AH_Logstats_Incr: Close
21:50:56.075395 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec36382b0>]}
21:50:56.075881 [info ] [Thread-2  ]: 2 of 4 OK created incremental model stg.AH_Logstats_Incr........................ [[32mOK[0m in 9.09s]
21:50:56.076256 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Logstats_Incr
21:50:56.074185 [debug] [Thread-3  ]: finished collecting timing info
21:50:56.076613 [debug] [Thread-3  ]: On model.Shawn.AH_UnProcessedQueueMessages_Incr: Close
21:50:56.077251 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec3634790>]}
21:50:56.077642 [info ] [Thread-3  ]: 3 of 4 OK created incremental model stg.AH_UnProcessedQueueMessages_Incr........ [[32mOK[0m in 9.09s]
21:50:56.077972 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_UnProcessedQueueMessages_Incr
21:51:02.952248 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 15.54 seconds
21:51:02.955838 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:02.956078 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:03.000800 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:03.002797 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:03.003053 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
    
21:51:04.047899 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:51:04.049567 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:04.049766 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:04.122101 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:04.124899 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:04.125121 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    
  if object_id ('"stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCards_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:04.334606 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:51:04.337709 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:04.337973 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'stg'
  
21:51:04.410710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:04.414692 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:04.415035 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCards_Incr'
      and table_schema = 'stg'
  
21:51:04.454395 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:04.457728 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_CreditCards_Incr"
21:51:04.458358 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_CreditCards_Incr".
21:51:04.458594 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_CreditCards_Incr: 
      
      
      delete from "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr"
          where (
                dbt_scd_id) in (
      select (dbt_scd_id)
      from "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
          );

      
      

      insert into "BJAC_DW_PROD"."stg"."AH_CreditCards_Incr" ("ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to")
          (
      select "ID", "ExpirationMonth", "ExpirationYear", "CreditCardTypeID", "UserID", "AddressID", "CreatedOn", "UpdatedOn", "DeletedOn", "CardNumber", "LastUpdatedUser", "LastFourdigits", "Description", "dbt_scd_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to"
      from "BJAC_DW_PROD"."stg"."#AH_CreditCards_Incr__dbt_tmp"
          )


  
21:51:05.815608 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:51:05.817454 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: COMMIT
21:51:05.828234 [debug] [Thread-1  ]: finished collecting timing info
21:51:05.828679 [debug] [Thread-1  ]: On model.Shawn.AH_CreditCards_Incr: Close
21:51:05.829490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '250db4f2-d3eb-4ba9-a0cc-6f736b4f5c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec36384c0>]}
21:51:05.829983 [info ] [Thread-1  ]: 1 of 4 OK created incremental model stg.AH_CreditCards_Incr..................... [[32mOK[0m in 18.85s]
21:51:05.830367 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_CreditCards_Incr
21:51:05.831889 [debug] [MainThread]: Acquiring new synapse connection "master"
21:51:05.832217 [debug] [MainThread]: On master: COMMIT
21:51:05.832588 [info ] [MainThread]: 
21:51:05.832861 [info ] [MainThread]: Finished running 4 incremental models in 34.08s.
21:51:05.833073 [debug] [MainThread]: Connection 'master' was properly closed.
21:51:05.833187 [debug] [MainThread]: Connection 'model.Shawn.AH_Logstats_Incr' was properly closed.
21:51:05.833288 [debug] [MainThread]: Connection 'model.Shawn.AH_CreditCards_Incr' was properly closed.
21:51:05.833385 [debug] [MainThread]: Connection 'model.Shawn.AH_UnProcessedQueueMessages_Incr' was properly closed.
21:51:05.833480 [debug] [MainThread]: Connection 'model.Shawn.AH_UserLogins_Incr' was properly closed.
21:51:05.862467 [info ] [MainThread]: 
21:51:05.862899 [info ] [MainThread]: [32mCompleted successfully[0m
21:51:05.863215 [info ] [MainThread]: 
21:51:05.863416 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
21:51:05.863736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9a564f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec9a56c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbec3655df0>]}


============================== 2022-09-14 21:51:08.180520 | 6063415e-760d-41e0-a01c-a8497e9d5756 ==============================
21:51:08.180520 [info ] [MainThread]: Running with dbt=1.0.0
21:51:08.185014 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='snapshot', select=None, selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='snapshot', write_json=None)
21:51:08.185285 [debug] [MainThread]: Tracking: tracking
21:51:08.185639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09dc0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09dc0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09dc0e80>]}
21:51:08.385745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:51:08.386149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:51:08.412946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09d2f310>]}
21:51:08.461286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09ad3a30>]}
21:51:08.461849 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
21:51:08.474816 [info ] [MainThread]: 
21:51:08.475636 [debug] [MainThread]: Acquiring new synapse connection "master"
21:51:08.481192 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
21:51:08.490559 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
21:51:08.490854 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
21:51:08.490997 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:51:08.491156 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:08.786039 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:08.821596 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:51:08.823590 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
21:51:08.844899 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
21:51:08.851592 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
21:51:08.852040 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
21:51:08.853922 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
21:51:08.854128 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
21:51:08.854257 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:51:08.854397 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:08.852369 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
21:51:08.855943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:51:08.856146 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:08.975470 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:08.979193 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:09.013764 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:51:09.037918 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
21:51:09.038331 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
21:51:09.046147 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:51:09.235311 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
21:51:09.247693 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
21:51:23.258997 [debug] [MainThread]: On master: COMMIT
21:51:23.259695 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
21:51:23.260033 [info ] [MainThread]: 
21:51:23.264778 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Addresses_Incr
21:51:23.265541 [info ] [Thread-1  ]: 1 of 101 START snapshot stg.AH_Addresses_Incr................................... [RUN]
21:51:23.266107 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Addresses_Incr"
21:51:23.265275 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_AuctionEvents_Incr
21:51:23.265076 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Attributes_Incr
21:51:23.266865 [info ] [Thread-2  ]: 2 of 101 START snapshot stg.AH_Attributes_Incr.................................. [RUN]
21:51:23.267290 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Attributes_Incr"
21:51:23.267450 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Attributes_Incr
21:51:23.267609 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Attributes_Incr
21:51:23.265187 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:51:23.271204 [info ] [Thread-3  ]: 3 of 101 START snapshot stg.AH_AuctionEventMedias_Incr.......................... [RUN]
21:51:23.271872 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr"
21:51:23.272055 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:51:23.266304 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Addresses_Incr
21:51:23.272330 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Addresses_Incr
21:51:23.266611 [info ] [Thread-4  ]: 4 of 101 START snapshot stg.AH_AuctionEvents_Incr............................... [RUN]
21:51:23.275762 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr"
21:51:23.275933 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_AuctionEvents_Incr
21:51:23.276090 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_AuctionEvents_Incr
21:51:23.272203 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_AuctionEventMedias_Incr
21:51:23.281869 [debug] [Thread-3  ]: finished collecting timing info
21:51:23.282107 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:51:23.275151 [debug] [Thread-1  ]: finished collecting timing info
21:51:23.287469 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Addresses_Incr
21:51:23.270890 [debug] [Thread-2  ]: finished collecting timing info
21:51:23.314818 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Attributes_Incr
21:51:23.279051 [debug] [Thread-4  ]: finished collecting timing info
21:51:23.333317 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_AuctionEvents_Incr
21:51:23.336705 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:23.333124 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:23.337121 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:23.337246 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:51:23.337386 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:23.332164 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:23.338907 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:23.339109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:51:23.339509 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:23.330209 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:23.340496 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:23.340648 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:51:23.340787 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:23.336974 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:23.341582 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:51:23.341908 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:23.464726 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:23.465459 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:23.472868 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:23.474090 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:23.498334 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:51:23.498861 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:51:23.507754 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:51:23.507969 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:51:23.669755 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:23.671890 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:23.672378 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:23.670946 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:23.672698 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:23.666747 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:23.672950 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:23.672228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:23.703824 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:23.711746 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:23.712129 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:23.729633 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:23.728023 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:23.730018 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Addresses_InterView]
        ) as __dbt_sbq
    
21:51:23.712247 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:23.731896 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:23.732097 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]
        ) as __dbt_sbq
    
21:51:23.729872 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_AuctionEvents_InterView]
        ) as __dbt_sbq
    
21:51:23.727314 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:23.732460 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Attributes_InterView]
        ) as __dbt_sbq
    
21:51:23.787847 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:23.797517 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:23.797864 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:23.797982 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:23.826425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:23.868911 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        ) as __dbt_sbq
    
21:51:23.868780 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:23.873454 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        ) as __dbt_sbq
    
21:51:23.868047 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:23.873755 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        ) as __dbt_sbq
    
21:51:23.873067 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:23.874007 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        ) as __dbt_sbq
    
21:51:23.926627 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:51:23.941624 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:23.941976 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
21:51:23.942597 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:23.945445 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:23.945654 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
21:51:23.948483 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:23.951446 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:23.951634 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
21:51:24.015417 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:24.015889 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:24.019374 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:24.060325 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:24.065160 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:24.065644 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEvents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689''), CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SoftclosingGroupIncrementseconds != source_data.SoftclosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.SoftclosingGroupIncrementseconds is null) and not (source_data.SoftclosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.SoftclosingGroupIncrementseconds is null) and (source_data.SoftclosingGroupIncrementseconds is null))
        ) or snapshotted_data.LotCount != source_data.LotCount
        or
        (
            ((snapshotted_data.LotCount is null) and not (source_data.LotCount is null))
            or
            ((not snapshotted_data.LotCount is null) and (source_data.LotCount is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.ClosingGroupIncrementseconds != source_data.ClosingGroupIncrementseconds
        or
        (
            ((snapshotted_data.ClosingGroupIncrementseconds is null) and not (source_data.ClosingGroupIncrementseconds is null))
            or
            ((not snapshotted_data.ClosingGroupIncrementseconds is null) and (source_data.ClosingGroupIncrementseconds is null))
        ) or snapshotted_data.CurrentclosingGroup != source_data.CurrentclosingGroup
        or
        (
            ((snapshotted_data.CurrentclosingGroup is null) and not (source_data.CurrentclosingGroup is null))
            or
            ((not snapshotted_data.CurrentclosingGroup is null) and (source_data.CurrentclosingGroup is null))
        ) or snapshotted_data.CurrentSoftclosingGroup != source_data.CurrentSoftclosingGroup
        or
        (
            ((snapshotted_data.CurrentSoftclosingGroup is null) and not (source_data.CurrentSoftclosingGroup is null))
            or
            ((not snapshotted_data.CurrentSoftclosingGroup is null) and (source_data.CurrentSoftclosingGroup is null))
        ) or snapshotted_data.CurrentLotOrder != source_data.CurrentLotOrder
        or
        (
            ((snapshotted_data.CurrentLotOrder is null) and not (source_data.CurrentLotOrder is null))
            or
            ((not snapshotted_data.CurrentLotOrder is null) and (source_data.CurrentLotOrder is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ProxyBidding != source_data.ProxyBidding
        or
        (
            ((snapshotted_data.ProxyBidding is null) and not (source_data.ProxyBidding is null))
            or
            ((not snapshotted_data.ProxyBidding is null) and (source_data.ProxyBidding is null))
        ) or snapshotted_data.Published != source_data.Published
        or
        (
            ((snapshotted_data.Published is null) and not (source_data.Published is null))
            or
            ((not snapshotted_data.Published is null) and (source_data.Published is null))
        ) or snapshotted_data.PreviewLots != source_data.PreviewLots
        or
        (
            ((snapshotted_data.PreviewLots is null) and not (source_data.PreviewLots is null))
            or
            ((not snapshotted_data.PreviewLots is null) and (source_data.PreviewLots is null))
        ) or snapshotted_data.LotsTaxable != source_data.LotsTaxable
        or
        (
            ((snapshotted_data.LotsTaxable is null) and not (source_data.LotsTaxable is null))
            or
            ((not snapshotted_data.LotsTaxable is null) and (source_data.LotsTaxable is null))
        ) or snapshotted_data.FollowLiveEnabled != source_data.FollowLiveEnabled
        or
        (
            ((snapshotted_data.FollowLiveEnabled is null) and not (source_data.FollowLiveEnabled is null))
            or
            ((not snapshotted_data.FollowLiveEnabled is null) and (source_data.FollowLiveEnabled is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.EstimatedLastEnddttm != source_data.EstimatedLastEnddttm
        or
        (
            ((snapshotted_data.EstimatedLastEnddttm is null) and not (source_data.EstimatedLastEnddttm is null))
            or
            ((not snapshotted_data.EstimatedLastEnddttm is null) and (source_data.EstimatedLastEnddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Timezone != source_data.Timezone
        or
        (
            ((snapshotted_data.Timezone is null) and not (source_data.Timezone is null))
            or
            ((not snapshotted_data.Timezone is null) and (source_data.Timezone is null))
        ) or snapshotted_data.TermsandConditions != source_data.TermsandConditions
        or
        (
            ((snapshotted_data.TermsandConditions is null) and not (source_data.TermsandConditions is null))
            or
            ((not snapshotted_data.TermsandConditions is null) and (source_data.TermsandConditions is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.SecondaryImageURI != source_data.SecondaryImageURI
        or
        (
            ((snapshotted_data.SecondaryImageURI is null) and not (source_data.SecondaryImageURI is null))
            or
            ((not snapshotted_data.SecondaryImageURI is null) and (source_data.SecondaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.ShippingInfo != source_data.ShippingInfo
        or
        (
            ((snapshotted_data.ShippingInfo is null) and not (source_data.ShippingInfo is null))
            or
            ((not snapshotted_data.ShippingInfo is null) and (source_data.ShippingInfo is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.ManagedByName != source_data.ManagedByName
        or
        (
            ((snapshotted_data.ManagedByName is null) and not (source_data.ManagedByName is null))
            or
            ((not snapshotted_data.ManagedByName is null) and (source_data.ManagedByName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEvents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEvents_Incr__dbt_tmp_temp_view"
    end



    
21:51:24.065455 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Attributes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Attributes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689''), CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.EditMode != source_data.EditMode
        or
        (
            ((snapshotted_data.EditMode is null) and not (source_data.EditMode is null))
            or
            ((not snapshotted_data.EditMode is null) and (source_data.EditMode is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Attributes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Attributes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Attributes_Incr__dbt_tmp_temp_view"
    end



    
21:51:24.064489 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:24.066451 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_AuctionEventMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689''), CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_AuctionEventMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_temp_view"
    end



    
21:51:24.109565 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:51:24.113398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:24.113664 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
21:51:24.180842 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:24.184922 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:24.185232 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Addresses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Addresses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689''), CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:23.682689'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ) or snapshotted_data.Street1 != source_data.Street1
        or
        (
            ((snapshotted_data.Street1 is null) and not (source_data.Street1 is null))
            or
            ((not snapshotted_data.Street1 is null) and (source_data.Street1 is null))
        ) or snapshotted_data.Street2 != source_data.Street2
        or
        (
            ((snapshotted_data.Street2 is null) and not (source_data.Street2 is null))
            or
            ((not snapshotted_data.Street2 is null) and (source_data.Street2 is null))
        ) or snapshotted_data.City != source_data.City
        or
        (
            ((snapshotted_data.City is null) and not (source_data.City is null))
            or
            ((not snapshotted_data.City is null) and (source_data.City is null))
        ) or snapshotted_data.Stateregion != source_data.Stateregion
        or
        (
            ((snapshotted_data.Stateregion is null) and not (source_data.Stateregion is null))
            or
            ((not snapshotted_data.Stateregion is null) and (source_data.Stateregion is null))
        ) or snapshotted_data.ZipPostal != source_data.ZipPostal
        or
        (
            ((snapshotted_data.ZipPostal is null) and not (source_data.ZipPostal is null))
            or
            ((not snapshotted_data.ZipPostal is null) and (source_data.ZipPostal is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Addresses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Addresses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Addresses_Incr__dbt_tmp_temp_view"
    end



    
21:51:30.483304 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.42 seconds
21:51:30.489985 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:30.490314 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:30.534315 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:30.536038 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:30.536297 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
21:51:31.231854 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.17 seconds
21:51:31.235442 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:31.235737 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:31.298740 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:31.300229 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:31.300421 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
21:51:31.564229 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:51:31.565979 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:31.566224 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:31.641603 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:31.644199 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:31.644484 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:31.933301 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:51:31.936416 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:31.936663 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
21:51:31.975063 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:31.979538 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:31.979911 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:32.176951 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:51:32.178657 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:32.178927 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
21:51:32.392548 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:51:32.394365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:32.394699 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:32.483722 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:32.486621 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:32.486969 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:32.697093 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:51:32.700122 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:32.700449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
21:51:32.734036 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:32.738214 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:32.738578 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:32.777536 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:32.779268 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:32.779531 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
21:51:33.054507 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:51:33.056309 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:33.056640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:33.219741 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:51:33.222581 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:33.222925 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:33.508730 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:51:33.511779 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:33.512091 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr'
      and table_schema = 'stg'
  
21:51:33.547900 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:33.556772 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:33.557142 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:33.599061 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:33.600765 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:33.601043 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    
21:51:33.975982 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
21:51:33.977631 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:33.977855 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:34.194138 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:51:34.199087 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:34.199511 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:34.569676 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:51:34.572738 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:34.573099 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr'
      and table_schema = 'stg'
  
21:51:34.617247 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:34.622480 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:34.622889 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:34.698951 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:34.700889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:34.701166 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
    
21:51:34.828884 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:51:34.830680 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:34.830957 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:34.873420 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:34.876202 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:34.876543 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEventMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:35.109494 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:51:35.116072 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEventMedias_Incr"
21:51:35.116820 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:35.117023 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEventMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "DisplayOrder", "MediaID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:35.690286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
21:51:35.691817 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:35.692014 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:35.786116 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:35.788862 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:35.789104 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Attributes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:36.050583 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:51:36.052925 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Attributes_Incr"
21:51:36.053394 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:36.053541 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Attributes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Attributes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Attributes_Incr" (
                  "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ConText", "Name", "Value", "EditMode", "Type", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Attributes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:36.534713 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
21:51:36.543247 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: COMMIT
21:51:36.546833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEventMedias_Incr".
21:51:36.547158 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEventMedias_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEventMedias_Incr__dbt_tmp"
    end

21:51:36.583289 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:36.595049 [debug] [Thread-3  ]: finished collecting timing info
21:51:36.595492 [debug] [Thread-3  ]: On snapshot.Shawn.AH_AuctionEventMedias_Incr: Close
21:51:36.596304 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00fded60>]}
21:51:36.596847 [info ] [Thread-3  ]: 3 of 101 OK snapshotted stg.AH_AuctionEventMedias_Incr.......................... [[32mOK[0m in 13.32s]
21:51:36.597258 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_AuctionEventMedias_Incr
21:51:36.597456 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_BannedUsers_Incr
21:51:36.597870 [info ] [Thread-3  ]: 5 of 101 START snapshot stg.AH_BannedUsers_Incr................................. [RUN]
21:51:36.598339 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannedUsers_Incr"
21:51:36.598500 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_BannedUsers_Incr
21:51:36.598683 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_BannedUsers_Incr
21:51:36.601592 [debug] [Thread-3  ]: finished collecting timing info
21:51:36.601810 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_BannedUsers_Incr
21:51:36.604724 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:36.604922 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:36.605052 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:51:36.605193 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:36.722707 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:36.751074 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:51:36.773964 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:36.774369 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:36.803725 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:36.806312 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:36.806669 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannedUsers_InterView]
        ) as __dbt_sbq
    
21:51:36.894609 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:36.916752 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:36.917153 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        ) as __dbt_sbq
    
21:51:37.018180 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:51:37.021882 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:37.022202 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
21:51:37.255243 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:51:37.259246 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:37.259597 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannedUsers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannedUsers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208''), CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:36.792208'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.FName != source_data.FName
        or
        (
            ((snapshotted_data.FName is null) and not (source_data.FName is null))
            or
            ((not snapshotted_data.FName is null) and (source_data.FName is null))
        ) or snapshotted_data.LName != source_data.LName
        or
        (
            ((snapshotted_data.LName is null) and not (source_data.LName is null))
            or
            ((not snapshotted_data.LName is null) and (source_data.LName is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannedUsers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannedUsers_Incr__dbt_tmp_temp_view"
    end



    
21:51:37.731370 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
21:51:37.733157 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: COMMIT
21:51:37.734030 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Attributes_Incr".
21:51:37.734199 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Attributes_Incr: 
    
  if object_id ('"stg"."#AH_Attributes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Attributes_Incr__dbt_tmp"
    end

21:51:37.774236 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:37.865197 [debug] [Thread-2  ]: finished collecting timing info
21:51:37.865648 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Attributes_Incr: Close
21:51:37.866424 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c74c0>]}
21:51:37.867013 [info ] [Thread-2  ]: 2 of 101 OK snapshotted stg.AH_Attributes_Incr.................................. [[32mOK[0m in 14.60s]
21:51:37.867415 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Attributes_Incr
21:51:37.867614 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BannerCategories_Incr
21:51:37.868041 [info ] [Thread-2  ]: 6 of 101 START snapshot stg.AH_BannerCategories_Incr............................ [RUN]
21:51:37.868519 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BannerCategories_Incr"
21:51:37.868682 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BannerCategories_Incr
21:51:37.868821 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BannerCategories_Incr
21:51:37.871856 [debug] [Thread-2  ]: finished collecting timing info
21:51:37.872070 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BannerCategories_Incr
21:51:37.874899 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:37.875097 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:37.875232 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:51:37.875375 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:38.060945 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:38.112510 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:51:38.135433 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:38.135840 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:38.193755 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:38.195852 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:38.196123 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BannerCategories_InterView]
        ) as __dbt_sbq
    
21:51:38.272931 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:38.295262 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:38.295650 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        ) as __dbt_sbq
    
21:51:38.363374 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:38.366886 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:38.367151 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
21:51:38.478203 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:51:38.482112 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:38.482459 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BannerCategories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BannerCategories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596''), CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:38.151596'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.BannerID != source_data.BannerID
        or
        (
            ((snapshotted_data.BannerID is null) and not (source_data.BannerID is null))
            or
            ((not snapshotted_data.BannerID is null) and (source_data.BannerID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BannerCategories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BannerCategories_Incr__dbt_tmp_temp_view"
    end



    
21:51:41.259208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 17.07 seconds
21:51:41.262914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:41.263156 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:41.305562 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:41.307230 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:41.307533 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
21:51:42.492456 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:51:42.494114 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:42.494318 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:42.584932 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:42.587726 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:42.587922 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:42.830747 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:51:42.833802 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:42.834021 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
21:51:42.927416 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:42.931781 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:42.932081 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:42.971606 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:42.973301 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:42.973594 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
21:51:43.577040 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.32 seconds
21:51:43.580617 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:43.580923 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:43.621571 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:43.623216 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:43.623483 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
21:51:43.830963 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.35 seconds
21:51:43.834476 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:43.834951 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:43.894518 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:43.896056 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:43.896293 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
21:51:44.039518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:51:44.041185 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:44.041460 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:44.086393 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:44.089243 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:44.089537 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:44.348896 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:51:44.351917 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:44.352226 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr'
      and table_schema = 'stg'
  
21:51:44.388808 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:44.394624 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:44.394965 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:44.429651 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:44.431547 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:44.431800 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
    
21:51:44.645223 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
21:51:44.646858 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:44.647071 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:44.734517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:44.737207 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:44.737503 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:44.769293 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
21:51:44.771074 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:44.771326 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:44.845433 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:44.848163 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:44.848448 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:45.093885 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:51:45.096907 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:45.097217 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
21:51:45.101274 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:51:45.103864 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:45.104098 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
21:51:45.180311 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:45.184559 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:45.184902 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:45.188145 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:45.188373 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:45.185028 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:45.225529 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:45.227048 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:45.227456 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
21:51:45.227330 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:45.228647 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:45.228841 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
21:51:45.433451 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
21:51:45.435171 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:45.435480 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:45.494135 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:45.496725 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:45.497013 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Addresses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:45.759561 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:51:45.761839 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Addresses_Incr"
21:51:45.762296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:45.762443 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Addresses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Addresses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Addresses_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "CountryID", "Street1", "Street2", "City", "Stateregion", "ZipPostal", "LastUpdatedUser", "Description", "FirstName", "LastName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Addresses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:46.402341 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
21:51:46.404017 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:46.404299 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:46.486127 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:46.489189 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:46.489506 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:46.517579 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.29 seconds
21:51:46.519198 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:46.519468 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:46.553900 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:46.556467 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:46.556753 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:46.697712 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:51:46.700809 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:46.701278 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr'
      and table_schema = 'stg'
  
21:51:46.735639 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:46.740737 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:46.741029 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:46.783583 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:46.785093 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:46.785375 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
    
21:51:47.301478 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.74 seconds
21:51:47.304681 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:47.304929 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr'
      and table_schema = 'stg'
  
21:51:47.349945 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:47.354418 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:47.354774 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:47.435736 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:47.437316 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:47.437554 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
    
21:51:47.629835 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
21:51:47.631773 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: COMMIT
21:51:47.632573 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Addresses_Incr".
21:51:47.632754 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Addresses_Incr: 
    
  if object_id ('"stg"."#AH_Addresses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Addresses_Incr__dbt_tmp"
    end

21:51:47.720160 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:51:47.732489 [debug] [Thread-1  ]: finished collecting timing info
21:51:47.732857 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Addresses_Incr: Close
21:51:47.733564 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c7fa0>]}
21:51:47.734067 [info ] [Thread-1  ]: 1 of 101 OK snapshotted stg.AH_Addresses_Incr................................... [[32mOK[0m in 24.47s]
21:51:47.734450 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Addresses_Incr
21:51:47.734676 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Banners_Incr
21:51:47.735074 [info ] [Thread-1  ]: 7 of 101 START snapshot stg.AH_Banners_Incr..................................... [RUN]
21:51:47.735495 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Banners_Incr"
21:51:47.735649 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Banners_Incr
21:51:47.735783 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Banners_Incr
21:51:47.738407 [debug] [Thread-1  ]: finished collecting timing info
21:51:47.738672 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Banners_Incr
21:51:47.741811 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:47.741988 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:47.742108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:51:47.742240 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:47.876365 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:47.946116 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:51:47.967574 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:47.967897 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:48.213023 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:51:48.215529 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:48.215758 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Banners_InterView]
        ) as __dbt_sbq
    
21:51:48.222519 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 24.16 seconds
21:51:48.225244 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:48.225438 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:48.263655 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:48.265498 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:48.265750 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
21:51:48.294120 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:48.315595 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:48.315974 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        ) as __dbt_sbq
    
21:51:48.389101 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:48.392822 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:48.393897 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
21:51:48.510071 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:51:48.513604 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:48.513911 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Banners_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Banners_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611''), CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:48.198611'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.LinkURI != source_data.LinkURI
        or
        (
            ((snapshotted_data.LinkURI is null) and not (source_data.LinkURI is null))
            or
            ((not snapshotted_data.LinkURI is null) and (source_data.LinkURI is null))
        ) or snapshotted_data.BannerLocation != source_data.BannerLocation
        or
        (
            ((snapshotted_data.BannerLocation is null) and not (source_data.BannerLocation is null))
            or
            ((not snapshotted_data.BannerLocation is null) and (source_data.BannerLocation is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Banners_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Banners_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Banners_Incr__dbt_tmp_temp_view"
    end



    
21:51:48.600002 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
21:51:48.601759 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:48.602011 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:48.640274 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:48.643528 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:48.644060 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannerCategories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:48.884249 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:51:48.886494 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannerCategories_Incr"
21:51:48.887073 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:48.887256 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannerCategories_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "BannerID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannerCategories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:49.103535 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
21:51:49.105356 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:49.105621 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:49.148391 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:49.151098 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:49.151388 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BannedUsers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:49.400039 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:51:49.402849 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BannedUsers_Incr"
21:51:49.403425 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:49.403622 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BannedUsers_Incr" (
                  "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Lastip", "UserName", "FName", "LName", "IsLockedOut", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BannedUsers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:50.302488 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.04 seconds
21:51:50.304070 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:50.304235 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:50.374303 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:50.377483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:50.377686 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:50.545558 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
21:51:50.547400 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannerCategories_Incr: COMMIT
21:51:50.548248 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannerCategories_Incr".
21:51:50.548435 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BannerCategories_Incr: 
    
  if object_id ('"stg"."#AH_BannerCategories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannerCategories_Incr__dbt_tmp"
    end

21:51:50.610469 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:50.621486 [debug] [Thread-2  ]: finished collecting timing info
21:51:50.621905 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BannerCategories_Incr: Close
21:51:50.622722 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218160>]}
21:51:50.623234 [info ] [Thread-2  ]: 6 of 101 OK snapshotted stg.AH_BannerCategories_Incr............................ [[32mOK[0m in 12.75s]
21:51:50.623620 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BannerCategories_Incr
21:51:50.623811 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_BiddingTransactions_Incr
21:51:50.624212 [info ] [Thread-2  ]: 8 of 101 START snapshot stg.AH_BiddingTransactions_Incr......................... [RUN]
21:51:50.624650 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr"
21:51:50.624808 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_BiddingTransactions_Incr
21:51:50.624948 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_BiddingTransactions_Incr
21:51:50.627816 [debug] [Thread-2  ]: finished collecting timing info
21:51:50.627976 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:51:50.630568 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:50.630753 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
21:51:50.628196 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_BiddingTransactions_Incr
21:51:50.633587 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:50.633889 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:50.634014 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:51:50.634150 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:50.665582 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:50.670834 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:50.671144 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:50.717617 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:51:50.719303 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:50.720008 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
21:51:50.729777 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:50.769453 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:51:50.791369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:50.791749 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:50.818740 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:50.820929 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:50.821193 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]
        ) as __dbt_sbq
    
21:51:50.876080 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:51:50.877831 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannedUsers_Incr: COMMIT
21:51:50.878976 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BannedUsers_Incr".
21:51:50.879348 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_BannedUsers_Incr: 
    
  if object_id ('"stg"."#AH_BannedUsers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BannedUsers_Incr__dbt_tmp"
    end

21:51:50.879240 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:50.900241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:50.900579 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        ) as __dbt_sbq
    
21:51:50.916760 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:50.927602 [debug] [Thread-3  ]: finished collecting timing info
21:51:50.927984 [debug] [Thread-3  ]: On snapshot.Shawn.AH_BannedUsers_Incr: Close
21:51:50.928723 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc082182b0>]}
21:51:50.929238 [info ] [Thread-3  ]: 5 of 101 OK snapshotted stg.AH_BannedUsers_Incr................................. [[32mOK[0m in 14.33s]
21:51:50.929677 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_BannedUsers_Incr
21:51:50.929870 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Categories_Incr
21:51:50.930277 [info ] [Thread-3  ]: 9 of 101 START snapshot stg.AH_Categories_Incr.................................. [RUN]
21:51:50.930761 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Categories_Incr"
21:51:50.930937 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Categories_Incr
21:51:50.931097 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Categories_Incr
21:51:50.933960 [debug] [Thread-3  ]: finished collecting timing info
21:51:50.934175 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Categories_Incr
21:51:50.937481 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:51:50.937674 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:50.937805 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:51:50.937945 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:50.961602 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:50.965069 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:50.966171 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
21:51:51.037914 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:51.041770 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:51:51.044937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:51.045161 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_BiddingTransactions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075''), CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:50.808075'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Maxmindscore != source_data.Maxmindscore
        or
        (
            ((snapshotted_data.Maxmindscore is null) and not (source_data.Maxmindscore is null))
            or
            ((not snapshotted_data.Maxmindscore is null) and (source_data.Maxmindscore is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_BiddingTransactions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_BiddingTransactions_Incr__dbt_tmp_temp_view"
    end



    
21:51:51.076196 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:51:51.097862 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:51:51.098235 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:51.133899 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:51.136097 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:51:51.136343 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Categories_InterView]
        ) as __dbt_sbq
    
21:51:51.190973 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:51:51.212561 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:51:51.212910 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        ) as __dbt_sbq
    
21:51:51.284486 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:51.288389 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:51:51.288622 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
21:51:51.361880 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:51.365763 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:51:51.366045 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Categories_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Categories_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531''), CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:51.120531'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ParentCategoryID != source_data.ParentCategoryID
        or
        (
            ((snapshotted_data.ParentCategoryID is null) and not (source_data.ParentCategoryID is null))
            or
            ((not snapshotted_data.ParentCategoryID is null) and (source_data.ParentCategoryID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Lft != source_data.Lft
        or
        (
            ((snapshotted_data.Lft is null) and not (source_data.Lft is null))
            or
            ((not snapshotted_data.Lft is null) and (source_data.Lft is null))
        ) or snapshotted_data.Rgt != source_data.Rgt
        or
        (
            ((snapshotted_data.Rgt is null) and not (source_data.Rgt is null))
            or
            ((not snapshotted_data.Rgt is null) and (source_data.Rgt is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.RolesAllowed != source_data.RolesAllowed
        or
        (
            ((snapshotted_data.RolesAllowed is null) and not (source_data.RolesAllowed is null))
            or
            ((not snapshotted_data.RolesAllowed is null) and (source_data.RolesAllowed is null))
        ) or snapshotted_data.EnabledCustomProperty != source_data.EnabledCustomProperty
        or
        (
            ((snapshotted_data.EnabledCustomProperty is null) and not (source_data.EnabledCustomProperty is null))
            or
            ((not snapshotted_data.EnabledCustomProperty is null) and (source_data.EnabledCustomProperty is null))
        ) or snapshotted_data.MetaKeyWords != source_data.MetaKeyWords
        or
        (
            ((snapshotted_data.MetaKeyWords is null) and not (source_data.MetaKeyWords is null))
            or
            ((not snapshotted_data.MetaKeyWords is null) and (source_data.MetaKeyWords is null))
        ) or snapshotted_data.MetaDescription != source_data.MetaDescription
        or
        (
            ((snapshotted_data.MetaDescription is null) and not (source_data.MetaDescription is null))
            or
            ((not snapshotted_data.MetaDescription is null) and (source_data.MetaDescription is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ) or snapshotted_data.Pagecontent != source_data.Pagecontent
        or
        (
            ((snapshotted_data.Pagecontent is null) and not (source_data.Pagecontent is null))
            or
            ((not snapshotted_data.Pagecontent is null) and (source_data.Pagecontent is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.MvcAction != source_data.MvcAction
        or
        (
            ((snapshotted_data.MvcAction is null) and not (source_data.MvcAction is null))
            or
            ((not snapshotted_data.MvcAction is null) and (source_data.MvcAction is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Categories_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Categories_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Categories_Incr__dbt_tmp_temp_view"
    end



    
21:51:51.751731 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:51:51.753243 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:51.753431 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:51.790010 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:51.793653 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:51.793940 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:52.026703 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:51:52.029742 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:52.030036 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr'
      and table_schema = 'stg'
  
21:51:52.066108 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:52.071106 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:52.071403 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:52.109156 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:52.110823 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:52.111081 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    
21:51:53.668784 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:51:53.670296 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:53.670477 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:53.707866 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:53.710792 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:53.710977 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_AuctionEvents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:54.023518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.51 seconds
21:51:54.027531 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:54.027781 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:54.064752 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:54.066282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:54.066513 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
21:51:54.141525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:51:54.144382 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_AuctionEvents_Incr"
21:51:54.144925 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:54.145109 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_AuctionEvents_Incr" (
                  "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SoftclosingGroupIncrementseconds", "LotCount", "CategoryID", "CurrencyID", "ClosingGroupIncrementseconds", "CurrentclosingGroup", "CurrentSoftclosingGroup", "CurrentLotOrder", "OwnerID", "ProxyBidding", "Published", "PreviewLots", "LotsTaxable", "FollowLiveEnabled", "BuyersPremiumPercent", "DeletedOn", "Startdttm", "Enddttm", "EstimatedLastEnddttm", "CreatedOn", "UpdatedOn", "Description", "LastUpdatedUser", "Status", "Timezone", "TermsandConditions", "PrimaryImageURI", "Title", "SecondaryImageURI", "OwnerUserName", "ShippingInfo", "SubTitle", "ManagedByName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_AuctionEvents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:54.977276 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:51:54.978933 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:54.979103 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:55.049217 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:55.051926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:55.052126 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:55.302898 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:51:55.305825 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:55.306011 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
21:51:55.350078 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:55.354508 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:55.354919 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:55.417808 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:55.419656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:55.419962 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
21:51:55.776977 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:51:55.778675 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: COMMIT
21:51:55.779487 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_AuctionEvents_Incr".
21:51:55.779647 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_AuctionEvents_Incr: 
    
  if object_id ('"stg"."#AH_AuctionEvents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_AuctionEvents_Incr__dbt_tmp"
    end

21:51:55.824763 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:55.836985 [debug] [Thread-4  ]: finished collecting timing info
21:51:55.837410 [debug] [Thread-4  ]: On snapshot.Shawn.AH_AuctionEvents_Incr: Close
21:51:55.838162 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081ae5e0>]}
21:51:55.838708 [info ] [Thread-4  ]: 4 of 101 OK snapshotted stg.AH_AuctionEvents_Incr............................... [[32mOK[0m in 32.56s]
21:51:55.839094 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_AuctionEvents_Incr
21:51:55.839286 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryCount_Incr
21:51:55.839704 [info ] [Thread-4  ]: 10 of 101 START snapshot stg.AH_CategoryCount_Incr.............................. [RUN]
21:51:55.840145 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCount_Incr"
21:51:55.840305 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryCount_Incr
21:51:55.840443 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryCount_Incr
21:51:55.843324 [debug] [Thread-4  ]: finished collecting timing info
21:51:55.843541 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryCount_Incr
21:51:55.846389 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:51:55.846609 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:51:55.846772 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:51:55.846918 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:51:56.018873 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:51:56.055343 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:51:56.077840 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:51:56.078226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:51:56.107476 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:56.109960 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:51:56.110275 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCount_InterView]
        ) as __dbt_sbq
    
21:51:56.169162 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:56.190398 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:51:56.190839 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        ) as __dbt_sbq
    
21:51:56.239563 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:51:56.243194 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:51:56.243476 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
21:51:56.318525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:56.322263 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:51:56.322475 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCount_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCount_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365''), CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:51:56.089365'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Count != source_data.Count
        or
        (
            ((snapshotted_data.Count is null) and not (source_data.Count is null))
            or
            ((not snapshotted_data.Count is null) and (source_data.Count is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCount_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCount_Incr__dbt_tmp_temp_view"
    end



    
21:51:56.854782 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.43 seconds
21:51:56.856820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:56.857096 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:56.894391 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:56.897099 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:56.897366 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:57.115695 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.07 seconds
21:51:57.119502 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:57.119790 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:57.175923 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:51:57.177436 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:57.177673 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
21:51:57.238584 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:51:57.241487 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:57.241738 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr'
      and table_schema = 'stg'
  
21:51:57.274967 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:57.279345 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:57.279597 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:57.318892 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:57.320526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:57.320765 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
    
21:51:58.082915 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:51:58.084568 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:58.084759 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:58.156377 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:51:58.158964 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:58.159166 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:58.267335 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:51:58.268939 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:58.269120 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Banners_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:58.308663 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:58.311588 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:58.311864 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Banners_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:58.382245 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:51:58.385228 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:58.385502 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
21:51:58.425595 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:58.429917 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:58.430207 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:58.473702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:58.475353 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:58.475612 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
21:51:58.533501 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:51:58.535631 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Banners_Incr"
21:51:58.536142 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:51:58.536321 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Banners_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Banners_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Banners_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "LinkURI", "BannerLocation", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Banners_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:51:59.517531 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:51:59.519199 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:59.519413 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:51:59.556705 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:59.559367 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:59.559564 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:59.773876 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:51:59.776692 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:59.776896 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr'
      and table_schema = 'stg'
  
21:51:59.810413 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:51:59.814433 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:59.814702 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:51:59.858817 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:51:59.860803 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:51:59.861071 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    
21:52:00.421771 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
21:52:00.423619 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: COMMIT
21:52:00.424435 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Banners_Incr".
21:52:00.424615 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Banners_Incr: 
    
  if object_id ('"stg"."#AH_Banners_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Banners_Incr__dbt_tmp"
    end

21:52:00.468579 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:00.480899 [debug] [Thread-1  ]: finished collecting timing info
21:52:00.481269 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Banners_Incr: Close
21:52:00.482005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc082180d0>]}
21:52:00.482572 [info ] [Thread-1  ]: 7 of 101 OK snapshotted stg.AH_Banners_Incr..................................... [[32mOK[0m in 12.75s]
21:52:00.482967 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Banners_Incr
21:52:00.483163 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:52:00.483564 [info ] [Thread-1  ]: 11 of 101 START snapshot stg.AH_CategoryCustomFields_Incr....................... [RUN]
21:52:00.484008 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr"
21:52:00.484170 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:52:00.484308 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_CategoryCustomFields_Incr
21:52:00.487141 [debug] [Thread-1  ]: finished collecting timing info
21:52:00.487343 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:52:00.490119 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:00.490307 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:00.490435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:52:00.490604 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:00.617020 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:00.659919 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:52:00.681533 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:00.681929 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:00.713029 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:00.715358 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:00.715599 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]
        ) as __dbt_sbq
    
21:52:00.778875 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:00.814504 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.49 seconds
21:52:00.818516 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:00.826146 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:00.830803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:00.831037 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        ) as __dbt_sbq
    
21:52:00.867382 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:00.868730 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:00.868925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
21:52:00.895682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:00.899037 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:00.899289 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
21:52:01.009540 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:52:01.013395 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:01.013703 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryCustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806''), CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:00.698806'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryCustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_temp_view"
    end



    
21:52:01.229379 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
21:52:01.231131 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:52:01.231423 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:01.310229 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:01.312793 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:52:01.313075 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_BiddingTransactions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:01.566860 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:52:01.569091 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_BiddingTransactions_Incr"
21:52:01.569674 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:52:01.569864 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_BiddingTransactions_Incr" (
                  "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Maxmindscore", "Amount", "ListingActionID", "CreditCardID", "Active", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:01.733915 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
21:52:01.735596 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:01.735821 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:01.821591 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:01.824318 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:01.824536 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:02.186467 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:52:02.189235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:02.189487 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
21:52:02.282746 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:02.287992 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:02.288373 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:02.331107 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:02.332755 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:02.333026 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
21:52:03.157878 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:52:03.159701 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: COMMIT
21:52:03.160789 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_BiddingTransactions_Incr".
21:52:03.160997 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_BiddingTransactions_Incr: 
    
  if object_id ('"stg"."#AH_BiddingTransactions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_BiddingTransactions_Incr__dbt_tmp"
    end

21:52:03.199840 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:03.210846 [debug] [Thread-2  ]: finished collecting timing info
21:52:03.211283 [debug] [Thread-2  ]: On snapshot.Shawn.AH_BiddingTransactions_Incr: Close
21:52:03.212057 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc082186a0>]}
21:52:03.212616 [info ] [Thread-2  ]: 8 of 101 OK snapshotted stg.AH_BiddingTransactions_Incr......................... [[32mOK[0m in 12.59s]
21:52:03.213008 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_BiddingTransactions_Incr
21:52:03.213199 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:52:03.213587 [info ] [Thread-2  ]: 12 of 101 START snapshot stg.AH_CategoryListingTypes_Incr....................... [RUN]
21:52:03.214035 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr"
21:52:03.214194 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:52:03.214333 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_CategoryListingTypes_Incr
21:52:03.217302 [debug] [Thread-2  ]: finished collecting timing info
21:52:03.217518 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:52:03.220475 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:03.220671 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:03.220798 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:52:03.220935 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:03.342776 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:03.357075 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
21:52:03.358742 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:03.358995 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:03.378490 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:52:03.401085 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:03.401474 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:03.462960 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:52:03.466512 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:03.466839 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:03.487470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:03.489712 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:03.489956 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]
        ) as __dbt_sbq
    
21:52:03.633096 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:52:03.655311 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:03.655712 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        ) as __dbt_sbq
    
21:52:03.708406 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:03.712644 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:03.712956 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
21:52:03.805217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:52:03.808410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:03.808738 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr'
      and table_schema = 'stg'
  
21:52:03.819595 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:52:03.822894 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:03.823202 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476''), CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:03.464476'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_temp_view"
    end



    
21:52:03.843531 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:03.847696 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:03.847976 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:03.881775 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:03.883470 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:03.883730 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
    
21:52:05.374631 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
21:52:05.376179 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:05.376386 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:05.411865 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:05.414465 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:05.414764 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCount_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:05.645528 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:52:05.647768 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCount_Incr"
21:52:05.648312 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:05.648489 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCount_Incr" (
                  "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Count", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCount_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:07.746051 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
21:52:07.747861 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: COMMIT
21:52:07.749105 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCount_Incr".
21:52:07.749273 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCount_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCount_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCount_Incr__dbt_tmp"
    end

21:52:07.792495 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:07.804336 [debug] [Thread-4  ]: finished collecting timing info
21:52:07.804775 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryCount_Incr: Close
21:52:07.805528 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218400>]}
21:52:07.806080 [info ] [Thread-4  ]: 10 of 101 OK snapshotted stg.AH_CategoryCount_Incr.............................. [[32mOK[0m in 11.97s]
21:52:07.806482 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryCount_Incr
21:52:07.806715 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CategoryListings_Incr
21:52:07.807115 [info ] [Thread-4  ]: 13 of 101 START snapshot stg.AH_CategoryListings_Incr........................... [RUN]
21:52:07.807576 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CategoryListings_Incr"
21:52:07.807743 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CategoryListings_Incr
21:52:07.807885 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CategoryListings_Incr
21:52:07.810755 [debug] [Thread-4  ]: finished collecting timing info
21:52:07.811022 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CategoryListings_Incr
21:52:07.813880 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:07.814070 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:07.814200 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:52:07.814344 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:07.935485 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:07.975413 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:52:07.997087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:07.997491 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:08.026290 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:08.028773 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:08.029056 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CategoryListings_InterView]
        ) as __dbt_sbq
    
21:52:08.099892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:08.121731 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:08.122127 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        ) as __dbt_sbq
    
21:52:08.224588 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:52:08.228301 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:08.228656 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
21:52:08.354611 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:52:08.358514 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:08.358894 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CategoryListings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CategoryListings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420''), CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:08.011420'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CategoryID != source_data.CategoryID
        or
        (
            ((snapshotted_data.CategoryID is null) and not (source_data.CategoryID is null))
            or
            ((not snapshotted_data.CategoryID is null) and (source_data.CategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CategoryListings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CategoryListings_Incr__dbt_tmp_temp_view"
    end



    
21:52:09.146656 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 17.78 seconds
21:52:09.150156 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:09.150434 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:09.256260 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:52:09.258177 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:09.258446 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
21:52:11.488125 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
21:52:11.489793 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:11.489993 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:11.612444 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:52:11.615354 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:11.615605 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:11.790239 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.97 seconds
21:52:11.793739 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:11.793974 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:12.003380 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:52:12.005144 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:12.005418 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
21:52:12.196008 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
21:52:12.199171 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:12.199460 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
21:52:12.310499 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:52:12.315192 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:12.315577 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:12.468766 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:12.470317 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:12.470619 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
21:52:13.591213 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:52:13.592901 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:13.593099 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:13.671287 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:13.673765 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:13.673975 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:14.351380 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
21:52:14.353084 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:14.353287 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:14.386197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:14.389538 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:14.389821 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:14.459543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 13.45 seconds
21:52:14.463343 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:14.463697 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:14.466664 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.79 seconds
21:52:14.469333 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:14.469569 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
21:52:14.636431 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:52:14.638013 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:14.638241 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
21:52:14.638698 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:52:14.644193 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:14.644504 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:14.684533 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:14.686168 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:14.686428 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
21:52:14.737288 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:52:14.740791 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:14.741125 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr'
      and table_schema = 'stg'
  
21:52:14.774941 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:14.779535 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:14.779897 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:14.834426 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:14.836259 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:14.836520 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
    
21:52:16.140764 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:52:16.142398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:16.142658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:52:16.143811 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:16.143945 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:16.142808 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:16.223226 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:16.225545 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:16.225744 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:16.231383 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:16.233639 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:16.233868 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:16.411843 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
21:52:16.413444 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:16.413670 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Categories_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:16.451215 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:52:16.451762 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:16.457362 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:16.455006 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:52:16.459684 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:16.459868 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr'
      and table_schema = 'stg'
  
21:52:16.457565 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Categories_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:16.454839 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:16.460247 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
21:52:16.505767 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:16.510259 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:16.510685 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:16.514267 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:16.514508 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:16.510835 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:16.554771 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:16.556482 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:16.556757 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:16.557914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:16.558108 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
21:52:16.556882 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    
21:52:16.682960 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:52:16.685360 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Categories_Incr"
21:52:16.685922 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:16.686110 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Categories_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Categories_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Categories_Incr" (
                  "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ParentCategoryID", "DisplayOrder", "Lft", "Rgt", "CreatedOn", "UpdatedOn", "DeletedOn", "RolesAllowed", "EnabledCustomProperty", "MetaKeyWords", "MetaDescription", "PageTitle", "Pagecontent", "Name", "LastUpdatedUser", "Type", "MvcAction", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Categories_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:17.613611 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:52:17.615310 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:17.615510 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:17.657643 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:52:17.659635 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:17.659837 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:17.660852 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:17.662967 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:17.663162 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:17.701334 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:17.703888 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:17.704177 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:18.078997 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:52:18.080982 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListingTypes_Incr"
21:52:18.081379 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:18.081500 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListingTypes_Incr" (
                  "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CategoryID", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:18.164855 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:52:18.168049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:18.168295 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr'
      and table_schema = 'stg'
  
21:52:18.221947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:18.226079 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:18.226353 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:18.263701 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:18.265242 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:18.265479 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    
21:52:18.652429 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.97 seconds
21:52:18.654216 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Categories_Incr: COMMIT
21:52:18.655179 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Categories_Incr".
21:52:18.655383 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Categories_Incr: 
    
  if object_id ('"stg"."#AH_Categories_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Categories_Incr__dbt_tmp"
    end

21:52:18.711937 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:18.724923 [debug] [Thread-3  ]: finished collecting timing info
21:52:18.725293 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Categories_Incr: Close
21:52:18.726017 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218550>]}
21:52:18.726515 [info ] [Thread-3  ]: 9 of 101 OK snapshotted stg.AH_Categories_Incr.................................. [[32mOK[0m in 27.80s]
21:52:18.726930 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Categories_Incr
21:52:18.727119 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Contactus_Incr
21:52:18.727508 [info ] [Thread-3  ]: 14 of 101 START snapshot stg.AH_Contactus_Incr.................................. [RUN]
21:52:18.727937 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contactus_Incr"
21:52:18.728093 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Contactus_Incr
21:52:18.728227 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Contactus_Incr
21:52:18.730926 [debug] [Thread-3  ]: finished collecting timing info
21:52:18.731187 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Contactus_Incr
21:52:18.733943 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:18.734125 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:18.734251 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:52:18.734389 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:18.862601 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:18.926114 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:52:18.947709 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:18.948093 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:18.975750 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:18.978290 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:18.978585 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contactus_InterView]
        ) as __dbt_sbq
    
21:52:19.033373 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:19.054912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:19.055309 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        ) as __dbt_sbq
    
21:52:19.201553 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:19.205119 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:19.205383 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
21:52:19.313912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:52:19.317779 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:19.318116 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contactus_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contactus_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722''), CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:18.964722'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contactus_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contactus_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contactus_Incr__dbt_tmp_temp_view"
    end



    
21:52:19.926710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
21:52:19.928352 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:19.928537 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:19.968273 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:19.970902 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:19.971099 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryCustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:20.008953 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.93 seconds
21:52:20.010818 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: COMMIT
21:52:20.011668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListingTypes_Incr".
21:52:20.011864 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListingTypes_Incr__dbt_tmp"
    end

21:52:20.054574 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:20.066610 [debug] [Thread-2  ]: finished collecting timing info
21:52:20.067017 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CategoryListingTypes_Incr: Close
21:52:20.067784 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218940>]}
21:52:20.068331 [info ] [Thread-2  ]: 12 of 101 OK snapshotted stg.AH_CategoryListingTypes_Incr....................... [[32mOK[0m in 16.85s]
21:52:20.068725 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_CategoryListingTypes_Incr
21:52:20.068921 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Contents_Incr
21:52:20.069353 [info ] [Thread-2  ]: 15 of 101 START snapshot stg.AH_Contents_Incr................................... [RUN]
21:52:20.069811 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Contents_Incr"
21:52:20.069971 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Contents_Incr
21:52:20.070108 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Contents_Incr
21:52:20.072916 [debug] [Thread-2  ]: finished collecting timing info
21:52:20.073119 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Contents_Incr
21:52:20.075938 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:20.076121 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:20.076246 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:52:20.076380 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:20.179026 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:20.189829 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:52:20.191937 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryCustomFields_Incr"
21:52:20.192454 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:20.192629 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryCustomFields_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "CategoryID", "CustomFieldID", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:20.213104 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:52:20.234739 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:20.235126 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:20.282649 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:20.284894 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:20.285511 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Contents_InterView]
        ) as __dbt_sbq
    
21:52:20.384613 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:52:20.407178 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:20.407569 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        ) as __dbt_sbq
    
21:52:20.484905 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:20.488652 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:20.488933 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
21:52:20.575063 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:20.579268 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:20.579587 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Contents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Contents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993''), CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:20.245993'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.Usehtmleditor != source_data.Usehtmleditor
        or
        (
            ((snapshotted_data.Usehtmleditor is null) and not (source_data.Usehtmleditor is null))
            or
            ((not snapshotted_data.Usehtmleditor is null) and (source_data.Usehtmleditor is null))
        ) or snapshotted_data.Userdefined != source_data.Userdefined
        or
        (
            ((snapshotted_data.Userdefined is null) and not (source_data.Userdefined is null))
            or
            ((not snapshotted_data.Userdefined is null) and (source_data.Userdefined is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Text != source_data.Text
        or
        (
            ((snapshotted_data.Text is null) and not (source_data.Text is null))
            or
            ((not snapshotted_data.Text is null) and (source_data.Text is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.PageTitle != source_data.PageTitle
        or
        (
            ((snapshotted_data.PageTitle is null) and not (source_data.PageTitle is null))
            or
            ((not snapshotted_data.PageTitle is null) and (source_data.PageTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Contents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Contents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Contents_Incr__dbt_tmp_temp_view"
    end



    
21:52:21.060189 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 12.70 seconds
21:52:21.064264 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:21.064569 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:21.101668 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:21.103234 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:21.103457 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
21:52:21.565687 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.37 seconds
21:52:21.567606 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: COMMIT
21:52:21.568429 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryCustomFields_Incr".
21:52:21.568634 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryCustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryCustomFields_Incr__dbt_tmp"
    end

21:52:21.614412 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:21.625422 [debug] [Thread-1  ]: finished collecting timing info
21:52:21.625744 [debug] [Thread-1  ]: On snapshot.Shawn.AH_CategoryCustomFields_Incr: Close
21:52:21.626433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc082187f0>]}
21:52:21.626962 [info ] [Thread-1  ]: 11 of 101 OK snapshotted stg.AH_CategoryCustomFields_Incr....................... [[32mOK[0m in 21.14s]
21:52:21.627367 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_CategoryCustomFields_Incr
21:52:21.627557 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Countries_Incr
21:52:21.627947 [info ] [Thread-1  ]: 16 of 101 START snapshot stg.AH_Countries_Incr.................................. [RUN]
21:52:21.628382 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Countries_Incr"
21:52:21.628540 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Countries_Incr
21:52:21.628674 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Countries_Incr
21:52:21.631393 [debug] [Thread-1  ]: finished collecting timing info
21:52:21.631588 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Countries_Incr
21:52:21.634310 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:21.634493 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:21.634650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:52:21.634791 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:21.733775 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:21.780458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:21.801956 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:21.802264 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:21.830202 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:21.832945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:21.833210 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Countries_InterView]
        ) as __dbt_sbq
    
21:52:21.895486 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:21.916198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:21.916524 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        ) as __dbt_sbq
    
21:52:21.979081 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:52:21.980604 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:21.980840 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:22.003037 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:22.006781 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:22.007039 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
21:52:22.050681 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:22.053127 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:22.053372 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:22.074726 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:22.078383 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:22.078685 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Countries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Countries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586''), CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:21.808586'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.StateRequired != source_data.StateRequired
        or
        (
            ((snapshotted_data.StateRequired is null) and not (source_data.StateRequired is null))
            or
            ((not snapshotted_data.StateRequired is null) and (source_data.StateRequired is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Countries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Countries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Countries_Incr__dbt_tmp_temp_view"
    end



    
21:52:22.295015 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:22.298407 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:22.298730 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
21:52:22.332961 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:22.337235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:22.337494 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:22.381073 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:22.382666 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:22.382913 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
21:52:23.536705 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:52:23.538370 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:23.538605 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:23.578439 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:23.580848 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:23.581050 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:23.872050 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:52:23.874943 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:23.875127 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr'
      and table_schema = 'stg'
  
21:52:23.910906 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:23.915051 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:23.915343 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:23.984242 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:23.985768 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:23.986018 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
    
21:52:24.196732 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.88 seconds
21:52:24.200447 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:24.200819 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:24.237450 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:24.239149 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:24.239399 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
21:52:24.984571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.00 seconds
21:52:24.986174 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:24.986377 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:25.021384 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:25.024048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:25.024270 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CategoryListings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:25.130045 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:52:25.131870 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:25.132120 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:25.210665 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:25.213538 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:25.213801 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:25.242430 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:52:25.244681 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CategoryListings_Incr"
21:52:25.245258 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:25.245454 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CategoryListings_Incr" (
                  "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DeletedOn", "CreatedOn", "UpdatedOn", "ListingID", "CategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CategoryListings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:25.429155 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:52:25.432096 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:25.432398 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
21:52:25.483692 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:25.488149 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:25.488451 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:25.556073 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:25.558079 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:25.558342 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
21:52:26.659262 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:52:26.660922 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:26.661131 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:26.703475 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:26.706003 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:26.706225 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:26.849680 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
21:52:26.851304 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: COMMIT
21:52:26.852101 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CategoryListings_Incr".
21:52:26.852298 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CategoryListings_Incr: 
    
  if object_id ('"stg"."#AH_CategoryListings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CategoryListings_Incr__dbt_tmp"
    end

21:52:26.905486 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:26.994642 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:52:26.997127 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:26.997377 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr'
      and table_schema = 'stg'
  
21:52:27.003240 [debug] [Thread-4  ]: finished collecting timing info
21:52:27.003494 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CategoryListings_Incr: Close
21:52:27.004137 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218cd0>]}
21:52:27.004620 [info ] [Thread-4  ]: 13 of 101 OK snapshotted stg.AH_CategoryListings_Incr........................... [[32mOK[0m in 19.20s]
21:52:27.004999 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CategoryListings_Incr
21:52:27.005189 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CreditCardTypes_Incr
21:52:27.005577 [info ] [Thread-4  ]: 17 of 101 START snapshot stg.AH_CreditCardTypes_Incr............................ [RUN]
21:52:27.006004 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr"
21:52:27.006160 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CreditCardTypes_Incr
21:52:27.006293 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CreditCardTypes_Incr
21:52:27.009607 [debug] [Thread-4  ]: finished collecting timing info
21:52:27.009810 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CreditCardTypes_Incr
21:52:27.012428 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:27.012608 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:27.012736 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:52:27.012873 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:27.032574 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:27.036554 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:27.038609 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:27.093160 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:27.094658 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:27.094882 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
    
21:52:27.110846 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:27.139348 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:52:27.161520 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:27.161844 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:27.194363 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:27.196621 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:27.196875 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]
        ) as __dbt_sbq
    
21:52:27.260202 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:27.280963 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:27.281306 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        ) as __dbt_sbq
    
21:52:27.329783 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:27.333643 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:27.333908 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
21:52:27.411536 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:27.416059 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:27.416313 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613''), CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:27.183613'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardTypes_Incr__dbt_tmp_temp_view"
    end



    
21:52:27.982057 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:52:27.983801 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:27.983995 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:28.015927 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:28.018697 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:28.018942 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contactus_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:28.057724 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.98 seconds
21:52:28.061432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:28.061680 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:28.116050 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:28.117669 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:28.117957 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
21:52:28.255319 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:28.257530 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contactus_Incr"
21:52:28.258108 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:28.258293 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contactus_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contactus_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contactus_Incr" (
                  "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "Message", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contactus_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:29.439524 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:52:29.441130 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:29.441310 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:29.511080 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:29.513653 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:29.513857 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:29.682316 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.42 seconds
21:52:29.684063 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contactus_Incr: COMMIT
21:52:29.685207 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contactus_Incr".
21:52:29.685362 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Contactus_Incr: 
    
  if object_id ('"stg"."#AH_Contactus_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contactus_Incr__dbt_tmp"
    end

21:52:29.719372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:52:29.722116 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:29.722360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
21:52:29.735569 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:29.745329 [debug] [Thread-3  ]: finished collecting timing info
21:52:29.745637 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Contactus_Incr: Close
21:52:29.746298 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218a90>]}
21:52:29.746815 [info ] [Thread-3  ]: 14 of 101 OK snapshotted stg.AH_Contactus_Incr.................................. [[32mOK[0m in 11.02s]
21:52:29.747193 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Contactus_Incr
21:52:29.747380 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:52:29.747763 [info ] [Thread-3  ]: 18 of 101 START snapshot stg.AH_CreditCardsExtraInFormation_Incr................ [RUN]
21:52:29.748185 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
21:52:29.748342 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:52:29.748477 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:52:29.751156 [debug] [Thread-3  ]: finished collecting timing info
21:52:29.751350 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:52:29.754563 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:29.754746 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:29.754873 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:52:29.755014 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:29.870361 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:29.874815 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:29.875074 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:29.875916 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.30 seconds
21:52:29.878358 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:29.878559 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:29.879830 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:29.910754 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:52:29.919207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:29.920541 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:29.920779 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
21:52:29.934824 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:29.935189 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:29.938789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:29.940026 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:29.940215 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
21:52:29.963073 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:29.965763 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:29.966055 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]
        ) as __dbt_sbq
    
21:52:30.024955 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:30.046363 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:30.046772 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        ) as __dbt_sbq
    
21:52:30.135520 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:30.139347 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:30.139671 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
21:52:30.230417 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:30.233941 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:30.234219 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CreditCardsExtraInFormation_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298''), CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:29.949298'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Cvv != source_data.Cvv
        or
        (
            ((snapshotted_data.Cvv is null) and not (source_data.Cvv is null))
            or
            ((not snapshotted_data.Cvv is null) and (source_data.Cvv is null))
        ) or snapshotted_data.CreditCardID != source_data.CreditCardID
        or
        (
            ((snapshotted_data.CreditCardID is null) and not (source_data.CreditCardID is null))
            or
            ((not snapshotted_data.CreditCardID is null) and (source_data.CreditCardID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_temp_view"
    end



    
21:52:30.768048 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:52:30.769686 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:30.769873 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:30.804215 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:30.806837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:30.807070 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:31.202360 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:52:31.205430 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:31.205700 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr'
      and table_schema = 'stg'
  
21:52:31.257518 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:31.262513 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:31.262907 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:31.299960 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:31.301710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:31.302006 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
    
21:52:31.411620 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:52:31.413284 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:31.413573 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:31.493367 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:31.496286 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:31.496625 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:31.730208 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:52:31.733113 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:31.733349 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
21:52:31.782578 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:31.786630 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:31.786912 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:31.833752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:31.835511 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:31.835766 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
21:52:32.202589 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:52:32.204317 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:32.204571 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Countries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:32.251825 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:32.254557 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:32.254852 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Countries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:32.570295 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:52:32.572739 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Countries_Incr"
21:52:32.573301 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:32.573485 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Countries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Countries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Countries_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "StateRequired", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Countries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:33.053440 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:52:33.055156 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:33.055387 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:33.095850 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:33.098671 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:33.098978 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:33.376806 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.96 seconds
21:52:33.380616 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:33.380976 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:52:33.385174 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:33.381109 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:33.385452 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr'
      and table_schema = 'stg'
  
21:52:33.420912 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:33.425289 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:33.425623 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:33.427326 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:33.428478 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:33.428678 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
21:52:33.464726 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:33.466378 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:33.466650 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
    
21:52:34.167563 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:52:34.169339 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Countries_Incr: COMMIT
21:52:34.170127 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Countries_Incr".
21:52:34.170282 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Countries_Incr: 
    
  if object_id ('"stg"."#AH_Countries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Countries_Incr__dbt_tmp"
    end

21:52:34.208527 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:34.220248 [debug] [Thread-1  ]: finished collecting timing info
21:52:34.220690 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Countries_Incr: Close
21:52:34.221475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218d30>]}
21:52:34.222014 [info ] [Thread-1  ]: 16 of 101 OK snapshotted stg.AH_Countries_Incr.................................. [[32mOK[0m in 12.59s]
21:52:34.222417 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Countries_Incr
21:52:34.222661 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Currencies_Incr
21:52:34.223081 [info ] [Thread-1  ]: 19 of 101 START snapshot stg.AH_Currencies_Incr................................. [RUN]
21:52:34.223528 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Currencies_Incr"
21:52:34.223687 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Currencies_Incr
21:52:34.223828 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Currencies_Incr
21:52:34.226699 [debug] [Thread-1  ]: finished collecting timing info
21:52:34.226906 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Currencies_Incr
21:52:34.230126 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:34.230312 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:34.230437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:52:34.230605 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:34.344787 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:34.375456 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:52:34.397482 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:34.397873 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:34.424857 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:34.427526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:34.427858 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Currencies_InterView]
        ) as __dbt_sbq
    
21:52:34.489985 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:34.511020 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:34.511449 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        ) as __dbt_sbq
    
21:52:34.526057 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:52:34.527761 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:34.528010 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Contents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:34.542947 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:52:34.544600 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:34.544852 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:34.561879 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:34.564751 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:34.565172 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:34.568797 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:34.565331 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Contents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:34.569063 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
21:52:34.614454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:34.617142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:34.617438 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:34.636061 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:34.640356 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:34.640697 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Currencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Currencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512''), CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:34.402512'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ConVersiontousd != source_data.ConVersiontousd
        or
        (
            ((snapshotted_data.ConVersiontousd is null) and not (source_data.ConVersiontousd is null))
            or
            ((not snapshotted_data.ConVersiontousd is null) and (source_data.ConVersiontousd is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Currencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Currencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Currencies_Incr__dbt_tmp_temp_view"
    end



    
21:52:34.769462 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:52:34.771937 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Contents_Incr"
21:52:34.772538 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:34.772729 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Contents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Contents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Contents_Incr" (
                  "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "Usehtmleditor", "Userdefined", "CreatedOn", "UpdatedOn", "DeletedOn", "Text", "Name", "Culture", "PageTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Contents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:34.861224 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:34.864265 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:34.864588 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
21:52:34.903815 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:34.908567 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:34.908897 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:35.005049 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:52:35.006797 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:35.007087 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
21:52:35.045724 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.81 seconds
21:52:35.049292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:35.049593 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:35.093577 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:35.095279 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:35.095556 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
21:52:36.404213 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:52:36.405778 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:36.405958 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:36.453333 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.68 seconds
21:52:36.455217 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contents_Incr: COMMIT
21:52:36.456350 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Contents_Incr".
21:52:36.456554 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Contents_Incr: 
    
  if object_id ('"stg"."#AH_Contents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Contents_Incr__dbt_tmp"
    end

21:52:36.475298 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:52:36.477075 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:36.477391 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:36.478085 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:36.480206 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:36.480415 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:36.493777 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:36.504978 [debug] [Thread-2  ]: finished collecting timing info
21:52:36.505374 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Contents_Incr: Close
21:52:36.506119 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08218e80>]}
21:52:36.506671 [info ] [Thread-2  ]: 15 of 101 OK snapshotted stg.AH_Contents_Incr................................... [[32mOK[0m in 16.44s]
21:52:36.507073 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Contents_Incr
21:52:36.507267 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_CustomFieldenums_Incr
21:52:36.507659 [info ] [Thread-2  ]: 20 of 101 START snapshot stg.AH_CustomFieldenums_Incr........................... [RUN]
21:52:36.508098 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr"
21:52:36.508254 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_CustomFieldenums_Incr
21:52:36.508390 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_CustomFieldenums_Incr
21:52:36.511292 [debug] [Thread-2  ]: finished collecting timing info
21:52:36.511568 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_CustomFieldenums_Incr
21:52:36.511721 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:36.516496 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:36.516674 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:36.514564 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:36.516957 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:36.517087 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:52:36.517241 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:36.616653 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:36.644818 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:52:36.667654 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:36.668039 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:36.698586 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:36.700925 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:36.701253 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]
        ) as __dbt_sbq
    
21:52:36.754456 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:36.775719 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:36.776124 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        ) as __dbt_sbq
    
21:52:36.831996 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:36.836055 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:36.836247 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:52:36.838430 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:36.838649 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
21:52:36.836449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
21:52:36.873383 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:36.877771 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:36.878083 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:36.906834 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:36.910773 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:36.911116 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFieldenums_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809''), CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:36.683809'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFieldenums_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFieldenums_Incr__dbt_tmp_temp_view"
    end



    
21:52:36.915480 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:36.916848 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:36.917142 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
21:52:36.934336 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:52:36.937456 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:36.937745 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr'
      and table_schema = 'stg'
  
21:52:36.971462 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:36.976073 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:36.976403 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:37.018901 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:37.020587 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:37.020882 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    
21:52:38.053160 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:52:38.054838 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:38.055015 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:38.095532 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:38.098010 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:38.098205 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:38.175703 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:52:38.177268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:38.177521 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:38.217564 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:38.220170 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:38.220438 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:38.331273 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:52:38.335914 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:38.336230 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr'
      and table_schema = 'stg'
  
21:52:38.380158 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:38.384648 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:38.384977 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:38.422401 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:38.424075 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:38.424321 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    
21:52:38.427387 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:52:38.429175 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardTypes_Incr"
21:52:38.429666 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:38.429837 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardTypes_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:39.440204 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
21:52:39.441992 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:39.442301 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:39.475956 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:39.479019 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:39.479385 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CreditCardsExtraInFormation_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:39.730052 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:52:39.731990 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: COMMIT
21:52:39.733046 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardTypes_Incr".
21:52:39.733306 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardTypes_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardTypes_Incr__dbt_tmp"
    end

21:52:39.766941 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:52:39.769167 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr"
21:52:39.769891 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:39.770069 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:39.770237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CreditCardsExtraInFormation_Incr" (
                  "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Cvv", "CreditCardID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:39.781020 [debug] [Thread-4  ]: finished collecting timing info
21:52:39.781397 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CreditCardTypes_Incr: Close
21:52:39.782139 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b0a0>]}
21:52:39.782737 [info ] [Thread-4  ]: 17 of 101 OK snapshotted stg.AH_CreditCardTypes_Incr............................ [[32mOK[0m in 12.78s]
21:52:39.783150 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CreditCardTypes_Incr
21:52:39.783344 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_CustomFields_Incr
21:52:39.783762 [info ] [Thread-4  ]: 21 of 101 START snapshot stg.AH_CustomFields_Incr............................... [RUN]
21:52:39.784249 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_CustomFields_Incr"
21:52:39.784408 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_CustomFields_Incr
21:52:39.784549 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_CustomFields_Incr
21:52:39.788248 [debug] [Thread-4  ]: finished collecting timing info
21:52:39.788489 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_CustomFields_Incr
21:52:39.791945 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:39.792164 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:39.792297 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:52:39.792441 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:39.933997 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:39.962237 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:52:39.984235 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:39.984638 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:40.022189 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:40.024517 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:40.025204 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_CustomFields_InterView]
        ) as __dbt_sbq
    
21:52:40.096438 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:40.118994 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:40.119400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        ) as __dbt_sbq
    
21:52:40.212859 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:40.216768 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:40.217130 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
21:52:40.289415 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:40.294270 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:40.294658 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_CustomFields_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_CustomFields_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373''), CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:39.996373'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Required != source_data.Required
        or
        (
            ((snapshotted_data.Required is null) and not (source_data.Required is null))
            or
            ((not snapshotted_data.Required is null) and (source_data.Required is null))
        ) or snapshotted_data.Deferred != source_data.Deferred
        or
        (
            ((snapshotted_data.Deferred is null) and not (source_data.Deferred is null))
            or
            ((not snapshotted_data.Deferred is null) and (source_data.Deferred is null))
        ) or snapshotted_data.Encrypted != source_data.Encrypted
        or
        (
            ((snapshotted_data.Encrypted is null) and not (source_data.Encrypted is null))
            or
            ((not snapshotted_data.Encrypted is null) and (source_data.Encrypted is null))
        ) or snapshotted_data.IncludeonInvoice != source_data.IncludeonInvoice
        or
        (
            ((snapshotted_data.IncludeonInvoice is null) and not (source_data.IncludeonInvoice is null))
            or
            ((not snapshotted_data.IncludeonInvoice is null) and (source_data.IncludeonInvoice is null))
        ) or snapshotted_data.IncludeinSalesReport != source_data.IncludeinSalesReport
        or
        (
            ((snapshotted_data.IncludeinSalesReport is null) and not (source_data.IncludeinSalesReport is null))
            or
            ((not snapshotted_data.IncludeinSalesReport is null) and (source_data.IncludeinSalesReport is null))
        ) or snapshotted_data.IncludeonInvoiceasSeller != source_data.IncludeonInvoiceasSeller
        or
        (
            ((snapshotted_data.IncludeonInvoiceasSeller is null) and not (source_data.IncludeonInvoiceasSeller is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasSeller is null) and (source_data.IncludeonInvoiceasSeller is null))
        ) or snapshotted_data.IncludeonInvoiceasBuyer != source_data.IncludeonInvoiceasBuyer
        or
        (
            ((snapshotted_data.IncludeonInvoiceasBuyer is null) and not (source_data.IncludeonInvoiceasBuyer is null))
            or
            ((not snapshotted_data.IncludeonInvoiceasBuyer is null) and (source_data.IncludeonInvoiceasBuyer is null))
        ) or snapshotted_data.IncludeinSalesReportasSeller != source_data.IncludeinSalesReportasSeller
        or
        (
            ((snapshotted_data.IncludeinSalesReportasSeller is null) and not (source_data.IncludeinSalesReportasSeller is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasSeller is null) and (source_data.IncludeinSalesReportasSeller is null))
        ) or snapshotted_data.IncludeinSalesReportasBuyer != source_data.IncludeinSalesReportasBuyer
        or
        (
            ((snapshotted_data.IncludeinSalesReportasBuyer is null) and not (source_data.IncludeinSalesReportasBuyer is null))
            or
            ((not snapshotted_data.IncludeinSalesReportasBuyer is null) and (source_data.IncludeinSalesReportasBuyer is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.VisiBIlity != source_data.VisiBIlity
        or
        (
            ((snapshotted_data.VisiBIlity is null) and not (source_data.VisiBIlity is null))
            or
            ((not snapshotted_data.VisiBIlity is null) and (source_data.VisiBIlity is null))
        ) or snapshotted_data.MutaBIlity != source_data.MutaBIlity
        or
        (
            ((snapshotted_data.MutaBIlity is null) and not (source_data.MutaBIlity is null))
            or
            ((not snapshotted_data.MutaBIlity is null) and (source_data.MutaBIlity is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DefaultValue != source_data.DefaultValue
        or
        (
            ((snapshotted_data.DefaultValue is null) and not (source_data.DefaultValue is null))
            or
            ((not snapshotted_data.DefaultValue is null) and (source_data.DefaultValue is null))
        ) or snapshotted_data.GroupName != source_data.GroupName
        or
        (
            ((snapshotted_data.GroupName is null) and not (source_data.GroupName is null))
            or
            ((not snapshotted_data.GroupName is null) and (source_data.GroupName is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_CustomFields_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_CustomFields_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_CustomFields_Incr__dbt_tmp_temp_view"
    end



    
21:52:40.508942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.87 seconds
21:52:40.512607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:40.512965 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:40.553708 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:40.555401 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:40.555657 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
21:52:41.021181 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:52:41.022861 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: COMMIT
21:52:41.023573 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr".
21:52:41.023708 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: 
    
  if object_id ('"stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CreditCardsExtraInFormation_Incr__dbt_tmp"
    end

21:52:41.058404 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:41.070639 [debug] [Thread-3  ]: finished collecting timing info
21:52:41.071085 [debug] [Thread-3  ]: On snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr: Close
21:52:41.071892 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b160>]}
21:52:41.072437 [info ] [Thread-3  ]: 18 of 101 OK snapshotted stg.AH_CreditCardsExtraInFormation_Incr................ [[32mOK[0m in 11.32s]
21:52:41.072834 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_CreditCardsExtraInFormation_Incr
21:52:41.073033 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Customcurrencies_Incr
21:52:41.073446 [info ] [Thread-3  ]: 22 of 101 START snapshot stg.AH_Customcurrencies_Incr........................... [RUN]
21:52:41.073924 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr"
21:52:41.074086 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Customcurrencies_Incr
21:52:41.074223 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Customcurrencies_Incr
21:52:41.077229 [debug] [Thread-3  ]: finished collecting timing info
21:52:41.077450 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Customcurrencies_Incr
21:52:41.080477 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:41.080675 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:41.080803 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:52:41.080942 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:41.196191 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:41.226303 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:41.248623 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:41.249023 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:41.284525 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:41.286928 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:41.287200 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Customcurrencies_InterView]
        ) as __dbt_sbq
    
21:52:41.378265 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:41.399727 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:41.400124 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        ) as __dbt_sbq
    
21:52:41.459457 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:41.462927 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:41.463244 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
21:52:41.561301 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:52:41.565295 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:41.565648 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Customcurrencies_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025''), CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:41.262025'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Isocurrencysymbol != source_data.Isocurrencysymbol
        or
        (
            ((snapshotted_data.Isocurrencysymbol is null) and not (source_data.Isocurrencysymbol is null))
            or
            ((not snapshotted_data.Isocurrencysymbol is null) and (source_data.Isocurrencysymbol is null))
        ) or snapshotted_data.Currencysymbol != source_data.Currencysymbol
        or
        (
            ((snapshotted_data.Currencysymbol is null) and not (source_data.Currencysymbol is null))
            or
            ((not snapshotted_data.Currencysymbol is null) and (source_data.Currencysymbol is null))
        ) or snapshotted_data.CurrencyenglishName != source_data.CurrencyenglishName
        or
        (
            ((snapshotted_data.CurrencyenglishName is null) and not (source_data.CurrencyenglishName is null))
            or
            ((not snapshotted_data.CurrencyenglishName is null) and (source_data.CurrencyenglishName is null))
        ) or snapshotted_data.CurrencynativeName != source_data.CurrencynativeName
        or
        (
            ((snapshotted_data.CurrencynativeName is null) and not (source_data.CurrencynativeName is null))
            or
            ((not snapshotted_data.CurrencynativeName is null) and (source_data.CurrencynativeName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Customcurrencies_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Customcurrencies_Incr__dbt_tmp_temp_view"
    end



    
21:52:41.752228 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
21:52:41.753825 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:41.754012 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:41.849879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:52:41.852564 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:41.852802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:42.094251 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:42.097682 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:42.098010 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
21:52:42.136399 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:42.140837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:42.141202 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:42.203237 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:42.204785 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:42.205012 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
21:52:43.531664 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.62 seconds
21:52:43.535245 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:43.535502 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:43.573243 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:43.574929 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:43.575167 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
21:52:43.664547 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:52:43.666305 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:43.666625 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:43.703107 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:43.705644 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:43.705939 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:43.942016 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:43.945121 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:43.945350 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr'
      and table_schema = 'stg'
  
21:52:43.980639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:43.985123 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:43.985455 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:44.031783 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:44.033432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:44.033699 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
    
21:52:44.442805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.87 seconds
21:52:44.444521 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:44.444783 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:44.527904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:44.531167 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:44.531497 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:44.916998 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:52:44.919031 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:44.919330 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:44.955993 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:44.959238 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:44.959598 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Currencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:45.069158 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:52:45.073984 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:45.074376 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
21:52:45.119400 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:45.124003 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:45.124396 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:45.184996 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:45.186757 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:45.187094 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
21:52:45.330918 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:52:45.333704 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Currencies_Incr"
21:52:45.334400 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:45.334678 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Currencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Currencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Currencies_Incr" (
                  "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Code", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "ConVersiontousd", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Currencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:46.380180 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
21:52:46.381844 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:46.382040 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:46.471103 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:46.473724 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:46.473963 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:46.716448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:46.719874 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:46.720188 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr'
      and table_schema = 'stg'
  
21:52:46.811534 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:46.816246 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:46.816572 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:46.848550 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:52:46.850387 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Currencies_Incr: COMMIT
21:52:46.851333 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Currencies_Incr".
21:52:46.851554 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Currencies_Incr: 
    
  if object_id ('"stg"."#AH_Currencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Currencies_Incr__dbt_tmp"
    end

21:52:46.867444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:46.869168 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:46.869440 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    
21:52:46.893929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:46.906164 [debug] [Thread-1  ]: finished collecting timing info
21:52:46.906660 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Currencies_Incr: Close
21:52:46.907453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b400>]}
21:52:46.907985 [info ] [Thread-1  ]: 19 of 101 OK snapshotted stg.AH_Currencies_Incr................................. [[32mOK[0m in 12.68s]
21:52:46.908387 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Currencies_Incr
21:52:46.908580 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:52:46.908988 [info ] [Thread-1  ]: 23 of 101 START snapshot stg.AH_DailyhuntEmailSubscribers_Incr.................. [RUN]
21:52:46.909433 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
21:52:46.909591 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:52:46.909725 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:52:46.912605 [debug] [Thread-1  ]: finished collecting timing info
21:52:46.912805 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:52:46.915680 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:46.915866 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:46.916003 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:52:46.916145 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:47.022399 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:47.054634 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:52:47.076619 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:47.077037 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:47.119433 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:47.122011 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:47.122335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]
        ) as __dbt_sbq
    
21:52:47.182208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:47.203381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:47.203804 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        ) as __dbt_sbq
    
21:52:47.334628 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:52:47.338352 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:47.338780 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
21:52:47.420906 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:47.424779 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:47.425137 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_DailyhuntEmailSubscribers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889''), CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:47.105889'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.FirstName != source_data.FirstName
        or
        (
            ((snapshotted_data.FirstName is null) and not (source_data.FirstName is null))
            or
            ((not snapshotted_data.FirstName is null) and (source_data.FirstName is null))
        ) or snapshotted_data.LastName != source_data.LastName
        or
        (
            ((snapshotted_data.LastName is null) and not (source_data.LastName is null))
            or
            ((not snapshotted_data.LastName is null) and (source_data.LastName is null))
        ) or snapshotted_data.ZipCode != source_data.ZipCode
        or
        (
            ((snapshotted_data.ZipCode is null) and not (source_data.ZipCode is null))
            or
            ((not snapshotted_data.ZipCode is null) and (source_data.ZipCode is null))
        ) or snapshotted_data.ASenthusiast != source_data.ASenthusiast
        or
        (
            ((snapshotted_data.ASenthusiast is null) and not (source_data.ASenthusiast is null))
            or
            ((not snapshotted_data.ASenthusiast is null) and (source_data.ASenthusiast is null))
        ) or snapshotted_data.AsBidder != source_data.AsBidder
        or
        (
            ((snapshotted_data.AsBidder is null) and not (source_data.AsBidder is null))
            or
            ((not snapshotted_data.AsBidder is null) and (source_data.AsBidder is null))
        ) or snapshotted_data.AsConsignor != source_data.AsConsignor
        or
        (
            ((snapshotted_data.AsConsignor is null) and not (source_data.AsConsignor is null))
            or
            ((not snapshotted_data.AsConsignor is null) and (source_data.AsConsignor is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_temp_view"
    end



    
21:52:47.940193 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:52:47.941816 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:47.941999 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:47.979178 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:47.981797 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:47.982019 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFieldenums_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:48.201261 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:52:48.203621 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFieldenums_Incr"
21:52:48.204256 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:48.204457 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFieldenums_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomFieldID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:49.181222 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 7.62 seconds
21:52:49.184980 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:49.185240 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:49.228824 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:49.230492 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:49.230765 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
21:52:49.527099 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:52:49.528901 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: COMMIT
21:52:49.529759 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFieldenums_Incr".
21:52:49.529959 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFieldenums_Incr: 
    
  if object_id ('"stg"."#AH_CustomFieldenums_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFieldenums_Incr__dbt_tmp"
    end

21:52:49.566731 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:49.578061 [debug] [Thread-2  ]: finished collecting timing info
21:52:49.578475 [debug] [Thread-2  ]: On snapshot.Shawn.AH_CustomFieldenums_Incr: Close
21:52:49.579265 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b2b0>]}
21:52:49.579800 [info ] [Thread-2  ]: 20 of 101 OK snapshotted stg.AH_CustomFieldenums_Incr........................... [[32mOK[0m in 13.07s]
21:52:49.580197 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_CustomFieldenums_Incr
21:52:49.580388 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Decorations_Incr
21:52:49.580782 [info ] [Thread-2  ]: 24 of 101 START snapshot stg.AH_Decorations_Incr................................ [RUN]
21:52:49.581230 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Decorations_Incr"
21:52:49.581388 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Decorations_Incr
21:52:49.581524 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Decorations_Incr
21:52:49.584392 [debug] [Thread-2  ]: finished collecting timing info
21:52:49.584594 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Decorations_Incr
21:52:49.587947 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:49.588133 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:49.588258 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:52:49.588393 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:49.704501 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:49.734910 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:49.757245 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:49.757636 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:49.800143 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:49.802642 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:49.802927 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Decorations_InterView]
        ) as __dbt_sbq
    
21:52:49.866585 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:49.887628 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:49.888023 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        ) as __dbt_sbq
    
21:52:49.947211 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:49.950616 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:49.950922 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
21:52:50.017364 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:50.021709 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:50.022013 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Decorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Decorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815''), CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:49.777815'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ValIDFields != source_data.ValIDFields
        or
        (
            ((snapshotted_data.ValIDFields is null) and not (source_data.ValIDFields is null))
            or
            ((not snapshotted_data.ValIDFields is null) and (source_data.ValIDFields is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.FormatString != source_data.FormatString
        or
        (
            ((snapshotted_data.FormatString is null) and not (source_data.FormatString is null))
            or
            ((not snapshotted_data.FormatString is null) and (source_data.FormatString is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Decorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Decorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Decorations_Incr__dbt_tmp_temp_view"
    end



    
21:52:50.283375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:52:50.285109 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:50.285356 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:50.357909 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:50.360680 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:50.360990 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:50.625434 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:52:50.628683 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:50.628953 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
21:52:50.703099 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:50.707316 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:50.707633 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:50.745705 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:50.747444 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:50.747719 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
21:52:51.627991 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:52:51.629615 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:51.629867 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:51.664734 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:51.667515 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:51.667861 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:51.932102 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:52:51.935155 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:51.935389 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr'
      and table_schema = 'stg'
  
21:52:51.970472 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:51.975079 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:51.975458 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:52.011816 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:52.013443 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:52.013716 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    
21:52:53.515059 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:52:53.516726 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:53.516937 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:53.553969 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:53.556665 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:53.556908 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Customcurrencies_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:53.852224 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:52:53.854479 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Customcurrencies_Incr"
21:52:53.855071 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:53.855223 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Customcurrencies_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Isocurrencysymbol", "Currencysymbol", "CurrencyenglishName", "CurrencynativeName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Customcurrencies_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:54.660234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.23 seconds
21:52:54.665274 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:54.665568 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:54.703341 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:54.704956 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:54.705241 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
21:52:55.291300 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 15.00 seconds
21:52:55.295470 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:55.295801 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:55.330029 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:52:55.332192 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: COMMIT
21:52:55.333056 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Customcurrencies_Incr".
21:52:55.333261 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Customcurrencies_Incr: 
    
  if object_id ('"stg"."#AH_Customcurrencies_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Customcurrencies_Incr__dbt_tmp"
    end

21:52:55.333864 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:55.334904 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:55.335085 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
21:52:55.379540 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:55.390805 [debug] [Thread-3  ]: finished collecting timing info
21:52:55.391236 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Customcurrencies_Incr: Close
21:52:55.392034 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b6a0>]}
21:52:55.392578 [info ] [Thread-3  ]: 22 of 101 OK snapshotted stg.AH_Customcurrencies_Incr........................... [[32mOK[0m in 14.32s]
21:52:55.392961 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Customcurrencies_Incr
21:52:55.393158 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:52:55.393557 [info ] [Thread-3  ]: 25 of 101 START snapshot stg.AH_Emailtemplatecontents_Incr...................... [RUN]
21:52:55.394003 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
21:52:55.394164 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:52:55.394300 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:52:55.397190 [debug] [Thread-3  ]: finished collecting timing info
21:52:55.397396 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:52:55.400596 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:52:55.400809 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:52:55.400941 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:52:55.401079 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:52:55.517360 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:52:55.549904 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:52:55.572771 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:52:55.573172 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:52:55.608057 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:55.610154 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:52:55.610400 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]
        ) as __dbt_sbq
    
21:52:55.694968 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:55.717090 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:52:55.717499 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        ) as __dbt_sbq
    
21:52:55.802624 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:52:55.804248 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:55.804505 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:55.892222 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:55.895007 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:55.895345 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:56.001271 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:52:56.005224 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:52:56.005567 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
21:52:56.081027 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:56.084749 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:52:56.085122 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426''), CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:52:55.590426'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
21:52:56.129549 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:52:56.132779 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:56.133075 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
21:52:56.166327 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:56.170711 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:56.171059 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:56.210986 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:56.212626 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:56.212849 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
21:52:56.315096 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
21:52:56.316611 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:56.316811 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:56.385085 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:52:56.388009 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:56.388269 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:56.669296 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:52:56.672595 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:56.672932 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
21:52:56.756177 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:52:56.760913 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:56.761274 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:56.796651 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:56.798284 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:56.798529 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
21:52:57.412182 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
21:52:57.413863 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:57.414089 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:57.448163 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:57.450819 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:57.451041 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:57.654883 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:52:57.658097 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:57.658415 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr'
      and table_schema = 'stg'
  
21:52:57.694288 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:57.698999 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:57.699352 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:57.761417 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:52:57.763034 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:57.763217 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    
21:52:57.827627 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:52:57.829379 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:57.829632 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:57.875256 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:57.878268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:57.878651 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:58.116500 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.09 seconds
21:52:58.120191 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:58.120543 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:58.168231 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:52:58.171412 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:58.171750 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:58.172952 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:58.173126 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
21:52:58.171877 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr'
      and table_schema = 'stg'
  
21:52:58.215560 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:58.222436 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:58.222862 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:58.261105 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:52:58.262768 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:58.263020 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
    
21:52:58.591372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:52:58.593091 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:58.593336 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:58.640196 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:52:58.642910 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:58.643152 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_DailyhuntEmailSubscribers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:58.886192 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:52:58.888367 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr"
21:52:58.888839 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:52:58.888975 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_DailyhuntEmailSubscribers_Incr" (
                  "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Email", "FirstName", "LastName", "ZipCode", "ASenthusiast", "AsBidder", "AsConsignor", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:52:59.306613 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:52:59.308228 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:59.308403 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:59.318299 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:52:59.320269 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:59.320531 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:52:59.340542 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:52:59.343595 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:52:59.343942 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_CustomFields_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:52:59.410825 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:52:59.413608 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:52:59.413901 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:00.093655 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.75 seconds
21:53:00.096223 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_CustomFields_Incr"
21:53:00.096717 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:53:00.096878 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_CustomFields_Incr" (
                  "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Required", "Deferred", "Encrypted", "IncludeonInvoice", "IncludeinSalesReport", "IncludeonInvoiceasSeller", "IncludeonInvoiceasBuyer", "IncludeinSalesReportasSeller", "IncludeinSalesReportasBuyer", "Type", "DisplayOrder", "VisiBIlity", "MutaBIlity", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "DefaultValue", "GroupName", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_CustomFields_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:00.111134 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:53:00.112834 [debug] [Thread-1  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: COMMIT
21:53:00.113643 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr".
21:53:00.113829 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: 
    
  if object_id ('"stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_DailyhuntEmailSubscribers_Incr__dbt_tmp"
    end

21:53:00.159702 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:00.171403 [debug] [Thread-1  ]: finished collecting timing info
21:53:00.171848 [debug] [Thread-1  ]: On snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr: Close
21:53:00.172657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b7f0>]}
21:53:00.173192 [info ] [Thread-1  ]: 23 of 101 OK snapshotted stg.AH_DailyhuntEmailSubscribers_Incr.................. [[32mOK[0m in 13.26s]
21:53:00.173598 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_DailyhuntEmailSubscribers_Incr
21:53:00.173798 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Emailtemplates_Incr
21:53:00.174207 [info ] [Thread-1  ]: 26 of 101 START snapshot stg.AH_Emailtemplates_Incr............................. [RUN]
21:53:00.174716 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr"
21:53:00.174885 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Emailtemplates_Incr
21:53:00.175023 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Emailtemplates_Incr
21:53:00.177960 [debug] [Thread-1  ]: finished collecting timing info
21:53:00.178176 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Emailtemplates_Incr
21:53:00.181485 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:00.181698 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:00.181826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:53:00.181965 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:00.219517 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.81 seconds
21:53:00.222467 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:00.223651 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
21:53:00.256604 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:00.263824 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:00.264540 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:00.302433 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:00.307443 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:00.309099 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:00.309374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
21:53:00.334386 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:00.356875 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:00.357274 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:00.386359 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:00.388691 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:00.389021 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Emailtemplates_InterView]
        ) as __dbt_sbq
    
21:53:00.442097 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:00.463848 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:00.464264 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        ) as __dbt_sbq
    
21:53:00.531966 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:00.536089 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:00.536456 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
21:53:00.613755 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:00.617737 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:00.618137 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Emailtemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756''), CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:00.371756'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Emailtemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Emailtemplates_Incr__dbt_tmp_temp_view"
    end



    
21:53:01.386809 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:53:01.388518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:01.388758 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:01.438080 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:01.440944 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:01.441304 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:01.579429 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:53:01.581240 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CustomFields_Incr: COMMIT
21:53:01.582106 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_CustomFields_Incr".
21:53:01.582292 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_CustomFields_Incr: 
    
  if object_id ('"stg"."#AH_CustomFields_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_CustomFields_Incr__dbt_tmp"
    end

21:53:01.623869 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:01.727130 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:53:01.729754 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:01.730082 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr'
      and table_schema = 'stg'
  
21:53:01.731381 [debug] [Thread-4  ]: finished collecting timing info
21:53:01.731839 [debug] [Thread-4  ]: On snapshot.Shawn.AH_CustomFields_Incr: Close
21:53:01.732569 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822b550>]}
21:53:01.733049 [info ] [Thread-4  ]: 21 of 101 OK snapshotted stg.AH_CustomFields_Incr............................... [[32mOK[0m in 21.95s]
21:53:01.733431 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_CustomFields_Incr
21:53:01.733618 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Eventproperties_Incr
21:53:01.734011 [info ] [Thread-4  ]: 27 of 101 START snapshot stg.AH_Eventproperties_Incr............................ [RUN]
21:53:01.734469 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Eventproperties_Incr"
21:53:01.734665 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Eventproperties_Incr
21:53:01.734807 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Eventproperties_Incr
21:53:01.737840 [debug] [Thread-4  ]: finished collecting timing info
21:53:01.738062 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Eventproperties_Incr
21:53:01.740770 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:01.740961 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:01.741087 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:53:01.741224 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:01.769339 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:01.773992 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:01.774473 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:01.823470 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:01.824999 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:01.825244 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
    
21:53:01.842087 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:01.880736 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:01.903211 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:01.903621 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:01.937104 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:01.939327 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:01.939634 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Eventproperties_InterView]
        ) as __dbt_sbq
    
21:53:01.999147 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:02.020811 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:02.021203 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        ) as __dbt_sbq
    
21:53:02.072062 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:02.076426 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:02.076782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
21:53:02.142725 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:02.146775 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:02.147154 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Eventproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Eventproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663''), CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:01.918663'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Eventproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Eventproperties_Incr__dbt_tmp_temp_view"
    end



    
21:53:03.157531 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
21:53:03.159545 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:03.159847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:03.200787 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:03.203587 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:03.203949 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Decorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:03.468479 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:53:03.470826 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Decorations_Incr"
21:53:03.471423 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:03.471607 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Decorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Decorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Decorations_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "ValIDFields", "Description", "LastUpdatedUser", "Name", "FormatString", "Amount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Decorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:04.806379 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.72 seconds
21:53:04.809966 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:04.810212 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:04.821211 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:53:04.822977 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Decorations_Incr: COMMIT
21:53:04.824029 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Decorations_Incr".
21:53:04.824233 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Decorations_Incr: 
    
  if object_id ('"stg"."#AH_Decorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Decorations_Incr__dbt_tmp"
    end

21:53:04.860849 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:04.869348 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:04.870823 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:04.871086 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
21:53:04.876249 [debug] [Thread-2  ]: finished collecting timing info
21:53:04.876655 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Decorations_Incr: Close
21:53:04.877434 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081ae2e0>]}
21:53:04.877990 [info ] [Thread-2  ]: 24 of 101 OK snapshotted stg.AH_Decorations_Incr................................ [[32mOK[0m in 15.30s]
21:53:04.878391 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Decorations_Incr
21:53:04.878618 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Events_Incr
21:53:04.879033 [info ] [Thread-2  ]: 28 of 101 START snapshot stg.AH_Events_Incr..................................... [RUN]
21:53:04.879526 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Events_Incr"
21:53:04.879718 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Events_Incr
21:53:04.879867 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Events_Incr
21:53:04.882762 [debug] [Thread-2  ]: finished collecting timing info
21:53:04.882993 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Events_Incr
21:53:04.886091 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:04.886305 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:04.886435 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:53:04.886611 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:04.995391 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:05.023557 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:05.045359 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:05.045755 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:05.074017 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:05.076391 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:05.076679 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Events_InterView]
        ) as __dbt_sbq
    
21:53:05.158000 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:05.180176 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:05.180601 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        ) as __dbt_sbq
    
21:53:05.229585 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:05.233180 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:05.233449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
21:53:05.306886 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:05.311020 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:05.311355 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Events_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Events_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Events_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344''), CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:05.059344'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Events_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Events_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Events_Incr__dbt_tmp_temp_view"
    end



    
21:53:05.644836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.03 seconds
21:53:05.648773 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:05.649153 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:05.702343 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:05.703985 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:05.704269 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
21:53:05.832014 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:53:05.833823 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:05.834069 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:05.916911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:05.919677 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:05.920026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:06.308170 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:53:06.311334 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:06.311677 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
21:53:06.356691 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:06.362456 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:06.362881 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:06.407609 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:06.409279 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:06.409591 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
21:53:06.769737 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:53:06.771497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:06.771777 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:06.837864 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:06.840401 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:06.840752 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:07.057386 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:53:07.060513 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:07.060859 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
21:53:07.100523 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:07.104742 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:07.105135 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:07.165062 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:07.166658 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:07.166928 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
21:53:07.802912 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.39 seconds
21:53:07.804496 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:07.804683 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:07.843224 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:07.845869 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:07.846104 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:07.965352 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.80 seconds
21:53:07.967296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:07.967586 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:08.025596 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:08.028425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:08.028750 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:08.067923 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:53:08.071222 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:08.071592 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr'
      and table_schema = 'stg'
  
21:53:08.116660 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:08.121493 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:08.121870 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:08.177976 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:08.179837 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:08.180106 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    
21:53:08.244144 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:53:08.247226 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:08.247585 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr'
      and table_schema = 'stg'
  
21:53:08.287028 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:08.291946 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:08.292342 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:08.350940 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:08.352578 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:08.352892 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    
21:53:09.068575 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:53:09.070239 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:09.070500 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:09.118051 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:09.121117 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:09.121437 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:09.376199 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:09.378565 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplatecontents_Incr"
21:53:09.379114 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:09.379290 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplatecontents_Incr" (
                  "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Culture", "SuBJect", "Body", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:09.470767 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:53:09.472516 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:09.472773 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:09.512803 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:09.515556 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:09.515851 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Emailtemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:09.774604 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:53:09.776727 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Emailtemplates_Incr"
21:53:09.777221 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:09.777361 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Emailtemplates_Incr" (
                  "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UpdatedOn", "DeletedOn", "CreatedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Emailtemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:10.429055 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.12 seconds
21:53:10.433289 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:10.433627 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:10.476544 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:10.478217 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:10.478452 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
21:53:11.001959 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.62 seconds
21:53:11.003743 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: COMMIT
21:53:11.004521 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplatecontents_Incr".
21:53:11.004663 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplatecontents_Incr__dbt_tmp"
    end

21:53:11.046724 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:11.059402 [debug] [Thread-3  ]: finished collecting timing info
21:53:11.059847 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Emailtemplatecontents_Incr: Close
21:53:11.060633 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822bbe0>]}
21:53:11.061189 [info ] [Thread-3  ]: 25 of 101 OK snapshotted stg.AH_Emailtemplatecontents_Incr...................... [[32mOK[0m in 15.67s]
21:53:11.061587 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Emailtemplatecontents_Incr
21:53:11.061781 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:53:11.062193 [info ] [Thread-3  ]: 29 of 101 START snapshot stg.AH_ExternalUserIDs_Incr............................ [RUN]
21:53:11.062732 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr"
21:53:11.062907 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:53:11.063051 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ExternalUserIDs_Incr
21:53:11.065883 [debug] [Thread-3  ]: finished collecting timing info
21:53:11.066103 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:53:11.069234 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:11.069442 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:11.069571 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:53:11.069710 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:11.195537 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:11.222533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
21:53:11.224387 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: COMMIT
21:53:11.225257 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Emailtemplates_Incr".
21:53:11.225484 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Emailtemplates_Incr: 
    
  if object_id ('"stg"."#AH_Emailtemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Emailtemplates_Incr__dbt_tmp"
    end

21:53:11.226531 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:53:11.248352 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:11.248756 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:11.262840 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:11.274368 [debug] [Thread-1  ]: finished collecting timing info
21:53:11.274878 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Emailtemplates_Incr: Close
21:53:11.275759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822bd30>]}
21:53:11.276339 [info ] [Thread-1  ]: 26 of 101 OK snapshotted stg.AH_Emailtemplates_Incr............................. [[32mOK[0m in 11.10s]
21:53:11.276773 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Emailtemplates_Incr
21:53:11.276981 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Feedbacks_Incr
21:53:11.277418 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:11.279664 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:11.279892 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]
        ) as __dbt_sbq
    
21:53:11.277743 [info ] [Thread-1  ]: 30 of 101 START snapshot stg.AH_Feedbacks_Incr.................................. [RUN]
21:53:11.280596 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feedbacks_Incr"
21:53:11.280773 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Feedbacks_Incr
21:53:11.280912 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Feedbacks_Incr
21:53:11.284419 [debug] [Thread-1  ]: finished collecting timing info
21:53:11.284719 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Feedbacks_Incr
21:53:11.287803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:11.288084 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:11.288221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:53:11.288482 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:11.334604 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:11.359994 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:11.360418 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        ) as __dbt_sbq
    
21:53:11.407644 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:11.430560 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:11.434707 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:11.434981 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:11.435220 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
21:53:11.457539 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:11.457945 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:11.490804 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:11.493093 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:11.493380 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feedbacks_InterView]
        ) as __dbt_sbq
    
21:53:11.518775 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:53:11.520748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:11.519295 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:11.524619 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:11.521053 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:11.524867 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ExternalUserIDs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572''), CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.262572'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.ProvIDErUserID != source_data.ProvIDErUserID
        or
        (
            ((snapshotted_data.ProvIDErUserID is null) and not (source_data.ProvIDErUserID is null))
            or
            ((not snapshotted_data.ProvIDErUserID is null) and (source_data.ProvIDErUserID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ExternalUserIDs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_temp_view"
    end



    
21:53:11.549298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:11.571688 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:11.572071 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        ) as __dbt_sbq
    
21:53:11.589172 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:11.591690 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:11.592085 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:11.621802 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:11.625913 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:11.626292 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
21:53:11.720087 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:11.723646 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:11.724016 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feedbacks_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feedbacks_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700''), CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:11.465700'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.Rating != source_data.Rating
        or
        (
            ((snapshotted_data.Rating is null) and not (source_data.Rating is null))
            or
            ((not snapshotted_data.Rating is null) and (source_data.Rating is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ListingOwnerUserName != source_data.ListingOwnerUserName
        or
        (
            ((snapshotted_data.ListingOwnerUserName is null) and not (source_data.ListingOwnerUserName is null))
            or
            ((not snapshotted_data.ListingOwnerUserName is null) and (source_data.ListingOwnerUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feedbacks_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feedbacks_Incr__dbt_tmp_temp_view"
    end



    
21:53:12.128430 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:53:12.131689 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:12.131976 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
21:53:12.171455 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:12.177669 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:12.178018 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:12.227603 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:12.230915 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:12.231218 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
21:53:12.375821 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 10.23 seconds
21:53:12.379474 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:12.379814 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:12.437278 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:12.438851 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:12.439101 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
21:53:13.181266 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:53:13.182957 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:13.183154 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:13.230679 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:13.233097 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:13.233336 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:13.377333 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:53:13.379097 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:13.379387 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:13.469165 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:13.472039 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:13.472374 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:13.493488 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:53:13.496850 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:13.497171 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr'
      and table_schema = 'stg'
  
21:53:13.533217 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:13.537798 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:13.538178 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:13.579130 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:13.580769 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:13.581032 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
    
21:53:14.006027 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.53 seconds
21:53:14.009140 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:14.009401 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
21:53:14.049928 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:14.054448 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:14.054850 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:14.092635 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:14.094178 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:14.094413 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
21:53:14.717008 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:53:14.718675 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:14.718910 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Events_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:14.754677 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:14.757335 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:14.757693 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Events_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:15.033506 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:53:15.035040 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:15.035259 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:15.072877 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:15.076084 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:15.076361 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:15.105394 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:53:15.107607 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Events_Incr"
21:53:15.108187 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:15.108374 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Events_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Events_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Events_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Events_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:15.300985 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:53:15.303959 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:15.304226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr'
      and table_schema = 'stg'
  
21:53:15.346406 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:15.351284 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:15.351583 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:15.407081 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:15.408856 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:15.409071 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
    
21:53:16.538817 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:53:16.540382 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:16.540576 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:16.575165 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:16.577688 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:16.577928 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Eventproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:16.581351 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:53:16.582866 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Events_Incr: COMMIT
21:53:16.583661 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Events_Incr".
21:53:16.583847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Events_Incr: 
    
  if object_id ('"stg"."#AH_Events_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Events_Incr__dbt_tmp"
    end

21:53:16.636340 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:16.649159 [debug] [Thread-2  ]: finished collecting timing info
21:53:16.649596 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Events_Incr: Close
21:53:16.650389 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc080d9220>]}
21:53:16.808185 [info ] [Thread-2  ]: 28 of 101 OK snapshotted stg.AH_Events_Incr..................................... [[32mOK[0m in 11.77s]
21:53:16.809187 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Events_Incr
21:53:16.809423 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Feeproperties_Incr
21:53:16.809873 [info ] [Thread-2  ]: 31 of 101 START snapshot stg.AH_Feeproperties_Incr.............................. [RUN]
21:53:16.810453 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeproperties_Incr"
21:53:16.810711 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Feeproperties_Incr
21:53:16.810882 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Feeproperties_Incr
21:53:16.814200 [debug] [Thread-2  ]: finished collecting timing info
21:53:16.814485 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Feeproperties_Incr
21:53:16.817946 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:16.818112 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:53:16.820151 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Eventproperties_Incr"
21:53:16.820623 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:16.820784 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Eventproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "AuctionEventID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Eventproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:16.818383 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:16.821098 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:53:16.821263 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:16.918611 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:16.946490 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:53:16.968498 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:16.968898 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:17.006528 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:17.009187 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:17.009525 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeproperties_InterView]
        ) as __dbt_sbq
    
21:53:17.076843 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:17.098462 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:17.098887 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        ) as __dbt_sbq
    
21:53:17.165402 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:17.169256 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:17.169610 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
21:53:17.239516 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:17.243283 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:17.243621 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418''), CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:16.981418'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Processor != source_data.Processor
        or
        (
            ((snapshotted_data.Processor is null) and not (source_data.Processor is null))
            or
            ((not snapshotted_data.Processor is null) and (source_data.Processor is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeproperties_Incr__dbt_tmp_temp_view"
    end



    
21:53:17.386427 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.86 seconds
21:53:17.390082 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:17.390363 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:17.432984 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:17.434658 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:17.434894 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
21:53:18.119472 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:53:18.121055 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Eventproperties_Incr: COMMIT
21:53:18.121781 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Eventproperties_Incr".
21:53:18.121925 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Eventproperties_Incr: 
    
  if object_id ('"stg"."#AH_Eventproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Eventproperties_Incr__dbt_tmp"
    end

21:53:18.158299 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:18.170416 [debug] [Thread-4  ]: finished collecting timing info
21:53:18.170870 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Eventproperties_Incr: Close
21:53:18.171631 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0822ba90>]}
21:53:18.172147 [info ] [Thread-4  ]: 27 of 101 OK snapshotted stg.AH_Eventproperties_Incr............................ [[32mOK[0m in 16.44s]
21:53:18.172542 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Eventproperties_Incr
21:53:18.172736 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Feeschedules_Incr
21:53:18.173124 [info ] [Thread-4  ]: 32 of 101 START snapshot stg.AH_Feeschedules_Incr............................... [RUN]
21:53:18.173564 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Feeschedules_Incr"
21:53:18.173722 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Feeschedules_Incr
21:53:18.173875 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Feeschedules_Incr
21:53:18.176795 [debug] [Thread-4  ]: finished collecting timing info
21:53:18.177001 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Feeschedules_Incr
21:53:18.179860 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:18.180047 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:18.180177 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:53:18.180313 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:18.306532 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:18.341665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:53:18.364198 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
21:53:18.365793 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:18.366041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:18.366920 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:18.367100 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:18.394367 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:18.396878 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:18.397180 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Feeschedules_InterView]
        ) as __dbt_sbq
    
21:53:18.439793 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:18.442313 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:18.442620 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:18.457563 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:18.479118 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:18.479500 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        ) as __dbt_sbq
    
21:53:18.533664 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:18.537786 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:18.538116 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
21:53:18.618212 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:18.621832 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:18.622143 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Feeschedules_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Feeschedules_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065''), CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:18.372065'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Feeschedules_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Feeschedules_Incr__dbt_tmp_temp_view"
    end



    
21:53:18.650926 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:53:18.654076 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:18.654354 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
21:53:18.702078 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:18.706444 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:18.706750 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:18.765539 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:18.767095 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:18.767350 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
21:53:20.398590 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:53:20.400143 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:20.400334 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:20.439441 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:20.442030 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:20.442231 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:20.451327 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.73 seconds
21:53:20.454527 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:20.454802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:20.505817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:20.507830 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:20.508119 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
21:53:20.675779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:53:20.678880 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:20.679129 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr'
      and table_schema = 'stg'
  
21:53:20.725125 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:20.729332 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:20.729662 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:20.773268 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:20.774991 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:20.775245 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    
21:53:21.671585 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:53:21.673321 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:21.673566 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:21.753089 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:21.755978 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:21.756271 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:21.830929 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:53:21.832951 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:21.833228 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:21.870894 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:21.873591 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:21.873883 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ExternalUserIDs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:21.983034 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:53:21.985991 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:21.986283 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
21:53:22.022955 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:22.027469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:22.027761 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:22.078844 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:22.080923 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:22.081171 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
21:53:22.086608 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:53:22.088574 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ExternalUserIDs_Incr"
21:53:22.089081 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:22.089248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ExternalUserIDs_Incr" (
                  "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "ProvIDErUserID", "CreatedOn", "UpdatedOn", "DeletedOn", "LocalUserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:23.116934 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:53:23.118666 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:23.118870 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:23.156945 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:23.159693 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:23.159923 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:23.406590 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:23.409531 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:23.409716 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr'
      and table_schema = 'stg'
  
21:53:23.438007 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.35 seconds
21:53:23.439849 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: COMMIT
21:53:23.440698 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ExternalUserIDs_Incr".
21:53:23.440897 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ExternalUserIDs_Incr: 
    
  if object_id ('"stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ExternalUserIDs_Incr__dbt_tmp"
    end

21:53:23.443745 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:23.448078 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:23.448299 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:23.477638 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:23.487692 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:23.488992 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:23.489232 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
    
21:53:23.492396 [debug] [Thread-3  ]: finished collecting timing info
21:53:23.492685 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ExternalUserIDs_Incr: Close
21:53:23.493394 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc082120a0>]}
21:53:23.493902 [info ] [Thread-3  ]: 29 of 101 OK snapshotted stg.AH_ExternalUserIDs_Incr............................ [[32mOK[0m in 12.43s]
21:53:23.494293 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ExternalUserIDs_Incr
21:53:23.494482 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:53:23.494905 [info ] [Thread-3  ]: 33 of 101 START snapshot stg.AH_ImportedCategoryMap_Incr........................ [RUN]
21:53:23.495348 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
21:53:23.495510 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:53:23.495662 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:53:23.498435 [debug] [Thread-3  ]: finished collecting timing info
21:53:23.498661 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:53:23.501465 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:23.501647 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:23.501771 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:53:23.501907 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:23.617801 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:23.648456 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:23.670341 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:23.670760 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:23.704061 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:23.706673 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:23.706985 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]
        ) as __dbt_sbq
    
21:53:23.757223 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:23.778757 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:23.779148 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        ) as __dbt_sbq
    
21:53:23.839690 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:23.842949 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:23.843220 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
21:53:23.914634 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:23.918325 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:23.918679 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedCategoryMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalCategoryID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650''), CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalCategoryID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalCategoryID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:23.684650'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalCategoryID != source_data.LocalCategoryID
        or
        (
            ((snapshotted_data.LocalCategoryID is null) and not (source_data.LocalCategoryID is null))
            or
            ((not snapshotted_data.LocalCategoryID is null) and (source_data.LocalCategoryID is null))
        ) or snapshotted_data.ForeignCategoryID != source_data.ForeignCategoryID
        or
        (
            ((snapshotted_data.ForeignCategoryID is null) and not (source_data.ForeignCategoryID is null))
            or
            ((not snapshotted_data.ForeignCategoryID is null) and (source_data.ForeignCategoryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_temp_view"
    end



    
21:53:25.011902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
21:53:25.013583 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:25.013795 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:25.048602 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:25.051500 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:25.051732 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feedbacks_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:25.288292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:53:25.290848 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feedbacks_Incr"
21:53:25.291077 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.05 seconds
21:53:25.295095 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:25.295775 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:25.295621 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:25.296137 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feedbacks_Incr" (
                  "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEndingUserID", "ReceivINgUserID", "Rating", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Comment", "LastUpdatedUser", "ListingOwnerUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feedbacks_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:25.347315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:25.349342 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:25.349577 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
21:53:26.876360 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.25 seconds
21:53:26.879933 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:26.880191 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:26.910040 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:53:26.911841 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:26.912133 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:26.956014 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:26.957586 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:26.957849 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
21:53:26.998933 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:27.001911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:27.002245 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:27.126914 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
21:53:27.129132 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Feedbacks_Incr: COMMIT
21:53:27.130114 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feedbacks_Incr".
21:53:27.130355 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Feedbacks_Incr: 
    
  if object_id ('"stg"."#AH_Feedbacks_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feedbacks_Incr__dbt_tmp"
    end

21:53:27.182918 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:27.194597 [debug] [Thread-1  ]: finished collecting timing info
21:53:27.195077 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Feedbacks_Incr: Close
21:53:27.195943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08179e80>]}
21:53:27.196514 [info ] [Thread-1  ]: 30 of 101 OK snapshotted stg.AH_Feedbacks_Incr.................................. [[32mOK[0m in 15.92s]
21:53:27.196954 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Feedbacks_Incr
21:53:27.197168 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:53:27.197587 [info ] [Thread-1  ]: 34 of 101 START snapshot stg.AH_ImportedListingsMap_Incr........................ [RUN]
21:53:27.198107 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr"
21:53:27.198275 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:53:27.198416 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ImportedListingsMap_Incr
21:53:27.202001 [debug] [Thread-1  ]: finished collecting timing info
21:53:27.202319 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:53:27.206101 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:27.206438 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:27.206621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:53:27.206789 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:27.244143 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.33 seconds
21:53:27.247652 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:27.248839 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:27.293748 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:27.295408 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:27.295673 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
21:53:27.310913 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:27.338607 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:53:27.361562 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:27.361974 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:27.398039 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:27.401139 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:27.401468 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]
        ) as __dbt_sbq
    
21:53:27.452616 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:27.473753 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:53:27.476638 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:27.478434 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
21:53:27.478284 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:27.478824 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        ) as __dbt_sbq
    
21:53:27.512858 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:27.517526 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:27.517907 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:27.542962 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:27.546950 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:27.547335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
21:53:27.559553 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:27.561140 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:27.561425 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
21:53:27.621610 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:27.625088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:27.625418 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedListingsMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LoCallistingID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203''), CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LoCallistingID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LoCallistingID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:27.372203'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LoCallistingID != source_data.LoCallistingID
        or
        (
            ((snapshotted_data.LoCallistingID is null) and not (source_data.LoCallistingID is null))
            or
            ((not snapshotted_data.LoCallistingID is null) and (source_data.LoCallistingID is null))
        ) or snapshotted_data.ForeignListingID != source_data.ForeignListingID
        or
        (
            ((snapshotted_data.ForeignListingID is null) and not (source_data.ForeignListingID is null))
            or
            ((not snapshotted_data.ForeignListingID is null) and (source_data.ForeignListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedListingsMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_temp_view"
    end



    
21:53:27.794759 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.84 seconds
21:53:27.796326 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:27.796550 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:27.876224 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:27.879108 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:27.879448 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:28.126372 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:28.129685 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:28.130036 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
21:53:28.166957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:28.171422 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:28.171797 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:28.220516 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:28.222191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:28.222447 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
21:53:28.244487 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:53:28.246246 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:28.246526 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:28.313437 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:28.316027 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:28.316315 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:28.906326 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
21:53:28.908088 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:28.908299 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:28.942025 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:28.945167 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:28.945465 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:29.144094 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:53:29.147173 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:29.147569 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
21:53:29.191235 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:29.194867 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:29.195167 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:29.198965 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:29.199229 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:29.195454 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr'
      and table_schema = 'stg'
  
21:53:29.242089 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:29.247220 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:29.247627 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:29.249414 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:29.250853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:29.251101 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
21:53:29.281389 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:53:29.285582 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:29.286061 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:29.293914 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:29.295581 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:29.295912 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
    
21:53:29.323795 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:29.326693 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:29.327088 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:29.572612 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:29.575742 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:29.576110 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr'
      and table_schema = 'stg'
  
21:53:29.610938 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:29.615771 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:29.616148 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:29.678445 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:29.680155 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:29.680479 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
    
21:53:30.609687 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:53:30.611348 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:30.611582 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:30.683439 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:30.685922 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:30.686129 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:30.746507 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.45 seconds
21:53:30.748198 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:30.748464 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:30.770832 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:53:30.772581 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:30.772849 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:30.781166 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:30.783771 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:30.784053 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:30.811064 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:30.814264 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:30.814653 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Feeschedules_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:30.828126 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.20 seconds
21:53:30.831626 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:30.831958 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:30.875702 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:30.877290 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:30.877522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
21:53:30.926746 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:53:30.929804 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:30.930141 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr'
      and table_schema = 'stg'
  
21:53:30.972779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:30.977303 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:30.977657 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:30.984970 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:53:30.987122 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeproperties_Incr"
21:53:30.987679 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:30.987855 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeproperties_Incr" (
                  "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Processor", "Name", "Description", "Amount", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:31.020006 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:53:31.022400 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Feeschedules_Incr"
21:53:31.023049 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:31.023263 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Feeschedules_Incr" (
                  "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PayToproceed", "CreatedOn", "UpdatedOn", "DeletedOn", "EventID", "ListingTypeID", "Description", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Feeschedules_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:31.029468 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:31.030987 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:31.031234 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    
21:53:31.907224 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:53:31.908880 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:31.909068 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:31.979611 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:31.982200 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:31.982416 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:32.081341 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:53:32.082936 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:32.083144 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:32.119476 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:32.121922 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:32.122268 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedCategoryMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:32.200936 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:53:32.204526 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:32.204890 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
21:53:32.282923 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:32.287291 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:32.287640 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:32.335891 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:32.337602 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:32.337850 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
21:53:32.386117 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:53:32.388255 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedCategoryMap_Incr"
21:53:32.388835 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:32.389022 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedCategoryMap_Incr" (
                  "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalCategoryID", "ForeignCategoryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:32.785312 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
21:53:32.787083 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Feeproperties_Incr: COMMIT
21:53:32.787909 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeproperties_Incr".
21:53:32.788069 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeproperties_Incr: 
    
  if object_id ('"stg"."#AH_Feeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeproperties_Incr__dbt_tmp"
    end

21:53:32.789974 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
21:53:32.791379 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeschedules_Incr: COMMIT
21:53:32.792476 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Feeschedules_Incr".
21:53:32.792660 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Feeschedules_Incr: 
    
  if object_id ('"stg"."#AH_Feeschedules_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Feeschedules_Incr__dbt_tmp"
    end

21:53:32.833270 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:32.847456 [debug] [Thread-2  ]: finished collecting timing info
21:53:32.848014 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Feeproperties_Incr: Close
21:53:32.848197 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:32.945548 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00d7a5e0>]}
21:53:32.946229 [info ] [Thread-2  ]: 31 of 101 OK snapshotted stg.AH_Feeproperties_Incr.............................. [[32mOK[0m in 16.14s]
21:53:32.946681 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Feeproperties_Incr
21:53:32.946887 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ImportedUserMap_Incr
21:53:32.947267 [info ] [Thread-2  ]: 35 of 101 START snapshot stg.AH_ImportedUserMap_Incr............................ [RUN]
21:53:32.947734 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr"
21:53:32.947896 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ImportedUserMap_Incr
21:53:32.948035 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ImportedUserMap_Incr
21:53:32.950869 [debug] [Thread-2  ]: finished collecting timing info
21:53:32.952002 [debug] [Thread-4  ]: finished collecting timing info
21:53:32.952348 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Feeschedules_Incr: Close
21:53:32.952963 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00d5c190>]}
21:53:32.953358 [info ] [Thread-4  ]: 32 of 101 OK snapshotted stg.AH_Feeschedules_Incr............................... [[32mOK[0m in 14.78s]
21:53:32.953700 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Feeschedules_Incr
21:53:32.953881 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ImportedregionMap_Incr
21:53:32.954223 [info ] [Thread-4  ]: 36 of 101 START snapshot stg.AH_ImportedregionMap_Incr.......................... [RUN]
21:53:32.952161 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ImportedUserMap_Incr
21:53:32.957455 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:32.954682 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr"
21:53:32.957793 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ImportedregionMap_Incr
21:53:32.957926 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ImportedregionMap_Incr
21:53:32.960667 [debug] [Thread-4  ]: finished collecting timing info
21:53:32.960875 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ImportedregionMap_Incr
21:53:32.963410 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:32.957647 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:32.963745 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:53:32.963888 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:32.963604 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:32.965361 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:53:32.965554 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:33.078282 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:33.079861 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:33.107163 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:33.108762 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:33.139368 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:33.151325 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:33.150891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:33.151698 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:33.158002 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.82 seconds
21:53:33.159398 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:33.159607 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:33.177701 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:33.177989 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:33.179911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:33.180130 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]
        ) as __dbt_sbq
    
21:53:33.181961 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:33.182145 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]
        ) as __dbt_sbq
    
21:53:33.190563 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:33.192558 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:33.192759 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:33.234195 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:33.243794 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:33.267310 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:33.275847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        ) as __dbt_sbq
    
21:53:33.277222 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:33.277453 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        ) as __dbt_sbq
    
21:53:33.362971 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:33.366827 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:33.367151 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
21:53:33.376288 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:53:33.380095 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:33.380476 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
21:53:33.441836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:33.444756 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:33.445013 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr'
      and table_schema = 'stg'
  
21:53:33.456459 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:33.459854 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:33.460127 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedUserMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalUserID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169''), CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalUserID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalUserID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalUserID != source_data.LocalUserID
        or
        (
            ((snapshotted_data.LocalUserID is null) and not (source_data.LocalUserID is null))
            or
            ((not snapshotted_data.LocalUserID is null) and (source_data.LocalUserID is null))
        ) or snapshotted_data.ForeignUserID != source_data.ForeignUserID
        or
        (
            ((snapshotted_data.ForeignUserID is null) and not (source_data.ForeignUserID is null))
            or
            ((not snapshotted_data.ForeignUserID is null) and (source_data.ForeignUserID is null))
        ) or snapshotted_data.ImportedUserName != source_data.ImportedUserName
        or
        (
            ((snapshotted_data.ImportedUserName is null) and not (source_data.ImportedUserName is null))
            or
            ((not snapshotted_data.ImportedUserName is null) and (source_data.ImportedUserName is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedUserMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedUserMap_Incr__dbt_tmp_temp_view"
    end



    
21:53:33.488004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:33.492527 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:33.492831 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:33.504342 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:53:33.509630 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:33.509988 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ImportedregionMap_InterView]

    ),

    snapshotted_data as (

        select *,
            LocalregionID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169''), CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LocalregionID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LocalregionID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.169169'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LocalregionID != source_data.LocalregionID
        or
        (
            ((snapshotted_data.LocalregionID is null) and not (source_data.LocalregionID is null))
            or
            ((not snapshotted_data.LocalregionID is null) and (source_data.LocalregionID is null))
        ) or snapshotted_data.ForeignregionID != source_data.ForeignregionID
        or
        (
            ((snapshotted_data.ForeignregionID is null) and not (source_data.ForeignregionID is null))
            or
            ((not snapshotted_data.ForeignregionID is null) and (source_data.ForeignregionID is null))
        ) or snapshotted_data.Foreignregiontier != source_data.Foreignregiontier
        or
        (
            ((snapshotted_data.Foreignregiontier is null) and not (source_data.Foreignregiontier is null))
            or
            ((not snapshotted_data.Foreignregiontier is null) and (source_data.Foreignregiontier is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ImportedregionMap_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ImportedregionMap_Incr__dbt_tmp_temp_view"
    end



    
21:53:33.537502 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:33.539106 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:33.539350 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    
21:53:33.687459 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:53:33.689300 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: COMMIT
21:53:33.690137 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedCategoryMap_Incr".
21:53:33.690338 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedCategoryMap_Incr__dbt_tmp"
    end

21:53:33.754297 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:33.765052 [debug] [Thread-3  ]: finished collecting timing info
21:53:33.765521 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ImportedCategoryMap_Incr: Close
21:53:33.766327 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00fb91f0>]}
21:53:33.766925 [info ] [Thread-3  ]: 33 of 101 OK snapshotted stg.AH_ImportedCategoryMap_Incr........................ [[32mOK[0m in 10.27s]
21:53:33.767333 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ImportedCategoryMap_Incr
21:53:33.767533 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Increments_Incr
21:53:33.767928 [info ] [Thread-3  ]: 37 of 101 START snapshot stg.AH_Increments_Incr................................. [RUN]
21:53:33.768399 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Increments_Incr"
21:53:33.768569 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Increments_Incr
21:53:33.768708 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Increments_Incr
21:53:33.771731 [debug] [Thread-3  ]: finished collecting timing info
21:53:33.771963 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Increments_Incr
21:53:33.775022 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:33.775256 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:33.775388 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:53:33.775534 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:33.889115 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:33.922222 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:33.943906 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:33.944310 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:33.978980 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:33.981828 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:33.982101 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Increments_InterView]
        ) as __dbt_sbq
    
21:53:34.050333 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:34.071445 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:34.071843 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        ) as __dbt_sbq
    
21:53:34.157643 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:34.161328 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:34.161606 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
21:53:34.241816 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:34.245514 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:34.245815 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Increments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Increments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426''), CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:33.950426'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PriceLevel != source_data.PriceLevel
        or
        (
            ((snapshotted_data.PriceLevel is null) and not (source_data.PriceLevel is null))
            or
            ((not snapshotted_data.PriceLevel is null) and (source_data.PriceLevel is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Increments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Increments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Increments_Incr__dbt_tmp_temp_view"
    end



    
21:53:34.522402 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
21:53:34.524088 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:34.524330 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:34.598503 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:34.601229 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:34.601634 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedListingsMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:34.812478 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:53:34.814971 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedListingsMap_Incr"
21:53:34.815525 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:34.815718 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedListingsMap_Incr" (
                  "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LoCallistingID", "ForeignListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:36.115073 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.30 seconds
21:53:36.116814 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: COMMIT
21:53:36.117607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedListingsMap_Incr".
21:53:36.117762 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedListingsMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedListingsMap_Incr__dbt_tmp"
    end

21:53:36.156743 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:36.167790 [debug] [Thread-1  ]: finished collecting timing info
21:53:36.168280 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ImportedListingsMap_Incr: Close
21:53:36.169148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00fbe3d0>]}
21:53:36.169748 [info ] [Thread-1  ]: 34 of 101 OK snapshotted stg.AH_ImportedListingsMap_Incr........................ [[32mOK[0m in 8.97s]
21:53:36.170184 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ImportedListingsMap_Incr
21:53:36.170397 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Invoices_Incr
21:53:36.170878 [info ] [Thread-1  ]: 38 of 101 START snapshot stg.AH_Invoices_Incr................................... [RUN]
21:53:36.171411 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Invoices_Incr"
21:53:36.171578 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Invoices_Incr
21:53:36.171720 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Invoices_Incr
21:53:36.174760 [debug] [Thread-1  ]: finished collecting timing info
21:53:36.174997 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Invoices_Incr
21:53:36.178299 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:53:36.178522 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:36.178705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:53:36.178924 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:36.278695 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:36.307161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:53:36.329393 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:53:36.329804 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:36.376714 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:36.379230 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:53:36.379591 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Invoices_InterView]
        ) as __dbt_sbq
    
21:53:36.442884 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:36.465095 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:53:36.465534 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        ) as __dbt_sbq
    
21:53:36.558114 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:36.562475 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:53:36.562880 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
21:53:36.814813 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:36.820277 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:53:36.820646 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Invoices_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709''), CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:36.356709'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Paiddttm != source_data.Paiddttm
        or
        (
            ((snapshotted_data.Paiddttm is null) and not (source_data.Paiddttm is null))
            or
            ((not snapshotted_data.Paiddttm is null) and (source_data.Paiddttm is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Createddttm != source_data.Createddttm
        or
        (
            ((snapshotted_data.Createddttm is null) and not (source_data.Createddttm is null))
            or
            ((not snapshotted_data.Createddttm is null) and (source_data.Createddttm is null))
        ) or snapshotted_data.Fulfilleddttm != source_data.Fulfilleddttm
        or
        (
            ((snapshotted_data.Fulfilleddttm is null) and not (source_data.Fulfilleddttm is null))
            or
            ((not snapshotted_data.Fulfilleddttm is null) and (source_data.Fulfilleddttm is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.ShippingOptionID != source_data.ShippingOptionID
        or
        (
            ((snapshotted_data.ShippingOptionID is null) and not (source_data.ShippingOptionID is null))
            or
            ((not snapshotted_data.ShippingOptionID is null) and (source_data.ShippingOptionID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.SalesTax != source_data.SalesTax
        or
        (
            ((snapshotted_data.SalesTax is null) and not (source_data.SalesTax is null))
            or
            ((not snapshotted_data.SalesTax is null) and (source_data.SalesTax is null))
        ) or snapshotted_data.BuyersPremiumPercent != source_data.BuyersPremiumPercent
        or
        (
            ((snapshotted_data.BuyersPremiumPercent is null) and not (source_data.BuyersPremiumPercent is null))
            or
            ((not snapshotted_data.BuyersPremiumPercent is null) and (source_data.BuyersPremiumPercent is null))
        ) or snapshotted_data.BuyersPremiumAmount != source_data.BuyersPremiumAmount
        or
        (
            ((snapshotted_data.BuyersPremiumAmount is null) and not (source_data.BuyersPremiumAmount is null))
            or
            ((not snapshotted_data.BuyersPremiumAmount is null) and (source_data.BuyersPremiumAmount is null))
        ) or snapshotted_data.ShippingAmount != source_data.ShippingAmount
        or
        (
            ((snapshotted_data.ShippingAmount is null) and not (source_data.ShippingAmount is null))
            or
            ((not snapshotted_data.ShippingAmount is null) and (source_data.ShippingAmount is null))
        ) or snapshotted_data.SubTotal != source_data.SubTotal
        or
        (
            ((snapshotted_data.SubTotal is null) and not (source_data.SubTotal is null))
            or
            ((not snapshotted_data.SubTotal is null) and (source_data.SubTotal is null))
        ) or snapshotted_data.Total != source_data.Total
        or
        (
            ((snapshotted_data.Total is null) and not (source_data.Total is null))
            or
            ((not snapshotted_data.Total is null) and (source_data.Total is null))
        ) or snapshotted_data.IsPayerLocked != source_data.IsPayerLocked
        or
        (
            ((snapshotted_data.IsPayerLocked is null) and not (source_data.IsPayerLocked is null))
            or
            ((not snapshotted_data.IsPayerLocked is null) and (source_data.IsPayerLocked is null))
        ) or snapshotted_data.Shipped != source_data.Shipped
        or
        (
            ((snapshotted_data.Shipped is null) and not (source_data.Shipped is null))
            or
            ((not snapshotted_data.Shipped is null) and (source_data.Shipped is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.ShippingLastName != source_data.ShippingLastName
        or
        (
            ((snapshotted_data.ShippingLastName is null) and not (source_data.ShippingLastName is null))
            or
            ((not snapshotted_data.ShippingLastName is null) and (source_data.ShippingLastName is null))
        ) or snapshotted_data.BillingLastName != source_data.BillingLastName
        or
        (
            ((snapshotted_data.BillingLastName is null) and not (source_data.BillingLastName is null))
            or
            ((not snapshotted_data.BillingLastName is null) and (source_data.BillingLastName is null))
        ) or snapshotted_data.OwnerName != source_data.OwnerName
        or
        (
            ((snapshotted_data.OwnerName is null) and not (source_data.OwnerName is null))
            or
            ((not snapshotted_data.OwnerName is null) and (source_data.OwnerName is null))
        ) or snapshotted_data.Shippingdetails != source_data.Shippingdetails
        or
        (
            ((snapshotted_data.Shippingdetails is null) and not (source_data.Shippingdetails is null))
            or
            ((not snapshotted_data.Shippingdetails is null) and (source_data.Shippingdetails is null))
        ) or snapshotted_data.OwnerCity != source_data.OwnerCity
        or
        (
            ((snapshotted_data.OwnerCity is null) and not (source_data.OwnerCity is null))
            or
            ((not snapshotted_data.OwnerCity is null) and (source_data.OwnerCity is null))
        ) or snapshotted_data.OwnerStateregion != source_data.OwnerStateregion
        or
        (
            ((snapshotted_data.OwnerStateregion is null) and not (source_data.OwnerStateregion is null))
            or
            ((not snapshotted_data.OwnerStateregion is null) and (source_data.OwnerStateregion is null))
        ) or snapshotted_data.OwnerzipPostal != source_data.OwnerzipPostal
        or
        (
            ((snapshotted_data.OwnerzipPostal is null) and not (source_data.OwnerzipPostal is null))
            or
            ((not snapshotted_data.OwnerzipPostal is null) and (source_data.OwnerzipPostal is null))
        ) or snapshotted_data.OwnerCountry != source_data.OwnerCountry
        or
        (
            ((snapshotted_data.OwnerCountry is null) and not (source_data.OwnerCountry is null))
            or
            ((not snapshotted_data.OwnerCountry is null) and (source_data.OwnerCountry is null))
        ) or snapshotted_data.ShippingFirstName != source_data.ShippingFirstName
        or
        (
            ((snapshotted_data.ShippingFirstName is null) and not (source_data.ShippingFirstName is null))
            or
            ((not snapshotted_data.ShippingFirstName is null) and (source_data.ShippingFirstName is null))
        ) or snapshotted_data.BillingFirstName != source_data.BillingFirstName
        or
        (
            ((snapshotted_data.BillingFirstName is null) and not (source_data.BillingFirstName is null))
            or
            ((not snapshotted_data.BillingFirstName is null) and (source_data.BillingFirstName is null))
        ) or snapshotted_data.BillingCity != source_data.BillingCity
        or
        (
            ((snapshotted_data.BillingCity is null) and not (source_data.BillingCity is null))
            or
            ((not snapshotted_data.BillingCity is null) and (source_data.BillingCity is null))
        ) or snapshotted_data.BillingStateregion != source_data.BillingStateregion
        or
        (
            ((snapshotted_data.BillingStateregion is null) and not (source_data.BillingStateregion is null))
            or
            ((not snapshotted_data.BillingStateregion is null) and (source_data.BillingStateregion is null))
        ) or snapshotted_data.BillingzipPostal != source_data.BillingzipPostal
        or
        (
            ((snapshotted_data.BillingzipPostal is null) and not (source_data.BillingzipPostal is null))
            or
            ((not snapshotted_data.BillingzipPostal is null) and (source_data.BillingzipPostal is null))
        ) or snapshotted_data.BillingCountry != source_data.BillingCountry
        or
        (
            ((snapshotted_data.BillingCountry is null) and not (source_data.BillingCountry is null))
            or
            ((not snapshotted_data.BillingCountry is null) and (source_data.BillingCountry is null))
        ) or snapshotted_data.OwnerStreet1 != source_data.OwnerStreet1
        or
        (
            ((snapshotted_data.OwnerStreet1 is null) and not (source_data.OwnerStreet1 is null))
            or
            ((not snapshotted_data.OwnerStreet1 is null) and (source_data.OwnerStreet1 is null))
        ) or snapshotted_data.OwnerStreet2 != source_data.OwnerStreet2
        or
        (
            ((snapshotted_data.OwnerStreet2 is null) and not (source_data.OwnerStreet2 is null))
            or
            ((not snapshotted_data.OwnerStreet2 is null) and (source_data.OwnerStreet2 is null))
        ) or snapshotted_data.ShippingCity != source_data.ShippingCity
        or
        (
            ((snapshotted_data.ShippingCity is null) and not (source_data.ShippingCity is null))
            or
            ((not snapshotted_data.ShippingCity is null) and (source_data.ShippingCity is null))
        ) or snapshotted_data.ShippingStateregion != source_data.ShippingStateregion
        or
        (
            ((snapshotted_data.ShippingStateregion is null) and not (source_data.ShippingStateregion is null))
            or
            ((not snapshotted_data.ShippingStateregion is null) and (source_data.ShippingStateregion is null))
        ) or snapshotted_data.ShippingzipPostal != source_data.ShippingzipPostal
        or
        (
            ((snapshotted_data.ShippingzipPostal is null) and not (source_data.ShippingzipPostal is null))
            or
            ((not snapshotted_data.ShippingzipPostal is null) and (source_data.ShippingzipPostal is null))
        ) or snapshotted_data.ShippingCountry != source_data.ShippingCountry
        or
        (
            ((snapshotted_data.ShippingCountry is null) and not (source_data.ShippingCountry is null))
            or
            ((not snapshotted_data.ShippingCountry is null) and (source_data.ShippingCountry is null))
        ) or snapshotted_data.BillingStreet1 != source_data.BillingStreet1
        or
        (
            ((snapshotted_data.BillingStreet1 is null) and not (source_data.BillingStreet1 is null))
            or
            ((not snapshotted_data.BillingStreet1 is null) and (source_data.BillingStreet1 is null))
        ) or snapshotted_data.BillingStreet2 != source_data.BillingStreet2
        or
        (
            ((snapshotted_data.BillingStreet2 is null) and not (source_data.BillingStreet2 is null))
            or
            ((not snapshotted_data.BillingStreet2 is null) and (source_data.BillingStreet2 is null))
        ) or snapshotted_data.Comments != source_data.Comments
        or
        (
            ((snapshotted_data.Comments is null) and not (source_data.Comments is null))
            or
            ((not snapshotted_data.Comments is null) and (source_data.Comments is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.ShippingStreet1 != source_data.ShippingStreet1
        or
        (
            ((snapshotted_data.ShippingStreet1 is null) and not (source_data.ShippingStreet1 is null))
            or
            ((not snapshotted_data.ShippingStreet1 is null) and (source_data.ShippingStreet1 is null))
        ) or snapshotted_data.ShippingStreet2 != source_data.ShippingStreet2
        or
        (
            ((snapshotted_data.ShippingStreet2 is null) and not (source_data.ShippingStreet2 is null))
            or
            ((not snapshotted_data.ShippingStreet2 is null) and (source_data.ShippingStreet2 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Invoices_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_Incr__dbt_tmp_temp_view"
    end



    
21:53:37.369295 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.91 seconds
21:53:37.372936 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:37.373193 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:37.494858 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:53:37.496506 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:37.496795 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
21:53:37.517306 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.01 seconds
21:53:37.520963 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:37.521318 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:37.580706 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:37.582274 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:37.582507 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
21:53:38.561531 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:53:38.563233 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:38.563420 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:38.575421 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
21:53:38.576899 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:38.577088 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:38.690220 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:53:38.692764 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:38.693032 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:38.701658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:38.704464 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:38.704805 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:40.246938 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
21:53:40.249878 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:40.250120 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
21:53:40.311323 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:53:40.314298 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:40.314688 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
21:53:40.345263 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:40.349695 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:40.350082 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:40.425953 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:53:40.430452 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:40.430816 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:40.432272 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:40.432576 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
21:53:40.431068 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:40.484513 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:40.486600 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:40.486877 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
21:53:41.594097 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:53:41.595662 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:41.595877 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:41.598117 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:53:41.599833 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:41.600035 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:41.683450 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:41.686026 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:41.686294 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:41.688304 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:41.690726 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:41.690995 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:41.938744 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:41.941688 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:41.941938 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr'
      and table_schema = 'stg'
  
21:53:41.948002 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:53:41.951010 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:41.951315 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr'
      and table_schema = 'stg'
  
21:53:41.985344 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:41.991608 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:41.991946 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:41.993270 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:41.996828 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:41.997066 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:42.031406 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:42.033073 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:42.033336 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    
21:53:42.047950 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:42.049571 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:42.049827 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    
21:53:42.373333 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.13 seconds
21:53:42.376997 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:42.377315 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:42.414018 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:42.415762 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:42.416063 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
21:53:43.110939 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:53:43.112589 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:43.112817 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:43.120542 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:53:43.121942 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:43.122118 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:43.146861 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:43.149333 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:43.149581 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedUserMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:43.155310 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:43.157454 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:43.157679 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ImportedregionMap_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:43.343725 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:53:43.345844 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedUserMap_Incr"
21:53:43.346467 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:43.346712 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedUserMap_Incr" (
                  "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalUserID", "ForeignUserID", "ImportedUserName", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:43.364251 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:53:43.366266 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:43.366587 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:43.372071 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:53:43.373985 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ImportedregionMap_Incr"
21:53:43.374501 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:43.374721 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ImportedregionMap_Incr" (
                  "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LocalregionID", "ForeignregionID", "Foreignregiontier", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:43.453825 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:43.456462 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:43.456762 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:43.932361 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
21:53:43.935666 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:43.935946 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
21:53:44.005299 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:44.009666 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:44.010043 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:44.071131 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:44.073144 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:44.073499 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
21:53:45.465590 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.09 seconds
21:53:45.467438 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: COMMIT
21:53:45.468298 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedregionMap_Incr".
21:53:45.468499 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedregionMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedregionMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedregionMap_Incr__dbt_tmp"
    end

21:53:45.523083 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:45.534424 [debug] [Thread-4  ]: finished collecting timing info
21:53:45.534891 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ImportedregionMap_Incr: Close
21:53:45.535670 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00f18520>]}
21:53:45.536207 [info ] [Thread-4  ]: 36 of 101 OK snapshotted stg.AH_ImportedregionMap_Incr.......................... [[32mOK[0m in 12.58s]
21:53:45.536608 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ImportedregionMap_Incr
21:53:45.536804 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_KeyTable_Incr
21:53:45.537198 [info ] [Thread-4  ]: 39 of 101 START snapshot stg.AH_KeyTable_Incr................................... [RUN]
21:53:45.537657 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_KeyTable_Incr"
21:53:45.537819 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_KeyTable_Incr
21:53:45.537956 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_KeyTable_Incr
21:53:45.540820 [debug] [Thread-4  ]: finished collecting timing info
21:53:45.541097 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_KeyTable_Incr
21:53:45.544056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:45.544250 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:45.544378 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:53:45.544516 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:45.677768 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:45.708525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:53:45.730577 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:45.730964 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:45.769730 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:45.772216 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:45.772464 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_KeyTable_InterView]
        ) as __dbt_sbq
    
21:53:45.814168 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
21:53:45.815927 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:45.816176 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:45.852195 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:45.854825 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:45.855019 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:45.855191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:45.876056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:45.876396 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
21:53:45.877903 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: COMMIT
21:53:45.878688 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ImportedUserMap_Incr".
21:53:45.878866 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ImportedUserMap_Incr: 
    
  if object_id ('"stg"."#AH_ImportedUserMap_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ImportedUserMap_Incr__dbt_tmp"
    end

21:53:45.876623 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        ) as __dbt_sbq
    
21:53:45.930154 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:45.937996 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:45.941131 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:45.946127 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
21:53:45.945913 [debug] [Thread-2  ]: finished collecting timing info
21:53:45.946637 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ImportedUserMap_Incr: Close
21:53:45.947375 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00eacfd0>]}
21:53:45.947889 [info ] [Thread-2  ]: 35 of 101 OK snapshotted stg.AH_ImportedUserMap_Incr............................ [[32mOK[0m in 13.00s]
21:53:45.948288 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ImportedUserMap_Incr
21:53:45.948484 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Languages_Incr
21:53:45.948898 [info ] [Thread-2  ]: 40 of 101 START snapshot stg.AH_Languages_Incr.................................. [RUN]
21:53:45.949361 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Languages_Incr"
21:53:45.949520 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Languages_Incr
21:53:45.949659 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Languages_Incr
21:53:45.952564 [debug] [Thread-2  ]: finished collecting timing info
21:53:45.952777 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Languages_Incr
21:53:45.955697 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:45.955886 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:45.956011 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:53:45.956148 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:46.034800 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:46.038058 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:46.038508 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_KeyTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_KeyTable_InterView]

    ),

    snapshotted_data as (

        select *,
            NextID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475''), CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(NextID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            NextID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:45.747475'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.NextID != source_data.NextID
        or
        (
            ((snapshotted_data.NextID is null) and not (source_data.NextID is null))
            or
            ((not snapshotted_data.NextID is null) and (source_data.NextID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_KeyTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_KeyTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_KeyTable_Incr__dbt_tmp_temp_view"
    end



    
21:53:46.072164 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:46.097348 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:53:46.100527 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:46.100832 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr'
      and table_schema = 'stg'
  
21:53:46.102352 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:46.123632 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:46.124022 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:46.140259 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:46.144636 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:46.144927 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:46.150324 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:46.152181 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:46.152402 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Languages_InterView]
        ) as __dbt_sbq
    
21:53:46.223497 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:46.225503 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:46.225746 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
    
21:53:46.231468 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:46.252709 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:46.253117 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        ) as __dbt_sbq
    
21:53:46.304200 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:46.308606 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:46.308976 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
21:53:46.407506 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:53:46.411137 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:46.411475 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Languages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Languages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147''), CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:46.138147'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Languages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Languages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Languages_Incr__dbt_tmp_temp_view"
    end



    
21:53:47.062808 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.84 seconds
21:53:47.064485 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:47.064678 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Increments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:47.109641 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:47.112111 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:47.112331 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Increments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:47.345103 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:53:47.347412 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Increments_Incr"
21:53:47.347948 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:47.348112 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Increments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Increments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Increments_Incr" (
                  "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PriceLevel", "Amount", "ListingTypeID", "AuctionEventID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Increments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:48.597571 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.56 seconds
21:53:48.601298 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:48.601555 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:48.638020 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:48.639756 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:48.640053 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
21:53:48.806468 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:53:48.808202 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Increments_Incr: COMMIT
21:53:48.809223 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Increments_Incr".
21:53:48.809407 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Increments_Incr: 
    
  if object_id ('"stg"."#AH_Increments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Increments_Incr__dbt_tmp"
    end

21:53:48.853094 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:48.865389 [debug] [Thread-3  ]: finished collecting timing info
21:53:48.865847 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Increments_Incr: Close
21:53:48.866692 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0800aa60>]}
21:53:48.867231 [info ] [Thread-3  ]: 37 of 101 OK snapshotted stg.AH_Increments_Incr................................. [[32mOK[0m in 15.10s]
21:53:48.867629 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Increments_Incr
21:53:48.867824 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_LineItems_Incr
21:53:48.868228 [info ] [Thread-3  ]: 41 of 101 START snapshot stg.AH_LineItems_Incr.................................. [RUN]
21:53:48.868710 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LineItems_Incr"
21:53:48.868887 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_LineItems_Incr
21:53:48.869030 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_LineItems_Incr
21:53:48.872049 [debug] [Thread-3  ]: finished collecting timing info
21:53:48.872284 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_LineItems_Incr
21:53:48.875399 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:53:48.875631 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:48.875765 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:53:48.875948 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:48.985150 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:49.012488 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:49.035490 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:53:49.035871 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:49.094218 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:49.096543 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:53:49.096802 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LineItems_InterView]
        ) as __dbt_sbq
    
21:53:49.211151 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:53:49.232714 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:53:49.233096 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        ) as __dbt_sbq
    
21:53:49.357915 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:53:49.361886 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:53:49.362237 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
21:53:49.439668 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:49.444050 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:53:49.444422 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LineItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401''), CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:49.044401'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Currency != source_data.Currency
        or
        (
            ((snapshotted_data.Currency is null) and not (source_data.Currency is null))
            or
            ((not snapshotted_data.Currency is null) and (source_data.Currency is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.PayerID != source_data.PayerID
        or
        (
            ((snapshotted_data.PayerID is null) and not (source_data.PayerID is null))
            or
            ((not snapshotted_data.PayerID is null) and (source_data.PayerID is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.TotalAmount != source_data.TotalAmount
        or
        (
            ((snapshotted_data.TotalAmount is null) and not (source_data.TotalAmount is null))
            or
            ((not snapshotted_data.TotalAmount is null) and (source_data.TotalAmount is null))
        ) or snapshotted_data.PeRunitAmount != source_data.PeRunitAmount
        or
        (
            ((snapshotted_data.PeRunitAmount is null) and not (source_data.PeRunitAmount is null))
            or
            ((not snapshotted_data.PeRunitAmount is null) and (source_data.PeRunitAmount is null))
        ) or snapshotted_data.Taxable != source_data.Taxable
        or
        (
            ((snapshotted_data.Taxable is null) and not (source_data.Taxable is null))
            or
            ((not snapshotted_data.Taxable is null) and (source_data.Taxable is null))
        ) or snapshotted_data.IsArchived != source_data.IsArchived
        or
        (
            ((snapshotted_data.IsArchived is null) and not (source_data.IsArchived is null))
            or
            ((not snapshotted_data.IsArchived is null) and (source_data.IsArchived is null))
        ) or snapshotted_data.BuyersPremiuMapplies != source_data.BuyersPremiuMapplies
        or
        (
            ((snapshotted_data.BuyersPremiuMapplies is null) and not (source_data.BuyersPremiuMapplies is null))
            or
            ((not snapshotted_data.BuyersPremiuMapplies is null) and (source_data.BuyersPremiuMapplies is null))
        ) or snapshotted_data.IsPayerArchived != source_data.IsPayerArchived
        or
        (
            ((snapshotted_data.IsPayerArchived is null) and not (source_data.IsPayerArchived is null))
            or
            ((not snapshotted_data.IsPayerArchived is null) and (source_data.IsPayerArchived is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LineItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_Incr__dbt_tmp_temp_view"
    end



    
21:53:49.611695 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:53:49.613409 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:49.613658 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:49.690004 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:49.692700 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:49.693078 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:49.968798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:53:49.972836 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:49.973123 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
21:53:50.016724 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:50.021074 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:50.021471 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:50.078391 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:50.079996 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:50.080266 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
21:53:51.064454 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
21:53:51.066115 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:51.066326 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:51.098910 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:51.101379 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:51.101621 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:51.347529 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:53:51.350812 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:51.351141 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr'
      and table_schema = 'stg'
  
21:53:51.387231 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:51.391723 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:51.392091 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:51.435845 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:51.438008 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:51.438367 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
    
21:53:51.657806 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.25 seconds
21:53:51.661449 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:51.661839 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:51.730930 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:51.732825 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:51.733162 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
21:53:52.360107 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
21:53:52.361842 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:52.362095 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:52.406346 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:52.408979 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:52.409259 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_KeyTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:52.611554 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:53:52.613729 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_KeyTable_Incr"
21:53:52.614428 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:52.614710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_KeyTable_Incr" (
                  "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "NextID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_KeyTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:52.703558 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:53:52.705354 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:52.705653 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:52.798017 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:52.801572 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:52.801902 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:53.094086 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:53:53.096986 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:53.097190 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
21:53:53.139157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:53.143589 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:53.143907 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:53.184360 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:53.186141 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:53.186361 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
21:53:54.168597 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.55 seconds
21:53:54.170233 [debug] [Thread-4  ]: On snapshot.Shawn.AH_KeyTable_Incr: COMMIT
21:53:54.170966 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_KeyTable_Incr".
21:53:54.171103 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_KeyTable_Incr: 
    
  if object_id ('"stg"."#AH_KeyTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_KeyTable_Incr__dbt_tmp"
    end

21:53:54.218930 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:53:54.231991 [debug] [Thread-4  ]: finished collecting timing info
21:53:54.232434 [debug] [Thread-4  ]: On snapshot.Shawn.AH_KeyTable_Incr: Close
21:53:54.233219 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0813fb50>]}
21:53:54.233761 [info ] [Thread-4  ]: 39 of 101 OK snapshotted stg.AH_KeyTable_Incr................................... [[32mOK[0m in 8.70s]
21:53:54.234166 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_KeyTable_Incr
21:53:54.234361 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingActionproperties_Incr
21:53:54.234795 [info ] [Thread-4  ]: 42 of 101 START snapshot stg.AH_ListingActionproperties_Incr.................... [RUN]
21:53:54.235270 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr"
21:53:54.235435 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingActionproperties_Incr
21:53:54.235574 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingActionproperties_Incr
21:53:54.238638 [debug] [Thread-4  ]: finished collecting timing info
21:53:54.238870 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingActionproperties_Incr
21:53:54.242011 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:53:54.242399 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:54.242626 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:53:54.242794 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:54.316516 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:53:54.318174 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:54.318409 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:54.356805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:54.359536 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:54.359828 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:54.363859 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:54.394732 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:53:54.417648 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:53:54.418033 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:54.450320 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:54.452620 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:53:54.452891 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]
        ) as __dbt_sbq
    
21:53:54.531000 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:53:54.552587 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:53:54.553014 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        ) as __dbt_sbq
    
21:53:54.634982 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:53:54.638298 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:54.638680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr'
      and table_schema = 'stg'
  
21:53:54.683726 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:54.688362 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:54.688699 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:54.709836 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:53:54.713934 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:53:54.714304 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
21:53:54.745747 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:53:54.747414 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:54.748204 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
    
21:53:54.800628 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:53:54.804154 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:53:54.804449 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActionproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111''), CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:54.435111'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingActionID != source_data.ListingActionID
        or
        (
            ((snapshotted_data.ListingActionID is null) and not (source_data.ListingActionID is null))
            or
            ((not snapshotted_data.ListingActionID is null) and (source_data.ListingActionID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActionproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActionproperties_Incr__dbt_tmp_temp_view"
    end



    
21:53:55.715995 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:53:55.717639 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:55.717834 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Languages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:53:55.755719 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:55.758095 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:55.758327 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Languages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:53:55.951892 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:53:55.954054 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Languages_Incr"
21:53:55.954518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:55.954872 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Languages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Languages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Languages_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Code", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Languages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:53:58.009048 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:53:58.010806 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Languages_Incr: COMMIT
21:53:58.012000 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Languages_Incr".
21:53:58.012159 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Languages_Incr: 
    
  if object_id ('"stg"."#AH_Languages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Languages_Incr__dbt_tmp"
    end

21:53:58.049444 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:53:58.061973 [debug] [Thread-2  ]: finished collecting timing info
21:53:58.062409 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Languages_Incr: Close
21:53:58.063232 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08212d30>]}
21:53:58.063771 [info ] [Thread-2  ]: 40 of 101 OK snapshotted stg.AH_Languages_Incr.................................. [[32mOK[0m in 12.11s]
21:53:58.064173 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Languages_Incr
21:53:58.064373 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingActions_Incr
21:53:58.064764 [info ] [Thread-2  ]: 43 of 101 START snapshot stg.AH_ListingActions_Incr............................. [RUN]
21:53:58.065263 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingActions_Incr"
21:53:58.065426 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingActions_Incr
21:53:58.065564 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingActions_Incr
21:53:58.068605 [debug] [Thread-2  ]: finished collecting timing info
21:53:58.068834 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingActions_Incr
21:53:58.071842 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:53:58.072054 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:53:58.072183 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:53:58.072324 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:53:58.188248 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:53:58.217227 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:58.239369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:53:58.239774 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:53:58.266387 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:53:58.268931 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:53:58.269277 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingActions_InterView]
        ) as __dbt_sbq
    
21:53:58.406732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:53:58.428696 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:53:58.429100 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        ) as __dbt_sbq
    
21:53:58.537224 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:53:58.541048 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:53:58.541426 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
21:53:58.610676 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:53:58.614985 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:53:58.615357 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingActions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736''), CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:53:58.247736'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Reason != source_data.Reason
        or
        (
            ((snapshotted_data.Reason is null) and not (source_data.Reason is null))
            or
            ((not snapshotted_data.Reason is null) and (source_data.Reason is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Actiondttm != source_data.Actiondttm
        or
        (
            ((snapshotted_data.Actiondttm is null) and not (source_data.Actiondttm is null))
            or
            ((not snapshotted_data.Actiondttm is null) and (source_data.Actiondttm is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.ProxyAmount != source_data.ProxyAmount
        or
        (
            ((snapshotted_data.ProxyAmount is null) and not (source_data.ProxyAmount is null))
            or
            ((not snapshotted_data.ProxyAmount is null) and (source_data.ProxyAmount is null))
        ) or snapshotted_data.Userentered != source_data.Userentered
        or
        (
            ((snapshotted_data.Userentered is null) and not (source_data.Userentered is null))
            or
            ((not snapshotted_data.Userentered is null) and (source_data.Userentered is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingActions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_Incr__dbt_tmp_temp_view"
    end



    
21:54:10.927930 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 21.48 seconds
21:54:10.932025 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:10.932263 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:10.975983 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:10.977669 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:10.977941 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
21:54:11.960257 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 17.16 seconds
21:54:11.963860 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:11.964083 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:12.031645 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:12.033124 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:12.033441 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:54:12.034656 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:12.034828 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:12.033601 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
21:54:12.109180 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:12.112326 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:12.112643 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:12.331625 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:54:12.334842 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:12.335125 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
21:54:12.413163 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:12.418012 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:12.418294 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:12.459594 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:12.461218 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:12.461469 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
21:54:13.242119 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:54:13.243723 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:13.243930 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:13.319456 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:13.322064 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:13.322270 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:13.574483 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:54:13.577400 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:13.577582 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
21:54:13.614761 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:13.618867 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:13.619173 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:13.683766 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:13.685322 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:13.685586 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
21:54:13.690161 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:54:13.691534 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:13.691736 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:13.725117 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:13.728211 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:13.728511 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:13.945975 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:54:13.949147 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:13.949350 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr'
      and table_schema = 'stg'
  
21:54:13.987723 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:13.992773 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:13.993088 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:14.028684 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:14.030325 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:14.030615 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
    
21:54:14.724350 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:54:14.725964 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:14.726144 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:15.005240 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:54:15.007928 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:15.008131 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:15.213293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:54:15.214946 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:15.215127 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:15.278268 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:54:15.281309 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:15.281680 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr'
      and table_schema = 'stg'
  
21:54:15.329218 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:54:15.332301 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:15.332568 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LineItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:15.361712 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:15.366328 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:15.366605 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:15.439002 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:15.440624 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:15.440884 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    
21:54:15.641016 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:54:15.643682 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LineItems_Incr"
21:54:15.644231 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:15.644414 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LineItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LineItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LineItems_Incr" (
                  "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Currency", "Status", "Type", "LotNumber", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "InvoiceID", "ListingID", "Quantity", "OwnerID", "PayerID", "ReListiteration", "AuctionEventID", "TotalAmount", "PeRunitAmount", "Taxable", "IsArchived", "BuyersPremiuMapplies", "IsPayerArchived", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LineItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:16.936704 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:54:16.938315 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:16.938611 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:16.978963 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:16.981954 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:16.982205 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActionproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:17.007187 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 18.39 seconds
21:54:17.012602 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:17.012932 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:17.050085 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:17.051748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:17.051993 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
21:54:17.194868 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:54:17.197246 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActionproperties_Incr"
21:54:17.197815 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:17.197997 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActionproperties_Incr" (
                  "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BoolnativeValue", "DecimalnativeValue", "CustomFieldID", "IntnativeValue", "ListingActionID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:17.740306 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.10 seconds
21:54:17.742026 [debug] [Thread-3  ]: On snapshot.Shawn.AH_LineItems_Incr: COMMIT
21:54:17.742821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LineItems_Incr".
21:54:17.742961 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_LineItems_Incr: 
    
  if object_id ('"stg"."#AH_LineItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LineItems_Incr__dbt_tmp"
    end

21:54:17.804718 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:17.816396 [debug] [Thread-3  ]: finished collecting timing info
21:54:17.816830 [debug] [Thread-3  ]: On snapshot.Shawn.AH_LineItems_Incr: Close
21:54:17.817594 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00f03520>]}
21:54:17.818106 [info ] [Thread-3  ]: 41 of 101 OK snapshotted stg.AH_LineItems_Incr.................................. [[32mOK[0m in 28.95s]
21:54:17.818507 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_LineItems_Incr
21:54:17.818742 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:54:17.819137 [info ] [Thread-3  ]: 44 of 101 START snapshot stg.AH_ListingCommentsMedias_Incr...................... [RUN]
21:54:17.819593 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
21:54:17.819751 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:54:17.819887 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:54:17.822785 [debug] [Thread-3  ]: finished collecting timing info
21:54:17.823008 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:54:17.826011 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:17.826204 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:17.826330 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:54:17.826471 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:17.935026 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:18.014117 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:54:18.036478 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:18.036855 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:18.070830 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:18.073476 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:18.073753 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]
        ) as __dbt_sbq
    
21:54:18.139997 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:18.161212 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:18.161473 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:54:18.162942 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:18.163167 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:18.161716 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        ) as __dbt_sbq
    
21:54:18.223779 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:18.225291 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 41.40 seconds
21:54:18.228239 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:18.230463 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:18.230333 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:18.230806 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
21:54:18.231702 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:18.233750 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:18.233933 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:18.270119 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:18.271817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:18.272091 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
21:54:18.300296 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:18.303840 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:18.304120 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingCommentsMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856''), CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:18.044856'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.CommentID != source_data.CommentID
        or
        (
            ((snapshotted_data.CommentID is null) and not (source_data.CommentID is null))
            or
            ((not snapshotted_data.CommentID is null) and (source_data.CommentID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_temp_view"
    end



    
21:54:18.497867 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:54:18.501238 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:18.501548 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
21:54:18.568324 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:18.572870 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:18.573206 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:18.631583 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:18.633133 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:18.633361 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
21:54:18.937203 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
21:54:18.938822 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: COMMIT
21:54:18.939539 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActionproperties_Incr".
21:54:18.939677 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActionproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingActionproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActionproperties_Incr__dbt_tmp"
    end

21:54:18.984728 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:18.996732 [debug] [Thread-4  ]: finished collecting timing info
21:54:18.997159 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingActionproperties_Incr: Close
21:54:18.997921 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00f852b0>]}
21:54:18.998472 [info ] [Thread-4  ]: 42 of 101 OK snapshotted stg.AH_ListingActionproperties_Incr.................... [[32mOK[0m in 24.76s]
21:54:18.998907 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingActionproperties_Incr
21:54:18.999102 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingComments_Incr
21:54:18.999475 [info ] [Thread-4  ]: 45 of 101 START snapshot stg.AH_ListingComments_Incr............................ [RUN]
21:54:18.999918 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingComments_Incr"
21:54:19.000078 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingComments_Incr
21:54:19.000214 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingComments_Incr
21:54:19.003056 [debug] [Thread-4  ]: finished collecting timing info
21:54:19.003264 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingComments_Incr
21:54:19.006054 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:19.006241 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:19.006370 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:54:19.006509 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:19.165326 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:19.203458 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:54:19.226065 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:19.226464 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:19.253513 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:19.256174 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:19.256548 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingComments_InterView]
        ) as __dbt_sbq
    
21:54:19.320052 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:19.341341 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:19.341741 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        ) as __dbt_sbq
    
21:54:19.568594 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:54:19.572376 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:19.572663 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
21:54:19.603246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:54:19.605171 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:19.605433 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:19.638200 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:19.640930 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:19.641207 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:19.644208 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:19.644411 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingComments_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingComments_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367''), CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:19.232367'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IsBID != source_data.IsBID
        or
        (
            ((snapshotted_data.IsBID is null) and not (source_data.IsBID is null))
            or
            ((not snapshotted_data.IsBID is null) and (source_data.IsBID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.ParentID != source_data.ParentID
        or
        (
            ((snapshotted_data.ParentID is null) and not (source_data.ParentID is null))
            or
            ((not snapshotted_data.ParentID is null) and (source_data.ParentID is null))
        ) or snapshotted_data.ReportCount != source_data.ReportCount
        or
        (
            ((snapshotted_data.ReportCount is null) and not (source_data.ReportCount is null))
            or
            ((not snapshotted_data.ReportCount is null) and (source_data.ReportCount is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingComments_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingComments_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingComments_Incr__dbt_tmp_temp_view"
    end



    
21:54:19.641407 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:19.753151 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:54:19.754890 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:19.755152 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:19.835928 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:19.840048 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:19.840361 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:19.882448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:54:19.885425 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:19.885705 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr'
      and table_schema = 'stg'
  
21:54:19.921384 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:19.926088 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:19.926400 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:19.970760 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:19.972419 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:19.972664 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
    
21:54:20.119882 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:54:20.122913 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:20.123199 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
21:54:20.198958 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:20.204186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:20.204532 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:20.267217 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:20.268990 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:20.269217 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
21:54:22.052045 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.08 seconds
21:54:22.053739 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:22.053975 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:22.092607 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:22.095639 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:22.095945 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:23.062953 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:54:23.065279 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingActions_Incr"
21:54:23.065759 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:23.065904 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingActions_Incr" (
                  "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Description", "LastUpdatedUser", "Reason", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Actiondttm", "Amount", "ProxyAmount", "Userentered", "UserID", "ListingID", "Quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingActions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:23.070768 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
21:54:23.071981 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:23.072154 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:23.213149 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:54:23.217018 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:23.217277 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:24.263844 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:54:24.266751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:24.266951 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr'
      and table_schema = 'stg'
  
21:54:24.305896 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:24.313471 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:24.313806 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:24.358698 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:24.360583 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:24.360835 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
    
21:54:25.680219 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.61 seconds
21:54:25.681831 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingActions_Incr: COMMIT
21:54:25.682509 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingActions_Incr".
21:54:25.682672 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingActions_Incr: 
    
  if object_id ('"stg"."#AH_ListingActions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingActions_Incr__dbt_tmp"
    end

21:54:25.720516 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:25.731243 [debug] [Thread-2  ]: finished collecting timing info
21:54:25.731602 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingActions_Incr: Close
21:54:25.732312 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00f66ca0>]}
21:54:25.732829 [info ] [Thread-2  ]: 43 of 101 OK snapshotted stg.AH_ListingActions_Incr............................. [[32mOK[0m in 27.67s]
21:54:25.733213 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingActions_Incr
21:54:25.733401 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:54:25.733775 [info ] [Thread-2  ]: 46 of 101 START snapshot stg.AH_ListingEnddttmAudit_Incr........................ [RUN]
21:54:25.734205 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
21:54:25.734362 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:54:25.734497 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:54:25.737237 [debug] [Thread-2  ]: finished collecting timing info
21:54:25.737433 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:54:25.740500 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:25.740686 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:25.740810 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:54:25.740946 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:25.803024 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
21:54:25.804706 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:25.804970 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:25.848182 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:25.852096 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:25.852364 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Invoices_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:25.856489 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:25.883970 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:54:25.906114 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:25.906447 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:25.937005 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:25.939224 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:25.939466 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]
        ) as __dbt_sbq
    
21:54:25.993543 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:26.014958 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:26.015311 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        ) as __dbt_sbq
    
21:54:26.112883 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:54:26.116791 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:26.117047 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
21:54:26.130619 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:54:26.133292 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Invoices_Incr"
21:54:26.133757 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:26.133916 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Invoices_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Invoices_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Invoices_Incr" (
                  "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Paiddttm", "CreatedOn", "UpdatedOn", "DeletedOn", "Createddttm", "Fulfilleddttm", "PropertybagID", "ShippingOptionID", "PayerID", "OwnerID", "AuctionEventID", "SalesTax", "BuyersPremiumPercent", "BuyersPremiumAmount", "ShippingAmount", "SubTotal", "Total", "IsPayerLocked", "Shipped", "IsArchived", "Status", "ShippingLastName", "BillingLastName", "OwnerName", "Shippingdetails", "OwnerCity", "OwnerStateregion", "OwnerzipPostal", "OwnerCountry", "ShippingFirstName", "BillingFirstName", "BillingCity", "BillingStateregion", "BillingzipPostal", "BillingCountry", "OwnerStreet1", "OwnerStreet2", "ShippingCity", "ShippingStateregion", "ShippingzipPostal", "ShippingCountry", "BillingStreet1", "BillingStreet2", "Comments", "LastUpdatedUser", "Currency", "Type", "ShippingStreet1", "ShippingStreet2", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Invoices_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:26.223709 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:54:26.227304 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:26.227587 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingEnddttmAudit_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973''), CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:25.919973'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.SourceListingID != source_data.SourceListingID
        or
        (
            ((snapshotted_data.SourceListingID is null) and not (source_data.SourceListingID is null))
            or
            ((not snapshotted_data.SourceListingID is null) and (source_data.SourceListingID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Origin != source_data.Origin
        or
        (
            ((snapshotted_data.Origin is null) and not (source_data.Origin is null))
            or
            ((not snapshotted_data.Origin is null) and (source_data.Origin is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_temp_view"
    end



    
21:54:27.759657 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 9.46 seconds
21:54:27.763360 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:27.763614 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:27.832208 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:27.833701 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:27.833924 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
21:54:28.245784 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.11 seconds
21:54:28.247607 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Invoices_Incr: COMMIT
21:54:28.248743 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Invoices_Incr".
21:54:28.248962 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Invoices_Incr: 
    
  if object_id ('"stg"."#AH_Invoices_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Invoices_Incr__dbt_tmp"
    end

21:54:28.329828 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:28.341416 [debug] [Thread-1  ]: finished collecting timing info
21:54:28.341763 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Invoices_Incr: Close
21:54:28.342469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00fbd700>]}
21:54:28.342994 [info ] [Thread-1  ]: 38 of 101 OK snapshotted stg.AH_Invoices_Incr................................... [[32mOK[0m in 52.17s]
21:54:28.343373 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Invoices_Incr
21:54:28.343564 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingLocations_Incr
21:54:28.343943 [info ] [Thread-1  ]: 47 of 101 START snapshot stg.AH_ListingLocations_Incr........................... [RUN]
21:54:28.344375 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingLocations_Incr"
21:54:28.344530 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingLocations_Incr
21:54:28.344664 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingLocations_Incr
21:54:28.347422 [debug] [Thread-1  ]: finished collecting timing info
21:54:28.347681 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingLocations_Incr
21:54:28.424640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:28.424988 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:28.425129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:54:28.425270 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:28.556915 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:28.591683 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:54:28.614400 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:28.614790 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:28.643332 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:28.645545 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:28.645797 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingLocations_InterView]
        ) as __dbt_sbq
    
21:54:28.705848 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:28.726798 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:28.727246 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        ) as __dbt_sbq
    
21:54:28.774681 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:28.779161 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:28.779444 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
21:54:28.851951 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:28.855822 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:28.856107 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingLocations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingLocations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137''), CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:28.623137'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LocationID != source_data.LocationID
        or
        (
            ((snapshotted_data.LocationID is null) and not (source_data.LocationID is null))
            or
            ((not snapshotted_data.LocationID is null) and (source_data.LocationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingLocations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingLocations_Incr__dbt_tmp_temp_view"
    end



    
21:54:29.033839 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
21:54:29.035555 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:29.035787 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:29.104911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:29.107453 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:29.107771 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:29.349340 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:54:29.352539 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:29.352777 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
21:54:29.401227 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:29.405557 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:29.405858 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:29.474873 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:29.476407 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:29.476673 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
21:54:30.612117 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:54:30.613843 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:30.614071 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:30.653237 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:30.655807 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:30.656004 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:30.879564 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:54:30.882728 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:30.883008 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr'
      and table_schema = 'stg'
  
21:54:30.931291 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:30.935878 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:30.936218 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:31.008447 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:31.010085 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:31.010371 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    
21:54:32.079362 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:54:32.080862 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:32.081057 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:32.115675 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:32.118143 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:32.118374 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingCommentsMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:32.369762 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:54:32.372034 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingCommentsMedias_Incr"
21:54:32.372507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:32.372640 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingCommentsMedias_Incr" (
                  "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UpdatedOn", "DeletedOn", "CreatedOn", "MediaID", "CommentID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:32.373372 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.15 seconds
21:54:32.376480 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:32.376704 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:32.429184 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:32.430809 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:32.431091 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
21:54:34.030720 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
21:54:34.032377 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:34.032577 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:34.055018 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 14.41 seconds
21:54:34.058680 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:34.059035 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:34.098660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:34.100290 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:34.100570 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
21:54:34.101658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:34.104241 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:34.104469 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:34.344089 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:54:34.346834 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:34.347076 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
21:54:34.413191 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:34.419074 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:34.419415 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:34.452619 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.08 seconds
21:54:34.454801 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: COMMIT
21:54:34.455681 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingCommentsMedias_Incr".
21:54:34.455884 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingCommentsMedias_Incr__dbt_tmp"
    end

21:54:34.463737 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:34.465245 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:34.465475 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
21:54:34.501189 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:34.512272 [debug] [Thread-3  ]: finished collecting timing info
21:54:34.512671 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingCommentsMedias_Incr: Close
21:54:34.513460 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0821e550>]}
21:54:34.513999 [info ] [Thread-3  ]: 44 of 101 OK snapshotted stg.AH_ListingCommentsMedias_Incr...................... [[32mOK[0m in 16.69s]
21:54:34.514395 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingCommentsMedias_Incr
21:54:34.514616 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingMedias_Incr
21:54:34.515018 [info ] [Thread-3  ]: 48 of 101 START snapshot stg.AH_ListingMedias_Incr.............................. [RUN]
21:54:34.515470 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingMedias_Incr"
21:54:34.515630 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingMedias_Incr
21:54:34.515765 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingMedias_Incr
21:54:34.518599 [debug] [Thread-3  ]: finished collecting timing info
21:54:34.518799 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingMedias_Incr
21:54:34.521950 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:34.522133 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:34.522262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:54:34.522401 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:34.638485 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:34.671044 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:54:34.693540 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:34.693941 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:34.722452 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:34.724749 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:34.725012 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingMedias_InterView]
        ) as __dbt_sbq
    
21:54:34.788911 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:34.809910 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:34.810303 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        ) as __dbt_sbq
    
21:54:34.855622 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.00 seconds
21:54:34.859335 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:34.859667 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:34.893928 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:34.897258 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:34.897515 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
21:54:34.902065 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:34.903607 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:34.903806 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
21:54:34.967875 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:34.971219 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:34.971526 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingMedias_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingMedias_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353''), CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:34.701353'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingMedias_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingMedias_Incr__dbt_tmp_temp_view"
    end



    
21:54:35.000482 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:54:35.002228 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:35.002478 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:35.077654 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:35.080449 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:35.080723 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:35.294803 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:54:35.296513 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:35.296759 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:35.355587 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:35.358465 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:35.358752 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:35.359356 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:54:35.361510 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:35.361696 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
21:54:35.397451 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:35.402113 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:35.402458 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:35.441179 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:35.443091 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:35.443339 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
21:54:35.586688 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:54:35.589560 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:35.589819 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr'
      and table_schema = 'stg'
  
21:54:35.624127 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:35.628823 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:35.629140 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:35.881021 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:54:35.882631 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:35.882847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    
21:54:35.918988 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
21:54:35.920732 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:35.921000 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:35.992809 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:35.995543 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:35.995895 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:36.318283 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:54:36.321454 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:36.321737 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
21:54:36.369373 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:36.373751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:36.374108 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:36.506985 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:54:36.508668 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:36.508921 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
21:54:36.910586 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:54:36.912245 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:36.912452 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:36.950359 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:36.953204 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:36.953505 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:37.049362 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
21:54:37.051164 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:37.051427 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:37.190078 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:54:37.192870 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:37.193195 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingEnddttmAudit_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:37.379893 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:54:37.382951 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:37.383283 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr'
      and table_schema = 'stg'
  
21:54:37.459986 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:37.467095 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:37.467480 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:37.493894 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:54:37.496530 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingEnddttmAudit_Incr"
21:54:37.497135 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:37.497329 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingEnddttmAudit_Incr" (
                  "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SqlDaTestamp", "Enddttm", "SourceListingID", "ListingID", "Origin", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:37.506091 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:37.507658 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:37.507897 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
    
21:54:38.304595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
21:54:38.306242 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:38.306428 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:38.402873 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:54:38.405425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:38.405644 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:38.596763 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:54:38.599744 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:38.599955 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr'
      and table_schema = 'stg'
  
21:54:39.036388 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
21:54:39.041038 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:39.041306 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:39.331024 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:54:39.332486 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:39.333200 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
    
21:54:39.555495 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:54:39.557241 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:39.557509 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:39.659781 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:54:39.662697 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:39.663023 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingComments_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:39.785268 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.29 seconds
21:54:39.787136 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: COMMIT
21:54:39.788659 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingEnddttmAudit_Incr".
21:54:39.788904 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: 
    
  if object_id ('"stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingEnddttmAudit_Incr__dbt_tmp"
    end

21:54:39.864917 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:39.876448 [debug] [Thread-2  ]: finished collecting timing info
21:54:39.876879 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingEnddttmAudit_Incr: Close
21:54:39.877666 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08051460>]}
21:54:39.878224 [info ] [Thread-2  ]: 46 of 101 OK snapshotted stg.AH_ListingEnddttmAudit_Incr........................ [[32mOK[0m in 14.14s]
21:54:39.878664 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingEnddttmAudit_Incr
21:54:39.878869 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:54:39.879257 [info ] [Thread-2  ]: 49 of 101 START snapshot stg.AH_ListingPaymentCharge_Incr....................... [RUN]
21:54:39.879713 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
21:54:39.879875 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:54:39.880016 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:54:39.882906 [debug] [Thread-2  ]: finished collecting timing info
21:54:39.883204 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:54:39.886239 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:39.886445 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:39.886633 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:54:39.886792 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:39.914757 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:54:39.917084 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingComments_Incr"
21:54:39.917692 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:39.918184 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingComments_Incr" (
                  "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IsBID", "Approved", "ParentID", "ReportCount", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Comment", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingComments_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:40.072347 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:40.183228 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:54:40.206237 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:40.206687 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:40.643065 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
21:54:40.645339 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:40.646019 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]
        ) as __dbt_sbq
    
21:54:40.714409 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:40.736687 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:40.737066 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        ) as __dbt_sbq
    
21:54:40.814694 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:54:40.816476 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:40.816740 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:40.817082 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:40.820553 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:40.820808 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
21:54:40.849756 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:40.852505 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:40.852844 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingLocations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:40.901178 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:40.904983 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:40.905349 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingPaymentCharge_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744''), CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:40.482744'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.ChargeAmount != source_data.ChargeAmount
        or
        (
            ((snapshotted_data.ChargeAmount is null) and not (source_data.ChargeAmount is null))
            or
            ((not snapshotted_data.ChargeAmount is null) and (source_data.ChargeAmount is null))
        ) or snapshotted_data.TotalBID != source_data.TotalBID
        or
        (
            ((snapshotted_data.TotalBID is null) and not (source_data.TotalBID is null))
            or
            ((not snapshotted_data.TotalBID is null) and (source_data.TotalBID is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_temp_view"
    end



    
21:54:41.224116 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:54:41.226407 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingLocations_Incr"
21:54:41.227105 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:41.227314 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingLocations_Incr" (
                  "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LocationID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingLocations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:42.358620 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
21:54:42.360351 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingComments_Incr: COMMIT
21:54:42.361205 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingComments_Incr".
21:54:42.361369 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingComments_Incr: 
    
  if object_id ('"stg"."#AH_ListingComments_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingComments_Incr__dbt_tmp"
    end

21:54:42.401123 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:42.413860 [debug] [Thread-4  ]: finished collecting timing info
21:54:42.414334 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingComments_Incr: Close
21:54:42.415271 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00f4c670>]}
21:54:42.415921 [info ] [Thread-4  ]: 45 of 101 OK snapshotted stg.AH_ListingComments_Incr............................ [[32mOK[0m in 23.42s]
21:54:42.416351 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingComments_Incr
21:54:42.416556 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_ListingQuestions_Incr
21:54:42.416972 [info ] [Thread-4  ]: 50 of 101 START snapshot stg.AH_ListingQuestions_Incr........................... [RUN]
21:54:42.417491 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr"
21:54:42.417663 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_ListingQuestions_Incr
21:54:42.417808 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_ListingQuestions_Incr
21:54:42.420978 [debug] [Thread-4  ]: finished collecting timing info
21:54:42.421234 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_ListingQuestions_Incr
21:54:42.424459 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:42.424698 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:42.424830 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:54:42.424970 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:42.561356 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:42.665579 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:54:42.688511 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:42.688923 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:42.832863 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:54:42.835545 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:42.835860 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingQuestions_InterView]
        ) as __dbt_sbq
    
21:54:42.887340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
21:54:42.889622 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingLocations_Incr: COMMIT
21:54:42.890643 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingLocations_Incr".
21:54:42.890877 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingLocations_Incr: 
    
  if object_id ('"stg"."#AH_ListingLocations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingLocations_Incr__dbt_tmp"
    end

21:54:42.898440 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:42.919864 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:42.920291 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        ) as __dbt_sbq
    
21:54:42.949122 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:42.961444 [debug] [Thread-1  ]: finished collecting timing info
21:54:42.961910 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingLocations_Incr: Close
21:54:42.962790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00ccf880>]}
21:54:42.963338 [info ] [Thread-1  ]: 47 of 101 OK snapshotted stg.AH_ListingLocations_Incr........................... [[32mOK[0m in 14.62s]
21:54:42.963748 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingLocations_Incr
21:54:42.963956 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:54:42.964428 [info ] [Thread-1  ]: 51 of 101 START snapshot stg.AH_ListingTypeFeeprovIDErs_Incr.................... [RUN]
21:54:42.964945 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
21:54:42.965111 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:54:42.965255 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:54:42.968405 [debug] [Thread-1  ]: finished collecting timing info
21:54:42.968642 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:54:42.971930 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:42.972178 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:42.972315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:54:42.972463 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:43.096780 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:43.250459 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:54:43.254049 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:43.254389 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
21:54:43.320868 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:43.324315 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:43.324669 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingQuestions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480''), CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:42.701480'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Question != source_data.Question
        or
        (
            ((snapshotted_data.Question is null) and not (source_data.Question is null))
            or
            ((not snapshotted_data.Question is null) and (source_data.Question is null))
        ) or snapshotted_data.Answer != source_data.Answer
        or
        (
            ((snapshotted_data.Answer is null) and not (source_data.Answer is null))
            or
            ((not snapshotted_data.Answer is null) and (source_data.Answer is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingQuestions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingQuestions_Incr__dbt_tmp_temp_view"
    end



    
21:54:43.344682 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:54:43.366919 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:43.367308 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:43.400360 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:43.402613 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:43.402969 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]
        ) as __dbt_sbq
    
21:54:43.461503 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:43.482678 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:43.483082 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        ) as __dbt_sbq
    
21:54:43.559577 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:43.563576 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:43.563932 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
21:54:43.673839 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:54:43.677475 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:43.677830 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeFeeprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362''), CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:43.373362'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ProvIDErName != source_data.ProvIDErName
        or
        (
            ((snapshotted_data.ProvIDErName is null) and not (source_data.ProvIDErName is null))
            or
            ((not snapshotted_data.ProvIDErName is null) and (source_data.ProvIDErName is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
21:54:47.162790 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 12.19 seconds
21:54:47.166456 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:47.166707 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:47.209162 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:47.210931 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:47.211239 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
21:54:48.114284 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:54:48.115951 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:48.116152 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:48.217714 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:54:48.220302 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:48.220496 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:48.437937 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:54:48.441064 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:48.441289 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
21:54:48.531719 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:54:48.536455 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:48.536791 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:48.585365 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:48.587062 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:48.587318 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
21:54:48.969270 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.06 seconds
21:54:48.972560 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:48.972779 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:49.009311 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:49.010988 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:49.011249 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
21:54:49.708039 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:54:49.709585 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:49.709754 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:49.743128 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:49.746040 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:49.746332 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:49.925252 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:54:49.927038 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:49.927302 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:49.955458 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:54:49.958567 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:49.958887 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr'
      and table_schema = 'stg'
  
21:54:49.961598 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.28 seconds
21:54:49.966917 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:49.967325 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:50.006282 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:50.010720 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:50.011062 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:50.021630 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:54:50.024394 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:50.024666 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:50.033645 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:50.035192 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:50.035430 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
21:54:50.048771 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:50.050344 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:50.050607 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
    
21:54:50.482718 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.46 seconds
21:54:50.485723 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:50.486091 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
21:54:50.523821 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:50.528380 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:50.528748 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:50.576851 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:50.578799 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:50.579127 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
21:54:51.508218 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:54:51.510009 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:51.510304 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:51.576931 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:51.579498 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:51.579803 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:51.581312 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.26 seconds
21:54:51.584437 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:51.584695 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:51.627125 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:51.628724 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:51.628967 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
21:54:51.701595 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:54:51.703390 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:51.703658 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:51.745777 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.69 seconds
21:54:51.747512 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:51.747752 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:51.758767 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:51.761501 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:51.761785 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:51.782116 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:51.784792 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:51.785062 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingMedias_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:51.845423 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:54:51.848438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:51.848721 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
21:54:51.884069 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:51.888426 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:51.888758 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:51.949310 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:51.950881 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:51.951122 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
21:54:51.966830 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:54:51.969609 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:51.969907 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr'
      and table_schema = 'stg'
  
21:54:52.010056 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:52.015260 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:52.015516 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:54:52.018046 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingMedias_Incr"
21:54:52.018653 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:52.018832 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingMedias_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaID", "ListingID", "DisplayOrder", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingMedias_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:52.015771 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:52.056958 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:52.058733 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:52.059017 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    
21:54:52.600750 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:54:52.602327 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:52.602509 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:52.668383 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:52.671072 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:52.671338 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:52.910670 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:54:52.913537 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:52.913754 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
21:54:52.948068 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:52.954981 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:52.955339 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:52.993016 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:52.994709 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:52.994958 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
21:54:53.002169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:54:53.003752 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:53.003977 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:53.062690 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:53.065367 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:53.065692 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:53.088694 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:54:53.090460 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:53.090745 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:53.123988 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:53.126639 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:53.126934 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:53.295241 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:54:53.298610 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:53.298924 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr'
      and table_schema = 'stg'
  
21:54:53.347674 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:53.352015 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:53.352299 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:53.375185 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:54:53.377519 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingPaymentCharge_Incr"
21:54:53.378146 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:53.378342 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingPaymentCharge_Incr" (
                  "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BuyerID", "ListingID", "UpdatedOn", "CreatedOn", "TransactionID", "ChargeAmount", "TotalBID", "BidHoldPercentage", "MaximumBidCharge", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:53.393662 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:53.395256 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:53.395498 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    
21:54:53.517793 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:54:53.519468 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingMedias_Incr: COMMIT
21:54:53.520282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingMedias_Incr".
21:54:53.520491 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingMedias_Incr: 
    
  if object_id ('"stg"."#AH_ListingMedias_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingMedias_Incr__dbt_tmp"
    end

21:54:53.565145 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:53.576941 [debug] [Thread-3  ]: finished collecting timing info
21:54:53.577362 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingMedias_Incr: Close
21:54:53.578143 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0821e940>]}
21:54:53.578695 [info ] [Thread-3  ]: 48 of 101 OK snapshotted stg.AH_ListingMedias_Incr.............................. [[32mOK[0m in 19.06s]
21:54:53.579095 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingMedias_Incr
21:54:53.579291 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:54:53.579667 [info ] [Thread-3  ]: 52 of 101 START snapshot stg.AH_ListingTypeMedia_Incr........................... [RUN]
21:54:53.580110 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr"
21:54:53.580269 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:54:53.580404 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ListingTypeMedia_Incr
21:54:53.583229 [debug] [Thread-3  ]: finished collecting timing info
21:54:53.583499 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:54:53.586845 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:54:53.587031 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:53.587160 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:54:53.587294 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:53.760339 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:53.788442 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:54:53.811702 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:54:53.812092 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:53.838407 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:53.840719 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:54:53.841322 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]
        ) as __dbt_sbq
    
21:54:53.913264 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:53.935012 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:54:53.935418 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        ) as __dbt_sbq
    
21:54:53.979409 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:53.983158 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:54:53.983506 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
21:54:54.034424 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:54:54.036800 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:54.037050 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:54.062951 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:54:54.066508 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:54:54.066847 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeMedia_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663''), CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:53.826663'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetName != source_data.MediaassetName
        or
        (
            ((snapshotted_data.MediaassetName is null) and not (source_data.MediaassetName is null))
            or
            ((not snapshotted_data.MediaassetName is null) and (source_data.MediaassetName is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeMedia_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_temp_view"
    end



    
21:54:54.081903 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:54.084482 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:54.084760 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:54.346245 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:54:54.348010 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:54.348256 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:54.382703 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:54.385719 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:54.386008 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:54.497344 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
21:54:54.500464 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:54.500761 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr'
      and table_schema = 'stg'
  
21:54:54.542644 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:54.547592 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:54.547952 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:54.583132 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:54.584743 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:54.584987 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    
21:54:54.737178 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.35 seconds
21:54:54.739517 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr"
21:54:54.740158 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:54.740388 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeFeeprovIDErs_Incr" (
                  "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ProvIDErName", "CreatedOn", "UpdatedOn", "DeletedOn", "ListingTypeID", "Enabled", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:54.757905 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
21:54:54.759629 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: COMMIT
21:54:54.760738 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingPaymentCharge_Incr".
21:54:54.760936 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: 
    
  if object_id ('"stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingPaymentCharge_Incr__dbt_tmp"
    end

21:54:55.048426 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:54:55.061018 [debug] [Thread-2  ]: finished collecting timing info
21:54:55.061450 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingPaymentCharge_Incr: Close
21:54:55.062295 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0821ebe0>]}
21:54:55.062854 [info ] [Thread-2  ]: 49 of 101 OK snapshotted stg.AH_ListingPaymentCharge_Incr....................... [[32mOK[0m in 15.18s]
21:54:55.063265 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingPaymentCharge_Incr
21:54:55.063465 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:54:55.063873 [info ] [Thread-2  ]: 53 of 101 START snapshot stg.AH_ListingTypeproperties_Incr...................... [RUN]
21:54:55.064342 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr"
21:54:55.064507 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:54:55.064649 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ListingTypeproperties_Incr
21:54:55.067676 [debug] [Thread-2  ]: finished collecting timing info
21:54:55.067901 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:54:55.070968 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:54:55.071175 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:55.071304 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:54:55.071447 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:55.170289 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:55.225332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:54:55.247876 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:54:55.248271 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:55.276017 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:55.278665 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:54:55.278967 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]
        ) as __dbt_sbq
    
21:54:55.340487 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:55.362109 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:54:55.362511 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        ) as __dbt_sbq
    
21:54:55.425292 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:55.429165 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:54:55.429503 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
21:54:55.497579 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:55.501704 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:54:55.502031 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypeproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233''), CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:55.264233'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Scope != source_data.Scope
        or
        (
            ((snapshotted_data.Scope is null) and not (source_data.Scope is null))
            or
            ((not snapshotted_data.Scope is null) and (source_data.Scope is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypeproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_temp_view"
    end



    
21:54:56.089082 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.50 seconds
21:54:56.090658 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:56.090836 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:54:56.130434 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:56.133042 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:56.133238 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingQuestions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:54:56.255157 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:54:56.256834 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: COMMIT
21:54:56.257595 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr".
21:54:56.257743 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeFeeprovIDErs_Incr__dbt_tmp"
    end

21:54:56.319104 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:56.332303 [debug] [Thread-1  ]: finished collecting timing info
21:54:56.332708 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr: Close
21:54:56.333457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0821ed30>]}
21:54:56.333971 [info ] [Thread-1  ]: 51 of 101 OK snapshotted stg.AH_ListingTypeFeeprovIDErs_Incr.................... [[32mOK[0m in 13.37s]
21:54:56.334373 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingTypeFeeprovIDErs_Incr
21:54:56.334600 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingTypes_Incr
21:54:56.334999 [info ] [Thread-1  ]: 54 of 101 START snapshot stg.AH_ListingTypes_Incr............................... [RUN]
21:54:56.335467 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingTypes_Incr"
21:54:56.335628 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingTypes_Incr
21:54:56.335763 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingTypes_Incr
21:54:56.338633 [debug] [Thread-1  ]: finished collecting timing info
21:54:56.338834 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingTypes_Incr
21:54:56.341750 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:54:56.341892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:54:56.343624 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingQuestions_Incr"
21:54:56.344048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:56.344201 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingQuestions_Incr" (
                  "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "UserName", "Question", "Answer", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingQuestions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:54:56.342045 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:56.344475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:54:56.344813 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:56.446577 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:56.476630 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:54:56.498436 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:54:56.498825 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:56.526754 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:54:56.529303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:54:56.529572 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingTypes_InterView]
        ) as __dbt_sbq
    
21:54:56.627385 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:54:56.648723 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:54:56.649045 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        ) as __dbt_sbq
    
21:54:56.696688 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:56.700296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:54:56.700601 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
21:54:56.788306 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:54:56.792263 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:54:56.792572 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingTypes_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingTypes_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254''), CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:56.514254'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingTypes_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingTypes_Incr__dbt_tmp_temp_view"
    end



    
21:54:57.950443 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:54:57.952201 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: COMMIT
21:54:57.952961 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingQuestions_Incr".
21:54:57.953093 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingQuestions_Incr: 
    
  if object_id ('"stg"."#AH_ListingQuestions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingQuestions_Incr__dbt_tmp"
    end

21:54:57.991009 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:58.003094 [debug] [Thread-4  ]: finished collecting timing info
21:54:58.003459 [debug] [Thread-4  ]: On snapshot.Shawn.AH_ListingQuestions_Incr: Close
21:54:58.004186 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc0821ea90>]}
21:54:58.004691 [info ] [Thread-4  ]: 50 of 101 OK snapshotted stg.AH_ListingQuestions_Incr........................... [[32mOK[0m in 15.59s]
21:54:58.005089 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_ListingQuestions_Incr
21:54:58.005280 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Listingdecorations_Incr
21:54:58.005653 [info ] [Thread-4  ]: 55 of 101 START snapshot stg.AH_Listingdecorations_Incr......................... [RUN]
21:54:58.006077 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr"
21:54:58.006237 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Listingdecorations_Incr
21:54:58.006372 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Listingdecorations_Incr
21:54:58.009089 [debug] [Thread-4  ]: finished collecting timing info
21:54:58.009287 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Listingdecorations_Incr
21:54:58.012087 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:54:58.012270 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:54:58.012397 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:54:58.012535 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:54:58.117852 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:54:58.153381 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:54:58.174932 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:54:58.175299 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:54:58.216027 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:54:58.218597 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:54:58.218833 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingdecorations_InterView]
        ) as __dbt_sbq
    
21:54:58.278379 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:54:58.299453 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:54:58.299817 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        ) as __dbt_sbq
    
21:54:58.345750 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:54:58.349781 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:54:58.350052 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
21:54:58.416691 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:54:58.420559 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:54:58.420849 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingdecorations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112''), CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:54:58.186112'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DecorationID != source_data.DecorationID
        or
        (
            ((snapshotted_data.DecorationID is null) and not (source_data.DecorationID is null))
            or
            ((not snapshotted_data.DecorationID is null) and (source_data.DecorationID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingdecorations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingdecorations_Incr__dbt_tmp_temp_view"
    end



    
21:55:00.661764 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.59 seconds
21:55:00.665289 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:00.665490 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:00.702197 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:00.703866 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:00.704124 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
21:55:01.935358 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:55:01.936949 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:01.937147 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:02.019568 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:55:02.021947 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:02.022149 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:02.274641 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:55:02.277702 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:02.277940 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
21:55:02.315449 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.52 seconds
21:55:02.319194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:02.319514 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:02.335474 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:02.340717 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:02.341053 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:02.364457 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:02.365998 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:02.366225 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
21:55:02.382778 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:02.384350 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:02.384616 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
21:55:04.064726 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.64 seconds
21:55:04.155173 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.77 seconds
21:55:04.155548 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
21:55:04.158064 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:04.158250 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:04.156923 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:04.158626 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:04.159993 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:04.160174 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:04.214883 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:04.217365 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:04.217731 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:04.217622 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:04.218816 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:04.218990 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
21:55:04.236756 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:55:04.239439 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:04.239740 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:04.435953 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:55:04.439234 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:04.439530 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr'
      and table_schema = 'stg'
  
21:55:04.467536 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:55:04.470679 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:04.470989 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
21:55:04.498825 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:04.503104 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:04.503432 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:04.511366 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:04.515325 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:04.515653 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:04.540951 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:04.542619 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:04.542872 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    
21:55:04.565094 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:04.566703 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:04.566949 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
21:55:05.211574 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.99 seconds
21:55:05.213113 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:05.213280 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:05.282362 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:05.284906 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:05.285101 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:05.482887 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:55:05.485841 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:05.486074 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
21:55:05.522593 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:05.526888 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:05.527185 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:05.563602 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:05.565138 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:05.565389 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
21:55:05.664206 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
21:55:05.665846 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:05.666079 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:05.710722 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:05.713718 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:05.714056 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeMedia_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:05.730788 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.16 seconds
21:55:05.732492 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:05.732719 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:05.768551 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:05.771058 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:05.771335 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:05.932811 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:55:05.934944 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeMedia_Incr"
21:55:05.935511 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:05.935684 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeMedia_Incr" (
                  "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "ListingTypeID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetName", "Scope", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:06.026360 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:55:06.029627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:06.029906 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr'
      and table_schema = 'stg'
  
21:55:06.061949 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:06.066349 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:06.066690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:06.103415 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:06.105061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:06.105299 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
    
21:55:06.442117 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:55:06.443749 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:06.443978 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:06.477674 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:06.480206 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:06.480511 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:06.553131 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 11.05 seconds
21:55:06.556859 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:06.557141 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:06.599067 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:06.600721 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:06.600997 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
21:55:06.710113 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:55:06.714989 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:06.715333 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr'
      and table_schema = 'stg'
  
21:55:06.747728 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:06.752194 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:06.752533 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:06.789823 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:06.791400 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:06.791624 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    
21:55:07.121825 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
21:55:07.123497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:07.123690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:07.166347 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:07.168925 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:07.169170 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypes_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:07.448704 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:55:07.450485 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: COMMIT
21:55:07.451385 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeMedia_Incr".
21:55:07.451586 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeMedia_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeMedia_Incr__dbt_tmp"
    end

21:55:07.487970 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:07.489739 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:55:07.491816 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypes_Incr"
21:55:07.502585 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:07.502817 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypes_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypes_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:07.501919 [debug] [Thread-3  ]: finished collecting timing info
21:55:07.503195 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ListingTypeMedia_Incr: Close
21:55:07.503894 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00d2ef40>]}
21:55:07.504392 [info ] [Thread-3  ]: 52 of 101 OK snapshotted stg.AH_ListingTypeMedia_Incr........................... [[32mOK[0m in 13.92s]
21:55:07.504768 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ListingTypeMedia_Incr
21:55:07.504958 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Listingproperties_Incr
21:55:07.505336 [info ] [Thread-3  ]: 56 of 101 START snapshot stg.AH_Listingproperties_Incr.......................... [RUN]
21:55:07.505783 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listingproperties_Incr"
21:55:07.505939 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Listingproperties_Incr
21:55:07.506075 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Listingproperties_Incr
21:55:07.508887 [debug] [Thread-3  ]: finished collecting timing info
21:55:07.509087 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Listingproperties_Incr
21:55:07.512333 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:07.512518 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:07.512646 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:55:07.512785 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:07.630172 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:07.659788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:55:07.681507 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:07.681913 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:07.696920 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:55:07.698638 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:07.698921 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:07.717937 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:07.720622 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:07.720914 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listingproperties_InterView]
        ) as __dbt_sbq
    
21:55:07.783440 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:07.797527 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:07.800123 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:07.800429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:07.808218 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:07.809102 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        ) as __dbt_sbq
    
21:55:07.854256 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:55:07.856058 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:07.856328 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:07.902333 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:07.904978 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:07.905376 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:07.908721 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:07.905503 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingdecorations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:07.908968 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
21:55:08.024677 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:55:08.028642 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:08.028997 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listingproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listingproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273''), CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:07.686273'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listingproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listingproperties_Incr__dbt_tmp_temp_view"
    end



    
21:55:08.036615 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:55:08.039404 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:08.039643 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
21:55:08.192344 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:55:08.196969 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:08.197342 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:08.239009 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:08.240654 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:08.240892 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
21:55:08.748734 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.84 seconds
21:55:08.750845 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingdecorations_Incr"
21:55:08.751409 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:08.751583 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingdecorations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DecorationID", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingdecorations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:08.755592 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
21:55:08.757075 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypes_Incr: COMMIT
21:55:08.758226 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypes_Incr".
21:55:08.758413 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypes_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypes_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypes_Incr__dbt_tmp"
    end

21:55:08.798238 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:08.811111 [debug] [Thread-1  ]: finished collecting timing info
21:55:08.811498 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingTypes_Incr: Close
21:55:08.812272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c42b0>]}
21:55:08.812791 [info ] [Thread-1  ]: 54 of 101 OK snapshotted stg.AH_ListingTypes_Incr............................... [[32mOK[0m in 12.48s]
21:55:08.813183 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingTypes_Incr
21:55:08.813379 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:55:08.813773 [info ] [Thread-1  ]: 57 of 101 START snapshot stg.AH_ListingsReserveHistory_Incr..................... [RUN]
21:55:08.814231 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
21:55:08.814391 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:55:08.814528 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:55:08.817485 [debug] [Thread-1  ]: finished collecting timing info
21:55:08.817691 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:55:08.820628 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:08.820812 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:08.820960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:55:08.821105 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:08.935585 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:08.994058 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:55:09.015921 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:09.016313 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:09.045520 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:09.048138 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:09.048453 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]
        ) as __dbt_sbq
    
21:55:09.093261 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:55:09.094944 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:09.095192 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:09.100641 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:09.121952 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:09.122360 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        ) as __dbt_sbq
    
21:55:09.127518 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:09.130093 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:09.130373 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:09.185082 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:09.188778 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:09.189104 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
21:55:09.282915 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:55:09.286516 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:09.286939 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ListingsReserveHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043''), CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:09.030043'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.OldReserve != source_data.OldReserve
        or
        (
            ((snapshotted_data.OldReserve is null) and not (source_data.OldReserve is null))
            or
            ((not snapshotted_data.OldReserve is null) and (source_data.OldReserve is null))
        ) or snapshotted_data.NewReserve != source_data.NewReserve
        or
        (
            ((snapshotted_data.NewReserve is null) and not (source_data.NewReserve is null))
            or
            ((not snapshotted_data.NewReserve is null) and (source_data.NewReserve is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_temp_view"
    end



    
21:55:09.338077 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:55:09.341572 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:09.341878 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr'
      and table_schema = 'stg'
  
21:55:09.667214 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:55:09.672044 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:09.672402 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:10.159488 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:55:10.161090 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:10.161282 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    
21:55:10.703141 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.95 seconds
21:55:10.704749 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: COMMIT
21:55:10.705449 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingdecorations_Incr".
21:55:10.705580 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingdecorations_Incr: 
    
  if object_id ('"stg"."#AH_Listingdecorations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingdecorations_Incr__dbt_tmp"
    end

21:55:10.837993 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:55:10.849885 [debug] [Thread-4  ]: finished collecting timing info
21:55:10.850307 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Listingdecorations_Incr: Close
21:55:10.851137 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4160>]}
21:55:10.851681 [info ] [Thread-4  ]: 55 of 101 OK snapshotted stg.AH_Listingdecorations_Incr......................... [[32mOK[0m in 12.85s]
21:55:10.852081 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Listingdecorations_Incr
21:55:10.852276 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Listings_Incr
21:55:10.852654 [info ] [Thread-4  ]: 58 of 101 START snapshot stg.AH_Listings_Incr................................... [RUN]
21:55:10.853102 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Listings_Incr"
21:55:10.853267 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Listings_Incr
21:55:10.853407 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Listings_Incr
21:55:10.856363 [debug] [Thread-4  ]: finished collecting timing info
21:55:10.856583 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Listings_Incr
21:55:10.859576 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:10.859782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:10.859910 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:55:10.860052 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:10.959351 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:10.994144 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:55:11.016499 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:11.016891 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:11.060751 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:11.063347 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:11.063655 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Listings_InterView]
        ) as __dbt_sbq
    
21:55:11.142381 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:55:11.164882 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:11.165286 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        ) as __dbt_sbq
    
21:55:11.239280 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:55:11.241020 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:11.241284 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:11.277426 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:11.280274 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:11.280540 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingTypeproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:11.564112 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:55:11.568905 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:11.569226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
21:55:11.636545 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:11.640540 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:11.640895 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Listings_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075''), CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:11.030075'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.PrimaryImageURI != source_data.PrimaryImageURI
        or
        (
            ((snapshotted_data.PrimaryImageURI is null) and not (source_data.PrimaryImageURI is null))
            or
            ((not snapshotted_data.PrimaryImageURI is null) and (source_data.PrimaryImageURI is null))
        ) or snapshotted_data.OwnerUserName != source_data.OwnerUserName
        or
        (
            ((snapshotted_data.OwnerUserName is null) and not (source_data.OwnerUserName is null))
            or
            ((not snapshotted_data.OwnerUserName is null) and (source_data.OwnerUserName is null))
        ) or snapshotted_data.CurrentListingActionUserName != source_data.CurrentListingActionUserName
        or
        (
            ((snapshotted_data.CurrentListingActionUserName is null) and not (source_data.CurrentListingActionUserName is null))
            or
            ((not snapshotted_data.CurrentListingActionUserName is null) and (source_data.CurrentListingActionUserName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.SubTitle != source_data.SubTitle
        or
        (
            ((snapshotted_data.SubTitle is null) and not (source_data.SubTitle is null))
            or
            ((not snapshotted_data.SubTitle is null) and (source_data.SubTitle is null))
        ) or snapshotted_data.Location != source_data.Location
        or
        (
            ((snapshotted_data.Location is null) and not (source_data.Location is null))
            or
            ((not snapshotted_data.Location is null) and (source_data.Location is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enddttm != source_data.Enddttm
        or
        (
            ((snapshotted_data.Enddttm is null) and not (source_data.Enddttm is null))
            or
            ((not snapshotted_data.Enddttm is null) and (source_data.Enddttm is null))
        ) or snapshotted_data.Startdttm != source_data.Startdttm
        or
        (
            ((snapshotted_data.Startdttm is null) and not (source_data.Startdttm is null))
            or
            ((not snapshotted_data.Startdttm is null) and (source_data.Startdttm is null))
        ) or snapshotted_data.AutoreListrEMAining != source_data.AutoreListrEMAining
        or
        (
            ((snapshotted_data.AutoreListrEMAining is null) and not (source_data.AutoreListrEMAining is null))
            or
            ((not snapshotted_data.AutoreListrEMAining is null) and (source_data.AutoreListrEMAining is null))
        ) or snapshotted_data.CurrentQuantity != source_data.CurrentQuantity
        or
        (
            ((snapshotted_data.CurrentQuantity is null) and not (source_data.CurrentQuantity is null))
            or
            ((not snapshotted_data.CurrentQuantity is null) and (source_data.CurrentQuantity is null))
        ) or snapshotted_data.OriginalQuantity != source_data.OriginalQuantity
        or
        (
            ((snapshotted_data.OriginalQuantity is null) and not (source_data.OriginalQuantity is null))
            or
            ((not snapshotted_data.OriginalQuantity is null) and (source_data.OriginalQuantity is null))
        ) or snapshotted_data.ReListiteration != source_data.ReListiteration
        or
        (
            ((snapshotted_data.ReListiteration is null) and not (source_data.ReListiteration is null))
            or
            ((not snapshotted_data.ReListiteration is null) and (source_data.ReListiteration is null))
        ) or snapshotted_data.LotID != source_data.LotID
        or
        (
            ((snapshotted_data.LotID is null) and not (source_data.LotID is null))
            or
            ((not snapshotted_data.LotID is null) and (source_data.LotID is null))
        ) or snapshotted_data.AcceptedActionCount != source_data.AcceptedActionCount
        or
        (
            ((snapshotted_data.AcceptedActionCount is null) and not (source_data.AcceptedActionCount is null))
            or
            ((not snapshotted_data.AcceptedActionCount is null) and (source_data.AcceptedActionCount is null))
        ) or snapshotted_data.OwnerID != source_data.OwnerID
        or
        (
            ((snapshotted_data.OwnerID is null) and not (source_data.OwnerID is null))
            or
            ((not snapshotted_data.OwnerID is null) and (source_data.OwnerID is null))
        ) or snapshotted_data.ListingTypeID != source_data.ListingTypeID
        or
        (
            ((snapshotted_data.ListingTypeID is null) and not (source_data.ListingTypeID is null))
            or
            ((not snapshotted_data.ListingTypeID is null) and (source_data.ListingTypeID is null))
        ) or snapshotted_data.Duration != source_data.Duration
        or
        (
            ((snapshotted_data.Duration is null) and not (source_data.Duration is null))
            or
            ((not snapshotted_data.Duration is null) and (source_data.Duration is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.CurrencyID != source_data.CurrencyID
        or
        (
            ((snapshotted_data.CurrencyID is null) and not (source_data.CurrencyID is null))
            or
            ((not snapshotted_data.CurrencyID is null) and (source_data.CurrencyID is null))
        ) or snapshotted_data.PrimaryCategoryID != source_data.PrimaryCategoryID
        or
        (
            ((snapshotted_data.PrimaryCategoryID is null) and not (source_data.PrimaryCategoryID is null))
            or
            ((not snapshotted_data.PrimaryCategoryID is null) and (source_data.PrimaryCategoryID is null))
        ) or snapshotted_data.CurrentListingActionID != source_data.CurrentListingActionID
        or
        (
            ((snapshotted_data.CurrentListingActionID is null) and not (source_data.CurrentListingActionID is null))
            or
            ((not snapshotted_data.CurrentListingActionID is null) and (source_data.CurrentListingActionID is null))
        ) or snapshotted_data.OfferCount != source_data.OfferCount
        or
        (
            ((snapshotted_data.OfferCount is null) and not (source_data.OfferCount is null))
            or
            ((not snapshotted_data.OfferCount is null) and (source_data.OfferCount is null))
        ) or snapshotted_data.OriginalreListCount != source_data.OriginalreListCount
        or
        (
            ((snapshotted_data.OriginalreListCount is null) and not (source_data.OriginalreListCount is null))
            or
            ((not snapshotted_data.OriginalreListCount is null) and (source_data.OriginalreListCount is null))
        ) or snapshotted_data.Hits != source_data.Hits
        or
        (
            ((snapshotted_data.Hits is null) and not (source_data.Hits is null))
            or
            ((not snapshotted_data.Hits is null) and (source_data.Hits is null))
        ) or snapshotted_data.CurrentPrice != source_data.CurrentPrice
        or
        (
            ((snapshotted_data.CurrentPrice is null) and not (source_data.CurrentPrice is null))
            or
            ((not snapshotted_data.CurrentPrice is null) and (source_data.CurrentPrice is null))
        ) or snapshotted_data.Increment != source_data.Increment
        or
        (
            ((snapshotted_data.Increment is null) and not (source_data.Increment is null))
            or
            ((not snapshotted_data.Increment is null) and (source_data.Increment is null))
        ) or snapshotted_data.OriginalPrice != source_data.OriginalPrice
        or
        (
            ((snapshotted_data.OriginalPrice is null) and not (source_data.OriginalPrice is null))
            or
            ((not snapshotted_data.OriginalPrice is null) and (source_data.OriginalPrice is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Listings_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_Incr__dbt_tmp_temp_view"
    end



    
21:55:11.930672 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.65 seconds
21:55:11.933031 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingTypeproperties_Incr"
21:55:11.933544 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:11.933712 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingTypeproperties_Incr" (
                  "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "Scope", "DecimalnativeValue", "DeletedOn", "DateTimenativeValue", "CreatedOn", "UpdatedOn", "IntnativeValue", "CustomFieldID", "ListingTypeID", "BoolnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:14.007032 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.07 seconds
21:55:14.008756 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: COMMIT
21:55:14.009935 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingTypeproperties_Incr".
21:55:14.010098 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingTypeproperties_Incr: 
    
  if object_id ('"stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingTypeproperties_Incr__dbt_tmp"
    end

21:55:14.057256 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:14.069850 [debug] [Thread-2  ]: finished collecting timing info
21:55:14.070273 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ListingTypeproperties_Incr: Close
21:55:14.071096 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08177d30>]}
21:55:14.071626 [info ] [Thread-2  ]: 53 of 101 OK snapshotted stg.AH_ListingTypeproperties_Incr...................... [[32mOK[0m in 19.01s]
21:55:14.072033 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ListingTypeproperties_Incr
21:55:14.072232 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Locations_Incr
21:55:14.072620 [info ] [Thread-2  ]: 59 of 101 START snapshot stg.AH_Locations_Incr.................................. [RUN]
21:55:14.073096 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Locations_Incr"
21:55:14.073257 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Locations_Incr
21:55:14.073394 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Locations_Incr
21:55:14.076344 [debug] [Thread-2  ]: finished collecting timing info
21:55:14.076557 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Locations_Incr
21:55:14.079539 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:14.079737 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:14.079863 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:55:14.079998 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:14.194811 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:14.230002 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:55:14.251878 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:14.252273 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:14.355999 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:14.358367 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:14.358661 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Locations_InterView]
        ) as __dbt_sbq
    
21:55:14.420661 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:14.441668 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:14.442059 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        ) as __dbt_sbq
    
21:55:14.497985 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:14.501370 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:14.501650 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
21:55:14.766578 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:55:14.770316 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:14.770669 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Locations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Locations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501''), CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:14.264501'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.PayToproceed != source_data.PayToproceed
        or
        (
            ((snapshotted_data.PayToproceed is null) and not (source_data.PayToproceed is null))
            or
            ((not snapshotted_data.PayToproceed is null) and (source_data.PayToproceed is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Locations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Locations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Locations_Incr__dbt_tmp_temp_view"
    end



    
21:55:21.029599 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 11.74 seconds
21:55:21.033346 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:21.033589 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:21.073458 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:21.075137 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:21.075404 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
21:55:22.223046 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:55:22.224793 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:22.225031 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:22.323055 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:22.325616 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:22.325819 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:22.771311 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.45 seconds
21:55:22.774397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:22.774735 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
21:55:22.812902 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:22.818083 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:22.818363 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:22.860606 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:22.862186 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:22.862421 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
21:55:23.120742 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.35 seconds
21:55:23.124243 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:23.124438 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:23.171789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:23.173426 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:23.173676 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
21:55:23.688023 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:55:23.689723 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:23.689970 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:23.732128 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:23.734761 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:23.735006 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:24.220342 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.49 seconds
21:55:24.220612 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:55:24.222611 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:24.222832 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:24.224751 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:24.224932 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr'
      and table_schema = 'stg'
  
21:55:24.264473 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:24.268758 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:24.269079 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:24.291934 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:24.294679 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:24.294963 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:24.311202 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:24.312670 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:24.312900 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    
21:55:24.500298 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:55:24.503631 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:24.503907 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
21:55:24.550286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:24.554332 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:24.554577 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:24.616694 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:24.618141 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:24.618351 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
21:55:25.715066 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
21:55:25.716715 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:25.716894 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:25.756515 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:25.759105 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:25.759369 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ListingsReserveHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:25.998304 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:55:26.000422 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ListingsReserveHistory_Incr"
21:55:26.000829 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:26.000967 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ListingsReserveHistory_Incr" (
                  "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "ListingID", "CreatedOn", "UpdatedOn", "DeletedOn", "OldReserve", "NewReserve", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:26.685351 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.07 seconds
21:55:26.687240 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:26.687429 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:26.720752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:26.723338 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:26.723538 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:26.962396 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:55:26.965230 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:26.965413 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr'
      and table_schema = 'stg'
  
21:55:27.005678 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:27.010261 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:27.010587 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:27.062183 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:27.064194 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:27.064439 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
    
21:55:28.238147 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.24 seconds
21:55:28.239732 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: COMMIT
21:55:28.240407 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ListingsReserveHistory_Incr".
21:55:28.240537 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: 
    
  if object_id ('"stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ListingsReserveHistory_Incr__dbt_tmp"
    end

21:55:28.356181 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:55:28.368715 [debug] [Thread-1  ]: finished collecting timing info
21:55:28.369062 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ListingsReserveHistory_Incr: Close
21:55:28.369766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c46a0>]}
21:55:28.370262 [info ] [Thread-1  ]: 57 of 101 OK snapshotted stg.AH_ListingsReserveHistory_Incr..................... [[32mOK[0m in 19.56s]
21:55:28.370674 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ListingsReserveHistory_Incr
21:55:28.370871 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:55:28.371245 [info ] [Thread-1  ]: 60 of 101 START snapshot stg.AH_LogentriesBuffer_Incr........................... [RUN]
21:55:28.371674 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr"
21:55:28.371830 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:55:28.371965 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_LogentriesBuffer_Incr
21:55:28.374626 [debug] [Thread-1  ]: finished collecting timing info
21:55:28.374874 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:55:28.377569 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:28.377752 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:28.377876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:55:28.378009 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:28.523356 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:28.588298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:55:28.610915 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:28.611228 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:28.684977 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:28.687476 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:28.687729 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]
        ) as __dbt_sbq
    
21:55:28.802242 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:55:28.823554 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:28.823879 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        ) as __dbt_sbq
    
21:55:28.922684 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:28.926367 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:28.926676 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
21:55:29.074815 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:55:29.079014 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:29.079350 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_LogentriesBuffer_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322''), CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:28.655322'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LogentriesBuffer_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_temp_view"
    end



    
21:55:29.420072 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.36 seconds
21:55:29.421790 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:29.422023 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Locations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:29.495172 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:29.497849 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:29.498126 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Locations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:29.899060 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:55:29.901113 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Locations_Incr"
21:55:29.901532 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:29.901660 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Locations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Locations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Locations_Incr" (
                  "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Description", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "Amount", "PayToproceed", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Locations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:32.429117 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.53 seconds
21:55:32.430827 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Locations_Incr: COMMIT
21:55:32.431587 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Locations_Incr".
21:55:32.431732 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Locations_Incr: 
    
  if object_id ('"stg"."#AH_Locations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Locations_Incr__dbt_tmp"
    end

21:55:32.495447 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:32.507229 [debug] [Thread-2  ]: finished collecting timing info
21:55:32.507633 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Locations_Incr: Close
21:55:32.508402 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4550>]}
21:55:32.651818 [info ] [Thread-2  ]: 59 of 101 OK snapshotted stg.AH_Locations_Incr.................................. [[32mOK[0m in 18.44s]
21:55:32.652766 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Locations_Incr
21:55:32.652974 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Logentries_Incr
21:55:32.653364 [info ] [Thread-2  ]: 61 of 101 START snapshot stg.AH_Logentries_Incr................................. [RUN]
21:55:32.653891 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Logentries_Incr"
21:55:32.654061 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Logentries_Incr
21:55:32.654205 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Logentries_Incr
21:55:32.657069 [debug] [Thread-2  ]: finished collecting timing info
21:55:32.657279 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Logentries_Incr
21:55:32.660118 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:55:32.660307 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:32.660433 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:55:32.660571 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:32.810811 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:32.854761 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:55:32.876661 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:55:32.877049 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:32.934990 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:32.937295 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:55:32.937875 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Logentries_InterView]
        ) as __dbt_sbq
    
21:55:33.022783 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:55:33.044931 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:55:33.045318 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        ) as __dbt_sbq
    
21:55:33.708442 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.66 seconds
21:55:33.712210 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:55:33.712491 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
21:55:33.813229 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:33.816924 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:55:33.817191 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Logentries_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Logentries_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382''), CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:32.905382'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Priority != source_data.Priority
        or
        (
            ((snapshotted_data.Priority is null) and not (source_data.Priority is null))
            or
            ((not snapshotted_data.Priority is null) and (source_data.Priority is null))
        ) or snapshotted_data.EventID != source_data.EventID
        or
        (
            ((snapshotted_data.EventID is null) and not (source_data.EventID is null))
            or
            ((not snapshotted_data.EventID is null) and (source_data.EventID is null))
        ) or snapshotted_data.SqlDaTestamp != source_data.SqlDaTestamp
        or
        (
            ((snapshotted_data.SqlDaTestamp is null) and not (source_data.SqlDaTestamp is null))
            or
            ((not snapshotted_data.SqlDaTestamp is null) and (source_data.SqlDaTestamp is null))
        ) or snapshotted_data.EntryDaTestamp != source_data.EntryDaTestamp
        or
        (
            ((snapshotted_data.EntryDaTestamp is null) and not (source_data.EntryDaTestamp is null))
            or
            ((not snapshotted_data.EntryDaTestamp is null) and (source_data.EntryDaTestamp is null))
        ) or snapshotted_data.MachineName != source_data.MachineName
        or
        (
            ((snapshotted_data.MachineName is null) and not (source_data.MachineName is null))
            or
            ((not snapshotted_data.MachineName is null) and (source_data.MachineName is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.Title != source_data.Title
        or
        (
            ((snapshotted_data.Title is null) and not (source_data.Title is null))
            or
            ((not snapshotted_data.Title is null) and (source_data.Title is null))
        ) or snapshotted_data.FunctionalArea != source_data.FunctionalArea
        or
        (
            ((snapshotted_data.FunctionalArea is null) and not (source_data.FunctionalArea is null))
            or
            ((not snapshotted_data.FunctionalArea is null) and (source_data.FunctionalArea is null))
        ) or snapshotted_data.Severity != source_data.Severity
        or
        (
            ((snapshotted_data.Severity is null) and not (source_data.Severity is null))
            or
            ((not snapshotted_data.Severity is null) and (source_data.Severity is null))
        ) or snapshotted_data.Actor != source_data.Actor
        or
        (
            ((snapshotted_data.Actor is null) and not (source_data.Actor is null))
            or
            ((not snapshotted_data.Actor is null) and (source_data.Actor is null))
        ) or snapshotted_data.ExceptionClass != source_data.ExceptionClass
        or
        (
            ((snapshotted_data.ExceptionClass is null) and not (source_data.ExceptionClass is null))
            or
            ((not snapshotted_data.ExceptionClass is null) and (source_data.ExceptionClass is null))
        ) or snapshotted_data.Stacktrace != source_data.Stacktrace
        or
        (
            ((snapshotted_data.Stacktrace is null) and not (source_data.Stacktrace is null))
            or
            ((not snapshotted_data.Stacktrace is null) and (source_data.Stacktrace is null))
        ) or snapshotted_data.Properties != source_data.Properties
        or
        (
            ((snapshotted_data.Properties is null) and not (source_data.Properties is null))
            or
            ((not snapshotted_data.Properties is null) and (source_data.Properties is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Logentries_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Logentries_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Logentries_Incr__dbt_tmp_temp_view"
    end



    
21:55:41.831054 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 33.80 seconds
21:55:41.834833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:41.835136 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:41.878283 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:41.880048 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:41.880376 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
21:55:43.060599 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:55:43.062135 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:43.062319 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:43.158515 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:43.161046 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:43.161254 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:43.394685 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:55:43.398807 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:43.399085 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
21:55:43.444773 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:43.449314 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:43.449661 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:43.490289 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:43.492065 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:43.492355 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
21:55:44.624644 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.13 seconds
21:55:44.626244 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:44.626438 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:44.663056 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:44.665601 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:44.665797 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:44.948857 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:55:44.951991 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:44.952241 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr'
      and table_schema = 'stg'
  
21:55:45.010667 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:45.015637 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:45.015961 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:45.116869 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:45.118434 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:45.118693 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
    
21:55:46.654989 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
21:55:46.656550 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:46.656735 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:46.700752 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:46.703319 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:46.703535 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listingproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:46.940457 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:55:46.942721 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listingproperties_Incr"
21:55:46.943234 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:46.943403 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listingproperties_Incr" (
                  "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "BoolnativeValue", "IntnativeValue", "ListingID", "CustomFieldID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listingproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:46.961254 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 17.88 seconds
21:55:46.964892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:46.965197 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:47.001384 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:47.003108 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:47.003375 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
21:55:48.546879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
21:55:48.548510 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:48.548705 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:48.620925 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:48.623948 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:48.624161 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:49.681514 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:55:49.684473 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:49.684715 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
21:55:49.809451 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:55:49.813879 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:49.814081 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:49.905383 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:55:49.907204 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:49.907463 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
21:55:50.057635 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 3.11 seconds
21:55:50.059226 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Listingproperties_Incr: COMMIT
21:55:50.059933 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listingproperties_Incr".
21:55:50.060072 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Listingproperties_Incr: 
    
  if object_id ('"stg"."#AH_Listingproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listingproperties_Incr__dbt_tmp"
    end

21:55:50.158356 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:55:50.170412 [debug] [Thread-3  ]: finished collecting timing info
21:55:50.170815 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Listingproperties_Incr: Close
21:55:50.171535 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4400>]}
21:55:50.172036 [info ] [Thread-3  ]: 56 of 101 OK snapshotted stg.AH_Listingproperties_Incr.......................... [[32mOK[0m in 42.67s]
21:55:50.172420 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Listingproperties_Incr
21:55:50.172608 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Lots_Incr
21:55:50.172972 [info ] [Thread-3  ]: 62 of 101 START snapshot stg.AH_Lots_Incr....................................... [RUN]
21:55:50.173423 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Lots_Incr"
21:55:50.173581 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Lots_Incr
21:55:50.173713 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Lots_Incr
21:55:50.176384 [debug] [Thread-3  ]: finished collecting timing info
21:55:50.176578 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Lots_Incr
21:55:50.179319 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:55:50.179498 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:50.179626 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:55:50.179761 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:50.297454 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:50.336464 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:55:50.358472 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:55:50.358853 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:50.409969 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:50.412933 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:55:50.413195 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Lots_InterView]
        ) as __dbt_sbq
    
21:55:50.485381 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:50.506209 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:55:50.506630 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        ) as __dbt_sbq
    
21:55:50.559042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:50.562388 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:55:50.562693 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
21:55:50.630753 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:50.634852 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:55:50.635152 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Lots_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Lots_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051''), CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:50.390051'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LotNumber != source_data.LotNumber
        or
        (
            ((snapshotted_data.LotNumber is null) and not (source_data.LotNumber is null))
            or
            ((not snapshotted_data.LotNumber is null) and (source_data.LotNumber is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.IsSoftclosing != source_data.IsSoftclosing
        or
        (
            ((snapshotted_data.IsSoftclosing is null) and not (source_data.IsSoftclosing is null))
            or
            ((not snapshotted_data.IsSoftclosing is null) and (source_data.IsSoftclosing is null))
        ) or snapshotted_data.SoftclosingGroup != source_data.SoftclosingGroup
        or
        (
            ((snapshotted_data.SoftclosingGroup is null) and not (source_data.SoftclosingGroup is null))
            or
            ((not snapshotted_data.SoftclosingGroup is null) and (source_data.SoftclosingGroup is null))
        ) or snapshotted_data.LotOrder != source_data.LotOrder
        or
        (
            ((snapshotted_data.LotOrder is null) and not (source_data.LotOrder is null))
            or
            ((not snapshotted_data.LotOrder is null) and (source_data.LotOrder is null))
        ) or snapshotted_data.AuctionEventID != source_data.AuctionEventID
        or
        (
            ((snapshotted_data.AuctionEventID is null) and not (source_data.AuctionEventID is null))
            or
            ((not snapshotted_data.AuctionEventID is null) and (source_data.AuctionEventID is null))
        ) or snapshotted_data.ClosingGroup != source_data.ClosingGroup
        or
        (
            ((snapshotted_data.ClosingGroup is null) and not (source_data.ClosingGroup is null))
            or
            ((not snapshotted_data.ClosingGroup is null) and (source_data.ClosingGroup is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Lots_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Lots_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Lots_Incr__dbt_tmp_temp_view"
    end



    
21:55:51.399562 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
21:55:51.401148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:51.401332 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:51.465652 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:55:51.468146 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:51.468323 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:51.716123 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:55:51.719198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:51.719430 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr'
      and table_schema = 'stg'
  
21:55:51.754527 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:51.759516 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:51.759874 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:51.841726 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:55:51.843443 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:51.843722 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    
21:55:52.270023 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 40.63 seconds
21:55:52.273401 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:52.273585 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:52.314763 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:52.316388 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:52.316642 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
21:55:52.933523 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:55:52.935182 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:52.935362 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:52.973873 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:52.976704 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:52.977028 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_LogentriesBuffer_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:53.772499 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.80 seconds
21:55:53.774846 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_LogentriesBuffer_Incr"
21:55:53.775288 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:53.775425 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_LogentriesBuffer_Incr" (
                  "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Message", "Properties", "MachineName", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "SqlDaTestamp", "EntryDaTestamp", "Priority", "EventID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:55:55.603761 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.83 seconds
21:55:55.605490 [debug] [Thread-1  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: COMMIT
21:55:55.608193 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_LogentriesBuffer_Incr".
21:55:55.608458 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_LogentriesBuffer_Incr: 
    
  if object_id ('"stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_LogentriesBuffer_Incr__dbt_tmp"
    end

21:55:55.647029 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.33 seconds
21:55:55.648793 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:55.649059 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:55.649366 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:55:55.660036 [debug] [Thread-1  ]: finished collecting timing info
21:55:55.660404 [debug] [Thread-1  ]: On snapshot.Shawn.AH_LogentriesBuffer_Incr: Close
21:55:55.661143 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4a90>]}
21:55:55.661652 [info ] [Thread-1  ]: 60 of 101 OK snapshotted stg.AH_LogentriesBuffer_Incr........................... [[32mOK[0m in 27.29s]
21:55:55.662039 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_LogentriesBuffer_Incr
21:55:55.662236 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_MediaMetaData_Incr
21:55:55.662663 [info ] [Thread-1  ]: 63 of 101 START snapshot stg.AH_MediaMetaData_Incr.............................. [RUN]
21:55:55.663128 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr"
21:55:55.663285 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_MediaMetaData_Incr
21:55:55.663419 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_MediaMetaData_Incr
21:55:55.666364 [debug] [Thread-1  ]: finished collecting timing info
21:55:55.666614 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_MediaMetaData_Incr
21:55:55.669621 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:55:55.669811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:55:55.669939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:55:55.670080 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:55:55.723992 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:55.727048 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:55.727335 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:55.779833 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:55:55.808597 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:55:55.831233 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:55:55.831605 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:55:55.863635 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:55:55.865716 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:55:55.865965 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaMetaData_InterView]
        ) as __dbt_sbq
    
21:55:55.920843 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:55:55.942292 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:55:55.942697 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        ) as __dbt_sbq
    
21:55:55.943209 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:55:55.946347 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:55.946573 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
21:55:56.017447 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:56.022329 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:56.022619 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:56.096741 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:56.098364 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:56.098638 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
21:55:56.108298 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:55:56.111586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:55:56.111843 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
21:55:56.180234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:56.184152 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:55:56.184433 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270''), CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:55:55.843270'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaMetaData_Incr__dbt_tmp_temp_view"
    end



    
21:55:58.501980 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.40 seconds
21:55:58.503597 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:58.503790 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:55:58.577532 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:55:58.580743 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:58.580957 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:59.076166 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
21:55:59.079361 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:59.079589 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr'
      and table_schema = 'stg'
  
21:55:59.197268 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:55:59.202128 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:59.202346 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:55:59.292525 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:55:59.294196 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:55:59.294468 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
    
21:56:03.597196 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.30 seconds
21:56:03.598896 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:56:03.599105 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Listings_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:56:03.653363 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:56:03.656630 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:56:03.656909 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Listings_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:03.932219 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:56:03.935131 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Listings_Incr"
21:56:03.935705 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:56:03.935879 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Listings_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Listings_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Listings_Incr" (
                  "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "PrimaryImageURI", "OwnerUserName", "CurrentListingActionUserName", "Title", "Description", "SubTitle", "Location", "Status", "CreatedOn", "UpdatedOn", "DeletedOn", "Enddttm", "Startdttm", "AutoreListrEMAining", "CurrentQuantity", "OriginalQuantity", "ReListiteration", "LotID", "AcceptedActionCount", "OwnerID", "ListingTypeID", "Duration", "Version", "CurrencyID", "PrimaryCategoryID", "CurrentListingActionID", "OfferCount", "OriginalreListCount", "Hits", "CurrentPrice", "Increment", "OriginalPrice", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Listings_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:56:06.390905 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.45 seconds
21:56:06.392631 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Listings_Incr: COMMIT
21:56:06.393421 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Listings_Incr".
21:56:06.393571 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Listings_Incr: 
    
  if object_id ('"stg"."#AH_Listings_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Listings_Incr__dbt_tmp"
    end

21:56:06.456833 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:56:06.468863 [debug] [Thread-4  ]: finished collecting timing info
21:56:06.469290 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Listings_Incr: Close
21:56:06.470044 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c47f0>]}
21:56:06.470591 [info ] [Thread-4  ]: 58 of 101 OK snapshotted stg.AH_Listings_Incr................................... [[32mOK[0m in 55.62s]
21:56:06.470999 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Listings_Incr
21:56:06.471191 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Media_Incr
21:56:06.471564 [info ] [Thread-4  ]: 64 of 101 START snapshot stg.AH_Media_Incr...................................... [RUN]
21:56:06.472014 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Media_Incr"
21:56:06.472174 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Media_Incr
21:56:06.472308 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Media_Incr
21:56:06.475207 [debug] [Thread-4  ]: finished collecting timing info
21:56:06.475411 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Media_Incr
21:56:06.478248 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:06.478434 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:56:06.478594 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:56:06.478751 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:56:06.766217 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:56:06.806158 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:56:06.827988 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:06.828395 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:56:06.864325 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:56:06.866723 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:06.866971 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Media_InterView]
        ) as __dbt_sbq
    
21:56:07.115199 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:56:07.136869 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:07.137278 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        ) as __dbt_sbq
    
21:56:07.562791 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.43 seconds
21:56:07.566458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:07.566782 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
21:56:07.775034 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:56:07.779076 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:07.779386 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Media_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Media_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Media_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451''), CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:56:06.843451'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.GUID != source_data.GUID
        or
        (
            ((snapshotted_data.GUID is null) and not (source_data.GUID is null))
            or
            ((not snapshotted_data.GUID is null) and (source_data.GUID is null))
        ) or snapshotted_data.DefaultvariationName != source_data.DefaultvariationName
        or
        (
            ((snapshotted_data.DefaultvariationName is null) and not (source_data.DefaultvariationName is null))
            or
            ((not snapshotted_data.DefaultvariationName is null) and (source_data.DefaultvariationName is null))
        ) or snapshotted_data.Loader != source_data.Loader
        or
        (
            ((snapshotted_data.Loader is null) and not (source_data.Loader is null))
            or
            ((not snapshotted_data.Loader is null) and (source_data.Loader is null))
        ) or snapshotted_data.Saver != source_data.Saver
        or
        (
            ((snapshotted_data.Saver is null) and not (source_data.Saver is null))
            or
            ((not snapshotted_data.Saver is null) and (source_data.Saver is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.ConText != source_data.ConText
        or
        (
            ((snapshotted_data.ConText is null) and not (source_data.ConText is null))
            or
            ((not snapshotted_data.ConText is null) and (source_data.ConText is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Media_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Media_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Media_Incr__dbt_tmp_temp_view"
    end



    
21:56:08.269628 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 17.63 seconds
21:56:08.273302 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:08.273567 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:08.463306 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:56:08.464941 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:08.465198 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
21:56:13.141211 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.68 seconds
21:56:13.142916 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:13.143115 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:56:13.227144 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:56:13.229871 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:13.230130 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:13.465812 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:56:13.468904 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:13.469137 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
21:56:13.624323 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:56:13.628776 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:13.629146 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:14.164927 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:56:14.166595 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:14.166846 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
21:56:15.439171 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:56:15.440821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:15.441007 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:56:15.546126 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:56:15.548837 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:15.549026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:16.313258 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.76 seconds
21:56:16.316174 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:16.316369 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr'
      and table_schema = 'stg'
  
21:56:16.432565 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:56:16.437152 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:16.437503 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:16.502623 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:56:16.504210 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:16.504458 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
    
21:56:18.294933 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.79 seconds
21:56:18.296593 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:18.296776 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Lots_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:56:18.363230 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:56:18.366200 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:18.366462 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Lots_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:18.732176 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:56:18.734295 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Lots_Incr"
21:56:18.734889 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:18.735063 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Lots_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Lots_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Lots_Incr" (
                  "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LotNumber", "LastUpdatedUser", "IsSoftclosing", "SoftclosingGroup", "LotOrder", "AuctionEventID", "ClosingGroup", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Lots_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:56:21.246165 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.51 seconds
21:56:21.249542 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Lots_Incr: COMMIT
21:56:21.250259 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Lots_Incr".
21:56:21.250390 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Lots_Incr: 
    
  if object_id ('"stg"."#AH_Lots_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Lots_Incr__dbt_tmp"
    end

21:56:21.323081 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:56:21.334489 [debug] [Thread-3  ]: finished collecting timing info
21:56:21.334906 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Lots_Incr: Close
21:56:21.335659 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4940>]}
21:56:21.336162 [info ] [Thread-3  ]: 62 of 101 OK snapshotted stg.AH_Lots_Incr....................................... [[32mOK[0m in 31.16s]
21:56:21.336548 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Lots_Incr
21:56:21.336737 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:56:21.337105 [info ] [Thread-3  ]: 65 of 101 START snapshot stg.AH_MediaassetMetaData_Incr......................... [RUN]
21:56:21.337534 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr"
21:56:21.337692 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:56:21.337826 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_MediaassetMetaData_Incr
21:56:21.340516 [debug] [Thread-3  ]: finished collecting timing info
21:56:21.340760 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:56:21.343467 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:56:21.343647 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:56:21.343771 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:56:21.343905 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:56:21.534448 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:56:21.637752 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:56:21.659437 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:56:21.659798 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:56:21.757527 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:56:21.760065 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:56:21.760309 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]
        ) as __dbt_sbq
    
21:56:21.952293 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:56:21.973447 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:56:21.973789 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        ) as __dbt_sbq
    
21:56:22.140610 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:56:22.144256 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:56:22.144525 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
21:56:22.326725 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:56:22.330525 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:56:22.330805 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_MediaassetMetaData_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669''), CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:56:21.718669'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaMetaDataID != source_data.MediaMetaDataID
        or
        (
            ((snapshotted_data.MediaMetaDataID is null) and not (source_data.MediaMetaDataID is null))
            or
            ((not snapshotted_data.MediaMetaDataID is null) and (source_data.MediaMetaDataID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_MediaassetMetaData_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_temp_view"
    end



    
21:56:52.609057 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 78.79 seconds
21:56:52.698326 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:56:52.698748 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:52.857093 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:56:52.858802 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:56:52.859044 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
21:56:53.869133 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 46.09 seconds
21:56:53.872697 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:53.872972 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:53.981984 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:56:53.983695 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:53.984002 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
21:56:56.004428 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
21:56:56.006075 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:56.006262 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:56:56.222608 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:56:56.225252 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:56.225455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:56.842490 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
21:56:56.845387 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:56.845599 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
21:56:57.055577 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:56:57.059812 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:57.060105 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:56:57.274015 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:56:57.275904 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:56:57.276152 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
21:57:01.211187 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.93 seconds
21:57:01.212861 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:01.213087 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:01.360352 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:57:01.363135 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:01.363400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:01.996357 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 9.14 seconds
21:57:01.998047 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:01.998268 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:02.019539 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.66 seconds
21:57:02.023489 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:02.023868 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr'
      and table_schema = 'stg'
  
21:57:02.116098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:57:02.119065 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:02.119424 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:02.159926 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:57:02.164549 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:02.164917 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:02.308190 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:57:02.309781 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:02.310037 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
    
21:57:02.624475 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
21:57:02.627830 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:02.628194 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
21:57:02.786530 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:57:02.791119 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:02.791478 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:02.994185 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:57:02.995802 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:02.995995 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
21:57:06.087371 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.78 seconds
21:57:06.089020 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:06.089222 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Media_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:06.186191 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:57:06.189179 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:06.189380 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Media_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:06.604983 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
21:57:06.607360 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Media_Incr"
21:57:06.607892 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:06.608046 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Media_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Media_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Media_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "GUID", "DefaultvariationName", "Loader", "Saver", "LastUpdatedUser", "ConText", "Status", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Media_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:57:10.336168 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.73 seconds
21:57:10.337863 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Media_Incr: COMMIT
21:57:10.338656 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Media_Incr".
21:57:10.338814 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Media_Incr: 
    
  if object_id ('"stg"."#AH_Media_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Media_Incr__dbt_tmp"
    end

21:57:10.468448 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:57:10.483398 [debug] [Thread-4  ]: finished collecting timing info
21:57:10.483836 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Media_Incr: Close
21:57:10.484631 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4be0>]}
21:57:10.485155 [info ] [Thread-4  ]: 64 of 101 OK snapshotted stg.AH_Media_Incr...................................... [[32mOK[0m in 64.01s]
21:57:10.485557 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Media_Incr
21:57:10.485754 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Mediaassets_Incr
21:57:10.486138 [info ] [Thread-4  ]: 66 of 101 START snapshot stg.AH_Mediaassets_Incr................................ [RUN]
21:57:10.486650 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediaassets_Incr"
21:57:10.486824 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Mediaassets_Incr
21:57:10.486967 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Mediaassets_Incr
21:57:10.489914 [debug] [Thread-4  ]: finished collecting timing info
21:57:10.490139 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Mediaassets_Incr
21:57:10.493222 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:10.493422 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:57:10.493551 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:57:10.493696 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:57:10.645266 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:57:10.699760 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:57:10.721761 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:10.722138 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:57:10.774989 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 7.78 seconds
21:57:10.776676 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:10.776966 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:10.777312 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:10.779483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:10.779725 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediaassets_InterView]
        ) as __dbt_sbq
    
21:57:10.879698 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:57:10.882567 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:10.882871 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:10.904384 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:57:10.927449 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:10.927840 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        ) as __dbt_sbq
    
21:57:11.226203 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:57:11.230188 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:11.230461 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
21:57:11.262910 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:57:11.266269 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:11.266665 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr'
      and table_schema = 'stg'
  
21:57:11.343182 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:57:11.348973 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:11.349326 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:11.361639 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:57:11.365047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:11.365390 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediaassets_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediaassets_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663''), CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:57:10.750663'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Type != source_data.Type
        or
        (
            ((snapshotted_data.Type is null) and not (source_data.Type is null))
            or
            ((not snapshotted_data.Type is null) and (source_data.Type is null))
        ) or snapshotted_data.Reference != source_data.Reference
        or
        (
            ((snapshotted_data.Reference is null) and not (source_data.Reference is null))
            or
            ((not snapshotted_data.Reference is null) and (source_data.Reference is null))
        ) or snapshotted_data.Sha1 != source_data.Sha1
        or
        (
            ((snapshotted_data.Sha1 is null) and not (source_data.Sha1 is null))
            or
            ((not snapshotted_data.Sha1 is null) and (source_data.Sha1 is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediaassets_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediaassets_Incr__dbt_tmp_temp_view"
    end



    
21:57:11.430076 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:57:11.431682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:11.431945 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
    
21:57:19.821640 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 57.49 seconds
21:57:19.825694 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:19.825897 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:19.889607 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:19.891235 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:19.891485 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
21:57:20.152694 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.72 seconds
21:57:20.154308 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:20.154483 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:20.247429 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:57:20.250289 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:20.250594 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Logentries_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:20.791244 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.54 seconds
21:57:20.793549 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Logentries_Incr"
21:57:20.793990 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:20.794127 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Logentries_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Logentries_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Logentries_Incr" (
                  "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Priority", "EventID", "SqlDaTestamp", "EntryDaTestamp", "MachineName", "Message", "Title", "FunctionalArea", "Severity", "Actor", "ExceptionClass", "Stacktrace", "Properties", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Logentries_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:57:21.953064 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.06 seconds
21:57:21.954831 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:21.955094 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:22.037061 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:57:22.040171 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:22.040449 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:22.398948 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:57:22.401635 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:22.401826 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
21:57:22.479737 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:57:22.484050 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:22.484332 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:22.531495 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:57:22.533412 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:22.533655 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
21:57:24.539290 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.01 seconds
21:57:24.540736 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:24.540903 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:24.644273 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:57:24.646787 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:24.646957 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:24.961732 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.17 seconds
21:57:24.963484 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Logentries_Incr: COMMIT
21:57:24.964206 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Logentries_Incr".
21:57:24.964345 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Logentries_Incr: 
    
  if object_id ('"stg"."#AH_Logentries_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Logentries_Incr__dbt_tmp"
    end

21:57:25.056401 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:57:25.069254 [debug] [Thread-2  ]: finished collecting timing info
21:57:25.069644 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Logentries_Incr: Close
21:57:25.072070 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4d30>]}
21:57:25.072991 [info ] [Thread-2  ]: 61 of 101 OK snapshotted stg.AH_Logentries_Incr................................. [[32mOK[0m in 112.42s]
21:57:25.073412 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Logentries_Incr
21:57:25.073868 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Mediavariations_Incr
21:57:25.074293 [info ] [Thread-2  ]: 67 of 101 START snapshot stg.AH_Mediavariations_Incr............................ [RUN]
21:57:25.074784 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Mediavariations_Incr"
21:57:25.074950 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Mediavariations_Incr
21:57:25.075099 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Mediavariations_Incr
21:57:25.078888 [debug] [Thread-2  ]: finished collecting timing info
21:57:25.079123 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Mediavariations_Incr
21:57:25.081973 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:57:25.082157 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:57:25.082285 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:57:25.082424 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:57:25.221778 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:57:25.223942 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
21:57:25.226607 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:25.226816 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr'
      and table_schema = 'stg'
  
21:57:25.257122 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:57:25.278786 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:57:25.279147 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:57:25.301729 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:25.306180 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:25.306463 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:25.319146 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:57:25.321467 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:57:25.321672 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Mediavariations_InterView]
        ) as __dbt_sbq
    
21:57:25.384080 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:25.405178 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:57:25.405529 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        ) as __dbt_sbq
    
21:57:25.441356 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:57:25.443360 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:25.443607 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    
21:57:25.528246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:57:25.531768 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:57:25.532011 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
21:57:25.628230 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:57:25.632010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:57:25.632262 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Mediavariations_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Mediavariations_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792''), CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:57:25.297792'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.MediaassetID != source_data.MediaassetID
        or
        (
            ((snapshotted_data.MediaassetID is null) and not (source_data.MediaassetID is null))
            or
            ((not snapshotted_data.MediaassetID is null) and (source_data.MediaassetID is null))
        ) or snapshotted_data.MediaID != source_data.MediaID
        or
        (
            ((snapshotted_data.MediaID is null) and not (source_data.MediaID is null))
            or
            ((not snapshotted_data.MediaID is null) and (source_data.MediaID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Mediavariations_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Mediavariations_Incr__dbt_tmp_temp_view"
    end



    
21:57:27.810019 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.37 seconds
21:57:27.811672 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:27.811874 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:28.033800 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:57:28.036449 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:28.036724 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaassetMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:28.789481 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.75 seconds
21:57:28.791561 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaassetMetaData_Incr"
21:57:28.791974 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:28.792105 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaassetMetaData_Incr" (
                  "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "MediaassetID", "MediaMetaDataID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:57:34.387046 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.59 seconds
21:57:34.388884 [debug] [Thread-3  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: COMMIT
21:57:34.389657 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaassetMetaData_Incr".
21:57:34.389836 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaassetMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaassetMetaData_Incr__dbt_tmp"
    end

21:57:34.585556 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:57:34.598570 [debug] [Thread-3  ]: finished collecting timing info
21:57:34.599001 [debug] [Thread-3  ]: On snapshot.Shawn.AH_MediaassetMetaData_Incr: Close
21:57:34.599782 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194160>]}
21:57:34.600306 [info ] [Thread-3  ]: 65 of 101 OK snapshotted stg.AH_MediaassetMetaData_Incr......................... [[32mOK[0m in 73.26s]
21:57:34.600688 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_MediaassetMetaData_Incr
21:57:34.600875 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Model_Incr
21:57:34.601242 [info ] [Thread-3  ]: 68 of 101 START snapshot stg.AH_Model_Incr...................................... [RUN]
21:57:34.601689 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Model_Incr"
21:57:34.601865 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Model_Incr
21:57:34.602009 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Model_Incr
21:57:34.604868 [debug] [Thread-3  ]: finished collecting timing info
21:57:34.605166 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Model_Incr
21:57:34.608205 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:34.608402 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:57:34.608530 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:57:34.608664 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:57:34.854096 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:57:35.011827 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:57:35.034179 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:35.034613 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:57:35.095028 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:35.097551 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:35.097803 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Model_InterView]
        ) as __dbt_sbq
    
21:57:35.164445 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:35.185822 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:35.186196 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        ) as __dbt_sbq
    
21:57:35.281078 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:57:35.284674 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:35.284988 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
21:57:35.411661 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:57:35.415196 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:35.415465 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Model_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Model_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Model_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577''), CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:57:35.063577'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Model_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Model_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Model_Incr__dbt_tmp_temp_view"
    end



    
21:57:42.776327 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 106.59 seconds
21:57:42.779937 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:42.780155 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:42.974389 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:57:42.975937 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:42.976112 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
21:57:45.870914 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 10.46 seconds
21:57:45.874344 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:45.874683 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:46.136541 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:57:46.138059 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:46.138308 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
21:57:49.564117 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.59 seconds
21:57:49.565718 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:49.565889 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:49.805638 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:57:49.808128 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:49.808327 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:50.592315 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.78 seconds
21:57:50.595374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:50.595565 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
21:57:50.776645 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:57:50.781848 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:50.782126 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:50.836128 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 4.70 seconds
21:57:50.837821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:50.838080 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:51.032671 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:57:51.035319 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:51.035551 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:51.060385 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:57:51.062012 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:51.062265 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
21:57:51.506049 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:57:51.509241 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:51.509513 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
21:57:51.617701 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:57:51.621937 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:51.622248 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:51.790091 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:57:51.791725 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:51.791983 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
21:57:53.235017 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.17 seconds
21:57:53.236638 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:53.236814 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:53.326690 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:57:53.329201 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:53.329408 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:53.607077 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.81 seconds
21:57:53.608690 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:53.608877 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:53.657974 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:57:53.660671 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:53.658479 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:57:53.663535 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:53.663742 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr'
      and table_schema = 'stg'
  
21:57:53.660930 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:53.757178 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:57:53.761830 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:53.762094 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:53.851469 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:57:53.853052 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:53.853281 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    
21:57:53.955566 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:57:53.958477 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:53.958768 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr'
      and table_schema = 'stg'
  
21:57:54.033431 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:54.037679 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:54.037874 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:54.146788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:57:54.148350 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:54.148593 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
    
21:57:55.174396 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 43.81 seconds
21:57:55.177800 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:55.177989 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:55.247676 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:55.249222 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:55.249399 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
21:57:55.758143 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.90 seconds
21:57:55.759792 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:55.759986 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:55.816846 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:55.819704 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:55.819955 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_MediaMetaData_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:55.886335 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.74 seconds
21:57:55.888141 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:55.888426 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Model_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:55.956891 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:55.959253 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:55.959495 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Model_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:56.185193 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.37 seconds
21:57:56.187178 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_MediaMetaData_Incr"
21:57:56.187565 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:57:56.187688 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_MediaMetaData_Incr" (
                  "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Value", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_MediaMetaData_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:57:56.294255 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:57:56.296085 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Model_Incr"
21:57:56.296497 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:56.296624 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Model_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Model_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Model_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Model_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:57:57.139642 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.89 seconds
21:57:57.141167 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:57.141357 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:57.345925 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:57:57.348428 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:57.348611 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:57.830850 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.48 seconds
21:57:57.834012 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:57.834200 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
21:57:57.896018 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:57.899874 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:57.900054 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:57:57.983461 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:57:57.985047 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:57.985306 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
21:57:58.814042 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.52 seconds
21:57:58.815780 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Model_Incr: COMMIT
21:57:58.816460 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Model_Incr".
21:57:58.816592 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Model_Incr: 
    
  if object_id ('"stg"."#AH_Model_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Model_Incr__dbt_tmp"
    end

21:57:58.901062 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:57:58.913088 [debug] [Thread-3  ]: finished collecting timing info
21:57:58.913456 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Model_Incr: Close
21:57:58.914156 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194550>]}
21:57:58.914691 [info ] [Thread-3  ]: 68 of 101 OK snapshotted stg.AH_Model_Incr...................................... [[32mOK[0m in 24.31s]
21:57:58.915085 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Model_Incr
21:57:58.915270 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:57:58.915617 [info ] [Thread-3  ]: 69 of 101 START snapshot stg.AH_NewSalestoInvoice_Incr.......................... [RUN]
21:57:58.916051 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
21:57:58.916207 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:57:58.916341 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:57:58.919177 [debug] [Thread-3  ]: finished collecting timing info
21:57:58.919379 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:57:58.922463 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:57:58.922671 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:57:58.922816 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:57:58.922955 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:57:59.071553 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:57:59.132301 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:57:59.154219 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:57:59.154632 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:57:59.217466 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:57:59.220027 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:57:59.220284 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]
        ) as __dbt_sbq
    
21:57:59.324027 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:57:59.344509 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:57:59.344828 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        ) as __dbt_sbq
    
21:57:59.418511 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:59.421972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:57:59.422249 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
21:57:59.549046 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:57:59.552616 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:57:59.552851 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_NewSalestoInvoice_InterView]

    ),

    snapshotted_data as (

        select *,
            LineItemID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957''), CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(LineItemID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            LineItemID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:57:59.188957'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_temp_view"
    end



    
21:57:59.904820 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.92 seconds
21:57:59.906433 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:59.906635 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:57:59.975934 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:57:59.978254 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:57:59.978434 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:00.360600 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.38 seconds
21:58:00.364346 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:00.364554 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr'
      and table_schema = 'stg'
  
21:58:00.410614 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:00.415107 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:00.415411 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:00.473956 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:00.475463 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:00.475700 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
    
21:58:02.056096 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.58 seconds
21:58:02.057705 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:02.057915 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:02.099781 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:02.102058 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:02.102247 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediaassets_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:02.336291 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:58:02.338448 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediaassets_Incr"
21:58:02.338942 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:02.339079 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediaassets_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Type", "Reference", "Sha1", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediaassets_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:04.788920 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.24 seconds
21:58:04.792509 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:04.792731 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:04.856180 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:04.857604 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:04.857790 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
21:58:05.366505 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 39.73 seconds
21:58:05.369987 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:05.370209 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:05.420481 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:05.422937 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:05.423174 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
21:58:05.722929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 9.54 seconds
21:58:05.724641 [debug] [Thread-1  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: COMMIT
21:58:05.725436 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_MediaMetaData_Incr".
21:58:05.725588 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_MediaMetaData_Incr: 
    
  if object_id ('"stg"."#AH_MediaMetaData_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_MediaMetaData_Incr__dbt_tmp"
    end

21:58:05.779161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:05.790757 [debug] [Thread-1  ]: finished collecting timing info
21:58:05.791144 [debug] [Thread-1  ]: On snapshot.Shawn.AH_MediaMetaData_Incr: Close
21:58:05.791895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c4e80>]}
21:58:05.792418 [info ] [Thread-1  ]: 63 of 101 OK snapshotted stg.AH_MediaMetaData_Incr.............................. [[32mOK[0m in 130.13s]
21:58:05.792814 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_MediaMetaData_Incr
21:58:05.793002 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Notifications_Incr
21:58:05.793357 [info ] [Thread-1  ]: 70 of 101 START snapshot stg.AH_Notifications_Incr.............................. [RUN]
21:58:05.793792 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Notifications_Incr"
21:58:05.793949 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Notifications_Incr
21:58:05.794083 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Notifications_Incr
21:58:05.796852 [debug] [Thread-1  ]: finished collecting timing info
21:58:05.797129 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Notifications_Incr
21:58:05.799923 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:05.800113 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:05.800256 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:58:05.800396 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:05.925948 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:05.966156 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:58:05.988953 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:05.989330 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:06.016679 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:06.018960 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:06.019209 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Notifications_InterView]
        ) as __dbt_sbq
    
21:58:06.076107 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:06.097727 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:06.098052 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        ) as __dbt_sbq
    
21:58:06.170878 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:06.174195 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:06.174434 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
21:58:06.245544 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:06.249604 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:06.249905 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Notifications_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Notifications_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557''), CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:06.001557'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DetailID != source_data.DetailID
        or
        (
            ((snapshotted_data.DetailID is null) and not (source_data.DetailID is null))
            or
            ((not snapshotted_data.DetailID is null) and (source_data.DetailID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Queueddttm != source_data.Queueddttm
        or
        (
            ((snapshotted_data.Queueddttm is null) and not (source_data.Queueddttm is null))
            or
            ((not snapshotted_data.Queueddttm is null) and (source_data.Queueddttm is null))
        ) or snapshotted_data.Statusdttm != source_data.Statusdttm
        or
        (
            ((snapshotted_data.Statusdttm is null) and not (source_data.Statusdttm is null))
            or
            ((not snapshotted_data.Statusdttm is null) and (source_data.Statusdttm is null))
        ) or snapshotted_data.RecipientEmail != source_data.RecipientEmail
        or
        (
            ((snapshotted_data.RecipientEmail is null) and not (source_data.RecipientEmail is null))
            or
            ((not snapshotted_data.RecipientEmail is null) and (source_data.RecipientEmail is null))
        ) or snapshotted_data.CcEmail != source_data.CcEmail
        or
        (
            ((snapshotted_data.CcEmail is null) and not (source_data.CcEmail is null))
            or
            ((not snapshotted_data.CcEmail is null) and (source_data.CcEmail is null))
        ) or snapshotted_data.BCcEmail != source_data.BCcEmail
        or
        (
            ((snapshotted_data.BCcEmail is null) and not (source_data.BCcEmail is null))
            or
            ((not snapshotted_data.BCcEmail is null) and (source_data.BCcEmail is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.StatusMessage != source_data.StatusMessage
        or
        (
            ((snapshotted_data.StatusMessage is null) and not (source_data.StatusMessage is null))
            or
            ((not snapshotted_data.StatusMessage is null) and (source_data.StatusMessage is null))
        ) or snapshotted_data.Message != source_data.Message
        or
        (
            ((snapshotted_data.Message is null) and not (source_data.Message is null))
            or
            ((not snapshotted_data.Message is null) and (source_data.Message is null))
        ) or snapshotted_data.DetailType != source_data.DetailType
        or
        (
            ((snapshotted_data.DetailType is null) and not (source_data.DetailType is null))
            or
            ((not snapshotted_data.DetailType is null) and (source_data.DetailType is null))
        ) or snapshotted_data.ReplytoEmail != source_data.ReplytoEmail
        or
        (
            ((snapshotted_data.ReplytoEmail is null) and not (source_data.ReplytoEmail is null))
            or
            ((not snapshotted_data.ReplytoEmail is null) and (source_data.ReplytoEmail is null))
        ) or snapshotted_data.SEnderUserName != source_data.SEnderUserName
        or
        (
            ((snapshotted_data.SEnderUserName is null) and not (source_data.SEnderUserName is null))
            or
            ((not snapshotted_data.SEnderUserName is null) and (source_data.SEnderUserName is null))
        ) or snapshotted_data.ReceiverUserName != source_data.ReceiverUserName
        or
        (
            ((snapshotted_data.ReceiverUserName is null) and not (source_data.ReceiverUserName is null))
            or
            ((not snapshotted_data.ReceiverUserName is null) and (source_data.ReceiverUserName is null))
        ) or snapshotted_data.Template != source_data.Template
        or
        (
            ((snapshotted_data.Template is null) and not (source_data.Template is null))
            or
            ((not snapshotted_data.Template is null) and (source_data.Template is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Notifications_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Notifications_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Notifications_Incr__dbt_tmp_temp_view"
    end



    
21:58:06.384744 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
21:58:06.386282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:06.386532 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:06.460379 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:06.462954 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:06.463207 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:06.635365 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.21 seconds
21:58:06.637010 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:06.637290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:06.727067 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:58:06.730306 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:06.730699 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:06.732965 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:06.733163 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:06.730942 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
21:58:06.772728 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.43 seconds
21:58:06.774523 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Mediaassets_Incr: COMMIT
21:58:06.775712 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediaassets_Incr".
21:58:06.776099 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediaassets_Incr: 
    
  if object_id ('"stg"."#AH_Mediaassets_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediaassets_Incr__dbt_tmp"
    end

21:58:06.775983 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:06.779793 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:06.780001 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:06.813881 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:06.815247 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:06.824494 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:06.824822 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
21:58:06.828663 [debug] [Thread-4  ]: finished collecting timing info
21:58:06.828951 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Mediaassets_Incr: Close
21:58:06.829977 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194400>]}
21:58:06.830466 [info ] [Thread-4  ]: 66 of 101 OK snapshotted stg.AH_Mediaassets_Incr................................ [[32mOK[0m in 56.34s]
21:58:06.830885 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Mediaassets_Incr
21:58:06.831071 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Offers_Incr
21:58:06.831416 [info ] [Thread-4  ]: 71 of 101 START snapshot stg.AH_Offers_Incr..................................... [RUN]
21:58:06.831855 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Offers_Incr"
21:58:06.832010 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Offers_Incr
21:58:06.832141 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Offers_Incr
21:58:06.834904 [debug] [Thread-4  ]: finished collecting timing info
21:58:06.835160 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Offers_Incr
21:58:06.837966 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:06.838147 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:06.838275 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:58:06.838409 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:06.936892 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:06.937455 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:58:06.940323 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:06.940684 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
21:58:06.977515 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:58:06.995801 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:06.999875 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:07.003665 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:07.003507 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:07.004044 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:07.032998 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:07.035050 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:07.035294 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Offers_InterView]
        ) as __dbt_sbq
    
21:58:07.046246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:07.047718 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:07.047933 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
21:58:07.110560 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:07.132756 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:07.133159 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        ) as __dbt_sbq
    
21:58:07.202924 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:07.206567 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:07.206860 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
21:58:07.494778 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:58:07.498709 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:07.499018 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Offers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Offers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195''), CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:07.017195'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.OfferMessage != source_data.OfferMessage
        or
        (
            ((snapshotted_data.OfferMessage is null) and not (source_data.OfferMessage is null))
            or
            ((not snapshotted_data.OfferMessage is null) and (source_data.OfferMessage is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DecLineMessage != source_data.DecLineMessage
        or
        (
            ((snapshotted_data.DecLineMessage is null) and not (source_data.DecLineMessage is null))
            or
            ((not snapshotted_data.DecLineMessage is null) and (source_data.DecLineMessage is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Expirationdttm != source_data.Expirationdttm
        or
        (
            ((snapshotted_data.Expirationdttm is null) and not (source_data.Expirationdttm is null))
            or
            ((not snapshotted_data.Expirationdttm is null) and (source_data.Expirationdttm is null))
        ) or snapshotted_data.SEndingUserID != source_data.SEndingUserID
        or
        (
            ((snapshotted_data.SEndingUserID is null) and not (source_data.SEndingUserID is null))
            or
            ((not snapshotted_data.SEndingUserID is null) and (source_data.SEndingUserID is null))
        ) or snapshotted_data.ReceivINgUserID != source_data.ReceivINgUserID
        or
        (
            ((snapshotted_data.ReceivINgUserID is null) and not (source_data.ReceivINgUserID is null))
            or
            ((not snapshotted_data.ReceivINgUserID is null) and (source_data.ReceivINgUserID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.Quantity != source_data.Quantity
        or
        (
            ((snapshotted_data.Quantity is null) and not (source_data.Quantity is null))
            or
            ((not snapshotted_data.Quantity is null) and (source_data.Quantity is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Offers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Offers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Offers_Incr__dbt_tmp_temp_view"
    end



    
21:58:07.909510 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.08 seconds
21:58:07.911240 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:07.911505 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:07.947225 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:07.949764 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:07.950084 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:08.522170 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.57 seconds
21:58:08.525292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:08.525505 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr'
      and table_schema = 'stg'
  
21:58:08.564360 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:08.568761 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:08.569098 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:08.609346 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:08.610976 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:08.611235 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    
21:58:08.654164 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:58:08.655745 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:08.655970 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:08.715128 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:08.717745 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:08.718017 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:08.967418 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:58:08.972605 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:08.972894 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr'
      and table_schema = 'stg'
  
21:58:09.036777 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:09.040910 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:09.041213 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:09.323007 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:58:09.324480 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:09.324696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
    
21:58:09.685967 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.07 seconds
21:58:09.687566 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:09.687743 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:09.736205 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:09.738693 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:09.738952 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_NewSalestoInvoice_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:09.951292 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:58:09.953373 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_NewSalestoInvoice_Incr"
21:58:09.953930 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:09.954109 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_NewSalestoInvoice_Incr" (
                  "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:10.275065 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:58:10.276607 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:10.276825 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:10.322676 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:10.326302 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:10.326639 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Mediavariations_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:10.553805 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:58:10.555853 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Mediavariations_Incr"
21:58:10.556345 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:10.556507 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Mediavariations_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "MediaassetID", "MediaID", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Mediavariations_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:11.364541 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
21:58:11.366207 [debug] [Thread-3  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: COMMIT
21:58:11.366972 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_NewSalestoInvoice_Incr".
21:58:11.367123 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: 
    
  if object_id ('"stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_NewSalestoInvoice_Incr__dbt_tmp"
    end

21:58:11.410186 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:11.422345 [debug] [Thread-3  ]: finished collecting timing info
21:58:11.422799 [debug] [Thread-3  ]: On snapshot.Shawn.AH_NewSalestoInvoice_Incr: Close
21:58:11.423562 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194940>]}
21:58:11.424082 [info ] [Thread-3  ]: 69 of 101 OK snapshotted stg.AH_NewSalestoInvoice_Incr.......................... [[32mOK[0m in 12.51s]
21:58:11.424468 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_NewSalestoInvoice_Incr
21:58:11.424651 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:58:11.424990 [info ] [Thread-3  ]: 72 of 101 START snapshot stg.AH_PaymentConfigurationTable_Incr.................. [RUN]
21:58:11.425422 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
21:58:11.425579 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:58:11.425716 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:58:11.428531 [debug] [Thread-3  ]: finished collecting timing info
21:58:11.428746 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:58:11.432161 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:11.432370 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:11.432499 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:58:11.432636 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:11.569736 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:11.602348 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:58:11.623722 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:11.624125 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:11.651717 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:11.653799 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:11.654365 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]
        ) as __dbt_sbq
    
21:58:11.713651 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:11.734690 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:11.735086 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        ) as __dbt_sbq
    
21:58:11.785156 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:11.789856 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:11.790144 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
21:58:11.866213 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:11.870014 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:11.870278 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentConfigurationTable_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636''), CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:11.626636'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Active != source_data.Active
        or
        (
            ((snapshotted_data.Active is null) and not (source_data.Active is null))
            or
            ((not snapshotted_data.Active is null) and (source_data.Active is null))
        ) or snapshotted_data.MinimumBidHold != source_data.MinimumBidHold
        or
        (
            ((snapshotted_data.MinimumBidHold is null) and not (source_data.MinimumBidHold is null))
            or
            ((not snapshotted_data.MinimumBidHold is null) and (source_data.MinimumBidHold is null))
        ) or snapshotted_data.BasicplanPrice != source_data.BasicplanPrice
        or
        (
            ((snapshotted_data.BasicplanPrice is null) and not (source_data.BasicplanPrice is null))
            or
            ((not snapshotted_data.BasicplanPrice is null) and (source_data.BasicplanPrice is null))
        ) or snapshotted_data.ProPhotographyPrice != source_data.ProPhotographyPrice
        or
        (
            ((snapshotted_data.ProPhotographyPrice is null) and not (source_data.ProPhotographyPrice is null))
            or
            ((not snapshotted_data.ProPhotographyPrice is null) and (source_data.ProPhotographyPrice is null))
        ) or snapshotted_data.ProMarketingPrice != source_data.ProMarketingPrice
        or
        (
            ((snapshotted_data.ProMarketingPrice is null) and not (source_data.ProMarketingPrice is null))
            or
            ((not snapshotted_data.ProMarketingPrice is null) and (source_data.ProMarketingPrice is null))
        ) or snapshotted_data.Minfraudscore != source_data.Minfraudscore
        or
        (
            ((snapshotted_data.Minfraudscore is null) and not (source_data.Minfraudscore is null))
            or
            ((not snapshotted_data.Minfraudscore is null) and (source_data.Minfraudscore is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.MaximumBidCharge != source_data.MaximumBidCharge
        or
        (
            ((snapshotted_data.MaximumBidCharge is null) and not (source_data.MaximumBidCharge is null))
            or
            ((not snapshotted_data.MaximumBidCharge is null) and (source_data.MaximumBidCharge is null))
        ) or snapshotted_data.BidHoldPercentage != source_data.BidHoldPercentage
        or
        (
            ((snapshotted_data.BidHoldPercentage is null) and not (source_data.BidHoldPercentage is null))
            or
            ((not snapshotted_data.BidHoldPercentage is null) and (source_data.BidHoldPercentage is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_temp_view"
    end



    
21:58:12.846329 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.29 seconds
21:58:12.848044 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Mediavariations_Incr: COMMIT
21:58:12.848829 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Mediavariations_Incr".
21:58:12.848980 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Mediavariations_Incr: 
    
  if object_id ('"stg"."#AH_Mediavariations_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Mediavariations_Incr__dbt_tmp"
    end

21:58:12.888489 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:12.900493 [debug] [Thread-2  ]: finished collecting timing info
21:58:12.900894 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Mediavariations_Incr: Close
21:58:12.901633 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00d460d0>]}
21:58:12.902137 [info ] [Thread-2  ]: 67 of 101 OK snapshotted stg.AH_Mediavariations_Incr............................ [[32mOK[0m in 47.83s]
21:58:12.902520 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Mediavariations_Incr
21:58:12.902756 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_PaymentResponses_Incr
21:58:12.903117 [info ] [Thread-2  ]: 73 of 101 START snapshot stg.AH_PaymentResponses_Incr........................... [RUN]
21:58:12.903567 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr"
21:58:12.903722 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_PaymentResponses_Incr
21:58:12.903858 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_PaymentResponses_Incr
21:58:12.906669 [debug] [Thread-2  ]: finished collecting timing info
21:58:12.906875 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_PaymentResponses_Incr
21:58:12.909612 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:12.909794 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:12.909922 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:58:12.910062 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:13.008641 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:13.038788 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:58:13.061054 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:13.061448 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:13.091745 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:13.094362 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:13.094696 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentResponses_InterView]
        ) as __dbt_sbq
    
21:58:13.158693 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:13.179686 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:13.180077 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        ) as __dbt_sbq
    
21:58:13.228838 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:13.232441 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:13.232760 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
21:58:13.306913 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:13.311233 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:13.311534 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentResponses_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780''), CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:13.079780'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Approved != source_data.Approved
        or
        (
            ((snapshotted_data.Approved is null) and not (source_data.Approved is null))
            or
            ((not snapshotted_data.Approved is null) and (source_data.Approved is null))
        ) or snapshotted_data.InvoiceID != source_data.InvoiceID
        or
        (
            ((snapshotted_data.InvoiceID is null) and not (source_data.InvoiceID is null))
            or
            ((not snapshotted_data.InvoiceID is null) and (source_data.InvoiceID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.AuthorizationCode != source_data.AuthorizationCode
        or
        (
            ((snapshotted_data.AuthorizationCode is null) and not (source_data.AuthorizationCode is null))
            or
            ((not snapshotted_data.AuthorizationCode is null) and (source_data.AuthorizationCode is null))
        ) or snapshotted_data.AvsResponseCode != source_data.AvsResponseCode
        or
        (
            ((snapshotted_data.AvsResponseCode is null) and not (source_data.AvsResponseCode is null))
            or
            ((not snapshotted_data.AvsResponseCode is null) and (source_data.AvsResponseCode is null))
        ) or snapshotted_data.Cvv2ResponseCode != source_data.Cvv2ResponseCode
        or
        (
            ((snapshotted_data.Cvv2ResponseCode is null) and not (source_data.Cvv2ResponseCode is null))
            or
            ((not snapshotted_data.Cvv2ResponseCode is null) and (source_data.Cvv2ResponseCode is null))
        ) or snapshotted_data.CavResponseCode != source_data.CavResponseCode
        or
        (
            ((snapshotted_data.CavResponseCode is null) and not (source_data.CavResponseCode is null))
            or
            ((not snapshotted_data.CavResponseCode is null) and (source_data.CavResponseCode is null))
        ) or snapshotted_data.BuyerStreet != source_data.BuyerStreet
        or
        (
            ((snapshotted_data.BuyerStreet is null) and not (source_data.BuyerStreet is null))
            or
            ((not snapshotted_data.BuyerStreet is null) and (source_data.BuyerStreet is null))
        ) or snapshotted_data.BuyerCity != source_data.BuyerCity
        or
        (
            ((snapshotted_data.BuyerCity is null) and not (source_data.BuyerCity is null))
            or
            ((not snapshotted_data.BuyerCity is null) and (source_data.BuyerCity is null))
        ) or snapshotted_data.ResponseStatus != source_data.ResponseStatus
        or
        (
            ((snapshotted_data.ResponseStatus is null) and not (source_data.ResponseStatus is null))
            or
            ((not snapshotted_data.ResponseStatus is null) and (source_data.ResponseStatus is null))
        ) or snapshotted_data.ProvIDEr != source_data.ProvIDEr
        or
        (
            ((snapshotted_data.ProvIDEr is null) and not (source_data.ProvIDEr is null))
            or
            ((not snapshotted_data.ProvIDEr is null) and (source_data.ProvIDEr is null))
        ) or snapshotted_data.RawResponseCode != source_data.RawResponseCode
        or
        (
            ((snapshotted_data.RawResponseCode is null) and not (source_data.RawResponseCode is null))
            or
            ((not snapshotted_data.RawResponseCode is null) and (source_data.RawResponseCode is null))
        ) or snapshotted_data.Description != source_data.Description
        or
        (
            ((snapshotted_data.Description is null) and not (source_data.Description is null))
            or
            ((not snapshotted_data.Description is null) and (source_data.Description is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Method != source_data.Method
        or
        (
            ((snapshotted_data.Method is null) and not (source_data.Method is null))
            or
            ((not snapshotted_data.Method is null) and (source_data.Method is null))
        ) or snapshotted_data.BuyerStateregion != source_data.BuyerStateregion
        or
        (
            ((snapshotted_data.BuyerStateregion is null) and not (source_data.BuyerStateregion is null))
            or
            ((not snapshotted_data.BuyerStateregion is null) and (source_data.BuyerStateregion is null))
        ) or snapshotted_data.BuyerzipPostal != source_data.BuyerzipPostal
        or
        (
            ((snapshotted_data.BuyerzipPostal is null) and not (source_data.BuyerzipPostal is null))
            or
            ((not snapshotted_data.BuyerzipPostal is null) and (source_data.BuyerzipPostal is null))
        ) or snapshotted_data.BuyerEmail != source_data.BuyerEmail
        or
        (
            ((snapshotted_data.BuyerEmail is null) and not (source_data.BuyerEmail is null))
            or
            ((not snapshotted_data.BuyerEmail is null) and (source_data.BuyerEmail is null))
        ) or snapshotted_data.AllFields != source_data.AllFields
        or
        (
            ((snapshotted_data.AllFields is null) and not (source_data.AllFields is null))
            or
            ((not snapshotted_data.AllFields is null) and (source_data.AllFields is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentResponses_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentResponses_Incr__dbt_tmp_temp_view"
    end



    
21:58:21.016643 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 13.52 seconds
21:58:21.019830 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:21.020000 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:21.057015 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:21.058414 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:21.058716 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
21:58:22.252559 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
21:58:22.254488 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:22.254764 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:22.330309 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:22.332855 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:22.333091 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:22.607646 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:58:22.610821 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:22.611092 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
21:58:22.647862 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:22.652258 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:22.652517 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:22.709314 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:22.710739 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:22.710999 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
21:58:23.855052 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:58:23.856582 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:23.856752 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:23.890581 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:23.892962 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:23.893151 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:23.939859 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 12.07 seconds
21:58:23.943415 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:23.943664 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:23.981162 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:23.982744 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:23.982986 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
21:58:24.176115 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:58:24.178879 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:24.179059 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr'
      and table_schema = 'stg'
  
21:58:24.216186 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:24.220558 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:24.220809 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:24.261159 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:24.262643 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:24.262909 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
    
21:58:24.933746 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:58:24.935329 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:24.935517 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:25.049945 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:58:25.052820 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:25.053026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:25.488250 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
21:58:25.490981 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:25.491165 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
21:58:25.618785 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:58:25.624766 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:25.625058 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:25.722792 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:58:25.724600 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:25.724833 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
21:58:25.892914 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.63 seconds
21:58:25.894675 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:25.894991 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Offers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:25.929934 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:25.932703 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:25.932976 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Offers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:26.158260 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:58:26.160532 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Offers_Incr"
21:58:26.160920 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:26.161036 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Offers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Offers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Offers_Incr" (
                  "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Amount", "LastUpdatedUser", "OfferMessage", "Status", "DecLineMessage", "CreatedOn", "UpdatedOn", "DeletedOn", "Expirationdttm", "SEndingUserID", "ReceivINgUserID", "BuyerID", "Quantity", "ListingID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Offers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:26.673327 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:58:26.674954 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:26.675191 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:26.709091 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:26.711664 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:26.711882 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:26.966611 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:58:26.969605 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:26.969864 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr'
      and table_schema = 'stg'
  
21:58:26.982013 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 20.73 seconds
21:58:26.985126 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:26.985453 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:27.004412 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:27.008582 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:27.008822 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:27.034434 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:27.035960 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:27.036192 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
21:58:27.051724 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:27.053267 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:27.053512 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    
21:58:27.638402 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:58:27.640188 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Offers_Incr: COMMIT
21:58:27.641067 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Offers_Incr".
21:58:27.641268 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Offers_Incr: 
    
  if object_id ('"stg"."#AH_Offers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Offers_Incr__dbt_tmp"
    end

21:58:27.680216 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:27.768298 [debug] [Thread-4  ]: finished collecting timing info
21:58:27.768701 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Offers_Incr: Close
21:58:27.769395 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081946a0>]}
21:58:27.769870 [info ] [Thread-4  ]: 71 of 101 OK snapshotted stg.AH_Offers_Incr..................................... [[32mOK[0m in 20.94s]
21:58:27.770263 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Offers_Incr
21:58:27.770456 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:58:27.770825 [info ] [Thread-4  ]: 74 of 101 START snapshot stg.AH_PaymentprovIDErs_Incr........................... [RUN]
21:58:27.771250 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
21:58:27.771406 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:58:27.771556 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:58:27.774242 [debug] [Thread-4  ]: finished collecting timing info
21:58:27.774433 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:58:27.777015 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:27.777194 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:27.777319 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:58:27.777457 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:27.899545 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:27.928441 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:58:27.951055 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:27.951422 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:27.984289 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:27.986405 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:27.986667 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]
        ) as __dbt_sbq
    
21:58:28.006805 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:58:28.008292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:28.008504 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:28.045702 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:28.061765 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:28.064375 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:28.064604 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentConfigurationTable_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:28.070385 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:28.070595 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        ) as __dbt_sbq
    
21:58:28.117413 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:28.121721 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:28.121972 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
21:58:28.200854 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:28.204367 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:28.204627 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PaymentprovIDErs_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717''), CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:27.970717'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.Batchcapable != source_data.Batchcapable
        or
        (
            ((snapshotted_data.Batchcapable is null) and not (source_data.Batchcapable is null))
            or
            ((not snapshotted_data.Batchcapable is null) and (source_data.Batchcapable is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_temp_view"
    end



    
21:58:28.281026 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:58:28.283327 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentConfigurationTable_Incr"
21:58:28.283872 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:28.284054 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentConfigurationTable_Incr" (
                  "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Active", "MinimumBidHold", "BasicplanPrice", "ProPhotographyPrice", "ProMarketingPrice", "Minfraudscore", "UpdatedOn", "CreatedOn", "MaximumBidCharge", "BidHoldPercentage", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:28.833292 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.80 seconds
21:58:28.834998 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:28.835241 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:28.911075 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:28.914275 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:28.914531 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:29.189041 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:58:29.191812 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:29.192006 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
21:58:29.264737 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:29.269457 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:29.269722 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:29.307264 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:29.308989 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:29.309206 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
21:58:29.645858 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.36 seconds
21:58:29.647573 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: COMMIT
21:58:29.648379 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentConfigurationTable_Incr".
21:58:29.648571 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: 
    
  if object_id ('"stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentConfigurationTable_Incr__dbt_tmp"
    end

21:58:29.706460 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:29.718011 [debug] [Thread-3  ]: finished collecting timing info
21:58:29.718353 [debug] [Thread-3  ]: On snapshot.Shawn.AH_PaymentConfigurationTable_Incr: Close
21:58:29.719032 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194a90>]}
21:58:29.719500 [info ] [Thread-3  ]: 72 of 101 OK snapshotted stg.AH_PaymentConfigurationTable_Incr.................. [[32mOK[0m in 18.29s]
21:58:29.719855 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_PaymentConfigurationTable_Incr
21:58:29.720035 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Properties_Incr
21:58:29.720356 [info ] [Thread-3  ]: 75 of 101 START snapshot stg.AH_Properties_Incr................................. [RUN]
21:58:29.720753 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Properties_Incr"
21:58:29.720903 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Properties_Incr
21:58:29.721033 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Properties_Incr
21:58:29.723611 [debug] [Thread-3  ]: finished collecting timing info
21:58:29.723798 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Properties_Incr
21:58:29.726415 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:29.726614 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:29.726750 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:58:29.726885 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:29.866802 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:29.912223 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:58:29.934169 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:29.934535 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:29.979797 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:29.982227 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:29.982447 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Properties_InterView]
        ) as __dbt_sbq
    
21:58:30.099616 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:58:30.120557 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:30.121453 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        ) as __dbt_sbq
    
21:58:30.185798 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:30.189041 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:30.189288 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
21:58:30.276550 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:30.280045 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:30.280312 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Properties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Properties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058''), CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:29.955058'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LineItemID != source_data.LineItemID
        or
        (
            ((snapshotted_data.LineItemID is null) and not (source_data.LineItemID is null))
            or
            ((not snapshotted_data.LineItemID is null) and (source_data.LineItemID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Properties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Properties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Properties_Incr__dbt_tmp_temp_view"
    end



    
21:58:31.148925 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.84 seconds
21:58:31.150497 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:31.150706 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:31.188656 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:31.191652 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:31.191925 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:31.435544 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:58:31.438843 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:31.439184 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr'
      and table_schema = 'stg'
  
21:58:31.483117 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:31.487817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:31.488170 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:31.539273 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:31.541344 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:31.541624 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
    
21:58:32.156282 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 18.84 seconds
21:58:32.160582 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:32.160821 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:32.238888 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:32.240510 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:32.240748 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
21:58:34.181292 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.98 seconds
21:58:34.184587 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:34.184865 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:34.221563 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:34.223201 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:34.223455 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
21:58:34.329660 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.09 seconds
21:58:34.331285 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:34.331513 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:34.342553 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
21:58:34.344042 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:34.344270 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:34.415887 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:34.418820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:34.419129 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Notifications_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:34.440884 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:58:34.444308 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:34.444643 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:34.665729 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:58:34.668045 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Notifications_Incr"
21:58:34.668635 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:34.668826 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Notifications_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Notifications_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Notifications_Incr" (
                  "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DetailID", "CreatedOn", "UpdatedOn", "DeletedOn", "Queueddttm", "Statusdttm", "RecipientEmail", "CcEmail", "BCcEmail", "LastUpdatedUser", "Status", "StatusMessage", "Message", "DetailType", "ReplytoEmail", "SEnderUserName", "ReceiverUserName", "Template", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Notifications_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:34.698626 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:58:34.701608 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:34.702207 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
21:58:34.743087 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:34.747568 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:34.747907 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:34.802223 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:34.804106 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:34.804357 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
21:58:35.192235 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.97 seconds
21:58:35.193646 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:35.193834 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:35.322726 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:58:35.325084 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:35.325289 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:35.514420 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:58:35.517527 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:35.517766 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
21:58:35.555890 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:35.560171 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:35.560496 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:35.605424 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:35.607021 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:35.607293 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
21:58:36.142808 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.86 seconds
21:58:36.145913 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:36.146129 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:36.191227 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:36.192777 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:36.193041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
21:58:36.514269 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.71 seconds
21:58:36.515948 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:36.516189 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:36.540651 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.87 seconds
21:58:36.542287 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Notifications_Incr: COMMIT
21:58:36.543086 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Notifications_Incr".
21:58:36.543270 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Notifications_Incr: 
    
  if object_id ('"stg"."#AH_Notifications_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Notifications_Incr__dbt_tmp"
    end

21:58:36.548802 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:58:36.550174 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:36.550392 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:36.552474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:36.555126 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:36.555319 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:36.580846 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:36.582205 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:36.584424 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:36.595749 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:36.597009 [debug] [Thread-1  ]: finished collecting timing info
21:58:36.597309 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Notifications_Incr: Close
21:58:36.598007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081942b0>]}
21:58:36.598502 [info ] [Thread-1  ]: 70 of 101 OK snapshotted stg.AH_Notifications_Incr.............................. [[32mOK[0m in 30.80s]
21:58:36.598929 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Notifications_Incr
21:58:36.599117 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_PropertybagItems_Incr
21:58:36.599468 [info ] [Thread-1  ]: 76 of 101 START snapshot stg.AH_PropertybagItems_Incr........................... [RUN]
21:58:36.599925 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr"
21:58:36.600079 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_PropertybagItems_Incr
21:58:36.600215 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_PropertybagItems_Incr
21:58:36.603059 [debug] [Thread-1  ]: finished collecting timing info
21:58:36.603273 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_PropertybagItems_Incr
21:58:36.606361 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:36.606611 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:36.606763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:58:36.606903 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:36.721462 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:36.749689 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:58:36.771411 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:36.771802 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:36.791552 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:58:36.794575 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:36.794880 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr'
      and table_schema = 'stg'
  
21:58:36.800808 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:36.802593 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:36.802800 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_PropertybagItems_InterView]
        ) as __dbt_sbq
    
21:58:36.833451 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:36.838275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:36.838612 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:36.856059 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:36.874071 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:58:36.877465 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:36.882313 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr'
      and table_schema = 'stg'
  
21:58:36.877656 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:36.883467 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:36.883670 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    
21:58:36.882049 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:36.883935 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        ) as __dbt_sbq
    
21:58:36.934921 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:36.939808 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:36.940142 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:36.956052 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:36.960649 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:36.961010 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
21:58:37.027377 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:37.030820 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:37.031041 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:37.032253 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:37.032436 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    
21:58:37.031250 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_PropertybagItems_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292''), CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:36.783292'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.PropertybagID != source_data.PropertybagID
        or
        (
            ((snapshotted_data.PropertybagID is null) and not (source_data.PropertybagID is null))
            or
            ((not snapshotted_data.PropertybagID is null) and (source_data.PropertybagID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_PropertybagItems_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_PropertybagItems_Incr__dbt_tmp_temp_view"
    end



    
21:58:37.227184 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:58:37.228752 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:37.228926 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:37.305099 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:37.307874 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:37.308055 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:37.550676 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:58:37.553597 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:37.553903 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
21:58:37.589160 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:37.593203 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:37.593511 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:37.631059 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:37.632971 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:37.633238 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
21:58:37.958509 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
21:58:37.960230 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:37.960508 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:37.994204 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:37.996800 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:37.997053 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentprovIDErs_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:38.120506 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:58:38.122200 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:38.122439 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:38.166881 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:38.169917 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:38.170230 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PaymentResponses_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:38.208122 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:58:38.210295 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentprovIDErs_Incr"
21:58:38.210868 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:38.211046 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentprovIDErs_Incr" (
                  "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "LastUpdatedUser", "DeletedOn", "CreatedOn", "UpdatedOn", "Batchcapable", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:38.395631 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:58:38.398244 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PaymentResponses_Incr"
21:58:38.398872 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:38.399066 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PaymentResponses_Incr" (
                  "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Approved", "InvoiceID", "CreatedOn", "UpdatedOn", "DeletedOn", "DaTestamp", "Amount", "AuthorizationCode", "AvsResponseCode", "Cvv2ResponseCode", "CavResponseCode", "BuyerStreet", "BuyerCity", "ResponseStatus", "ProvIDEr", "RawResponseCode", "Description", "TransactionID", "Method", "BuyerStateregion", "BuyerzipPostal", "BuyerEmail", "AllFields", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PaymentResponses_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:38.465619 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:58:38.467674 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:38.467984 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:38.508823 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:38.511487 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:38.511847 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:38.780161 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:58:38.783100 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:38.783353 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr'
      and table_schema = 'stg'
  
21:58:38.818320 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:38.822962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:38.823285 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:38.897683 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:38.899303 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:38.899542 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
    
21:58:39.692490 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.48 seconds
21:58:39.694159 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: COMMIT
21:58:39.694944 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentprovIDErs_Incr".
21:58:39.695108 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: 
    
  if object_id ('"stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentprovIDErs_Incr__dbt_tmp"
    end

21:58:39.732119 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:39.744151 [debug] [Thread-4  ]: finished collecting timing info
21:58:39.744565 [debug] [Thread-4  ]: On snapshot.Shawn.AH_PaymentprovIDErs_Incr: Close
21:58:39.745302 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194d30>]}
21:58:39.745811 [info ] [Thread-4  ]: 74 of 101 OK snapshotted stg.AH_PaymentprovIDErs_Incr........................... [[32mOK[0m in 11.97s]
21:58:39.746190 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_PaymentprovIDErs_Incr
21:58:39.746374 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Propertybags_Incr
21:58:39.746746 [info ] [Thread-4  ]: 77 of 101 START snapshot stg.AH_Propertybags_Incr............................... [RUN]
21:58:39.747177 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Propertybags_Incr"
21:58:39.747330 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Propertybags_Incr
21:58:39.747463 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Propertybags_Incr
21:58:39.750108 [debug] [Thread-4  ]: finished collecting timing info
21:58:39.750303 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Propertybags_Incr
21:58:39.753077 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:39.753294 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:39.753430 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:58:39.753567 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:39.871730 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:39.901848 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:58:39.923942 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:39.924323 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:39.952355 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:39.954912 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:39.955226 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Propertybags_InterView]
        ) as __dbt_sbq
    
21:58:40.016505 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:40.037394 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:40.037791 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        ) as __dbt_sbq
    
21:58:40.087842 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:40.092488 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:40.092811 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
21:58:40.195518 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:58:40.199088 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:40.199437 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Propertybags_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Propertybags_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657''), CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:39.939657'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Propertybags_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Propertybags_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Propertybags_Incr__dbt_tmp_temp_view"
    end



    
21:58:40.223603 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:58:40.225288 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:40.225520 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Properties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:40.269606 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:40.272234 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:40.272518 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Properties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:40.299140 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.90 seconds
21:58:40.300891 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: COMMIT
21:58:40.301751 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PaymentResponses_Incr".
21:58:40.301951 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_PaymentResponses_Incr: 
    
  if object_id ('"stg"."#AH_PaymentResponses_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PaymentResponses_Incr__dbt_tmp"
    end

21:58:40.348475 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:40.359961 [debug] [Thread-2  ]: finished collecting timing info
21:58:40.360368 [debug] [Thread-2  ]: On snapshot.Shawn.AH_PaymentResponses_Incr: Close
21:58:40.361092 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081947f0>]}
21:58:40.361598 [info ] [Thread-2  ]: 73 of 101 OK snapshotted stg.AH_PaymentResponses_Incr........................... [[32mOK[0m in 27.46s]
21:58:40.361979 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_PaymentResponses_Incr
21:58:40.362163 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ReListHistory_Incr
21:58:40.362507 [info ] [Thread-2  ]: 78 of 101 START snapshot stg.AH_ReListHistory_Incr.............................. [RUN]
21:58:40.362978 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ReListHistory_Incr"
21:58:40.363140 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ReListHistory_Incr
21:58:40.363275 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ReListHistory_Incr
21:58:40.365923 [debug] [Thread-2  ]: finished collecting timing info
21:58:40.366182 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ReListHistory_Incr
21:58:40.368889 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:40.369086 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:40.369217 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:58:40.369349 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:40.480985 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:40.487985 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:58:40.489943 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Properties_Incr"
21:58:40.490433 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:40.490643 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Properties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Properties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Properties_Incr" (
                  "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Value", "Name", "CreatedOn", "UpdatedOn", "DeletedOn", "LineItemID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Properties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:40.509817 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:58:40.531425 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:40.531820 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:40.563312 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:40.565503 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:40.566133 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ReListHistory_InterView]
        ) as __dbt_sbq
    
21:58:40.626598 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:40.647460 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:40.647858 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        ) as __dbt_sbq
    
21:58:40.742002 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:40.745694 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:40.746014 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
21:58:40.815495 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:40.819645 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:40.819975 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ReListHistory_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ReListHistory_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975''), CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:40.548975'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CurrentPrice_Old != source_data.CurrentPrice_Old
        or
        (
            ((snapshotted_data.CurrentPrice_Old is null) and not (source_data.CurrentPrice_Old is null))
            or
            ((not snapshotted_data.CurrentPrice_Old is null) and (source_data.CurrentPrice_Old is null))
        ) or snapshotted_data.CurrentPrice_New != source_data.CurrentPrice_New
        or
        (
            ((snapshotted_data.CurrentPrice_New is null) and not (source_data.CurrentPrice_New is null))
            or
            ((not snapshotted_data.CurrentPrice_New is null) and (source_data.CurrentPrice_New is null))
        ) or snapshotted_data.ReservePrice != source_data.ReservePrice
        or
        (
            ((snapshotted_data.ReservePrice is null) and not (source_data.ReservePrice is null))
            or
            ((not snapshotted_data.ReservePrice is null) and (source_data.ReservePrice is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.NewreListiteration != source_data.NewreListiteration
        or
        (
            ((snapshotted_data.NewreListiteration is null) and not (source_data.NewreListiteration is null))
            or
            ((not snapshotted_data.NewreListiteration is null) and (source_data.NewreListiteration is null))
        ) or snapshotted_data.Duration_Old != source_data.Duration_Old
        or
        (
            ((snapshotted_data.Duration_Old is null) and not (source_data.Duration_Old is null))
            or
            ((not snapshotted_data.Duration_Old is null) and (source_data.Duration_Old is null))
        ) or snapshotted_data.Duration_New != source_data.Duration_New
        or
        (
            ((snapshotted_data.Duration_New is null) and not (source_data.Duration_New is null))
            or
            ((not snapshotted_data.Duration_New is null) and (source_data.Duration_New is null))
        ) or snapshotted_data.HighBidderID != source_data.HighBidderID
        or
        (
            ((snapshotted_data.HighBidderID is null) and not (source_data.HighBidderID is null))
            or
            ((not snapshotted_data.HighBidderID is null) and (source_data.HighBidderID is null))
        ) or snapshotted_data.BidCount != source_data.BidCount
        or
        (
            ((snapshotted_data.BidCount is null) and not (source_data.BidCount is null))
            or
            ((not snapshotted_data.BidCount is null) and (source_data.BidCount is null))
        ) or snapshotted_data.Startdttm_New != source_data.Startdttm_New
        or
        (
            ((snapshotted_data.Startdttm_New is null) and not (source_data.Startdttm_New is null))
            or
            ((not snapshotted_data.Startdttm_New is null) and (source_data.Startdttm_New is null))
        ) or snapshotted_data.Enddttm_Old != source_data.Enddttm_Old
        or
        (
            ((snapshotted_data.Enddttm_Old is null) and not (source_data.Enddttm_Old is null))
            or
            ((not snapshotted_data.Enddttm_Old is null) and (source_data.Enddttm_Old is null))
        ) or snapshotted_data.Enddttm_New != source_data.Enddttm_New
        or
        (
            ((snapshotted_data.Enddttm_New is null) and not (source_data.Enddttm_New is null))
            or
            ((not snapshotted_data.Enddttm_New is null) and (source_data.Enddttm_New is null))
        ) or snapshotted_data.ReListdttm != source_data.ReListdttm
        or
        (
            ((snapshotted_data.ReListdttm is null) and not (source_data.ReListdttm is null))
            or
            ((not snapshotted_data.ReListdttm is null) and (source_data.ReListdttm is null))
        ) or snapshotted_data.Startdttm_Old != source_data.Startdttm_Old
        or
        (
            ((snapshotted_data.Startdttm_Old is null) and not (source_data.Startdttm_Old is null))
            or
            ((not snapshotted_data.Startdttm_Old is null) and (source_data.Startdttm_Old is null))
        ) or snapshotted_data.MaxBidAmount != source_data.MaxBidAmount
        or
        (
            ((snapshotted_data.MaxBidAmount is null) and not (source_data.MaxBidAmount is null))
            or
            ((not snapshotted_data.MaxBidAmount is null) and (source_data.MaxBidAmount is null))
        ) or snapshotted_data.ProxyBidAmount != source_data.ProxyBidAmount
        or
        (
            ((snapshotted_data.ProxyBidAmount is null) and not (source_data.ProxyBidAmount is null))
            or
            ((not snapshotted_data.ProxyBidAmount is null) and (source_data.ProxyBidAmount is null))
        ) or snapshotted_data.BidIncrement != source_data.BidIncrement
        or
        (
            ((snapshotted_data.BidIncrement is null) and not (source_data.BidIncrement is null))
            or
            ((not snapshotted_data.BidIncrement is null) and (source_data.BidIncrement is null))
        ) or snapshotted_data.ListingTitle != source_data.ListingTitle
        or
        (
            ((snapshotted_data.ListingTitle is null) and not (source_data.ListingTitle is null))
            or
            ((not snapshotted_data.ListingTitle is null) and (source_data.ListingTitle is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ReListHistory_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ReListHistory_Incr__dbt_tmp_temp_view"
    end



    
21:58:42.079711 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.59 seconds
21:58:42.081388 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Properties_Incr: COMMIT
21:58:42.082156 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Properties_Incr".
21:58:42.082304 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Properties_Incr: 
    
  if object_id ('"stg"."#AH_Properties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Properties_Incr__dbt_tmp"
    end

21:58:42.118923 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:42.130963 [debug] [Thread-3  ]: finished collecting timing info
21:58:42.131463 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Properties_Incr: Close
21:58:42.132211 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc080e55b0>]}
21:58:42.133297 [info ] [Thread-3  ]: 75 of 101 OK snapshotted stg.AH_Properties_Incr................................. [[32mOK[0m in 12.41s]
21:58:42.133722 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Properties_Incr
21:58:42.133911 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Reports_Incr
21:58:42.134263 [info ] [Thread-3  ]: 79 of 101 START snapshot stg.AH_Reports_Incr.................................... [RUN]
21:58:42.134754 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Reports_Incr"
21:58:42.134916 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Reports_Incr
21:58:42.135048 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Reports_Incr
21:58:42.137911 [debug] [Thread-3  ]: finished collecting timing info
21:58:42.138121 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Reports_Incr
21:58:42.141125 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:42.141328 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:42.141457 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:58:42.141593 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:42.268879 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:42.307867 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:58:42.329534 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:42.329920 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:42.367854 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:42.370382 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:42.370729 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Reports_InterView]
        ) as __dbt_sbq
    
21:58:42.463995 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:42.485270 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:42.485662 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        ) as __dbt_sbq
    
21:58:42.540130 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:42.543802 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:42.544069 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
21:58:42.615782 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:42.619548 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:42.619862 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Reports_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Reports_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883''), CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:42.345883'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SecondstogeneRate != source_data.SecondstogeneRate
        or
        (
            ((snapshotted_data.SecondstogeneRate is null) and not (source_data.SecondstogeneRate is null))
            or
            ((not snapshotted_data.SecondstogeneRate is null) and (source_data.SecondstogeneRate is null))
        ) or snapshotted_data.ReportName != source_data.ReportName
        or
        (
            ((snapshotted_data.ReportName is null) and not (source_data.ReportName is null))
            or
            ((not snapshotted_data.ReportName is null) and (source_data.ReportName is null))
        ) or snapshotted_data.Data != source_data.Data
        or
        (
            ((snapshotted_data.Data is null) and not (source_data.Data is null))
            or
            ((not snapshotted_data.Data is null) and (source_data.Data is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Reports_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Reports_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Reports_Incr__dbt_tmp_temp_view"
    end



    
21:58:43.201455 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.17 seconds
21:58:43.204968 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:43.205217 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:43.244819 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:43.246431 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:43.246718 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
21:58:44.500167 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.25 seconds
21:58:44.501761 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:44.501941 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:44.603034 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:58:44.605547 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:44.605766 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:44.856259 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:58:44.859335 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:44.859552 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
21:58:44.910864 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:44.916165 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:44.916446 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:44.961672 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:44.963305 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:44.963534 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
21:58:45.213959 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.59 seconds
21:58:45.217574 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:45.217833 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:45.293627 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:45.295260 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:45.295505 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
21:58:45.942927 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
21:58:45.944537 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:45.944736 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:45.979924 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:45.982304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:45.982595 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:46.152313 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.95 seconds
21:58:46.155760 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:46.155950 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:46.194856 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.90 seconds
21:58:46.196450 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:46.196705 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:46.210317 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:46.211709 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:46.211932 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
21:58:46.235651 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:58:46.238877 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:46.239183 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr'
      and table_schema = 'stg'
  
21:58:46.271788 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:46.273695 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:46.276012 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:46.276229 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:46.278870 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:46.279061 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:46.315062 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:46.316617 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:46.316823 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    
21:58:46.501478 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:58:46.504782 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:46.505091 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
21:58:46.551094 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:46.555315 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:46.555630 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:46.597261 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:46.598803 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:46.599026 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
21:58:47.224221 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
21:58:47.225678 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:47.225853 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:47.227208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:58:47.228180 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:47.228308 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:47.263548 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:47.266158 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:47.266336 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_PropertybagItems_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:47.311072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:47.313559 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:47.313805 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:47.482720 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:58:47.484899 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_PropertybagItems_Incr"
21:58:47.485448 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:47.485683 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:58:47.486962 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:47.487154 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:47.485847 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_PropertybagItems_Incr" (
                  "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "PropertybagID", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "Value", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_PropertybagItems_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:47.522882 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:47.525376 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:47.525613 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:47.549660 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:58:47.552612 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:47.552846 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
21:58:47.592782 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:47.596674 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:47.596928 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:47.662457 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:47.663965 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:47.664180 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
21:58:47.752375 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:58:47.755438 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:47.755714 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr'
      and table_schema = 'stg'
  
21:58:47.823866 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:47.827903 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:47.828196 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:47.863861 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:47.865418 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:47.865655 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
    
21:58:48.698701 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:58:48.700246 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:48.700448 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:48.740996 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:48.743412 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:48.743597 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:48.948646 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:58:48.954001 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:48.954276 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr'
      and table_schema = 'stg'
  
21:58:49.005317 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:49.010017 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:49.010804 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:49.074969 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:49.076483 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:49.076729 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
    
21:58:49.100626 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:58:49.102130 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:49.102370 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Reports_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:49.142312 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:49.144878 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:49.145132 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Reports_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:49.158399 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.67 seconds
21:58:49.160384 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: COMMIT
21:58:49.161205 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_PropertybagItems_Incr".
21:58:49.161396 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_PropertybagItems_Incr: 
    
  if object_id ('"stg"."#AH_PropertybagItems_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_PropertybagItems_Incr__dbt_tmp"
    end

21:58:49.213791 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:49.224760 [debug] [Thread-1  ]: finished collecting timing info
21:58:49.225129 [debug] [Thread-1  ]: On snapshot.Shawn.AH_PropertybagItems_Incr: Close
21:58:49.225825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08194be0>]}
21:58:49.226298 [info ] [Thread-1  ]: 76 of 101 OK snapshotted stg.AH_PropertybagItems_Incr........................... [[32mOK[0m in 12.63s]
21:58:49.226710 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_PropertybagItems_Incr
21:58:49.226897 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Roles_Incr
21:58:49.227232 [info ] [Thread-1  ]: 80 of 101 START snapshot stg.AH_Roles_Incr...................................... [RUN]
21:58:49.227651 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Roles_Incr"
21:58:49.227803 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Roles_Incr
21:58:49.227936 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Roles_Incr
21:58:49.230567 [debug] [Thread-1  ]: finished collecting timing info
21:58:49.230762 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Roles_Incr
21:58:49.233772 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:49.233951 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:49.234074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:58:49.234207 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:49.352958 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:49.389875 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:58:49.411213 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:49.411579 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:49.412833 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
21:58:49.414609 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Reports_Incr"
21:58:49.415068 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:49.415225 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Reports_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Reports_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Reports_Incr" (
                  "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SecondstogeneRate", "ReportName", "Data", "LastUpdatedUser", "CreatedOn", "UpdatedOn", "DeletedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Reports_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:49.439128 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:49.441284 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:49.441892 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Roles_InterView]
        ) as __dbt_sbq
    
21:58:49.519129 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:49.540683 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:49.541051 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        ) as __dbt_sbq
    
21:58:49.590404 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:49.593926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:49.594206 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
21:58:49.678977 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:49.682517 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:49.682790 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Roles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Roles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124''), CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:49.424124'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Roles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Roles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Roles_Incr__dbt_tmp_temp_view"
    end



    
21:58:49.952538 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:58:49.954226 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:49.954467 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:49.995434 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:49.997960 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:49.998219 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Propertybags_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:50.642380 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
21:58:50.644056 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Reports_Incr: COMMIT
21:58:50.644800 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Reports_Incr".
21:58:50.644947 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Reports_Incr: 
    
  if object_id ('"stg"."#AH_Reports_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Reports_Incr__dbt_tmp"
    end

21:58:50.685516 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:50.697100 [debug] [Thread-3  ]: finished collecting timing info
21:58:50.697811 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Reports_Incr: Close
21:58:50.698578 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081962b0>]}
21:58:50.699092 [info ] [Thread-3  ]: 79 of 101 OK snapshotted stg.AH_Reports_Incr.................................... [[32mOK[0m in 8.56s]
21:58:50.699475 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Reports_Incr
21:58:50.699680 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:58:50.700029 [info ] [Thread-3  ]: 81 of 101 START snapshot stg.AH_SMStemplatecontents_Incr........................ [RUN]
21:58:50.700462 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr"
21:58:50.700617 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:58:50.700755 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_SMStemplatecontents_Incr
21:58:50.703597 [debug] [Thread-3  ]: finished collecting timing info
21:58:50.703799 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:58:50.707045 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:50.707226 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:50.707350 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:58:50.707483 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:50.821371 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:50.850094 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:58:50.871809 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:50.872197 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:50.902343 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:50.904521 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:50.905084 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]
        ) as __dbt_sbq
    
21:58:50.949109 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:58:50.951326 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Propertybags_Incr"
21:58:50.951909 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:50.952096 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Propertybags_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Propertybags_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:50.979807 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:51.001564 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:51.001947 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        ) as __dbt_sbq
    
21:58:51.089559 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:58:51.093307 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:51.093583 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
21:58:51.206908 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:58:51.210046 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:51.210302 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplatecontents_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263''), CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:50.877263'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplatecontents_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_temp_view"
    end



    
21:58:52.266844 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:58:52.268533 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Propertybags_Incr: COMMIT
21:58:52.269317 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Propertybags_Incr".
21:58:52.269503 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Propertybags_Incr: 
    
  if object_id ('"stg"."#AH_Propertybags_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Propertybags_Incr__dbt_tmp"
    end

21:58:52.336510 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:52.348758 [debug] [Thread-4  ]: finished collecting timing info
21:58:52.349179 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Propertybags_Incr: Close
21:58:52.349931 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196160>]}
21:58:52.350431 [info ] [Thread-4  ]: 77 of 101 OK snapshotted stg.AH_Propertybags_Incr............................... [[32mOK[0m in 12.60s]
21:58:52.350855 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Propertybags_Incr
21:58:52.351044 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_SMStemplates_Incr
21:58:52.351378 [info ] [Thread-4  ]: 82 of 101 START snapshot stg.AH_SMStemplates_Incr............................... [RUN]
21:58:52.351797 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SMStemplates_Incr"
21:58:52.351948 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_SMStemplates_Incr
21:58:52.352081 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_SMStemplates_Incr
21:58:52.354892 [debug] [Thread-4  ]: finished collecting timing info
21:58:52.355155 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_SMStemplates_Incr
21:58:52.358003 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:52.358191 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:58:52.358317 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:58:52.358457 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:58:52.454950 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:58:52.487745 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:58:52.510166 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:52.510502 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:58:52.542884 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:52.545313 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:52.545552 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SMStemplates_InterView]
        ) as __dbt_sbq
    
21:58:52.607847 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:52.629679 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:52.630034 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        ) as __dbt_sbq
    
21:58:52.683442 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:52.686866 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:52.687125 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
21:58:52.756028 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:52.759758 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:52.760020 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SMStemplates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SMStemplates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913''), CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:58:52.517913'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SMStemplates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SMStemplates_Incr__dbt_tmp_temp_view"
    end



    
21:58:54.108617 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 13.29 seconds
21:58:54.112082 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:54.112340 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:54.149845 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:54.151359 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:54.151561 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
21:58:55.315447 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.63 seconds
21:58:55.318738 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:55.318929 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:55.319123 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.17 seconds
21:58:55.320084 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:55.320214 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:55.378822 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:55.380253 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:55.380469 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
21:58:55.398517 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:55.401003 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:55.401211 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:55.662448 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:58:55.665578 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:55.665827 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
21:58:55.718175 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:55.722635 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:55.722897 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:55.761427 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:55.763050 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:55.763311 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
21:58:56.476895 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.10 seconds
21:58:56.478425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:56.478659 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:56.551207 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:56.553710 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:56.553905 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:56.776441 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:58:56.779432 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:56.779646 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
21:58:56.833595 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:56.837389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:56.837674 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:56.888802 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:56.890921 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:56.891210 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
21:58:57.005650 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.24 seconds
21:58:57.007378 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:57.007625 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:57.042393 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:57.045362 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:57.045672 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:57.306808 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:58:57.309664 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:57.309867 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr'
      and table_schema = 'stg'
  
21:58:57.365324 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:57.371115 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:57.371389 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:57.433850 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:57.435519 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:57.435750 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
    
21:58:57.790775 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.58 seconds
21:58:57.794228 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:57.794578 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:57.858564 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:57.860107 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:57.860346 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
21:58:58.043918 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:58:58.045609 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:58.045852 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:58.081481 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:58:58.084058 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:58.084320 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:58.298723 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:58:58.301948 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:58.302192 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr'
      and table_schema = 'stg'
  
21:58:58.360844 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:58.364869 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:58.365147 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:58.419705 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:58.421156 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:58.421391 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
    
21:58:58.478691 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:58:58.480294 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:58.480525 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:58.525735 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:58:58.528634 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:58.528915 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ReListHistory_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:58.724268 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.96 seconds
21:58:58.727633 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:58.727884 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:58.789829 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:58:58.792111 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ReListHistory_Incr"
21:58:58.792416 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:58:58.793462 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:58.793633 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
21:58:58.794114 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:58:58.794269 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ReListHistory_Incr" (
                  "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CurrentPrice_Old", "CurrentPrice_New", "ReservePrice", "ListingID", "NewreListiteration", "Duration_Old", "Duration_New", "HighBidderID", "BidCount", "Startdttm_New", "Enddttm_Old", "Enddttm_New", "ReListdttm", "Startdttm_Old", "MaxBidAmount", "ProxyBidAmount", "BidIncrement", "ListingTitle", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ReListHistory_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:58.823366 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:58:58.824991 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:58.825223 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:58.902621 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:58.905170 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:58.905420 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:59.144517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:58:59.147524 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:59.147720 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
21:58:59.182069 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:59.186264 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:59.186622 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:59.257170 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:58:59.258803 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:58:59.259041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
21:58:59.332689 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
21:58:59.334335 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:59.334613 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Roles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:59.368782 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:58:59.371445 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:59.371718 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Roles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:58:59.611681 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:58:59.614112 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Roles_Incr"
21:58:59.614683 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:58:59.614877 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Roles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Roles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Roles_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "LastUpdatedUser", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Roles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:58:59.806645 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.01 seconds
21:58:59.808295 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:59.808543 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:58:59.892820 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:58:59.895386 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:58:59.895632 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:00.104892 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:00.108088 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:00.108312 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
21:59:00.149083 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:00.153742 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:00.154014 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:00.193834 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
21:59:00.195530 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:00.195780 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:00.196058 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:00.197147 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:00.197338 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
21:59:00.251445 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:00.253833 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:00.254109 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:00.280878 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.49 seconds
21:59:00.282666 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ReListHistory_Incr: COMMIT
21:59:00.283468 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ReListHistory_Incr".
21:59:00.283648 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ReListHistory_Incr: 
    
  if object_id ('"stg"."#AH_ReListHistory_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ReListHistory_Incr__dbt_tmp"
    end

21:59:00.320812 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:00.415012 [debug] [Thread-2  ]: finished collecting timing info
21:59:00.415427 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ReListHistory_Incr: Close
21:59:00.416171 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196040>]}
21:59:00.416721 [info ] [Thread-2  ]: 78 of 101 OK snapshotted stg.AH_ReListHistory_Incr.............................. [[32mOK[0m in 20.05s]
21:59:00.417117 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ReListHistory_Incr
21:59:00.417301 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_SalesTaxRates_Incr
21:59:00.417637 [info ] [Thread-2  ]: 83 of 101 START snapshot stg.AH_SalesTaxRates_Incr.............................. [RUN]
21:59:00.418068 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr"
21:59:00.418225 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_SalesTaxRates_Incr
21:59:00.418360 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_SalesTaxRates_Incr
21:59:00.421235 [debug] [Thread-2  ]: finished collecting timing info
21:59:00.421442 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_SalesTaxRates_Incr
21:59:00.424030 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:00.424214 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:00.424336 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:59:00.424469 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:00.523621 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:00.555394 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:59:00.577250 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:00.577635 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:00.607424 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:00.609607 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:00.609869 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]
        ) as __dbt_sbq
    
21:59:00.685100 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:00.706876 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:00.707275 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        ) as __dbt_sbq
    
21:59:00.756912 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:00.760768 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:00.761071 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
21:59:00.828279 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:00.831841 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:00.832140 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SalesTaxRates_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210''), CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:00.596210'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Shipping != source_data.Shipping
        or
        (
            ((snapshotted_data.Shipping is null) and not (source_data.Shipping is null))
            or
            ((not snapshotted_data.Shipping is null) and (source_data.Shipping is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.StateID != source_data.StateID
        or
        (
            ((snapshotted_data.StateID is null) and not (source_data.StateID is null))
            or
            ((not snapshotted_data.StateID is null) and (source_data.StateID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.TaxRate != source_data.TaxRate
        or
        (
            ((snapshotted_data.TaxRate is null) and not (source_data.TaxRate is null))
            or
            ((not snapshotted_data.TaxRate is null) and (source_data.TaxRate is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SalesTaxRates_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SalesTaxRates_Incr__dbt_tmp_temp_view"
    end



    
21:59:01.102421 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.85 seconds
21:59:01.105201 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:01.105406 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr'
      and table_schema = 'stg'
  
21:59:01.124222 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.51 seconds
21:59:01.126858 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Roles_Incr: COMMIT
21:59:01.127655 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Roles_Incr".
21:59:01.127836 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Roles_Incr: 
    
  if object_id ('"stg"."#AH_Roles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Roles_Incr__dbt_tmp"
    end

21:59:01.156657 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:01.161052 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:01.161331 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:01.165695 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:01.175420 [debug] [Thread-1  ]: finished collecting timing info
21:59:01.175760 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Roles_Incr: Close
21:59:01.176474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196400>]}
21:59:01.176961 [info ] [Thread-1  ]: 80 of 101 OK snapshotted stg.AH_Roles_Incr...................................... [[32mOK[0m in 11.95s]
21:59:01.177335 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Roles_Incr
21:59:01.177520 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_ShippingMethods_Incr
21:59:01.177854 [info ] [Thread-1  ]: 84 of 101 START snapshot stg.AH_ShippingMethods_Incr............................ [RUN]
21:59:01.178268 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr"
21:59:01.178419 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_ShippingMethods_Incr
21:59:01.178580 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_ShippingMethods_Incr
21:59:01.181259 [debug] [Thread-1  ]: finished collecting timing info
21:59:01.181479 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_ShippingMethods_Incr
21:59:01.184525 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:01.184710 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:01.184835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:01.184969 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:01.206089 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:01.207706 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:01.207948 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    
21:59:01.310311 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:01.348613 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:59:01.370930 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:01.371313 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:01.411441 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:01.413968 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:01.414247 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingMethods_InterView]
        ) as __dbt_sbq
    
21:59:01.501533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:01.523499 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:01.523880 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        ) as __dbt_sbq
    
21:59:01.578710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:01.582040 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:01.582350 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
21:59:01.650832 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:01.654303 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:01.654662 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingMethods_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039''), CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:01.393039'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DisplayOrder != source_data.DisplayOrder
        or
        (
            ((snapshotted_data.DisplayOrder is null) and not (source_data.DisplayOrder is null))
            or
            ((not snapshotted_data.DisplayOrder is null) and (source_data.DisplayOrder is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingMethods_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingMethods_Incr__dbt_tmp_temp_view"
    end



    
21:59:01.760696 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:59:01.762390 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:01.762710 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:01.795684 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:01.798281 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:01.798593 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:02.020072 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:59:02.023961 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:02.024677 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr'
      and table_schema = 'stg'
  
21:59:02.061629 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:02.066113 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:02.066454 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:02.102450 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:59:02.104157 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:02.104450 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:02.116413 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:02.118066 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:02.118311 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
    
21:59:02.142596 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:02.145220 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:02.145526 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplatecontents_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:02.538604 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:59:02.540656 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplatecontents_Incr"
21:59:02.541109 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:02.541249 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplatecontents_Incr" (
                  "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Body", "UpdatedOn", "DeletedOn", "CreatedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:03.100205 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.98 seconds
21:59:03.102143 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:03.102345 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:03.146393 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:03.149036 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:03.149349 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SMStemplates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:03.482884 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.33 seconds
21:59:03.485103 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SMStemplates_Incr"
21:59:03.485703 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:03.485892 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SMStemplates_Incr" (
                  "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SMStemplates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:04.153446 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
21:59:04.155181 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: COMMIT
21:59:04.155914 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplatecontents_Incr".
21:59:04.156054 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplatecontents_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplatecontents_Incr__dbt_tmp"
    end

21:59:04.194199 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:04.206374 [debug] [Thread-3  ]: finished collecting timing info
21:59:04.206813 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SMStemplatecontents_Incr: Close
21:59:04.207583 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081967f0>]}
21:59:04.208073 [info ] [Thread-3  ]: 81 of 101 OK snapshotted stg.AH_SMStemplatecontents_Incr........................ [[32mOK[0m in 13.51s]
21:59:04.208449 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_SMStemplatecontents_Incr
21:59:04.208636 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_ShippingOptions_Incr
21:59:04.208969 [info ] [Thread-3  ]: 85 of 101 START snapshot stg.AH_ShippingOptions_Incr............................ [RUN]
21:59:04.209389 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr"
21:59:04.209544 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_ShippingOptions_Incr
21:59:04.209674 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_ShippingOptions_Incr
21:59:04.212344 [debug] [Thread-3  ]: finished collecting timing info
21:59:04.212545 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_ShippingOptions_Incr
21:59:04.215357 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:04.215538 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:04.215662 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:59:04.215795 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:04.329806 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:04.359664 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:59:04.381683 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:04.382065 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:04.410612 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:04.413068 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:04.413365 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ShippingOptions_InterView]
        ) as __dbt_sbq
    
21:59:04.471788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:04.492496 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:04.492891 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        ) as __dbt_sbq
    
21:59:04.542863 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:04.547516 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:04.547813 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
21:59:04.622803 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:04.626695 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:04.627019 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ShippingOptions_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131''), CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:04.393131'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.ShippingMethodID != source_data.ShippingMethodID
        or
        (
            ((snapshotted_data.ShippingMethodID is null) and not (source_data.ShippingMethodID is null))
            or
            ((not snapshotted_data.ShippingMethodID is null) and (source_data.ShippingMethodID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.FirstItEMAmount != source_data.FirstItEMAmount
        or
        (
            ((snapshotted_data.FirstItEMAmount is null) and not (source_data.FirstItEMAmount is null))
            or
            ((not snapshotted_data.FirstItEMAmount is null) and (source_data.FirstItEMAmount is null))
        ) or snapshotted_data.AdditionalItEMAmount != source_data.AdditionalItEMAmount
        or
        (
            ((snapshotted_data.AdditionalItEMAmount is null) and not (source_data.AdditionalItEMAmount is null))
            or
            ((not snapshotted_data.AdditionalItEMAmount is null) and (source_data.AdditionalItEMAmount is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ShippingOptions_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ShippingOptions_Incr__dbt_tmp_temp_view"
    end



    
21:59:04.793798 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.31 seconds
21:59:04.795631 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SMStemplates_Incr: COMMIT
21:59:04.796491 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SMStemplates_Incr".
21:59:04.796693 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SMStemplates_Incr: 
    
  if object_id ('"stg"."#AH_SMStemplates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SMStemplates_Incr__dbt_tmp"
    end

21:59:04.851127 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:04.863130 [debug] [Thread-4  ]: finished collecting timing info
21:59:04.863542 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SMStemplates_Incr: Close
21:59:04.864304 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196550>]}
21:59:04.864827 [info ] [Thread-4  ]: 82 of 101 OK snapshotted stg.AH_SMStemplates_Incr............................... [[32mOK[0m in 12.51s]
21:59:04.865213 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_SMStemplates_Incr
21:59:04.865400 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Siteproperties_Incr
21:59:04.865740 [info ] [Thread-4  ]: 86 of 101 START snapshot stg.AH_Siteproperties_Incr............................. [RUN]
21:59:04.866178 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Siteproperties_Incr"
21:59:04.866331 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Siteproperties_Incr
21:59:04.866465 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Siteproperties_Incr
21:59:04.869254 [debug] [Thread-4  ]: finished collecting timing info
21:59:04.869465 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Siteproperties_Incr
21:59:04.872485 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:04.872674 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:04.872824 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:59:04.872966 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:04.990614 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:05.019177 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:05.041462 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:05.041873 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:05.077215 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:05.079788 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:05.080110 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Siteproperties_InterView]
        ) as __dbt_sbq
    
21:59:05.134390 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:05.155072 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:05.155459 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        ) as __dbt_sbq
    
21:59:05.244769 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:05.248359 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:05.248672 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
21:59:05.331280 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:05.335266 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:05.335608 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Siteproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Siteproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341''), CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:05.049341'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Siteproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Siteproperties_Incr__dbt_tmp_temp_view"
    end



    
21:59:07.147001 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.49 seconds
21:59:07.150401 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:07.150747 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:07.205409 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:07.206941 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:07.207126 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
21:59:07.432831 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.60 seconds
21:59:07.436024 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:07.436248 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:07.480182 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:07.481764 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:07.481993 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
21:59:08.250004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.04 seconds
21:59:08.251629 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:08.251816 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:08.330770 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:08.333290 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:08.333518 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:08.508883 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.03 seconds
21:59:08.510465 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:08.510681 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:08.579905 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:59:08.583190 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:08.583524 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
21:59:08.585332 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:08.587477 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:08.587699 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:08.620140 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:08.624534 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:08.624882 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:08.663887 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:08.665498 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:08.665755 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
21:59:08.801737 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:08.806218 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:08.806575 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
21:59:08.844240 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:08.848617 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:08.848971 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:08.891207 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:08.892811 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:08.893069 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
21:59:09.606436 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:59:09.608068 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:09.608243 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:09.641787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:09.644323 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:09.644535 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:09.837424 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:59:09.839040 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:09.839515 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:09.875466 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:09.878124 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:09.878399 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:09.882078 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:59:09.884368 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:09.884549 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr'
      and table_schema = 'stg'
  
21:59:09.917229 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:09.921995 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:09.922341 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:10.013010 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:10.014677 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:10.014961 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    
21:59:10.265998 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:59:10.268904 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:10.269172 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr'
      and table_schema = 'stg'
  
21:59:10.318683 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:10.323055 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:10.323360 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:10.372351 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:10.374222 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:10.374481 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    
21:59:11.044840 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.42 seconds
21:59:11.048282 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:11.048544 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:11.074945 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:59:11.076549 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:11.076809 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:11.085305 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:11.086819 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:11.087059 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
21:59:11.114139 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:11.116803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:11.117103 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingMethods_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:11.321432 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:59:11.323129 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:11.323395 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:11.362533 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:59:11.364719 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingMethods_Incr"
21:59:11.365296 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:11.365481 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingMethods_Incr" (
                  "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DisplayOrder", "CreatedOn", "UpdatedOn", "DeletedOn", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingMethods_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:11.365789 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:11.367999 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:11.368211 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SalesTaxRates_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:11.644227 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:59:11.646496 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SalesTaxRates_Incr"
21:59:11.647061 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:11.647239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SalesTaxRates_Incr" (
                  "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "LastUpdatedUser", "Shipping", "DeletedOn", "CreatedOn", "UpdatedOn", "StateID", "UserID", "TaxRate", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:11.942812 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.86 seconds
21:59:11.944798 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:11.945098 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:12.017501 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:12.020029 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:12.020311 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:12.271255 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:59:12.274219 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:12.274453 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
21:59:12.314931 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:12.319397 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:12.319747 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:12.359252 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:12.360861 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:12.361115 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
21:59:12.772740 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.41 seconds
21:59:12.774505 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: COMMIT
21:59:12.775389 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingMethods_Incr".
21:59:12.775606 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingMethods_Incr: 
    
  if object_id ('"stg"."#AH_ShippingMethods_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingMethods_Incr__dbt_tmp"
    end

21:59:12.840999 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:12.853231 [debug] [Thread-1  ]: finished collecting timing info
21:59:12.853667 [debug] [Thread-1  ]: On snapshot.Shawn.AH_ShippingMethods_Incr: Close
21:59:12.854431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196a30>]}
21:59:12.854994 [info ] [Thread-1  ]: 84 of 101 OK snapshotted stg.AH_ShippingMethods_Incr............................ [[32mOK[0m in 11.68s]
21:59:12.855380 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_ShippingMethods_Incr
21:59:12.855564 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_States_Incr
21:59:12.855900 [info ] [Thread-1  ]: 87 of 101 START snapshot stg.AH_States_Incr..................................... [RUN]
21:59:12.856341 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_States_Incr"
21:59:12.856504 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_States_Incr
21:59:12.856641 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_States_Incr
21:59:12.859521 [debug] [Thread-1  ]: finished collecting timing info
21:59:12.859800 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_States_Incr
21:59:12.862616 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:12.862809 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:12.862932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:12.863064 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:12.981253 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.33 seconds
21:59:12.983116 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: COMMIT
21:59:12.984022 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SalesTaxRates_Incr".
21:59:12.984239 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_SalesTaxRates_Incr: 
    
  if object_id ('"stg"."#AH_SalesTaxRates_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SalesTaxRates_Incr__dbt_tmp"
    end

21:59:12.984533 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:13.013345 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:13.026483 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:13.048423 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:13.048857 [debug] [Thread-2  ]: finished collecting timing info
21:59:13.049177 [debug] [Thread-2  ]: On snapshot.Shawn.AH_SalesTaxRates_Incr: Close
21:59:13.049895 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081966a0>]}
21:59:13.050389 [info ] [Thread-2  ]: 83 of 101 OK snapshotted stg.AH_SalesTaxRates_Incr.............................. [[32mOK[0m in 12.63s]
21:59:13.050819 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_SalesTaxRates_Incr
21:59:13.051009 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_StripeCustomers_Incr
21:59:13.051347 [info ] [Thread-2  ]: 88 of 101 START snapshot stg.AH_StripeCustomers_Incr............................ [RUN]
21:59:13.051786 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr"
21:59:13.051943 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_StripeCustomers_Incr
21:59:13.052080 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_StripeCustomers_Incr
21:59:13.049003 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:13.055290 [debug] [Thread-2  ]: finished collecting timing info
21:59:13.055749 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_StripeCustomers_Incr
21:59:13.058697 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:13.058898 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:13.059024 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:59:13.059159 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:13.084644 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:13.086981 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:13.087244 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_States_InterView]
        ) as __dbt_sbq
    
21:59:13.159239 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:13.181222 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:13.181486 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:13.181721 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        ) as __dbt_sbq
    
21:59:13.209711 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:13.231528 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:13.231928 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:13.232331 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:13.235722 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:13.236082 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
21:59:13.304088 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:13.306108 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:13.306357 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_StripeCustomers_InterView]
        ) as __dbt_sbq
    
21:59:13.325164 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:13.328887 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:13.329244 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_States_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_States_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_States_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134''), CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.065134'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.Code != source_data.Code
        or
        (
            ((snapshotted_data.Code is null) and not (source_data.Code is null))
            or
            ((not snapshotted_data.Code is null) and (source_data.Code is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.CountryID != source_data.CountryID
        or
        (
            ((snapshotted_data.CountryID is null) and not (source_data.CountryID is null))
            or
            ((not snapshotted_data.CountryID is null) and (source_data.CountryID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_States_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_States_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_States_Incr__dbt_tmp_temp_view"
    end



    
21:59:13.361380 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:13.379412 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.02 seconds
21:59:13.380889 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:13.381137 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:13.385784 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:13.385993 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        ) as __dbt_sbq
    
21:59:13.414001 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:13.416670 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:13.416947 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:13.432428 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:13.437275 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:13.437690 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
21:59:13.508777 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:13.512394 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:13.512758 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_StripeCustomers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843''), CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:13.283843'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SellerID != source_data.SellerID
        or
        (
            ((snapshotted_data.SellerID is null) and not (source_data.SellerID is null))
            or
            ((not snapshotted_data.SellerID is null) and (source_data.SellerID is null))
        ) or snapshotted_data.BuyerID != source_data.BuyerID
        or
        (
            ((snapshotted_data.BuyerID is null) and not (source_data.BuyerID is null))
            or
            ((not snapshotted_data.BuyerID is null) and (source_data.BuyerID is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CustomerID != source_data.CustomerID
        or
        (
            ((snapshotted_data.CustomerID is null) and not (source_data.CustomerID is null))
            or
            ((not snapshotted_data.CustomerID is null) and (source_data.CustomerID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_StripeCustomers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_StripeCustomers_Incr__dbt_tmp_temp_view"
    end



    
21:59:13.604810 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:59:13.608121 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:13.608464 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr'
      and table_schema = 'stg'
  
21:59:13.650022 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:13.654712 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:13.655083 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:13.691687 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:13.693304 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:13.693554 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    
21:59:14.133651 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 8.80 seconds
21:59:14.136872 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:14.137089 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:14.178066 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:14.179656 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:14.179887 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
21:59:14.909517 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
21:59:14.911179 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:14.911400 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:14.945792 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:14.948387 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:14.948723 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ShippingOptions_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:15.259592 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
21:59:15.261739 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ShippingOptions_Incr"
21:59:15.262168 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:15.262305 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ShippingOptions_Incr" (
                  "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "CreatedOn", "UpdatedOn", "DeletedOn", "ShippingMethodID", "ListingID", "FirstItEMAmount", "AdditionalItEMAmount", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ShippingOptions_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:15.269714 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:59:15.271240 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:15.271463 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:15.341898 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:15.344627 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:15.344889 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:15.572260 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:15.575622 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:15.575919 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
21:59:15.609915 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:15.614003 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:15.614267 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:15.662490 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:15.664151 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:15.664409 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
21:59:16.612859 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:59:16.614611 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:16.614897 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:16.648810 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:16.651961 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:16.652309 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:16.659219 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
21:59:16.660901 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: COMMIT
21:59:16.661731 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ShippingOptions_Incr".
21:59:16.661921 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_ShippingOptions_Incr: 
    
  if object_id ('"stg"."#AH_ShippingOptions_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ShippingOptions_Incr__dbt_tmp"
    end

21:59:16.695677 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:16.708203 [debug] [Thread-3  ]: finished collecting timing info
21:59:16.708644 [debug] [Thread-3  ]: On snapshot.Shawn.AH_ShippingOptions_Incr: Close
21:59:16.709429 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc080536d0>]}
21:59:16.709959 [info ] [Thread-3  ]: 85 of 101 OK snapshotted stg.AH_ShippingOptions_Incr............................ [[32mOK[0m in 12.50s]
21:59:16.710348 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_ShippingOptions_Incr
21:59:16.710535 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:59:16.710925 [info ] [Thread-3  ]: 89 of 101 START snapshot stg.AH_SubmittedListingPayment_Incr.................... [RUN]
21:59:16.711368 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
21:59:16.711524 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:59:16.711660 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:59:16.714453 [debug] [Thread-3  ]: finished collecting timing info
21:59:16.714785 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:59:16.717912 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:16.718116 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:16.718244 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:59:16.718384 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:16.839541 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:16.868683 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:16.885335 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:16.888285 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:16.894472 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr'
      and table_schema = 'stg'
  
21:59:16.894313 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:16.894885 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:16.922620 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:16.924818 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:16.925083 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]
        ) as __dbt_sbq
    
21:59:16.928756 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:16.932891 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:16.933113 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:16.970416 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:16.972066 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:16.972319 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
    
21:59:16.976709 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:16.997774 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:16.998153 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        ) as __dbt_sbq
    
21:59:17.059241 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:17.063069 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:17.063392 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
21:59:17.141651 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:17.145754 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:17.146047 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SubmittedListingPayment_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897''), CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:16.908897'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.TransactionID != source_data.TransactionID
        or
        (
            ((snapshotted_data.TransactionID is null) and not (source_data.TransactionID is null))
            or
            ((not snapshotted_data.TransactionID is null) and (source_data.TransactionID is null))
        ) or snapshotted_data.Amount != source_data.Amount
        or
        (
            ((snapshotted_data.Amount is null) and not (source_data.Amount is null))
            or
            ((not snapshotted_data.Amount is null) and (source_data.Amount is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.ConsignorID != source_data.ConsignorID
        or
        (
            ((snapshotted_data.ConsignorID is null) and not (source_data.ConsignorID is null))
            or
            ((not snapshotted_data.ConsignorID is null) and (source_data.ConsignorID is null))
        ) or snapshotted_data.HasproMarketing != source_data.HasproMarketing
        or
        (
            ((snapshotted_data.HasproMarketing is null) and not (source_data.HasproMarketing is null))
            or
            ((not snapshotted_data.HasproMarketing is null) and (source_data.HasproMarketing is null))
        ) or snapshotted_data.HasproPhotography != source_data.HasproPhotography
        or
        (
            ((snapshotted_data.HasproPhotography is null) and not (source_data.HasproPhotography is null))
            or
            ((not snapshotted_data.HasproPhotography is null) and (source_data.HasproPhotography is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_temp_view"
    end



    
21:59:17.865346 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:59:17.866954 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:17.867120 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:17.902374 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:17.905101 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:17.905358 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Siteproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:18.151340 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
21:59:18.153546 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Siteproperties_Incr"
21:59:18.153986 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:18.154176 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Siteproperties_Incr" (
                  "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "DecimalnativeValue", "BoolnativeValue", "IntnativeValue", "CustomFieldID", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Siteproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:19.565658 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.05 seconds
21:59:19.569106 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:19.569290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:19.605505 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:19.606917 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:19.607102 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
21:59:19.804169 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.47 seconds
21:59:19.807566 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:19.807811 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:19.813070 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.66 seconds
21:59:19.814266 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Siteproperties_Incr: COMMIT
21:59:19.814951 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Siteproperties_Incr".
21:59:19.815120 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Siteproperties_Incr: 
    
  if object_id ('"stg"."#AH_Siteproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Siteproperties_Incr__dbt_tmp"
    end

21:59:19.856678 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:19.867723 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:19.868817 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:19.868993 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
21:59:19.870366 [debug] [Thread-4  ]: finished collecting timing info
21:59:19.870584 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Siteproperties_Incr: Close
21:59:19.871177 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00d7ea00>]}
21:59:19.871617 [info ] [Thread-4  ]: 86 of 101 OK snapshotted stg.AH_Siteproperties_Incr............................. [[32mOK[0m in 15.01s]
21:59:19.871976 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Siteproperties_Incr
21:59:19.872152 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_SysDiagrams_Incr
21:59:19.872479 [info ] [Thread-4  ]: 90 of 101 START snapshot stg.AH_SysDiagrams_Incr................................ [RUN]
21:59:19.872877 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr"
21:59:19.873025 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_SysDiagrams_Incr
21:59:19.873154 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_SysDiagrams_Incr
21:59:19.875749 [debug] [Thread-4  ]: finished collecting timing info
21:59:19.875937 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_SysDiagrams_Incr
21:59:19.878587 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:19.878759 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:19.878876 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:59:19.879005 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:19.974220 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:20.020712 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:59:20.043589 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:20.043929 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:20.077053 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:20.079544 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:20.079783 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_SysDiagrams_InterView]
        ) as __dbt_sbq
    
21:59:20.140902 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:20.161820 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:20.162161 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        ) as __dbt_sbq
    
21:59:20.270967 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
21:59:20.274217 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:20.274494 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
21:59:20.426246 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:20.430269 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:20.430630 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_SysDiagrams_InterView]

    ),

    snapshotted_data as (

        select *,
            Diagram_ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191''), CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(Diagram_ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            Diagram_ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:20.065191'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.Diagram_ID != source_data.Diagram_ID
        or
        (
            ((snapshotted_data.Diagram_ID is null) and not (source_data.Diagram_ID is null))
            or
            ((not snapshotted_data.Diagram_ID is null) and (source_data.Diagram_ID is null))
        ) or snapshotted_data.Version != source_data.Version
        or
        (
            ((snapshotted_data.Version is null) and not (source_data.Version is null))
            or
            ((not snapshotted_data.Version is null) and (source_data.Version is null))
        ) or snapshotted_data.Principal_ID != source_data.Principal_ID
        or
        (
            ((snapshotted_data.Principal_ID is null) and not (source_data.Principal_ID is null))
            or
            ((not snapshotted_data.Principal_ID is null) and (source_data.Principal_ID is null))
        ) or snapshotted_data.Definition != source_data.Definition
        or
        (
            ((snapshotted_data.Definition is null) and not (source_data.Definition is null))
            or
            ((not snapshotted_data.Definition is null) and (source_data.Definition is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SysDiagrams_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SysDiagrams_Incr__dbt_tmp_temp_view"
    end



    
21:59:20.543667 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:59:20.545369 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:20.545612 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:20.616058 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:20.618749 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:20.619041 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:20.827327 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:20.830523 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:20.830795 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
21:59:20.833654 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.96 seconds
21:59:20.834857 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:20.835047 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:20.913977 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:20.918215 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:20.918501 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:20.920879 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:20.922993 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:20.923194 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:20.959817 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:20.961362 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:20.961607 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
21:59:21.141695 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
21:59:21.144640 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:21.144813 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
21:59:21.220003 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:21.224193 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:21.224481 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:21.274309 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:21.276852 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:21.277112 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
21:59:21.844265 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:59:21.845911 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:21.846148 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:21.879757 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:21.882206 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:21.882440 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:22.163975 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:59:22.166881 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:22.167049 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr'
      and table_schema = 'stg'
  
21:59:22.171947 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.89 seconds
21:59:22.173066 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:22.173241 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:22.239740 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:22.242098 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:22.242353 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:22.285549 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:59:22.289832 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:22.290112 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:22.341119 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:22.343116 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:22.343344 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    
21:59:22.637920 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
21:59:22.640846 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:22.641110 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr'
      and table_schema = 'stg'
  
21:59:22.716912 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:22.721510 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:22.721777 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:22.768623 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:22.770160 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:22.770399 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
    
21:59:23.664815 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.32 seconds
21:59:23.666387 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:23.666593 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:23.766673 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:59:23.769092 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:23.769276 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_StripeCustomers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:24.002693 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:24.004799 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_StripeCustomers_Incr"
21:59:24.005210 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:24.005343 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_StripeCustomers_Incr" (
                  "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SellerID", "BuyerID", "CreatedOn", "UpdatedOn", "DeletedOn", "CustomerID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_StripeCustomers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:24.977584 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.21 seconds
21:59:24.979156 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:24.979334 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_States_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:25.051855 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:25.054131 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:25.054312 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_States_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:25.257467 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:59:25.259573 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_States_Incr"
21:59:25.259988 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:25.260121 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_States_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_States_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_States_Incr" (
                  "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Name", "Code", "CreatedOn", "UpdatedOn", "DeletedOn", "Enabled", "CountryID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_States_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:25.262643 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 8.12 seconds
21:59:25.265567 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:25.265710 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:25.303353 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:25.304934 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:25.305181 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
21:59:25.732172 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.73 seconds
21:59:25.733896 [debug] [Thread-2  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: COMMIT
21:59:25.735006 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_StripeCustomers_Incr".
21:59:25.735210 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_StripeCustomers_Incr: 
    
  if object_id ('"stg"."#AH_StripeCustomers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_StripeCustomers_Incr__dbt_tmp"
    end

21:59:25.798427 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:25.811069 [debug] [Thread-2  ]: finished collecting timing info
21:59:25.811453 [debug] [Thread-2  ]: On snapshot.Shawn.AH_StripeCustomers_Incr: Close
21:59:25.812178 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196d30>]}
21:59:25.934025 [info ] [Thread-2  ]: 88 of 101 OK snapshotted stg.AH_StripeCustomers_Incr............................ [[32mOK[0m in 12.76s]
21:59:25.934840 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_StripeCustomers_Incr
21:59:25.935049 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_ThReadTracking_Incr
21:59:25.935405 [info ] [Thread-2  ]: 91 of 101 START snapshot stg.AH_ThReadTracking_Incr............................. [RUN]
21:59:25.935912 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr"
21:59:25.936121 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_ThReadTracking_Incr
21:59:25.936269 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_ThReadTracking_Incr
21:59:25.939138 [debug] [Thread-2  ]: finished collecting timing info
21:59:25.939360 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_ThReadTracking_Incr
21:59:25.942265 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:25.942469 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:25.942636 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:59:25.942778 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:26.072559 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:26.116904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.17 seconds
21:59:26.138328 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:26.138749 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:26.169242 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:26.171453 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:26.172021 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_ThReadTracking_InterView]
        ) as __dbt_sbq
    
21:59:26.227316 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:26.248274 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:26.248663 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        ) as __dbt_sbq
    
21:59:26.296029 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:26.299580 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:26.299886 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
21:59:26.372767 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:26.376274 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:26.376548 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_ThReadTracking_InterView]

    ),

    snapshotted_data as (

        select *,
            ThReadGUID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036''), CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ThReadGUID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ThReadGUID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:26.159036'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ThReadGUID != source_data.ThReadGUID
        or
        (
            ((snapshotted_data.ThReadGUID is null) and not (source_data.ThReadGUID is null))
            or
            ((not snapshotted_data.ThReadGUID is null) and (source_data.ThReadGUID is null))
        ) or snapshotted_data.Name != source_data.Name
        or
        (
            ((snapshotted_data.Name is null) and not (source_data.Name is null))
            or
            ((not snapshotted_data.Name is null) and (source_data.Name is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ) or snapshotted_data.PrimarythRead != source_data.PrimarythRead
        or
        (
            ((snapshotted_data.PrimarythRead is null) and not (source_data.PrimarythRead is null))
            or
            ((not snapshotted_data.PrimarythRead is null) and (source_data.PrimarythRead is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ThReadTracking_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ThReadTracking_Incr__dbt_tmp_temp_view"
    end



    
21:59:26.585615 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.28 seconds
21:59:26.587580 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:26.587841 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:26.653381 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:26.656032 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:26.656283 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:26.859236 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.60 seconds
21:59:26.861009 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: COMMIT
21:59:26.861852 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_States_Incr".
21:59:26.862046 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_States_Incr: 
    
  if object_id ('"stg"."#AH_States_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_States_Incr__dbt_tmp"
    end

21:59:26.897065 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:26.909059 [debug] [Thread-1  ]: finished collecting timing info
21:59:26.909453 [debug] [Thread-1  ]: On snapshot.Shawn.AH_States_Incr: Close
21:59:26.910196 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc08196e80>]}
21:59:26.910726 [info ] [Thread-1  ]: 87 of 101 OK snapshotted stg.AH_States_Incr..................................... [[32mOK[0m in 14.05s]
21:59:26.911111 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_States_Incr
21:59:26.911297 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Tiers_Incr
21:59:26.911622 [info ] [Thread-1  ]: 92 of 101 START snapshot stg.AH_Tiers_Incr...................................... [RUN]
21:59:26.912047 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Tiers_Incr"
21:59:26.912200 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Tiers_Incr
21:59:26.912332 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Tiers_Incr
21:59:26.915017 [debug] [Thread-1  ]: finished collecting timing info
21:59:26.915213 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Tiers_Incr
21:59:26.917963 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:26.918149 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:26.918275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:26.918409 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:26.999137 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
21:59:27.002135 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:27.002405 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
21:59:27.017008 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:27.044310 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
21:59:27.065844 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:27.066214 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:27.077721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:27.082200 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:27.082482 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:27.098340 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:27.100280 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:27.100495 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Tiers_InterView]
        ) as __dbt_sbq
    
21:59:27.117378 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:27.118774 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:27.118991 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
21:59:27.178192 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:27.199194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:27.199574 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        ) as __dbt_sbq
    
21:59:27.291222 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:27.295252 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:27.295611 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
21:59:27.373446 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:27.377197 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:27.377534 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Tiers_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Tiers_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923''), CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:27.080923'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Upperboundexclusive != source_data.Upperboundexclusive
        or
        (
            ((snapshotted_data.Upperboundexclusive is null) and not (source_data.Upperboundexclusive is null))
            or
            ((not snapshotted_data.Upperboundexclusive is null) and (source_data.Upperboundexclusive is null))
        ) or snapshotted_data.Value != source_data.Value
        or
        (
            ((snapshotted_data.Value is null) and not (source_data.Value is null))
            or
            ((not snapshotted_data.Value is null) and (source_data.Value is null))
        ) or snapshotted_data.Lowerboundinclusive != source_data.Lowerboundinclusive
        or
        (
            ((snapshotted_data.Lowerboundinclusive is null) and not (source_data.Lowerboundinclusive is null))
            or
            ((not snapshotted_data.Lowerboundinclusive is null) and (source_data.Lowerboundinclusive is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.FeescheduleID != source_data.FeescheduleID
        or
        (
            ((snapshotted_data.FeescheduleID is null) and not (source_data.FeescheduleID is null))
            or
            ((not snapshotted_data.FeescheduleID is null) and (source_data.FeescheduleID is null))
        ) or snapshotted_data.ValueType != source_data.ValueType
        or
        (
            ((snapshotted_data.ValueType is null) and not (source_data.ValueType is null))
            or
            ((not snapshotted_data.ValueType is null) and (source_data.ValueType is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Tiers_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Tiers_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Tiers_Incr__dbt_tmp_temp_view"
    end



    
21:59:27.575815 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 7.14 seconds
21:59:27.579458 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:27.579754 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:27.639105 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:27.640722 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:27.640975 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
21:59:28.233106 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:59:28.234578 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:28.234771 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:28.280010 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:28.282607 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:28.282799 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:28.474690 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:59:28.477802 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:28.478069 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr'
      and table_schema = 'stg'
  
21:59:28.513814 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:28.518316 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:28.518647 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:28.559603 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:28.561231 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:28.561467 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    
21:59:28.795426 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.15 seconds
21:59:28.797029 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:28.797270 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:28.888676 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:28.891407 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:28.891680 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:29.103290 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:29.106027 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:29.106211 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
21:59:29.188392 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:29.192191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:29.192420 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:29.233252 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:29.234879 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:29.235124 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
21:59:29.653338 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.09 seconds
21:59:29.654963 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:29.655182 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:29.693826 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:29.696244 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:29.696484 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:29.901413 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:59:29.903603 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SubmittedListingPayment_Incr"
21:59:29.904151 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:29.904335 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SubmittedListingPayment_Incr" (
                  "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "TransactionID", "Amount", "CreatedOn", "UpdatedOn", "ListingID", "ConsignorID", "HasproMarketing", "HasproPhotography", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:30.178997 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.94 seconds
21:59:30.180554 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:30.180769 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:30.223622 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:30.226602 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:30.226917 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:30.524917 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:59:30.527903 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:30.528206 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr'
      and table_schema = 'stg'
  
21:59:30.563631 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:30.568142 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:30.568393 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:30.607221 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:30.608821 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:30.609083 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    
21:59:30.685317 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 4.31 seconds
21:59:30.688713 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:30.688961 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:30.734498 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:30.736065 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:30.736306 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
21:59:31.720484 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
21:59:31.722129 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: COMMIT
21:59:31.723366 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SubmittedListingPayment_Incr".
21:59:31.723564 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: 
    
  if object_id ('"stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SubmittedListingPayment_Incr__dbt_tmp"
    end

21:59:31.750510 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.14 seconds
21:59:31.751986 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:31.752157 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:31.763096 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:31.775749 [debug] [Thread-3  ]: finished collecting timing info
21:59:31.776137 [debug] [Thread-3  ]: On snapshot.Shawn.AH_SubmittedListingPayment_Incr: Close
21:59:31.776872 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00ecff40>]}
21:59:31.777367 [info ] [Thread-3  ]: 89 of 101 OK snapshotted stg.AH_SubmittedListingPayment_Incr.................... [[32mOK[0m in 15.07s]
21:59:31.777748 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_SubmittedListingPayment_Incr
21:59:31.777933 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_UserAlerts_Incr
21:59:31.778265 [info ] [Thread-3  ]: 93 of 101 START snapshot stg.AH_UserAlerts_Incr................................. [RUN]
21:59:31.778708 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserAlerts_Incr"
21:59:31.778869 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_UserAlerts_Incr
21:59:31.779001 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_UserAlerts_Incr
21:59:31.781892 [debug] [Thread-3  ]: finished collecting timing info
21:59:31.782086 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_UserAlerts_Incr
21:59:31.784811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:31.785055 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:31.787036 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:31.787214 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_SysDiagrams_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:31.785215 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:31.787485 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:59:31.787641 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:31.794005 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.06 seconds
21:59:31.795325 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:31.795525 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:31.871220 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:31.873905 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:31.874152 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:31.905845 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:31.946860 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:59:31.969508 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:31.969865 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:31.981776 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:59:31.983746 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_SysDiagrams_Incr"
21:59:31.984242 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:31.984408 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_SysDiagrams_Incr" (
                  "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "Diagram_ID", "Version", "Principal_ID", "Definition", "Name", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_SysDiagrams_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:32.009893 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:32.012087 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:32.012350 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserAlerts_InterView]
        ) as __dbt_sbq
    
21:59:32.081962 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:32.103335 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:32.103702 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        ) as __dbt_sbq
    
21:59:32.103996 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:32.106641 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:32.106847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
21:59:32.143348 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:32.148243 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:32.148553 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:32.157780 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:32.161089 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:32.161330 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
21:59:32.182968 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:32.185188 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:32.185463 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
21:59:32.246769 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:32.250042 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:32.250298 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserAlerts_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserAlerts_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246''), CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:31.987246'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.Enabled != source_data.Enabled
        or
        (
            ((snapshotted_data.Enabled is null) and not (source_data.Enabled is null))
            or
            ((not snapshotted_data.Enabled is null) and (source_data.Enabled is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.MakeID != source_data.MakeID
        or
        (
            ((snapshotted_data.MakeID is null) and not (source_data.MakeID is null))
            or
            ((not snapshotted_data.MakeID is null) and (source_data.MakeID is null))
        ) or snapshotted_data.ModelID != source_data.ModelID
        or
        (
            ((snapshotted_data.ModelID is null) and not (source_data.ModelID is null))
            or
            ((not snapshotted_data.ModelID is null) and (source_data.ModelID is null))
        ) or snapshotted_data.YearFrom != source_data.YearFrom
        or
        (
            ((snapshotted_data.YearFrom is null) and not (source_data.YearFrom is null))
            or
            ((not snapshotted_data.YearFrom is null) and (source_data.YearFrom is null))
        ) or snapshotted_data.Yearto != source_data.Yearto
        or
        (
            ((snapshotted_data.Yearto is null) and not (source_data.Yearto is null))
            or
            ((not snapshotted_data.Yearto is null) and (source_data.Yearto is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserAlerts_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserAlerts_Incr__dbt_tmp_temp_view"
    end



    
21:59:33.457216 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.27 seconds
21:59:33.458871 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:33.459040 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:33.501113 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:33.503345 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:33.503529 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:33.539957 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.56 seconds
21:59:33.541939 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: COMMIT
21:59:33.542767 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_SysDiagrams_Incr".
21:59:33.542946 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_SysDiagrams_Incr: 
    
  if object_id ('"stg"."#AH_SysDiagrams_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_SysDiagrams_Incr__dbt_tmp"
    end

21:59:33.586090 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:33.596864 [debug] [Thread-4  ]: finished collecting timing info
21:59:33.597271 [debug] [Thread-4  ]: On snapshot.Shawn.AH_SysDiagrams_Incr: Close
21:59:33.598037 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b6160>]}
21:59:33.598577 [info ] [Thread-4  ]: 90 of 101 OK snapshotted stg.AH_SysDiagrams_Incr................................ [[32mOK[0m in 13.73s]
21:59:33.598997 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_SysDiagrams_Incr
21:59:33.599184 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_UserMessages_Incr
21:59:33.599522 [info ] [Thread-4  ]: 94 of 101 START snapshot stg.AH_UserMessages_Incr............................... [RUN]
21:59:33.599964 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserMessages_Incr"
21:59:33.600120 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_UserMessages_Incr
21:59:33.600258 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_UserMessages_Incr
21:59:33.603024 [debug] [Thread-4  ]: finished collecting timing info
21:59:33.603297 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_UserMessages_Incr
21:59:33.606464 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:33.606685 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:33.606823 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:59:33.606963 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:33.703573 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:33.731411 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:33.734518 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:33.734870 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr'
      and table_schema = 'stg'
  
21:59:33.755603 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:33.773023 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:33.777138 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:33.783449 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:33.783268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:33.783835 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:33.811737 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:33.813978 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:33.814348 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserMessages_InterView]
        ) as __dbt_sbq
    
21:59:33.819776 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:33.821148 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:33.821346 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    
21:59:33.873076 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:33.894672 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:33.895048 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        ) as __dbt_sbq
    
21:59:34.080985 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:59:34.084607 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:34.084817 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
21:59:34.180632 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:59:34.184435 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:34.184708 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserMessages_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserMessages_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845''), CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:33.799845'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.SEnderID != source_data.SEnderID
        or
        (
            ((snapshotted_data.SEnderID is null) and not (source_data.SEnderID is null))
            or
            ((not snapshotted_data.SEnderID is null) and (source_data.SEnderID is null))
        ) or snapshotted_data.RecipientID != source_data.RecipientID
        or
        (
            ((snapshotted_data.RecipientID is null) and not (source_data.RecipientID is null))
            or
            ((not snapshotted_data.RecipientID is null) and (source_data.RecipientID is null))
        ) or snapshotted_data.MasTerMessageID != source_data.MasTerMessageID
        or
        (
            ((snapshotted_data.MasTerMessageID is null) and not (source_data.MasTerMessageID is null))
            or
            ((not snapshotted_data.MasTerMessageID is null) and (source_data.MasTerMessageID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.Sent != source_data.Sent
        or
        (
            ((snapshotted_data.Sent is null) and not (source_data.Sent is null))
            or
            ((not snapshotted_data.Sent is null) and (source_data.Sent is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.SuBJect != source_data.SuBJect
        or
        (
            ((snapshotted_data.SuBJect is null) and not (source_data.SuBJect is null))
            or
            ((not snapshotted_data.SuBJect is null) and (source_data.SuBJect is null))
        ) or snapshotted_data.Body != source_data.Body
        or
        (
            ((snapshotted_data.Body is null) and not (source_data.Body is null))
            or
            ((not snapshotted_data.Body is null) and (source_data.Body is null))
        ) or snapshotted_data.SEnderStatus != source_data.SEnderStatus
        or
        (
            ((snapshotted_data.SEnderStatus is null) and not (source_data.SEnderStatus is null))
            or
            ((not snapshotted_data.SEnderStatus is null) and (source_data.SEnderStatus is null))
        ) or snapshotted_data.RecipientStatus != source_data.RecipientStatus
        or
        (
            ((snapshotted_data.RecipientStatus is null) and not (source_data.RecipientStatus is null))
            or
            ((not snapshotted_data.RecipientStatus is null) and (source_data.RecipientStatus is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserMessages_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserMessages_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserMessages_Incr__dbt_tmp_temp_view"
    end



    
21:59:35.002774 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:59:35.004358 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:35.004531 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:35.012613 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.63 seconds
21:59:35.015844 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:35.016203 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:35.036390 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:35.039057 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:35.039370 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_ThReadTracking_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:35.057737 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:35.059281 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:35.059517 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
21:59:35.396505 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.36 seconds
21:59:35.398531 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_ThReadTracking_Incr"
21:59:35.398974 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:35.399103 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_ThReadTracking_Incr" (
                  "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ThReadGUID", "Name", "DaTestamp", "PrimarythRead", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_ThReadTracking_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:36.584358 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.52 seconds
21:59:36.585945 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:36.586127 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:36.733076 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
21:59:36.736431 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:36.736817 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:37.126610 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
21:59:37.129427 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:37.129673 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
21:59:37.210777 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:37.215044 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:37.215350 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:37.301061 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
21:59:37.303217 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:37.303489 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
21:59:37.425145 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.03 seconds
21:59:37.426982 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: COMMIT
21:59:37.427835 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_ThReadTracking_Incr".
21:59:37.428017 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_ThReadTracking_Incr: 
    
  if object_id ('"stg"."#AH_ThReadTracking_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_ThReadTracking_Incr__dbt_tmp"
    end

21:59:37.508710 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:37.521837 [debug] [Thread-2  ]: finished collecting timing info
21:59:37.522257 [debug] [Thread-2  ]: On snapshot.Shawn.AH_ThReadTracking_Incr: Close
21:59:37.523093 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b6400>]}
21:59:37.523607 [info ] [Thread-2  ]: 91 of 101 OK snapshotted stg.AH_ThReadTracking_Incr............................. [[32mOK[0m in 11.59s]
21:59:37.523997 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_ThReadTracking_Incr
21:59:37.524186 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_UserOptOut_Incr
21:59:37.524521 [info ] [Thread-2  ]: 95 of 101 START snapshot stg.AH_UserOptOut_Incr................................. [RUN]
21:59:37.524937 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserOptOut_Incr"
21:59:37.525093 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_UserOptOut_Incr
21:59:37.525225 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_UserOptOut_Incr
21:59:37.527958 [debug] [Thread-2  ]: finished collecting timing info
21:59:37.528251 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_UserOptOut_Incr
21:59:37.531027 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:37.531215 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:37.531341 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:59:37.531478 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:37.686236 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:37.719698 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:59:37.741428 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:37.741809 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:37.788773 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:37.791332 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:37.791680 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserOptOut_InterView]
        ) as __dbt_sbq
    
21:59:37.849330 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:37.870279 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:37.870712 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        ) as __dbt_sbq
    
21:59:37.932464 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:37.935796 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:37.936080 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
21:59:38.005543 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:38.009648 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:38.010021 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserOptOut_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserOptOut_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968''), CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:37.752968'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.EmailName != source_data.EmailName
        or
        (
            ((snapshotted_data.EmailName is null) and not (source_data.EmailName is null))
            or
            ((not snapshotted_data.EmailName is null) and (source_data.EmailName is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserOptOut_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserOptOut_Incr__dbt_tmp_temp_view"
    end



    
21:59:38.772062 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.47 seconds
21:59:38.773659 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:38.773837 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:38.838233 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:38.840576 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:38.840739 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:39.130325 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
21:59:39.133425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:39.133644 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr'
      and table_schema = 'stg'
  
21:59:39.171392 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:39.175963 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:39.176323 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:39.245917 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:39.247504 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:39.247748 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
    
21:59:40.199079 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:59:40.200554 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:40.200737 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:40.237233 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:40.239837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:40.240079 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Tiers_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:40.518535 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
21:59:40.520861 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Tiers_Incr"
21:59:40.521440 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:40.521624 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Tiers_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Tiers_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Tiers_Incr" (
                  "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Upperboundexclusive", "Value", "Lowerboundinclusive", "CreatedOn", "UpdatedOn", "DeletedOn", "FeescheduleID", "ValueType", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Tiers_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:42.563739 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.04 seconds
21:59:42.565443 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Tiers_Incr: COMMIT
21:59:42.567822 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Tiers_Incr".
21:59:42.568053 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Tiers_Incr: 
    
  if object_id ('"stg"."#AH_Tiers_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Tiers_Incr__dbt_tmp"
    end

21:59:42.630877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:42.642699 [debug] [Thread-1  ]: finished collecting timing info
21:59:42.643144 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Tiers_Incr: Close
21:59:42.643922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b62b0>]}
21:59:42.644458 [info ] [Thread-1  ]: 92 of 101 OK snapshotted stg.AH_Tiers_Incr...................................... [[32mOK[0m in 15.73s]
21:59:42.644855 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Tiers_Incr
21:59:42.645046 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_UserRoles_Incr
21:59:42.645390 [info ] [Thread-1  ]: 96 of 101 START snapshot stg.AH_UserRoles_Incr.................................. [RUN]
21:59:42.645824 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_UserRoles_Incr"
21:59:42.645977 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_UserRoles_Incr
21:59:42.646113 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_UserRoles_Incr
21:59:42.649005 [debug] [Thread-1  ]: finished collecting timing info
21:59:42.649210 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_UserRoles_Incr
21:59:42.652148 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:42.652362 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:42.652491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:42.652626 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:42.772710 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:42.810089 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:59:42.831786 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:42.832195 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:42.859050 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:42.861642 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:42.861987 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_UserRoles_InterView]
        ) as __dbt_sbq
    
21:59:42.930164 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:42.951506 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:42.951917 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        ) as __dbt_sbq
    
21:59:43.075754 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
21:59:43.079319 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:43.079654 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
21:59:43.155836 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:43.160207 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:43.160547 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_UserRoles_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_UserRoles_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794''), CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:42.846794'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.RoleID != source_data.RoleID
        or
        (
            ((snapshotted_data.RoleID is null) and not (source_data.RoleID is null))
            or
            ((not snapshotted_data.RoleID is null) and (source_data.RoleID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_UserRoles_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_UserRoles_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_UserRoles_Incr__dbt_tmp_temp_view"
    end



    
21:59:44.279760 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.27 seconds
21:59:44.373463 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:44.373850 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:44.614289 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:59:44.615913 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:44.616154 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
21:59:45.523376 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 13.27 seconds
21:59:45.526825 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:45.527041 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:45.850514 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
21:59:45.852015 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:45.852196 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
21:59:46.015752 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.40 seconds
21:59:46.017343 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:46.017532 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:46.101333 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:46.104128 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:46.104373 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:46.401542 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.30 seconds
21:59:46.404148 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:46.404323 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
21:59:46.440259 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:46.445508 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:46.447149 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:46.514019 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:46.515887 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:46.516151 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
21:59:47.675936 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
21:59:47.677447 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:47.677617 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:47.818037 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:59:47.820617 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:47.820824 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:48.547154 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.73 seconds
21:59:48.550100 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:48.550295 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
21:59:48.551585 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.04 seconds
21:59:48.552731 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:48.552875 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:48.583365 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:48.587811 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:48.588027 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:48.590047 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:48.590252 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:48.588240 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:48.637187 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:48.638856 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:48.639104 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
21:59:48.797431 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:48.800564 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:48.800847 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr'
      and table_schema = 'stg'
  
21:59:48.997020 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:59:49.001023 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:49.001278 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:49.058562 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:49.060018 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:49.060251 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
    
21:59:49.818731 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.18 seconds
21:59:49.820300 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:49.820487 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:50.053329 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:50.056208 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:50.056424 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:50.112339 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
21:59:50.114659 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:50.114936 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:50.194753 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:50.197392 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:50.197638 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserOptOut_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:50.241751 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
21:59:50.244844 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:50.245095 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr'
      and table_schema = 'stg'
  
21:59:50.345356 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:59:50.349853 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:50.350152 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:50.403073 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:50.405134 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserOptOut_Incr"
21:59:50.405636 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:50.405800 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserOptOut_Incr" (
                  "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "EmailName", "UpdatedOn", "DeletedOn", "CreatedOn", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserOptOut_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:50.447035 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
21:59:50.448566 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:50.448803 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
    
21:59:52.101755 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
21:59:52.103309 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:52.103491 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:52.140539 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:52.143141 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:52.143343 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserAlerts_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:52.221253 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.82 seconds
21:59:52.223157 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserOptOut_Incr: COMMIT
21:59:52.226305 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserOptOut_Incr".
21:59:52.226560 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_UserOptOut_Incr: 
    
  if object_id ('"stg"."#AH_UserOptOut_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserOptOut_Incr__dbt_tmp"
    end

21:59:52.264561 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:52.274405 [debug] [Thread-2  ]: finished collecting timing info
21:59:52.274782 [debug] [Thread-2  ]: On snapshot.Shawn.AH_UserOptOut_Incr: Close
21:59:52.275522 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b67f0>]}
21:59:52.276048 [info ] [Thread-2  ]: 95 of 101 OK snapshotted stg.AH_UserOptOut_Incr................................. [[32mOK[0m in 14.75s]
21:59:52.276446 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_UserOptOut_Incr
21:59:52.276635 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Userclaims_Incr
21:59:52.276966 [info ] [Thread-2  ]: 97 of 101 START snapshot stg.AH_Userclaims_Incr................................. [RUN]
21:59:52.277408 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userclaims_Incr"
21:59:52.277562 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Userclaims_Incr
21:59:52.277697 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Userclaims_Incr
21:59:52.280411 [debug] [Thread-2  ]: finished collecting timing info
21:59:52.280616 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Userclaims_Incr
21:59:52.283327 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:52.283505 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:52.283628 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:59:52.283818 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:52.289853 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 9.13 seconds
21:59:52.292302 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:52.292478 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:52.338455 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:52.339916 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:52.340138 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
21:59:52.383589 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
21:59:52.385847 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserAlerts_Incr"
21:59:52.386434 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:52.386659 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserAlerts_Incr" (
                  "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "Enabled", "UserID", "MakeID", "ModelID", "YearFrom", "Yearto", "CreatedOn", "UpdatedOn", "DeletedOn", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserAlerts_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:52.400616 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:52.427136 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:59:52.448980 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:52.449308 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:52.476190 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:52.479047 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:52.479290 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userclaims_InterView]
        ) as __dbt_sbq
    
21:59:52.536300 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:52.557064 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:52.557393 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        ) as __dbt_sbq
    
21:59:52.610863 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:52.613909 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:52.614138 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
21:59:52.678319 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 18.49 seconds
21:59:52.681585 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:52.681816 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:52.695246 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:52.698693 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:52.698934 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userclaims_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userclaims_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315''), CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:52.456315'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ClaimType != source_data.ClaimType
        or
        (
            ((snapshotted_data.ClaimType is null) and not (source_data.ClaimType is null))
            or
            ((not snapshotted_data.ClaimType is null) and (source_data.ClaimType is null))
        ) or snapshotted_data.ClaimValue != source_data.ClaimValue
        or
        (
            ((snapshotted_data.ClaimValue is null) and not (source_data.ClaimValue is null))
            or
            ((not snapshotted_data.ClaimValue is null) and (source_data.ClaimValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userclaims_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userclaims_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userclaims_Incr__dbt_tmp_temp_view"
    end



    
21:59:52.724821 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:52.726366 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:52.726642 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
21:59:53.290802 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.95 seconds
21:59:53.292390 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:53.292581 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:53.360837 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:53.363326 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:53.363540 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:53.563281 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
21:59:53.566294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:53.566530 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
21:59:53.642362 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:53.646074 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:53.646310 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:53.687013 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:53.688566 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:53.688853 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
21:59:53.837180 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.11 seconds
21:59:53.838865 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:53.839135 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:53.913317 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.53 seconds
21:59:53.914972 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserAlerts_Incr: COMMIT
21:59:53.915755 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserAlerts_Incr".
21:59:53.915944 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_UserAlerts_Incr: 
    
  if object_id ('"stg"."#AH_UserAlerts_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserAlerts_Incr__dbt_tmp"
    end

21:59:53.916803 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:53.919191 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:53.919379 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:53.950788 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:53.962725 [debug] [Thread-3  ]: finished collecting timing info
21:59:53.963110 [debug] [Thread-3  ]: On snapshot.Shawn.AH_UserAlerts_Incr: Close
21:59:53.963821 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b6550>]}
21:59:53.964310 [info ] [Thread-3  ]: 93 of 101 OK snapshotted stg.AH_UserAlerts_Incr................................. [[32mOK[0m in 22.19s]
21:59:53.964687 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_UserAlerts_Incr
21:59:53.964879 [debug] [Thread-3  ]: Began running node snapshot.Shawn.AH_Userproperties_Incr
21:59:53.965196 [info ] [Thread-3  ]: 98 of 101 START snapshot stg.AH_Userproperties_Incr............................. [RUN]
21:59:53.965613 [debug] [Thread-3  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Userproperties_Incr"
21:59:53.965767 [debug] [Thread-3  ]: Began compiling node snapshot.Shawn.AH_Userproperties_Incr
21:59:53.965899 [debug] [Thread-3  ]: Compiling snapshot.Shawn.AH_Userproperties_Incr
21:59:53.968531 [debug] [Thread-3  ]: finished collecting timing info
21:59:53.968725 [debug] [Thread-3  ]: Began executing node snapshot.Shawn.AH_Userproperties_Incr
21:59:53.971358 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:59:53.971536 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:53.971660 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:59:53.971792 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:54.068077 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:54.112589 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
21:59:54.134836 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:59:54.135166 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:54.145566 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
21:59:54.148297 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:54.148521 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
21:59:54.164455 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:54.166329 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:59:54.166561 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Userproperties_InterView]
        ) as __dbt_sbq
    
21:59:54.215308 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:54.219787 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:54.220089 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:54.238003 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:54.258556 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:59:54.258762 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:54.259943 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:54.260124 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
21:59:54.258952 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        ) as __dbt_sbq
    
21:59:54.319341 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
21:59:54.322821 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:59:54.323059 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
21:59:54.395326 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:54.399206 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
21:59:54.399456 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Userproperties_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Userproperties_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848''), CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:54.143848'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.IntnativeValue != source_data.IntnativeValue
        or
        (
            ((snapshotted_data.IntnativeValue is null) and not (source_data.IntnativeValue is null))
            or
            ((not snapshotted_data.IntnativeValue is null) and (source_data.IntnativeValue is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.CustomFieldID != source_data.CustomFieldID
        or
        (
            ((snapshotted_data.CustomFieldID is null) and not (source_data.CustomFieldID is null))
            or
            ((not snapshotted_data.CustomFieldID is null) and (source_data.CustomFieldID is null))
        ) or snapshotted_data.BoolnativeValue != source_data.BoolnativeValue
        or
        (
            ((snapshotted_data.BoolnativeValue is null) and not (source_data.BoolnativeValue is null))
            or
            ((not snapshotted_data.BoolnativeValue is null) and (source_data.BoolnativeValue is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.DateTimenativeValue != source_data.DateTimenativeValue
        or
        (
            ((snapshotted_data.DateTimenativeValue is null) and not (source_data.DateTimenativeValue is null))
            or
            ((not snapshotted_data.DateTimenativeValue is null) and (source_data.DateTimenativeValue is null))
        ) or snapshotted_data.StringnativeValue != source_data.StringnativeValue
        or
        (
            ((snapshotted_data.StringnativeValue is null) and not (source_data.StringnativeValue is null))
            or
            ((not snapshotted_data.StringnativeValue is null) and (source_data.StringnativeValue is null))
        ) or snapshotted_data.EnumnativeValue != source_data.EnumnativeValue
        or
        (
            ((snapshotted_data.EnumnativeValue is null) and not (source_data.EnumnativeValue is null))
            or
            ((not snapshotted_data.EnumnativeValue is null) and (source_data.EnumnativeValue is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.DecimalnativeValue != source_data.DecimalnativeValue
        or
        (
            ((snapshotted_data.DecimalnativeValue is null) and not (source_data.DecimalnativeValue is null))
            or
            ((not snapshotted_data.DecimalnativeValue is null) and (source_data.DecimalnativeValue is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Userproperties_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Userproperties_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Userproperties_Incr__dbt_tmp_temp_view"
    end



    
21:59:54.520178 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.83 seconds
21:59:54.521812 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:54.522037 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:54.564438 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:54.566792 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:54.567035 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:54.825694 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:59:54.828757 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:54.828961 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr'
      and table_schema = 'stg'
  
21:59:54.876637 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:54.880835 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:54.881113 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:54.959618 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:54.961294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:54.961585 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
    
21:59:55.135368 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.88 seconds
21:59:55.136951 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:55.137134 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:55.181717 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:55.184539 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:55.184849 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:55.972785 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.79 seconds
21:59:55.975589 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:55.975772 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr'
      and table_schema = 'stg'
  
21:59:56.011416 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:56.015643 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:56.015899 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:56.053919 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:56.055521 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:56.055766 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
    
21:59:56.418710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.46 seconds
21:59:56.420166 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:56.420340 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:56.495229 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
21:59:56.497590 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:56.497785 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserRoles_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:56.963559 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.47 seconds
21:59:56.965547 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserRoles_Incr"
21:59:56.965969 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:56.966099 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserRoles_Incr" (
                  "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "RoleID", "UserID", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserRoles_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:57.595227 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.54 seconds
21:59:57.596691 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:57.596860 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:57.645518 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:57.650157 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:57.650351 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_UserMessages_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:57.829920 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.13 seconds
21:59:57.833412 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:57.833831 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:57.833715 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
21:59:57.835812 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_UserMessages_Incr"
21:59:57.836282 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:57.836449 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_UserMessages_Incr" (
                  "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "SEnderID", "RecipientID", "MasTerMessageID", "ListingID", "Sent", "CreatedOn", "UpdatedOn", "DeletedOn", "SuBJect", "Body", "SEnderStatus", "RecipientStatus", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_UserMessages_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
21:59:57.869546 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:57.871100 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:57.871358 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
21:59:59.193148 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.23 seconds
21:59:59.194994 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserRoles_Incr: COMMIT
21:59:59.195808 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserRoles_Incr".
21:59:59.195999 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_UserRoles_Incr: 
    
  if object_id ('"stg"."#AH_UserRoles_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserRoles_Incr__dbt_tmp"
    end

21:59:59.215663 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.34 seconds
21:59:59.217071 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:59.217269 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
21:59:59.232332 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:59.242402 [debug] [Thread-1  ]: finished collecting timing info
21:59:59.242745 [debug] [Thread-1  ]: On snapshot.Shawn.AH_UserRoles_Incr: Close
21:59:59.243524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b6940>]}
21:59:59.243994 [info ] [Thread-1  ]: 96 of 101 OK snapshotted stg.AH_UserRoles_Incr.................................. [[32mOK[0m in 16.60s]
21:59:59.244420 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_UserRoles_Incr
21:59:59.244607 [debug] [Thread-1  ]: Began running node snapshot.Shawn.AH_Users_Incr
21:59:59.244933 [info ] [Thread-1  ]: 99 of 101 START snapshot stg.AH_Users_Incr...................................... [RUN]
21:59:59.245349 [debug] [Thread-1  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Users_Incr"
21:59:59.245497 [debug] [Thread-1  ]: Began compiling node snapshot.Shawn.AH_Users_Incr
21:59:59.245630 [debug] [Thread-1  ]: Compiling snapshot.Shawn.AH_Users_Incr
21:59:59.248287 [debug] [Thread-1  ]: finished collecting timing info
21:59:59.248526 [debug] [Thread-1  ]: Began executing node snapshot.Shawn.AH_Users_Incr
21:59:59.251503 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:59:59.251681 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:59.251804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:59:59.251937 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
21:59:59.296465 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:59.298888 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:59.299146 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:59.367198 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
21:59:59.413305 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
21:59:59.434700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:59:59.435039 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select SYSDATETIME() as snapshot_start
  
21:59:59.471820 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
21:59:59.474388 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:59:59.474673 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Users_InterView]
        ) as __dbt_sbq
    
21:59:59.512593 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
21:59:59.515472 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:59.515722 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
21:59:59.529227 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:59.550046 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:59:59.550286 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:59.553775 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:59.553979 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

21:59:59.550499 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        ) as __dbt_sbq
    
21:59:59.588814 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
21:59:59.590261 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
21:59:59.590488 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
21:59:59.816234 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
21:59:59.820109 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:59:59.820369 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
21:59:59.885665 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.05 seconds
21:59:59.887380 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserMessages_Incr: COMMIT
21:59:59.888225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_UserMessages_Incr".
21:59:59.888400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_UserMessages_Incr: 
    
  if object_id ('"stg"."#AH_UserMessages_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_UserMessages_Incr__dbt_tmp"
    end

21:59:59.898830 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
21:59:59.902507 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
21:59:59.902761 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Users_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Users_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Users_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819''), CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 21:59:59.440819'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.BillingAddressID != source_data.BillingAddressID
        or
        (
            ((snapshotted_data.BillingAddressID is null) and not (source_data.BillingAddressID is null))
            or
            ((not snapshotted_data.BillingAddressID is null) and (source_data.BillingAddressID is null))
        ) or snapshotted_data.BillingCreditCardID != source_data.BillingCreditCardID
        or
        (
            ((snapshotted_data.BillingCreditCardID is null) and not (source_data.BillingCreditCardID is null))
            or
            ((not snapshotted_data.BillingCreditCardID is null) and (source_data.BillingCreditCardID is null))
        ) or snapshotted_data.PrimaryAddressID != source_data.PrimaryAddressID
        or
        (
            ((snapshotted_data.PrimaryAddressID is null) and not (source_data.PrimaryAddressID is null))
            or
            ((not snapshotted_data.PrimaryAddressID is null) and (source_data.PrimaryAddressID is null))
        ) or snapshotted_data.AccessfailedCount != source_data.AccessfailedCount
        or
        (
            ((snapshotted_data.AccessfailedCount is null) and not (source_data.AccessfailedCount is null))
            or
            ((not snapshotted_data.AccessfailedCount is null) and (source_data.AccessfailedCount is null))
        ) or snapshotted_data.IsApproved != source_data.IsApproved
        or
        (
            ((snapshotted_data.IsApproved is null) and not (source_data.IsApproved is null))
            or
            ((not snapshotted_data.IsApproved is null) and (source_data.IsApproved is null))
        ) or snapshotted_data.IsLockedOut != source_data.IsLockedOut
        or
        (
            ((snapshotted_data.IsLockedOut is null) and not (source_data.IsLockedOut is null))
            or
            ((not snapshotted_data.IsLockedOut is null) and (source_data.IsLockedOut is null))
        ) or snapshotted_data.NewsLetter != source_data.NewsLetter
        or
        (
            ((snapshotted_data.NewsLetter is null) and not (source_data.NewsLetter is null))
            or
            ((not snapshotted_data.NewsLetter is null) and (source_data.NewsLetter is null))
        ) or snapshotted_data.IsVerified != source_data.IsVerified
        or
        (
            ((snapshotted_data.IsVerified is null) and not (source_data.IsVerified is null))
            or
            ((not snapshotted_data.IsVerified is null) and (source_data.IsVerified is null))
        ) or snapshotted_data.IsActive != source_data.IsActive
        or
        (
            ((snapshotted_data.IsActive is null) and not (source_data.IsActive is null))
            or
            ((not snapshotted_data.IsActive is null) and (source_data.IsActive is null))
        ) or snapshotted_data.EmailConfirmed != source_data.EmailConfirmed
        or
        (
            ((snapshotted_data.EmailConfirmed is null) and not (source_data.EmailConfirmed is null))
            or
            ((not snapshotted_data.EmailConfirmed is null) and (source_data.EmailConfirmed is null))
        ) or snapshotted_data.PhoneNumberConfirmed != source_data.PhoneNumberConfirmed
        or
        (
            ((snapshotted_data.PhoneNumberConfirmed is null) and not (source_data.PhoneNumberConfirmed is null))
            or
            ((not snapshotted_data.PhoneNumberConfirmed is null) and (source_data.PhoneNumberConfirmed is null))
        ) or snapshotted_data.TwoFactorEnabled != source_data.TwoFactorEnabled
        or
        (
            ((snapshotted_data.TwoFactorEnabled is null) and not (source_data.TwoFactorEnabled is null))
            or
            ((not snapshotted_data.TwoFactorEnabled is null) and (source_data.TwoFactorEnabled is null))
        ) or snapshotted_data.LockOutEnabled != source_data.LockOutEnabled
        or
        (
            ((snapshotted_data.LockOutEnabled is null) and not (source_data.LockOutEnabled is null))
            or
            ((not snapshotted_data.LockOutEnabled is null) and (source_data.LockOutEnabled is null))
        ) or snapshotted_data.WebapiEnabled != source_data.WebapiEnabled
        or
        (
            ((snapshotted_data.WebapiEnabled is null) and not (source_data.WebapiEnabled is null))
            or
            ((not snapshotted_data.WebapiEnabled is null) and (source_data.WebapiEnabled is null))
        ) or snapshotted_data.CreationDate != source_data.CreationDate
        or
        (
            ((snapshotted_data.CreationDate is null) and not (source_data.CreationDate is null))
            or
            ((not snapshotted_data.CreationDate is null) and (source_data.CreationDate is null))
        ) or snapshotted_data.LastLoginDate != source_data.LastLoginDate
        or
        (
            ((snapshotted_data.LastLoginDate is null) and not (source_data.LastLoginDate is null))
            or
            ((not snapshotted_data.LastLoginDate is null) and (source_data.LastLoginDate is null))
        ) or snapshotted_data.LastActivityDate != source_data.LastActivityDate
        or
        (
            ((snapshotted_data.LastActivityDate is null) and not (source_data.LastActivityDate is null))
            or
            ((not snapshotted_data.LastActivityDate is null) and (source_data.LastActivityDate is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.LockOutEndDateUTC != source_data.LockOutEndDateUTC
        or
        (
            ((snapshotted_data.LockOutEndDateUTC is null) and not (source_data.LockOutEndDateUTC is null))
            or
            ((not snapshotted_data.LockOutEndDateUTC is null) and (source_data.LockOutEndDateUTC is null))
        ) or snapshotted_data.UserName != source_data.UserName
        or
        (
            ((snapshotted_data.UserName is null) and not (source_data.UserName is null))
            or
            ((not snapshotted_data.UserName is null) and (source_data.UserName is null))
        ) or snapshotted_data.Email != source_data.Email
        or
        (
            ((snapshotted_data.Email is null) and not (source_data.Email is null))
            or
            ((not snapshotted_data.Email is null) and (source_data.Email is null))
        ) or snapshotted_data.Password != source_data.Password
        or
        (
            ((snapshotted_data.Password is null) and not (source_data.Password is null))
            or
            ((not snapshotted_data.Password is null) and (source_data.Password is null))
        ) or snapshotted_data.Comment != source_data.Comment
        or
        (
            ((snapshotted_data.Comment is null) and not (source_data.Comment is null))
            or
            ((not snapshotted_data.Comment is null) and (source_data.Comment is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ) or snapshotted_data.Culture != source_data.Culture
        or
        (
            ((snapshotted_data.Culture is null) and not (source_data.Culture is null))
            or
            ((not snapshotted_data.Culture is null) and (source_data.Culture is null))
        ) or snapshotted_data.Lastip != source_data.Lastip
        or
        (
            ((snapshotted_data.Lastip is null) and not (source_data.Lastip is null))
            or
            ((not snapshotted_data.Lastip is null) and (source_data.Lastip is null))
        ) or snapshotted_data.VerificationToken != source_data.VerificationToken
        or
        (
            ((snapshotted_data.VerificationToken is null) and not (source_data.VerificationToken is null))
            or
            ((not snapshotted_data.VerificationToken is null) and (source_data.VerificationToken is null))
        ) or snapshotted_data.PasswordResetToken != source_data.PasswordResetToken
        or
        (
            ((snapshotted_data.PasswordResetToken is null) and not (source_data.PasswordResetToken is null))
            or
            ((not snapshotted_data.PasswordResetToken is null) and (source_data.PasswordResetToken is null))
        ) or snapshotted_data.ServiceAuthorizationToken != source_data.ServiceAuthorizationToken
        or
        (
            ((snapshotted_data.ServiceAuthorizationToken is null) and not (source_data.ServiceAuthorizationToken is null))
            or
            ((not snapshotted_data.ServiceAuthorizationToken is null) and (source_data.ServiceAuthorizationToken is null))
        ) or snapshotted_data.PasswordHash != source_data.PasswordHash
        or
        (
            ((snapshotted_data.PasswordHash is null) and not (source_data.PasswordHash is null))
            or
            ((not snapshotted_data.PasswordHash is null) and (source_data.PasswordHash is null))
        ) or snapshotted_data.SecURItyStamp != source_data.SecURItyStamp
        or
        (
            ((snapshotted_data.SecURItyStamp is null) and not (source_data.SecURItyStamp is null))
            or
            ((not snapshotted_data.SecURItyStamp is null) and (source_data.SecURItyStamp is null))
        ) or snapshotted_data.PhoneNumber != source_data.PhoneNumber
        or
        (
            ((snapshotted_data.PhoneNumber is null) and not (source_data.PhoneNumber is null))
            or
            ((not snapshotted_data.PhoneNumber is null) and (source_data.PhoneNumber is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Users_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Users_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Users_Incr__dbt_tmp_temp_view"
    end



    
21:59:59.938347 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
21:59:59.949907 [debug] [Thread-4  ]: finished collecting timing info
21:59:59.950288 [debug] [Thread-4  ]: On snapshot.Shawn.AH_UserMessages_Incr: Close
21:59:59.951033 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00ac1910>]}
21:59:59.951545 [info ] [Thread-4  ]: 94 of 101 OK snapshotted stg.AH_UserMessages_Incr............................... [[32mOK[0m in 26.35s]
21:59:59.951913 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_UserMessages_Incr
21:59:59.952099 [debug] [Thread-4  ]: Began running node snapshot.Shawn.AH_Version_Incr
21:59:59.952422 [info ] [Thread-4  ]: 100 of 101 START snapshot stg.AH_Version_Incr................................... [RUN]
21:59:59.952833 [debug] [Thread-4  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Version_Incr"
21:59:59.952986 [debug] [Thread-4  ]: Began compiling node snapshot.Shawn.AH_Version_Incr
21:59:59.953117 [debug] [Thread-4  ]: Compiling snapshot.Shawn.AH_Version_Incr
21:59:59.955738 [debug] [Thread-4  ]: finished collecting timing info
21:59:59.955983 [debug] [Thread-4  ]: Began executing node snapshot.Shawn.AH_Version_Incr
21:59:59.958668 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
21:59:59.958843 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
21:59:59.958968 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
21:59:59.959102 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:00:00.074611 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:00:00.105115 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:00:00.127528 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:00.127878 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select SYSDATETIME() as snapshot_start
  
22:00:00.154188 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:00:00.156698 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:00.156978 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Version_InterView]
        ) as __dbt_sbq
    
22:00:00.207849 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
22:00:00.229215 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:00.229589 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        ) as __dbt_sbq
    
22:00:00.279068 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
22:00:00.282265 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:00.282557 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
22:00:00.353174 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:00:00.356960 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:00.357260 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Version_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Version_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Version_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960''), CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 22:00:00.143960'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.VersionNumber != source_data.VersionNumber
        or
        (
            ((snapshotted_data.VersionNumber is null) and not (source_data.VersionNumber is null))
            or
            ((not snapshotted_data.VersionNumber is null) and (source_data.VersionNumber is null))
        ) or snapshotted_data.Status != source_data.Status
        or
        (
            ((snapshotted_data.Status is null) and not (source_data.Status is null))
            or
            ((not snapshotted_data.Status is null) and (source_data.Status is null))
        ) or snapshotted_data.DaTestamp != source_data.DaTestamp
        or
        (
            ((snapshotted_data.DaTestamp is null) and not (source_data.DaTestamp is null))
            or
            ((not snapshotted_data.DaTestamp is null) and (source_data.DaTestamp is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Version_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Version_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Version_Incr__dbt_tmp_temp_view"
    end



    
22:00:00.967075 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.38 seconds
22:00:00.968711 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:00.968913 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:01.231773 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
22:00:01.234307 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:01.234712 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:01.850474 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.62 seconds
22:00:01.853609 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:01.853842 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr'
      and table_schema = 'stg'
  
22:00:01.994254 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:00:01.998526 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:01.998880 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:02.035098 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:02.036614 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:02.036868 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
    
22:00:03.159157 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.12 seconds
22:00:03.160732 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:03.160926 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:03.201235 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:03.203788 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:03.204048 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userclaims_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:03.436956 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
22:00:03.439049 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userclaims_Incr"
22:00:03.439493 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:03.439627 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userclaims_Incr" (
                  "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ClaimType", "ClaimValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userclaims_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
22:00:05.316568 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.88 seconds
22:00:05.318240 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userclaims_Incr: COMMIT
22:00:05.319365 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userclaims_Incr".
22:00:05.319534 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Userclaims_Incr: 
    
  if object_id ('"stg"."#AH_Userclaims_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userclaims_Incr__dbt_tmp"
    end

22:00:05.360764 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:05.372746 [debug] [Thread-2  ]: finished collecting timing info
22:00:05.373187 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Userclaims_Incr: Close
22:00:05.373968 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081b6d30>]}
22:00:05.374535 [info ] [Thread-2  ]: 97 of 101 OK snapshotted stg.AH_Userclaims_Incr................................. [[32mOK[0m in 13.10s]
22:00:05.374960 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Userclaims_Incr
22:00:05.375144 [debug] [Thread-2  ]: Began running node snapshot.Shawn.AH_Watches_Incr
22:00:05.375476 [info ] [Thread-2  ]: 101 of 101 START snapshot stg.AH_Watches_Incr................................... [RUN]
22:00:05.375928 [debug] [Thread-2  ]: Acquiring new synapse connection "snapshot.Shawn.AH_Watches_Incr"
22:00:05.376082 [debug] [Thread-2  ]: Began compiling node snapshot.Shawn.AH_Watches_Incr
22:00:05.376217 [debug] [Thread-2  ]: Compiling snapshot.Shawn.AH_Watches_Incr
22:00:05.379116 [debug] [Thread-2  ]: finished collecting timing info
22:00:05.379322 [debug] [Thread-2  ]: Began executing node snapshot.Shawn.AH_Watches_Incr
22:00:05.382169 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:05.382360 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: --USE 
    SELECT count(*) as schema_exist FROM sys.schemas WHERE name = 'stg'
22:00:05.382485 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:00:05.382656 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:00:05.500392 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:00:05.558039 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
22:00:05.579332 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:05.579726 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select SYSDATETIME() as snapshot_start
  
22:00:05.620924 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:05.623650 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:05.623943 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            
	
	SELECT * from stg.[AH_Watches_InterView]
        ) as __dbt_sbq
    
22:00:05.711716 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
22:00:05.733535 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:05.733929 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: select TOP 0 * from (
            select * from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        ) as __dbt_sbq
    
22:00:05.922978 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
22:00:05.926621 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:05.926946 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
22:00:06.012959 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
22:00:06.016944 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:06.017319 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_Incr__dbt_tmp_temp_view as
    with snapshot_query as (

        
	
	SELECT * from stg.[AH_Watches_InterView]

    ),

    snapshotted_data as (

        select *,
            ID as dbt_unique_key

        from "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'') as dbt_valid_from,
            nullif(CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172''), CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'')) as dbt_valid_to,
            
    CONVERT(VARCHAR(32), HashBytes(''MD5'', 
        coalesce(cast(ID as varchar(max)), '''')  + ''|'' + 
    
        coalesce(cast(CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'') as varchar(max)), '''') 
    ), 2)
 as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            ID as dbt_unique_key,
            CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'') as dbt_updated_at,
            CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'') as dbt_valid_from,
            CONVERT(DATETIME2, ''2022-09-14 22:00:05.597172'') as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            ''insert'' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
            )
        )

    ),

    updates as (

        select
            ''update'' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.ID != source_data.ID
        or
        (
            ((snapshotted_data.ID is null) and not (source_data.ID is null))
            or
            ((not snapshotted_data.ID is null) and (source_data.ID is null))
        ) or snapshotted_data.UserID != source_data.UserID
        or
        (
            ((snapshotted_data.UserID is null) and not (source_data.UserID is null))
            or
            ((not snapshotted_data.UserID is null) and (source_data.UserID is null))
        ) or snapshotted_data.ListingID != source_data.ListingID
        or
        (
            ((snapshotted_data.ListingID is null) and not (source_data.ListingID is null))
            or
            ((not snapshotted_data.ListingID is null) and (source_data.ListingID is null))
        ) or snapshotted_data.DeletedOn != source_data.DeletedOn
        or
        (
            ((snapshotted_data.DeletedOn is null) and not (source_data.DeletedOn is null))
            or
            ((not snapshotted_data.DeletedOn is null) and (source_data.DeletedOn is null))
        ) or snapshotted_data.CreatedOn != source_data.CreatedOn
        or
        (
            ((snapshotted_data.CreatedOn is null) and not (source_data.CreatedOn is null))
            or
            ((not snapshotted_data.CreatedOn is null) and (source_data.CreatedOn is null))
        ) or snapshotted_data.UpdatedOn != source_data.UpdatedOn
        or
        (
            ((snapshotted_data.UpdatedOn is null) and not (source_data.UpdatedOn is null))
            or
            ((not snapshotted_data.UpdatedOn is null) and (source_data.UpdatedOn is null))
        ) or snapshotted_data.LastUpdatedUser != source_data.LastUpdatedUser
        or
        (
            ((snapshotted_data.LastUpdatedUser is null) and not (source_data.LastUpdatedUser is null))
            or
            ((not snapshotted_data.LastUpdatedUser is null) and (source_data.LastUpdatedUser is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ');

  CREATE TABLE "stg"."#AH_Watches_Incr__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_Incr__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_Incr__dbt_tmp_temp_view"
    end



    
22:00:07.086523 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 6.73 seconds
22:00:07.089903 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:07.090162 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:07.320196 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
22:00:07.321719 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:07.321914 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
22:00:09.452758 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.13 seconds
22:00:09.454300 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:09.454490 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:09.585740 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:00:09.588225 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:09.588461 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:09.899809 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
22:00:09.902882 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:09.903125 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
22:00:09.939028 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:09.943359 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:09.943706 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:10.001315 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
22:00:10.002817 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:10.003036 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
22:00:12.024567 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.02 seconds
22:00:12.026189 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:12.026400 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:12.060279 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:00:12.062778 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:12.063003 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:12.335200 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
22:00:12.339629 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:12.339944 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr'
      and table_schema = 'stg'
  
22:00:12.372926 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:00:12.377089 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:12.377410 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:12.412456 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:00:12.414070 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:12.414306 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
    
22:00:14.066804 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 1.65 seconds
22:00:14.068293 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:14.068473 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Version_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:14.223664 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:00:14.226122 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:14.226345 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Version_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:14.515842 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
22:00:14.517745 [debug] [Thread-4  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Version_Incr"
22:00:14.518205 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:14.518335 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Version_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Version_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Version_Incr" (
                  "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "VersionNumber", "Status", "DaTestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Version_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
22:00:17.351339 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.83 seconds
22:00:17.353022 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Version_Incr: COMMIT
22:00:17.354132 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Version_Incr".
22:00:17.354297 [debug] [Thread-4  ]: SQLServer adapter: On snapshot.Shawn.AH_Version_Incr: 
    
  if object_id ('"stg"."#AH_Version_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Version_Incr__dbt_tmp"
    end

22:00:17.453663 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:00:17.464147 [debug] [Thread-4  ]: finished collecting timing info
22:00:17.464582 [debug] [Thread-4  ]: On snapshot.Shawn.AH_Version_Incr: Close
22:00:17.465340 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00c5b3d0>]}
22:00:17.465892 [info ] [Thread-4  ]: 100 of 101 OK snapshotted stg.AH_Version_Incr................................... [[32mOK[0m in 17.51s]
22:00:17.466288 [debug] [Thread-4  ]: Finished running node snapshot.Shawn.AH_Version_Incr
22:00:22.870263 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 16.85 seconds
22:00:22.873601 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:22.873859 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:22.914630 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:22.916475 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:22.916730 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
22:00:23.465647 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 29.07 seconds
22:00:23.469525 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:23.469729 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:23.518404 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
22:00:23.519965 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:23.520206 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
22:00:24.132405 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.22 seconds
22:00:24.133979 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:24.134162 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:24.204996 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:00:24.207676 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:24.207947 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:24.446019 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
22:00:24.449123 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:24.449423 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
22:00:24.552349 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:00:24.556606 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:24.556900 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:24.697233 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:00:24.698847 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:24.699069 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
22:00:24.709251 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
22:00:24.710614 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:24.710814 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:24.813947 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:00:24.816705 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:24.816998 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:25.135469 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
22:00:25.138437 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:25.138707 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
22:00:25.177296 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:25.181624 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:25.181907 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:25.259276 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
22:00:25.260829 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:25.261082 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
22:00:25.753384 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 1.05 seconds
22:00:25.755088 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:25.755348 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:25.798754 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:25.801377 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:25.801654 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:25.987399 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
22:00:25.990330 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:25.990648 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr'
      and table_schema = 'stg'
  
22:00:26.023606 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:00:26.027834 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:26.028116 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:26.065062 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:26.066748 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:26.067018 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
    
22:00:26.172731 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.91 seconds
22:00:26.174292 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:26.174522 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:26.217322 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:26.220037 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:26.220290 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:26.441795 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
22:00:26.445078 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:26.445434 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr'
      and table_schema = 'stg'
  
22:00:26.484721 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:26.489395 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:26.489756 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:26.525771 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:26.527411 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:26.527667 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
    
22:00:26.982726 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.92 seconds
22:00:26.984408 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:26.984674 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Watches_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:27.025586 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:27.029038 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:27.029386 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Watches_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:27.460058 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.93 seconds
22:00:27.461727 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:27.461976 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:27.501045 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:27.503873 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:27.504192 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Userproperties_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:27.664645 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
22:00:27.666937 [debug] [Thread-2  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Watches_Incr"
22:00:27.667540 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:27.667720 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Watches_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Watches_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Watches_Incr" (
                  "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "UserID", "ListingID", "DeletedOn", "CreatedOn", "UpdatedOn", "LastUpdatedUser", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Watches_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
22:00:27.815687 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.31 seconds
22:00:27.818037 [debug] [Thread-3  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Userproperties_Incr"
22:00:27.818684 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:27.818893 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Userproperties_Incr" (
                  "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "IntnativeValue", "UserID", "CustomFieldID", "BoolnativeValue", "CreatedOn", "UpdatedOn", "DeletedOn", "DateTimenativeValue", "StringnativeValue", "EnumnativeValue", "LastUpdatedUser", "DecimalnativeValue", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Userproperties_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
22:00:30.104510 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.44 seconds
22:00:30.106052 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Watches_Incr: COMMIT
22:00:30.106777 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Watches_Incr".
22:00:30.106919 [debug] [Thread-2  ]: SQLServer adapter: On snapshot.Shawn.AH_Watches_Incr: 
    
  if object_id ('"stg"."#AH_Watches_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Watches_Incr__dbt_tmp"
    end

22:00:30.525103 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.42 seconds
22:00:30.538068 [debug] [Thread-2  ]: finished collecting timing info
22:00:30.538485 [debug] [Thread-2  ]: On snapshot.Shawn.AH_Watches_Incr: Close
22:00:30.539269 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc081c70a0>]}
22:00:30.539756 [info ] [Thread-2  ]: 101 of 101 OK snapshotted stg.AH_Watches_Incr................................... [[32mOK[0m in 25.16s]
22:00:30.540158 [debug] [Thread-2  ]: Finished running node snapshot.Shawn.AH_Watches_Incr
22:00:30.572123 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 2.75 seconds
22:00:30.573907 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Userproperties_Incr: COMMIT
22:00:30.574707 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Userproperties_Incr".
22:00:30.574892 [debug] [Thread-3  ]: SQLServer adapter: On snapshot.Shawn.AH_Userproperties_Incr: 
    
  if object_id ('"stg"."#AH_Userproperties_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Userproperties_Incr__dbt_tmp"
    end

22:00:30.611639 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:30.622271 [debug] [Thread-3  ]: finished collecting timing info
22:00:30.622697 [debug] [Thread-3  ]: On snapshot.Shawn.AH_Userproperties_Incr: Close
22:00:30.623448 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00bc4c10>]}
22:00:30.623953 [info ] [Thread-3  ]: 98 of 101 OK snapshotted stg.AH_Userproperties_Incr............................. [[32mOK[0m in 36.66s]
22:00:30.624327 [debug] [Thread-3  ]: Finished running node snapshot.Shawn.AH_Userproperties_Incr
22:00:51.574422 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 51.67 seconds
22:00:51.577652 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:51.577857 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:51.624843 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
22:00:51.626744 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:51.626988 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
22:00:52.859639 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.23 seconds
22:00:52.861225 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:52.861454 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:52.936877 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.08 seconds
22:00:52.939889 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:52.940191 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:53.125565 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
22:00:53.128308 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:53.128525 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
22:00:53.201944 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:00:53.206835 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:53.207107 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:53.249924 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:53.251450 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:53.251690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
22:00:54.690847 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.44 seconds
22:00:54.692442 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:54.692628 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:54.731461 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:54.734773 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:54.735052 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:54.922307 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
22:00:54.925418 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:54.925690 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr'
      and table_schema = 'stg'
  
22:00:54.962151 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:54.967266 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:54.967581 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:55.005693 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:55.007264 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:55.007526 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
        CREATE TABLE "BJAC_DW_PROD"."stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
        WITH(
          -- Always use a round-robin heap, since columns with types like varbinaries
          -- cannot be part of a clustered column store, which is the default index
          DISTRIBUTION = ROUND_ROBIN,
          HEAP
        )
        AS
        SELECT TOP(1) *
        FROM "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
    
22:00:56.211357 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.20 seconds
22:00:56.212980 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:56.213187 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    select
        column_name,
        data_type,
        character_maximum_length,
        numeric_precision,
        numeric_scale
    from INFORMATION_SCHEMA.COLUMNS
    where table_name = 'AH_Users_Incr__dbt_tmp_tmp_tbl_hack'
      and table_schema = 'stg'
  
22:00:56.253315 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:56.256496 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:56.256731 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"','U') is not null
    begin
    drop table "stg"."AH_Users_Incr__dbt_tmp_tmp_tbl_hack"
    end

22:00:56.466216 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
22:00:56.468936 [debug] [Thread-1  ]: Writing runtime SQL for node "snapshot.Shawn.AH_Users_Incr"
22:00:56.469357 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:56.469491 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
      EXEC('
           BEGIN TRANSACTION
           update "BJAC_DW_PROD"."stg"."AH_Users_Incr"
          set dbt_valid_to = TMP.dbt_valid_to
          from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp" TMP
          where "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_scd_id = TMP.dbt_scd_id
            and TMP.dbt_change_type in (''update'', ''delete'')
            and "BJAC_DW_PROD"."stg"."AH_Users_Incr".dbt_valid_to is null;

            insert into "BJAC_DW_PROD"."stg"."AH_Users_Incr" (
                  "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
                  )
            select "ID", "BillingAddressID", "BillingCreditCardID", "PrimaryAddressID", "AccessfailedCount", "IsApproved", "IsLockedOut", "NewsLetter", "IsVerified", "IsActive", "EmailConfirmed", "PhoneNumberConfirmed", "TwoFactorEnabled", "LockOutEnabled", "WebapiEnabled", "CreationDate", "LastLoginDate", "LastActivityDate", "CreatedOn", "UpdatedOn", "DeletedOn", "LockOutEndDateUTC", "UserName", "Email", "Password", "Comment", "LastUpdatedUser", "Culture", "Lastip", "VerificationToken", "PasswordResetToken", "ServiceAuthorizationToken", "PasswordHash", "SecURItyStamp", "PhoneNumber", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id"
            from "BJAC_DW_PROD"."stg"."#AH_Users_Incr__dbt_tmp"
            where dbt_change_type = ''insert'' ;
           COMMIT TRANSACTION;
           ');


  
22:00:58.083391 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.61 seconds
22:00:58.085252 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Users_Incr: COMMIT
22:00:58.085929 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "snapshot.Shawn.AH_Users_Incr".
22:00:58.086059 [debug] [Thread-1  ]: SQLServer adapter: On snapshot.Shawn.AH_Users_Incr: 
    
  if object_id ('"stg"."#AH_Users_Incr__dbt_tmp"','U') is not null
    begin
    drop table "stg"."#AH_Users_Incr__dbt_tmp"
    end

22:00:58.124747 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:00:58.136965 [debug] [Thread-1  ]: finished collecting timing info
22:00:58.137354 [debug] [Thread-1  ]: On snapshot.Shawn.AH_Users_Incr: Close
22:00:58.138108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6063415e-760d-41e0-a01c-a8497e9d5756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00cc0b80>]}
22:00:58.138660 [info ] [Thread-1  ]: 99 of 101 OK snapshotted stg.AH_Users_Incr...................................... [[32mOK[0m in 58.89s]
22:00:58.139051 [debug] [Thread-1  ]: Finished running node snapshot.Shawn.AH_Users_Incr
22:00:58.140974 [debug] [MainThread]: Acquiring new synapse connection "master"
22:00:58.141370 [debug] [MainThread]: On master: COMMIT
22:00:58.141814 [info ] [MainThread]: 
22:00:58.142079 [info ] [MainThread]: Finished running 101 snapshots in 589.67s.
22:00:58.142284 [debug] [MainThread]: Connection 'master' was properly closed.
22:00:58.142393 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Users_Incr' was properly closed.
22:00:58.142495 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Watches_Incr' was properly closed.
22:00:58.142627 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Userproperties_Incr' was properly closed.
22:00:58.142727 [debug] [MainThread]: Connection 'snapshot.Shawn.AH_Version_Incr' was properly closed.
22:00:58.173961 [info ] [MainThread]: 
22:00:58.174351 [info ] [MainThread]: [32mCompleted successfully[0m
22:00:58.174810 [info ] [MainThread]: 
22:00:58.175019 [info ] [MainThread]: Done. PASS=101 WARN=0 ERROR=0 SKIP=0 TOTAL=101
22:00:58.175337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09c46280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc09d50430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc00cb4280>]}


============================== 2022-09-14 22:01:00.777125 | b8fdb24a-8b8a-4760-84a4-a22b4804074e ==============================
22:01:00.777125 [info ] [MainThread]: Running with dbt=1.0.0
22:01:00.782872 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step5_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:01:00.783165 [debug] [MainThread]: Tracking: tracking
22:01:00.783526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe684bcbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe684bcbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe684bcbfd0>]}
22:01:01.084495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:01:01.084898 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:01:01.111523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe684b383d0>]}
22:01:01.158759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6848e3940>]}
22:01:01.159273 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:01:01.166920 [info ] [MainThread]: 
22:01:01.167529 [debug] [MainThread]: Acquiring new synapse connection "master"
22:01:01.168730 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:01:01.177791 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:01:01.178048 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:01:01.178189 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:01.178336 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:01.493464 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:01.526824 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.35 seconds
22:01:01.528859 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:01:01.551233 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:01:01.557425 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:01:01.558079 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:01:01.559914 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:01:01.560127 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:01:01.560257 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:01.560393 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:01.558301 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:01:01.561965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:01:01.562156 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:01.663575 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:01.666453 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:01.727286 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
22:01:01.728487 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
22:01:01.756416 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:01:01.757680 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:01:01.918081 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:01:01.927697 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:01:15.904041 [debug] [MainThread]: On master: COMMIT
22:01:15.904729 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:01:15.905068 [info ] [MainThread]: 
22:01:15.908840 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Buyers_DM
22:01:15.909526 [info ] [Thread-1  ]: 1 of 5 START table model dbo.AH_Buyers_DM....................................... [RUN]
22:01:15.910059 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Buyers_DM"
22:01:15.910234 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Buyers_DM
22:01:15.909096 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Categories_DM
22:01:15.909201 [debug] [Thread-3  ]: Began running node model.Shawn.AH_Consignors_DM
22:01:15.911016 [info ] [Thread-3  ]: 3 of 5 START table model dbo.AH_Consignors_DM................................... [RUN]
22:01:15.911486 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_Consignors_DM"
22:01:15.911640 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_Consignors_DM
22:01:15.911764 [debug] [Thread-3  ]: Compiling model.Shawn.AH_Consignors_DM
22:01:15.909286 [debug] [Thread-4  ]: Began running node model.Shawn.AH_Currencies_DM
22:01:15.915337 [info ] [Thread-4  ]: 4 of 5 START table model dbo.AH_Currencies_DM................................... [RUN]
22:01:15.915793 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_Currencies_DM"
22:01:15.915952 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_Currencies_DM
22:01:15.916082 [debug] [Thread-4  ]: Compiling model.Shawn.AH_Currencies_DM
22:01:15.910687 [info ] [Thread-2  ]: 2 of 5 START table model dbo.AH_Categories_DM................................... [RUN]
22:01:15.919170 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Categories_DM"
22:01:15.919330 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Categories_DM
22:01:15.919454 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Categories_DM
22:01:15.910399 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Buyers_DM
22:01:15.925466 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Buyers_DM"
22:01:15.918696 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_Currencies_DM"
22:01:15.915052 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_Consignors_DM"
22:01:15.926195 [debug] [Thread-3  ]: finished collecting timing info
22:01:15.926374 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_Consignors_DM
22:01:15.922175 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Categories_DM"
22:01:15.936172 [debug] [Thread-4  ]: finished collecting timing info
22:01:15.936668 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_Currencies_DM
22:01:15.936558 [debug] [Thread-2  ]: finished collecting timing info
22:01:15.963759 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Categories_DM
22:01:15.936400 [debug] [Thread-1  ]: finished collecting timing info
22:01:15.983999 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Buyers_DM
22:01:16.054709 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_Consignors_DM"
22:01:16.055044 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_Currencies_DM"
22:01:16.063066 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Buyers_DM"
22:01:16.072417 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
22:01:16.073083 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
  
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Buyers_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Buyers_DM__dbt_tmp_temp_view as
    

with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
), part1 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID not in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
),
part2 as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) AS [Buyer_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(UserID) from [stg].[AH_ListingActions_FinalView]
        union
        select distinct(UserID) from [stg].[AH_Watches_FinalView]
        union
        select distinct(UserID) from [stg].[AH_ListingComments_FinalView]
    )
)

select
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part1 
union all 
select 
	[Buyer_SKey],
	[UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from part2
    ');

  CREATE TABLE "dbo"."AH_Buyers_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Buyers_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Buyers_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Buyers_DM__dbt_tmp_temp_view"
    end



22:01:16.073239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:01:16.073395 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:16.072978 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
22:01:16.074678 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
  
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Consignors_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Consignors_DM__dbt_tmp_temp_view as
    
with UserProperties_temp as (
    select 
        t1.UserID,
        max(case Name when ''FirstName'' then StringNativeValue else NULL end) as FirstName,
        max(case Name when ''LastName'' then StringNativeValue else NULL end) as LastName,
        max(case Name when ''UserPhone'' then StringNativeValue else NULL end) as Phone,
        max(case Name when ''IsInternational'' then cast(EnumNativeValue as varchar(200)) else NULL end) as IsInternational,
        max(case Name when ''Reg_Reference'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Reference,
        max(case Name when ''Reg_Referral'' then cast(EnumNativeValue as varchar(200)) else NULL end) as Reg_Referral
    from
        (SELECT
            up.*,
            cf.Name
        FROM [stg].[AH_UserProperties_FinalView] AS up
        left JOIN [stg].[AH_CustomFields_FinalView] as cf
            ON cf.[Id] = up.[CustomFieldId]
        where CustomFieldID=''5''
            or CustomFieldID=''6''
            or CustomFieldID=''161098''
            or CustomFieldID=''2407692''
            or CustomFieldID=''2694978''
            or CustomFieldID=''2708864''
        ) t1
    group by UserID
),
DMstg as (
    SELECT
        HASHBYTES(''SHA2_256'', COALESCE(CAST(u.[ID] AS VARCHAR(200)), '''')) as [Consignor_SKey],
        u.[ID] AS [UserID],
        u.[UserName],
        u.[Email],
        u.[Comment],
        upt.[FirstName],
        upt.[LastName],
        u.[PhoneNumber] AS [Phone],
        upt.[Phone] AS [UserPhone],
        upt.[IsInternational],
        upt.[Reg_Reference],
        upt.[Reg_Referral],
        u.[BillingAddressID],
        badd.[Street1] + '' '' + badd.[Street2] AS [BillingAddress],
        badd.[City] AS [BillingCity],
        badd.[StateRegion] AS [BillingState],
        badd.[ZipPostal] AS [BillingPostalCode],
        bc.[Name] AS [BillingCountry],
        u.[PrimaryAddressID],
        padd.[Street1] + '' '' + padd.[Street2] AS [PrimaryAddress],
        padd.[City] AS [PrimaryCity],
        padd.[StateRegion] AS [PrimaryState],
        padd.[ZipPostal] AS [PrimaryPostalCode],
        pc.[Name] AS [PrimaryCountry],
        u.[BillingCreditCardID],
        c.[ExpirationMonth] AS [CreditCardExpirationMonth],
        c.[ExpirationYear] AS [CreditCardExpirationYear],
        c.[LastFourDigits] AS [CreditCardLastFourDigits],
        c.[AddressID] AS [CreditCardAddressID],
        cadd.[Street1] + '' '' + cadd.[Street2] AS [CreditCardAddress],
        cadd.[City] AS [CreditCardCity],
        cadd.[StateRegion] AS [CreditCardState],
        cadd.[ZipPostal] AS [CreditCardPostalCode],
        cc.[Name] AS [CreditCardCountry],
        u.[Culture],
        u.[IsApproved],
        u.[IsLockedOut],
        u.[Newsletter],
        u.[IsVerified],
        u.[IsActive],
        u.[EmailConfirmed],
        u.[LastLoginDate],
        u.[LastActivityDate],
        u.[CreatedOn] AS [CreatedDate],
        u.[UpdatedOn] AS [UpdatedDate],
        u.[DeletedOn] AS [DeletedDate]
    from [stg].[AH_Users_FinalView] u
    left join UserProperties_temp upt on u.ID=upt.UserID
    left join [stg].[AH_CreditCards_FinalView] c on u.BillingCreditCardID=c.ID
    left join [stg].[AH_Addresses_FinalView] badd on badd.ID=u.BillingAddressID
    left join [stg].[AH_Addresses_FinalView] padd on padd.ID=u.PrimaryAddressID
    left join [stg].[AH_Addresses_FinalView] cadd on cadd.ID=c.AddressID
    left join [stg].[AH_Countries_FinalView] bc on  badd.CountryID=bc.ID
    left join [stg].[AH_Countries_FinalView] pc on  padd.CountryID=pc.ID
    left join [stg].[AH_Countries_FinalView] cc on  cadd.CountryID=cc.ID
    where u.ID in(
        select distinct(OwnerID) from [stg].[AH_Listings_FinalView]
    )
)
SELECT
	[Consignor_SKey],
    [UserID],
	[UserName],
	[Email],
	[Comment],
	[FirstName],
	[LastName],
	[Phone],
	[UserPhone],
	[IsInternational],
	[Reg_Reference],
	[Reg_Referral],
	[BillingAddressID],
	[BillingAddress],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[PrimaryAddressID],
	[PrimaryAddress],
	[PrimaryCity],
	[PrimaryState],
	[PrimaryPostalCode],
	[PrimaryCountry],
	[BillingCreditCardID],
	[CreditCardExpirationMonth],
	[CreditCardExpirationYear],
	[CreditCardLastFourDigits],
	[CreditCardAddressID],
	[CreditCardAddress],
	[CreditCardCity],
	[CreditCardState],
	[CreditCardPostalCode],
	[CreditCardCountry],
	[Culture],
	[IsApproved],
	[IsLockedOut],
	[Newsletter],
	[IsVerified],
	[IsActive],
	[EmailConfirmed],
	[LastLoginDate],
	[LastActivityDate],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMstg
    ');

  CREATE TABLE "dbo"."AH_Consignors_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Consignors_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Consignors_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Consignors_DM__dbt_tmp_temp_view"
    end



22:01:16.074857 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:01:16.075007 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:16.072739 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
22:01:16.075869 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
  
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Currencies_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Currencies_DM__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [CurrencyId],
	[ConversionToUSD],
	[Code],
	[LastUpdatedUser],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_Currencies_FinalView];
    ');

  CREATE TABLE "dbo"."AH_Currencies_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Currencies_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Currencies_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Currencies_DM__dbt_tmp_temp_view"
    end



22:01:16.076016 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:01:16.076149 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:16.077212 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Categories_DM"
22:01:16.077936 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
22:01:16.078096 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
  
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Categories_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Categories_DM__dbt_tmp_temp_view as
    
SELECT
	Id,
	Name,
	ParentCategoryId,
	DisplayOrder,
	LastUpdatedUser,
	Type,
	MVCAction,
	RolesAllowed,
	EnabledCustomProperty,
	lft,
	rgt,
	CreatedOn,
	UpdatedOn,
	DeletedOn
FROM stg.AH_Categories_FinalView;
    ');

  CREATE TABLE "dbo"."AH_Categories_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Categories_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Categories_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Categories_DM__dbt_tmp_temp_view"
    end



22:01:16.078225 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:01:16.078358 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:16.215267 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:16.222772 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:16.224491 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:16.225854 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:18.216168 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.14 seconds
22:01:18.301830 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
22:01:18.302182 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo"."AH_Currencies_DM" to AH_Currencies_DM__dbt_backup
22:01:18.374904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.30 seconds
22:01:18.387413 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
22:01:18.387732 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo"."AH_Categories_DM" to AH_Categories_DM__dbt_backup
22:01:18.715283 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
22:01:18.727268 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
22:01:18.727486 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
22:01:18.727685 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: rename object "dbo"."AH_Currencies_DM__dbt_tmp" to AH_Currencies_DM
22:01:18.737477 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
22:01:18.737940 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: rename object "dbo"."AH_Categories_DM__dbt_tmp" to AH_Categories_DM
22:01:18.767593 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:18.767933 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:18.779304 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: COMMIT
22:01:18.779926 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: COMMIT
22:01:18.789995 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Categories_DM".
22:01:18.791482 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Categories_DM: 
    
  if object_id ('"dbo"."AH_Categories_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Categories_DM__dbt_backup"
    end

22:01:18.791289 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Currencies_DM".
22:01:18.791795 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_Currencies_DM: 
    
  if object_id ('"dbo"."AH_Currencies_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Currencies_DM__dbt_backup"
    end

22:01:19.080839 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
22:01:19.092295 [debug] [Thread-2  ]: finished collecting timing info
22:01:19.092654 [debug] [Thread-2  ]: On model.Shawn.AH_Categories_DM: Close
22:01:19.093341 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68283c8b0>]}
22:01:19.093801 [info ] [Thread-2  ]: 2 of 5 OK created table model dbo.AH_Categories_DM.............................. [[32mOK[0m in 3.17s]
22:01:19.094205 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Categories_DM
22:01:19.094396 [debug] [Thread-2  ]: Began running node model.Shawn.AH_ShippingOptions_DM
22:01:19.094771 [info ] [Thread-2  ]: 5 of 5 START table model dbo.AH_ShippingOptions_DM.............................. [RUN]
22:01:19.095192 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_ShippingOptions_DM"
22:01:19.095343 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_ShippingOptions_DM
22:01:19.095474 [debug] [Thread-2  ]: Compiling model.Shawn.AH_ShippingOptions_DM
22:01:19.097933 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_ShippingOptions_DM"
22:01:19.098309 [debug] [Thread-2  ]: finished collecting timing info
22:01:19.098457 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_ShippingOptions_DM
22:01:19.115643 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
22:01:19.125188 [debug] [Thread-4  ]: finished collecting timing info
22:01:19.130495 [debug] [Thread-4  ]: On model.Shawn.AH_Currencies_DM: Close
22:01:19.131193 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe68283c070>]}
22:01:19.131598 [info ] [Thread-4  ]: 4 of 5 OK created table model dbo.AH_Currencies_DM.............................. [[32mOK[0m in 3.22s]
22:01:19.131956 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_Currencies_DM
22:01:19.130176 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_ShippingOptions_DM"
22:01:19.132510 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
22:01:19.132664 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
  
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view as
    
SELECT
	so.[Id] AS [ShippingOptionID],
	so.[ShippingMethodId] AS [ShippingMethodID],
	sm.[Name] AS [ShippingMethod],
	so.[FirstItemAmount],
	so.[ListingId] AS [ListingID],
	so.[AdditionalItemAmount],
	so.[CreatedOn] AS [CreatedDate],
	so.[UpdatedOn] AS [UpdatedDate],
	so.[DeletedOn] AS [DeletedDate]
From
	[stg].[AH_ShippingOptions_FinalView] AS so
left JOIN [stg].[AH_ShippingMethods_FinalView] AS sm 
on so.ShippingMethodID=sm.ID
    ');

  CREATE TABLE "dbo"."AH_ShippingOptions_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ShippingOptions_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ShippingOptions_DM__dbt_tmp_temp_view"
    end



22:01:19.132786 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:01:19.132922 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:19.259024 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:21.443797 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.31 seconds
22:01:21.456619 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
22:01:21.456913 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo"."AH_ShippingOptions_DM" to AH_ShippingOptions_DM__dbt_backup
22:01:21.513646 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
22:01:21.525062 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
22:01:21.525377 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: rename object "dbo"."AH_ShippingOptions_DM__dbt_tmp" to AH_ShippingOptions_DM
22:01:21.574532 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
22:01:21.576383 [debug] [Thread-2  ]: On model.Shawn.AH_ShippingOptions_DM: COMMIT
22:01:21.580155 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ShippingOptions_DM".
22:01:21.580371 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_ShippingOptions_DM: 
    
  if object_id ('"dbo"."AH_ShippingOptions_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ShippingOptions_DM__dbt_backup"
    end

22:01:21.829158 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
22:01:21.839794 [debug] [Thread-2  ]: finished collecting timing info
22:01:21.840203 [debug] [Thread-2  ]: On model.Shawn.AH_ShippingOptions_DM: Close
22:01:21.840956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6806e4f70>]}
22:01:21.841435 [info ] [Thread-2  ]: 5 of 5 OK created table model dbo.AH_ShippingOptions_DM......................... [[32mOK[0m in 2.75s]
22:01:21.841802 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_ShippingOptions_DM
22:01:22.744945 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.67 seconds
22:01:22.758141 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
22:01:22.758483 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo"."AH_Consignors_DM" to AH_Consignors_DM__dbt_backup
22:01:22.800363 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:01:22.811793 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
22:01:22.812098 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: rename object "dbo"."AH_Consignors_DM__dbt_tmp" to AH_Consignors_DM
22:01:22.846027 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:22.847950 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: COMMIT
22:01:22.851960 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Consignors_DM".
22:01:22.852173 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_Consignors_DM: 
    
  if object_id ('"dbo"."AH_Consignors_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Consignors_DM__dbt_backup"
    end

22:01:23.130642 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
22:01:23.142863 [debug] [Thread-3  ]: finished collecting timing info
22:01:23.143242 [debug] [Thread-3  ]: On model.Shawn.AH_Consignors_DM: Close
22:01:23.144019 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6827b0160>]}
22:01:23.144497 [info ] [Thread-3  ]: 3 of 5 OK created table model dbo.AH_Consignors_DM.............................. [[32mOK[0m in 7.23s]
22:01:23.144867 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_Consignors_DM
22:01:27.211349 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 11.14 seconds
22:01:27.223898 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
22:01:27.224191 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo"."AH_Buyers_DM" to AH_Buyers_DM__dbt_backup
22:01:27.260125 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:01:27.271698 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
22:01:27.272028 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: rename object "dbo"."AH_Buyers_DM__dbt_tmp" to AH_Buyers_DM
22:01:27.303114 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:27.305034 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: COMMIT
22:01:27.309855 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Buyers_DM".
22:01:27.310067 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Buyers_DM: 
    
  if object_id ('"dbo"."AH_Buyers_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Buyers_DM__dbt_backup"
    end

22:01:27.909203 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.60 seconds
22:01:27.919831 [debug] [Thread-1  ]: finished collecting timing info
22:01:27.920145 [debug] [Thread-1  ]: On model.Shawn.AH_Buyers_DM: Close
22:01:27.920845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8fdb24a-8b8a-4760-84a4-a22b4804074e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6807655e0>]}
22:01:27.921282 [info ] [Thread-1  ]: 1 of 5 OK created table model dbo.AH_Buyers_DM.................................. [[32mOK[0m in 12.01s]
22:01:27.921642 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Buyers_DM
22:01:27.923123 [debug] [MainThread]: Acquiring new synapse connection "master"
22:01:27.923420 [debug] [MainThread]: On master: COMMIT
22:01:27.923761 [info ] [MainThread]: 
22:01:27.924020 [info ] [MainThread]: Finished running 5 table models in 26.76s.
22:01:27.924219 [debug] [MainThread]: Connection 'master' was properly closed.
22:01:27.924325 [debug] [MainThread]: Connection 'model.Shawn.AH_Buyers_DM' was properly closed.
22:01:27.924425 [debug] [MainThread]: Connection 'model.Shawn.AH_ShippingOptions_DM' was properly closed.
22:01:27.924519 [debug] [MainThread]: Connection 'model.Shawn.AH_Consignors_DM' was properly closed.
22:01:27.924611 [debug] [MainThread]: Connection 'model.Shawn.AH_Currencies_DM' was properly closed.
22:01:27.951053 [info ] [MainThread]: 
22:01:27.951448 [info ] [MainThread]: [32mCompleted successfully[0m
22:01:27.951748 [info ] [MainThread]: 
22:01:27.951995 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
22:01:27.952296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6844b4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6844b4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6827fc9a0>]}


============================== 2022-09-14 22:01:30.161486 | c253d8fb-4cad-4a16-8407-c95d3b39b1ff ==============================
22:01:30.161486 [info ] [MainThread]: Running with dbt=1.0.0
22:01:30.166912 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_1_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:01:30.167231 [debug] [MainThread]: Tracking: tracking
22:01:30.167589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd7769d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd7769d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd7769df0>]}
22:01:30.363635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:01:30.364015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:01:30.389756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd76d4280>]}
22:01:30.434424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd74799a0>]}
22:01:30.434922 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:01:30.442597 [info ] [MainThread]: 
22:01:30.443230 [debug] [MainThread]: Acquiring new synapse connection "master"
22:01:30.444467 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:01:30.453988 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:01:30.454214 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:01:30.454348 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:30.454495 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:30.758680 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:30.790826 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.34 seconds
22:01:30.792845 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:01:30.814949 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:01:30.820973 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:01:30.821369 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:01:30.823168 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:01:30.823357 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:01:30.823481 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:30.823613 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:30.821649 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:01:30.825125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:01:30.825296 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:30.941810 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:30.944545 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:30.979213 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:01:30.984371 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:01:31.010421 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:01:31.013620 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:01:31.154731 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:01:31.163820 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:01:45.062958 [debug] [MainThread]: On master: COMMIT
22:01:45.063624 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:01:45.063955 [info ] [MainThread]: 
22:01:45.067674 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_stg
22:01:45.068372 [info ] [Thread-1  ]: 1 of 6 START table model stg.AH_Invoices_FT_stg................................. [RUN]
22:01:45.068899 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_stg"
22:01:45.069079 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_stg
22:01:45.067935 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_stg
22:01:45.069574 [info ] [Thread-2  ]: 2 of 6 START table model stg.AH_LineItems_FT_stg................................ [RUN]
22:01:45.070009 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_stg"
22:01:45.070160 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_stg
22:01:45.070285 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_stg
22:01:45.068040 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_stg
22:01:45.073365 [info ] [Thread-3  ]: 3 of 6 START table model stg.AH_ListingActions_FT_stg........................... [RUN]
22:01:45.073813 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_stg"
22:01:45.073970 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_stg
22:01:45.074100 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_stg
22:01:45.068125 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_stg
22:01:45.076923 [info ] [Thread-4  ]: 4 of 6 START table model stg.AH_ListingPaymentCharge_FT_stg..................... [RUN]
22:01:45.077373 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg"
22:01:45.077533 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_stg
22:01:45.077663 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_stg
22:01:45.069244 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_stg
22:01:45.082334 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_stg"
22:01:45.073071 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_stg"
22:01:45.083011 [debug] [Thread-2  ]: finished collecting timing info
22:01:45.083449 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_stg
22:01:45.076639 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_stg"
22:01:45.083336 [debug] [Thread-1  ]: finished collecting timing info
22:01:45.091977 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_stg
22:01:45.080068 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
22:01:45.108917 [debug] [Thread-3  ]: finished collecting timing info
22:01:45.114448 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_stg
22:01:45.114807 [debug] [Thread-4  ]: finished collecting timing info
22:01:45.116323 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_stg
22:01:45.360178 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_stg"
22:01:45.360799 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_stg"
22:01:45.377744 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
22:01:45.378152 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
  
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [LineItemsID],
		[OwnerId] AS [OwnerID],
		[PayerId] AS [PayerID],
		[InvoiceId] AS [InvoiceID],
		[ListingId] AS [ListingID],
		[Description],
		[LastUpdatedUser],
		[Currency],
		[Status],
		[Type],
		[TotalAmount],
		[Quantity] AS [QTY],
		[PerUnitAmount],
		[Taxable] AS [IsTaxable],
		[IsArchived],
		[Relistiteration],
		[BuyersPremiumApplies] AS [HasBuyerPremiumApplies],
		[IsPayerArchived],
		[DateStamp],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_LineItems_FinalView];
    ');

  CREATE TABLE "stg"."AH_LineItems_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_stg__dbt_tmp_temp_view"
    end



22:01:45.378297 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:01:45.378450 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:45.378047 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
22:01:45.384297 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
  
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingActionID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[ActionDTTM],
		[Description],
		[LastUpdatedUser],
		[Amount],
		[ProxyAmount],
		[Quantity] AS [QTY],
		[Reason],
		[Status],
		[UserEntered] AS [HasUserEntered],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
FROM [stg].[AH_ListingActions_FinalView];
    ');

  CREATE TABLE "stg"."AH_ListingActions_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_stg__dbt_tmp_temp_view"
    end



22:01:45.384478 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:01:45.384634 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:45.376988 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_stg"
22:01:45.385974 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
22:01:45.386145 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
  
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_FT_stg__dbt_tmp_temp_view as
    
SELECT
	[Id] AS [InvoiceID],
	[PayerId] AS [PayerID],
	[OwnerId] AS [OwnerID],
	[CreatedOn] AS [CreatedDate],
	[UpdatedOn] AS [UpdatedDate],
	[DeletedOn] AS [DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comments] AS [Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingStateRegion] AS [ShippingState],
	[ShippingZipPostal] AS [ShippingPostalCode],
	[ShippingCountry],
	[BIllingFIrstName] AS [BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingStateRegion] AS [BillingState],
	[BillingZIpPostal] AS [BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[Shipped] AS [HasShipped],
	[ShippingDetails],
	[BuyersPremiumPercent] AS [BuyerPremiumPct],
	[BuyersPremiumAmount] AS [BuyerPremiumAmount],
	[IsArchived]
FROM [stg].[AH_Invoices_FinalView];
    ');

  CREATE TABLE "stg"."AH_Invoices_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_stg__dbt_tmp_temp_view"
    end



22:01:45.386275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:01:45.386403 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:45.382807 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_stg"
22:01:45.387952 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
22:01:45.388107 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [ListingPaymentChargeID],
		[BuyerId],
		[ListingId] AS [ListingID],
		[ChargeAmount],
		[TotalBid],
		[BidHoldPercentage],
		[MaximumBidCharge],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM stg.AH_ListingPaymentCharge_FinalView;
    ');

  CREATE TABLE "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp_temp_view"
    end



22:01:45.388222 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:01:45.388349 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:45.486427 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:45.495815 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:45.496470 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:45.507003 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:47.938083 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.55 seconds
22:01:48.014785 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
22:01:48.015157 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "stg"."AH_ListingPaymentCharge_FT_stg" to AH_ListingPaymentCharge_FT_stg__dbt_backup
22:01:48.084321 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:01:48.095781 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
22:01:48.096120 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: rename object "stg"."AH_ListingPaymentCharge_FT_stg__dbt_tmp" to AH_ListingPaymentCharge_FT_stg
22:01:48.129668 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:48.141193 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: COMMIT
22:01:48.147591 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_stg".
22:01:48.147895 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_stg: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_stg__dbt_backup"
    end

22:01:48.421391 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
22:01:48.432057 [debug] [Thread-4  ]: finished collecting timing info
22:01:48.432469 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_stg: Close
22:01:48.433244 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd53e90a0>]}
22:01:48.433753 [info ] [Thread-4  ]: 4 of 6 OK created table model stg.AH_ListingPaymentCharge_FT_stg................ [[32mOK[0m in 3.36s]
22:01:48.434143 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_stg
22:01:48.434338 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_stg
22:01:48.434733 [info ] [Thread-4  ]: 5 of 6 START table model stg.AH_SubmittedListingPayment_FT_stg.................. [RUN]
22:01:48.435179 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg"
22:01:48.435337 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_stg
22:01:48.435473 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_stg
22:01:48.438034 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
22:01:48.438510 [debug] [Thread-4  ]: finished collecting timing info
22:01:48.438704 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_stg
22:01:48.446364 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 3.07 seconds
22:01:48.470100 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
22:01:48.470375 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "stg"."AH_LineItems_FT_stg" to AH_LineItems_FT_stg__dbt_backup
22:01:48.481091 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.09 seconds
22:01:48.503689 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:48.504788 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
22:01:48.505916 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "stg"."AH_Invoices_FT_stg" to AH_Invoices_FT_stg__dbt_backup
22:01:48.521953 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
22:01:48.531807 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: rename object "stg"."AH_LineItems_FT_stg__dbt_tmp" to AH_LineItems_FT_stg
22:01:48.534033 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_stg"
22:01:48.534498 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
22:01:48.534702 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [SubmittedListingPaymentID],
		[ConsignorId] AS [UserID],
		[ListingId] AS [ListingID],
		[Amount],
		[HasProPhotography],
		[HasProMarketing],
		[TransactionId] AS [TransactionID],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate]
FROM [stg].[AH_SubmittedListingPayment_FinalView];
    ');

  CREATE TABLE "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp_temp_view"
    end



22:01:48.534829 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:01:48.534969 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:48.536848 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:48.547791 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
22:01:48.548014 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: rename object "stg"."AH_Invoices_FT_stg__dbt_tmp" to AH_Invoices_FT_stg
22:01:48.559549 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:48.562693 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: COMMIT
22:01:48.567754 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_stg".
22:01:48.567953 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_stg: 
    
  if object_id ('"stg"."AH_LineItems_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_stg__dbt_backup"
    end

22:01:48.575858 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:48.577228 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: COMMIT
22:01:48.581252 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_stg".
22:01:48.581447 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_stg: 
    
  if object_id ('"stg"."AH_Invoices_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_stg__dbt_backup"
    end

22:01:48.657001 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:49.079346 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.51 seconds
22:01:49.088625 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.51 seconds
22:01:49.092734 [debug] [Thread-2  ]: finished collecting timing info
22:01:49.101345 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_stg: Close
22:01:49.102011 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd535e9d0>]}
22:01:49.102450 [info ] [Thread-2  ]: 2 of 6 OK created table model stg.AH_LineItems_FT_stg........................... [[32mOK[0m in 4.03s]
22:01:49.102868 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_stg
22:01:49.103050 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Watches_FT_stg
22:01:49.103401 [info ] [Thread-2  ]: 6 of 6 START table model stg.AH_Watches_FT_stg.................................. [RUN]
22:01:49.103870 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_stg"
22:01:49.104041 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Watches_FT_stg
22:01:49.104178 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Watches_FT_stg
22:01:49.101031 [debug] [Thread-1  ]: finished collecting timing info
22:01:49.106835 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_stg: Close
22:01:49.107377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd535ea60>]}
22:01:49.107722 [info ] [Thread-1  ]: 1 of 6 OK created table model stg.AH_Invoices_FT_stg............................ [[32mOK[0m in 4.04s]
22:01:49.108033 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_stg
22:01:49.106620 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_stg"
22:01:49.108490 [debug] [Thread-2  ]: finished collecting timing info
22:01:49.108643 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Watches_FT_stg
22:01:49.168932 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_stg"
22:01:49.169579 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
22:01:49.169762 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
  
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_FT_stg__dbt_tmp_temp_view as
    
SELECT
		[Id] AS [WatchID],
		[UserId] AS [UserID],
		[ListingId] AS [ListingID],
		[LastUpdatedUser],
		[CreatedOn] AS [CreatedDate],
		[UpdatedOn] AS [UpdatedDate],
		[DeletedOn] AS [DeletedDate]
From [stg].[AH_Watches_FinalView]
    ');

  CREATE TABLE "stg"."AH_Watches_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_stg__dbt_tmp_temp_view"
    end



22:01:49.169885 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:01:49.170027 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:49.276945 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:50.788560 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 2.25 seconds
22:01:50.800958 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
22:01:50.801262 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "stg"."AH_SubmittedListingPayment_FT_stg" to AH_SubmittedListingPayment_FT_stg__dbt_backup
22:01:50.831250 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:50.843289 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
22:01:50.843626 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: rename object "stg"."AH_SubmittedListingPayment_FT_stg__dbt_tmp" to AH_SubmittedListingPayment_FT_stg
22:01:50.874085 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:50.875915 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: COMMIT
22:01:50.879857 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_stg".
22:01:50.880080 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_stg: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_stg__dbt_backup"
    end

22:01:50.889481 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 5.50 seconds
22:01:50.900641 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
22:01:50.900866 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "stg"."AH_ListingActions_FT_stg" to AH_ListingActions_FT_stg__dbt_backup
22:01:50.929684 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:50.941272 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
22:01:50.941630 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: rename object "stg"."AH_ListingActions_FT_stg__dbt_tmp" to AH_ListingActions_FT_stg
22:01:50.969342 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:01:50.971386 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: COMMIT
22:01:50.975471 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_stg".
22:01:50.975698 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_stg: 
    
  if object_id ('"stg"."AH_ListingActions_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_stg__dbt_backup"
    end

22:01:51.060195 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
22:01:51.071495 [debug] [Thread-4  ]: finished collecting timing info
22:01:51.071906 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_stg: Close
22:01:51.072645 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd6eef730>]}
22:01:51.073115 [info ] [Thread-4  ]: 5 of 6 OK created table model stg.AH_SubmittedListingPayment_FT_stg............. [[32mOK[0m in 2.64s]
22:01:51.073487 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_stg
22:01:51.151475 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
22:01:51.162874 [debug] [Thread-3  ]: finished collecting timing info
22:01:51.163254 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_stg: Close
22:01:51.164031 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd53e9400>]}
22:01:51.164537 [info ] [Thread-3  ]: 3 of 6 OK created table model stg.AH_ListingActions_FT_stg...................... [[32mOK[0m in 6.09s]
22:01:51.164925 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_stg
22:01:51.973968 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
22:01:51.986326 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
22:01:51.986682 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "stg"."AH_Watches_FT_stg" to AH_Watches_FT_stg__dbt_backup
22:01:52.022480 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:01:52.035160 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
22:01:52.035503 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: rename object "stg"."AH_Watches_FT_stg__dbt_tmp" to AH_Watches_FT_stg
22:01:52.099106 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
22:01:52.100860 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_stg: COMMIT
22:01:52.104750 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_stg".
22:01:52.104972 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_stg: 
    
  if object_id ('"stg"."AH_Watches_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_stg__dbt_backup"
    end

22:01:52.295384 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.19 seconds
22:01:52.307668 [debug] [Thread-2  ]: finished collecting timing info
22:01:52.308037 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_stg: Close
22:01:52.308782 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c253d8fb-4cad-4a16-8407-c95d3b39b1ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd4294580>]}
22:01:52.309260 [info ] [Thread-2  ]: 6 of 6 OK created table model stg.AH_Watches_FT_stg............................. [[32mOK[0m in 3.21s]
22:01:52.309623 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Watches_FT_stg
22:01:52.311126 [debug] [MainThread]: Acquiring new synapse connection "master"
22:01:52.311429 [debug] [MainThread]: On master: COMMIT
22:01:52.311782 [info ] [MainThread]: 
22:01:52.312040 [info ] [MainThread]: Finished running 6 table models in 21.87s.
22:01:52.312242 [debug] [MainThread]: Connection 'master' was properly closed.
22:01:52.312351 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_stg' was properly closed.
22:01:52.312451 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoices_FT_stg' was properly closed.
22:01:52.312546 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT_stg' was properly closed.
22:01:52.312640 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_stg' was properly closed.
22:01:52.340414 [info ] [MainThread]: 
22:01:52.340870 [info ] [MainThread]: [32mCompleted successfully[0m
22:01:52.341188 [info ] [MainThread]: 
22:01:52.341387 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
22:01:52.341703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd76f2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd974f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fd539c850>]}


============================== 2022-09-14 22:01:54.599621 | 807dab1f-106a-4acf-8cfe-88868f339fc2 ==============================
22:01:54.599621 [info ] [MainThread]: Running with dbt=1.0.0
22:01:54.602847 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_2_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:01:54.606632 [debug] [MainThread]: Tracking: tracking
22:01:54.607093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d0a1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d0a1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d0a1e80>]}
22:01:54.801561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:01:54.801965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:01:54.828062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1d00f310>]}
22:01:54.875555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1f0a4a30>]}
22:01:54.876087 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:01:54.884030 [info ] [MainThread]: 
22:01:54.884694 [debug] [MainThread]: Acquiring new synapse connection "master"
22:01:54.885998 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:01:54.895129 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:01:54.895360 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:01:54.895494 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:54.895638 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:55.195133 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:55.227824 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
22:01:55.229590 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:01:55.251086 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:01:55.257194 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:01:55.257781 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:01:55.259532 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:01:55.259728 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:01:55.259854 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:01:55.259991 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:55.257992 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:01:55.261494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:01:55.261671 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:01:55.377488 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:55.380319 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:01:55.411516 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:01:55.413034 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:01:55.441199 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:01:55.441610 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:01:55.583834 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:01:55.595823 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:02:09.629823 [debug] [MainThread]: On master: COMMIT
22:02:09.630586 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:02:09.630950 [info ] [MainThread]: 
22:02:09.634180 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoices_FT_tmp
22:02:09.635427 [info ] [Thread-1  ]: 1 of 6 START table model stg.AH_Invoices_FT_tmp................................. [RUN]
22:02:09.636007 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoices_FT_tmp"
22:02:09.636187 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoices_FT_tmp
22:02:09.634443 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT_tmp
22:02:09.636708 [info ] [Thread-2  ]: 2 of 6 START table model stg.AH_LineItems_FT_tmp................................ [RUN]
22:02:09.637157 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT_tmp"
22:02:09.637310 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT_tmp
22:02:09.637438 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT_tmp
22:02:09.634587 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT_tmp
22:02:09.640613 [info ] [Thread-3  ]: 3 of 6 START table model stg.AH_ListingActions_FT_tmp........................... [RUN]
22:02:09.641075 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT_tmp"
22:02:09.641234 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT_tmp
22:02:09.641365 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT_tmp
22:02:09.643968 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
22:02:09.636353 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoices_FT_tmp
22:02:09.634682 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
22:02:09.647054 [info ] [Thread-4  ]: 4 of 6 START table model stg.AH_ListingPaymentCharge_FT_tmp..................... [RUN]
22:02:09.647530 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
22:02:09.647688 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT_tmp
22:02:09.647816 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT_tmp
22:02:09.650339 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
22:02:09.640308 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT_tmp"
22:02:09.651261 [debug] [Thread-2  ]: finished collecting timing info
22:02:09.651432 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT_tmp
22:02:09.646742 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoices_FT_tmp"
22:02:09.650898 [debug] [Thread-3  ]: finished collecting timing info
22:02:09.660213 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT_tmp
22:02:09.660463 [debug] [Thread-4  ]: finished collecting timing info
22:02:09.693916 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT_tmp
22:02:09.660631 [debug] [Thread-1  ]: finished collecting timing info
22:02:09.737333 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoices_FT_tmp
22:02:09.917521 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT_tmp"
22:02:09.922498 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT_tmp"
22:02:09.926136 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT_tmp"
22:02:09.936589 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
22:02:09.937242 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
  
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		li.[LineItemsID],
		c.[Consignor_Skey],
		b.[Buyer_Skey],
		li.[OwnerID],
		li.[PayerID],
		li.[InvoiceID],
		li.[ListingID],
		li.[Description],
		li.[LastUpdatedUser],
		li.[Currency],
		li.[Status],
		li.[Type],
		li.[TotalAmount],
		li.[QTY],
		li.[PerUnitAmount],
		li.[IsTaxable],
		li.[IsArchived],
		li.[Relistiteration],
		li.[HasBuyerPremiumApplies],
		li.[IsPayerArchived],
		li.[DateStamp],
		li.[CreatedDate],
		li.[UpdatedDate],
		li.[DeletedDate]
FROM
	[stg].[AH_LineItems_FT_stg] li
left join [dbo].[AH_Buyers_DM] b on li.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on li.OwnerID=c.UserID
    ');

  CREATE TABLE "stg"."AH_LineItems_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_LineItems_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_LineItems_FT_tmp__dbt_tmp_temp_view"
    end



22:02:09.937388 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:02:09.937554 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:09.937133 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
22:02:09.938879 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		lpc.[ListingPaymentChargeID],
		b.[Buyer_Skey],
		lpc.[BuyerId],
		lpc.[ListingID],
		lpc.[ChargeAmount],
		lpc.[TotalBid],
		lpc.[BidHoldPercentage],
		lpc.[MaximumBidCharge],
		lpc.[TransactionID],
		lpc.[CreatedDate],
		lpc.[UpdatedDate]
FROM 	[stg].[AH_ListingPaymentCharge_FT_stg] lpc
left join [dbo].[AH_Buyers_DM] b on lpc.BuyerId=b.UserID
    ');

  CREATE TABLE "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp_temp_view"
    end



22:02:09.939079 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:02:09.939252 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:09.936879 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
22:02:09.940143 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
  
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		la.[ListingActionID],
		b.[Buyer_Skey],
		la.[UserID],
		la.[ListingID],
		la.[ActionDTTM],
		la.[Description],
		la.[LastUpdatedUser],
		la.[Amount],
		la.[ProxyAmount],
		la.[QTY],
		la.[Reason],
		la.[Status],
		la.[HasUserEntered],
		la.[CreatedDate],
		la.[UpdatedDate],
		la.[DeletedDate]
FROM	[stg].[AH_ListingActions_FT_stg] la
left join [dbo].[AH_Buyers_DM] b on la.UserID=b.UserID
    ');

  CREATE TABLE "stg"."AH_ListingActions_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_ListingActions_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_ListingActions_FT_tmp__dbt_tmp_temp_view"
    end



22:02:09.940310 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:02:09.940454 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:09.948126 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoices_FT_tmp"
22:02:09.948767 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
22:02:09.948965 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
  
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view as
    
SELECT
	i.[InvoiceID],
	
    c.[Consignor_Skey],
    b.[Buyer_Skey],
	
    i.[PayerID],
    i.[OwnerID],
	
    i.[CreatedDate],
    i.[UpdatedDate],
    i.[DeletedDate],
    i.[Status],
    i.[CreatedDTTM],
    i.[FulfilledDTTM],
    i.[Comment],
    i.[LastUpdatedUser],
    i.[Currency],
    i.[Type],
    i.[ShippingAmount],
    i.[Subtotal],
    i.[Total],
	
    i.[ShippingFirstName],
    i.[ShippingLastName],
    i.[ShippingStreet1],
    i.[ShippingStreet2],
    i.[ShippingCity],
    i.[ShippingState],
    i.[ShippingPostalCode],
    i.[ShippingCountry],
	
    i.[BillingFIrstName],
    i.[BillingLastName],
    i.[BillingStreet1],
    i.[BillingStreet2],
    i.[BillingCity],
    i.[BillingState],
    i.[BillingPostalCode],
    i.[BillingCountry],
	
    i.[SalesTax],
    
    i.[PaidDTTM],
    i.[IsPayerLocked],
    i.[HasShipped],
    i.[ShippingDetails],
    i.[BuyerPremiumPct],
    i.[BuyerPremiumAmount],
    i.[IsArchived]
FROM
	[stg].[AH_Invoices_FT_stg] i
left join [dbo].[AH_Buyers_DM] b on i.PayerID=b.UserID
left join [dbo].[AH_Consignors_DM] c on i.OwnerID=c.UserID
    ');

  CREATE TABLE "stg"."AH_Invoices_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Invoices_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Invoices_FT_tmp__dbt_tmp_temp_view"
    end



22:02:09.949091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:02:09.949235 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:10.066999 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:10.085419 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:10.089701 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:10.090368 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:14.825251 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 4.89 seconds
22:02:14.912256 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
22:02:14.912636 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "stg"."AH_ListingPaymentCharge_FT_tmp" to AH_ListingPaymentCharge_FT_tmp__dbt_backup
22:02:14.969109 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.06 seconds
22:02:14.980561 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
22:02:14.980905 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: rename object "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_tmp" to AH_ListingPaymentCharge_FT_tmp
22:02:15.013158 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:15.025356 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: COMMIT
22:02:15.031827 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT_tmp".
22:02:15.032139 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: 
    
  if object_id ('"stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingPaymentCharge_FT_tmp__dbt_backup"
    end

22:02:15.276790 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
22:02:15.287235 [debug] [Thread-4  ]: finished collecting timing info
22:02:15.287577 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT_tmp: Close
22:02:15.288297 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ac8a7f0>]}
22:02:15.288778 [info ] [Thread-4  ]: 4 of 6 OK created table model stg.AH_ListingPaymentCharge_FT_tmp................ [[32mOK[0m in 5.64s]
22:02:15.289166 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT_tmp
22:02:15.289365 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
22:02:15.289722 [info ] [Thread-4  ]: 5 of 6 START table model stg.AH_SubmittedListingPayment_FT_tmp.................. [RUN]
22:02:15.290149 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
22:02:15.290302 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT_tmp
22:02:15.290435 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT_tmp
22:02:15.292956 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
22:02:15.293408 [debug] [Thread-4  ]: finished collecting timing info
22:02:15.293577 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT_tmp
22:02:15.352886 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT_tmp"
22:02:15.353517 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
22:02:15.353708 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		slp.[SubmittedListingPaymentID],
		c.[Consignor_Skey],
		slp.[UserID],
		slp.[ListingID],
		slp.[Amount],
		slp.[HasProPhotography],
		slp.[HasProMarketing],
		slp.[TransactionID],
		slp.[CreatedDate],
		slp.[UpdatedDate]
FROM
	[stg].[AH_SubmittedListingPayment_FT_stg] slp
left join [dbo].[AH_Consignors_DM] c on slp.UserID=c.UserID
    ');

  CREATE TABLE "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp_temp_view"
    end



22:02:15.353839 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:02:15.353986 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:15.459013 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:16.749718 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.81 seconds
22:02:16.762169 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
22:02:16.762534 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "stg"."AH_ListingActions_FT_tmp" to AH_ListingActions_FT_tmp__dbt_backup
22:02:16.799714 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:16.812907 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.88 seconds
22:02:16.812693 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
22:02:16.823959 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: rename object "stg"."AH_ListingActions_FT_tmp__dbt_tmp" to AH_ListingActions_FT_tmp
22:02:16.825847 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
22:02:16.826146 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "stg"."AH_LineItems_FT_tmp" to AH_LineItems_FT_tmp__dbt_backup
22:02:16.855576 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:16.857808 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: COMMIT
22:02:16.861718 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT_tmp".
22:02:16.862101 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:16.862241 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT_tmp: 
    
  if object_id ('"stg"."AH_ListingActions_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_ListingActions_FT_tmp__dbt_backup"
    end

22:02:16.874839 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
22:02:16.875173 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: rename object "stg"."AH_LineItems_FT_tmp__dbt_tmp" to AH_LineItems_FT_tmp
22:02:16.904613 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:16.906634 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: COMMIT
22:02:16.910864 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT_tmp".
22:02:16.911172 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT_tmp: 
    
  if object_id ('"stg"."AH_LineItems_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_LineItems_FT_tmp__dbt_backup"
    end

22:02:17.547738 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.64 seconds
22:02:17.558572 [debug] [Thread-2  ]: finished collecting timing info
22:02:17.559006 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT_tmp: Close
22:02:17.559790 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce18434940>]}
22:02:17.560264 [info ] [Thread-2  ]: 2 of 6 OK created table model stg.AH_LineItems_FT_tmp........................... [[32mOK[0m in 7.92s]
22:02:17.560650 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT_tmp
22:02:17.560861 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Watches_FT_tmp
22:02:17.561210 [info ] [Thread-2  ]: 6 of 6 START table model stg.AH_Watches_FT_tmp.................................. [RUN]
22:02:17.561643 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT_tmp"
22:02:17.561797 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Watches_FT_tmp
22:02:17.561933 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Watches_FT_tmp
22:02:17.564523 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT_tmp"
22:02:17.565005 [debug] [Thread-2  ]: finished collecting timing info
22:02:17.565179 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Watches_FT_tmp
22:02:17.626056 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT_tmp"
22:02:17.626758 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
22:02:17.626974 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
  
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Watches_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		w.[WatchID],
		b.[Buyer_Skey],
		w.[UserID],
		w.[ListingID],
		w.[LastUpdatedUser],
		w.[CreatedDate],
		w.[UpdatedDate],
		w.[DeletedDate]
FROM [stg].[AH_Watches_FT_stg] w
left join [dbo].[AH_Buyers_DM] b on w.UserID=b.UserID
    ');

  CREATE TABLE "stg"."AH_Watches_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Watches_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Watches_FT_tmp__dbt_tmp_temp_view"
    end



22:02:17.627103 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:02:17.627250 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:17.630068 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.76 seconds
22:02:17.640776 [debug] [Thread-3  ]: finished collecting timing info
22:02:17.641148 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT_tmp: Close
22:02:17.642023 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ace6490>]}
22:02:17.642514 [info ] [Thread-3  ]: 3 of 6 OK created table model stg.AH_ListingActions_FT_tmp...................... [[32mOK[0m in 8.00s]
22:02:17.642945 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT_tmp
22:02:17.731640 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:18.022185 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 8.07 seconds
22:02:18.034705 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
22:02:18.035079 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "stg"."AH_Invoices_FT_tmp" to AH_Invoices_FT_tmp__dbt_backup
22:02:18.070436 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:18.082425 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
22:02:18.082809 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: rename object "stg"."AH_Invoices_FT_tmp__dbt_tmp" to AH_Invoices_FT_tmp
22:02:18.123116 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:18.125049 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: COMMIT
22:02:18.129202 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoices_FT_tmp".
22:02:18.129442 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoices_FT_tmp: 
    
  if object_id ('"stg"."AH_Invoices_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Invoices_FT_tmp__dbt_backup"
    end

22:02:18.713174 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.58 seconds
22:02:18.724113 [debug] [Thread-1  ]: finished collecting timing info
22:02:18.724466 [debug] [Thread-1  ]: On model.Shawn.AH_Invoices_FT_tmp: Close
22:02:18.725158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ace6190>]}
22:02:18.725618 [info ] [Thread-1  ]: 1 of 6 OK created table model stg.AH_Invoices_FT_tmp............................ [[32mOK[0m in 9.09s]
22:02:18.725981 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoices_FT_tmp
22:02:19.334099 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 3.98 seconds
22:02:19.347614 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
22:02:19.347933 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "stg"."AH_SubmittedListingPayment_FT_tmp" to AH_SubmittedListingPayment_FT_tmp__dbt_backup
22:02:19.382327 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:19.395371 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
22:02:19.395727 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: rename object "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_tmp" to AH_SubmittedListingPayment_FT_tmp
22:02:19.439217 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:19.441196 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: COMMIT
22:02:19.445056 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT_tmp".
22:02:19.445287 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: 
    
  if object_id ('"stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_SubmittedListingPayment_FT_tmp__dbt_backup"
    end

22:02:19.890010 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.44 seconds
22:02:19.901148 [debug] [Thread-4  ]: finished collecting timing info
22:02:19.901543 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT_tmp: Close
22:02:19.902280 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce18434790>]}
22:02:19.902811 [info ] [Thread-4  ]: 5 of 6 OK created table model stg.AH_SubmittedListingPayment_FT_tmp............. [[32mOK[0m in 4.61s]
22:02:19.903198 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT_tmp
22:02:26.296085 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 8.67 seconds
22:02:26.309458 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
22:02:26.309820 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "stg"."AH_Watches_FT_tmp" to AH_Watches_FT_tmp__dbt_backup
22:02:26.376904 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:02:26.388903 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
22:02:26.389269 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: rename object "stg"."AH_Watches_FT_tmp__dbt_tmp" to AH_Watches_FT_tmp
22:02:26.422313 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:26.424156 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_tmp: COMMIT
22:02:26.428087 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT_tmp".
22:02:26.428351 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT_tmp: 
    
  if object_id ('"stg"."AH_Watches_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Watches_FT_tmp__dbt_backup"
    end

22:02:26.608857 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.18 seconds
22:02:26.620425 [debug] [Thread-2  ]: finished collecting timing info
22:02:26.620823 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT_tmp: Close
22:02:26.621566 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '807dab1f-106a-4acf-8cfe-88868f339fc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce183aa760>]}
22:02:26.622058 [info ] [Thread-2  ]: 6 of 6 OK created table model stg.AH_Watches_FT_tmp............................. [[32mOK[0m in 9.06s]
22:02:26.622629 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Watches_FT_tmp
22:02:26.624043 [debug] [MainThread]: Acquiring new synapse connection "master"
22:02:26.624335 [debug] [MainThread]: On master: COMMIT
22:02:26.624697 [info ] [MainThread]: 
22:02:26.624965 [info ] [MainThread]: Finished running 6 table models in 31.74s.
22:02:26.625171 [debug] [MainThread]: Connection 'master' was properly closed.
22:02:26.625283 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoices_FT_tmp' was properly closed.
22:02:26.625385 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT_tmp' was properly closed.
22:02:26.625479 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT_tmp' was properly closed.
22:02:26.625571 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT_tmp' was properly closed.
22:02:26.653151 [info ] [MainThread]: 
22:02:26.653557 [info ] [MainThread]: [32mCompleted successfully[0m
22:02:26.653868 [info ] [MainThread]: 
22:02:26.654064 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
22:02:26.654362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1f0a4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1cd97ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce1ad0d8e0>]}


============================== 2022-09-14 22:02:28.906714 | 4cfa5270-615d-46e0-b202-eb6024cbfc1e ==============================
22:02:28.906714 [info ] [MainThread]: Running with dbt=1.0.0
22:02:28.907343 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step6_FT_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:02:28.907584 [debug] [MainThread]: Tracking: tracking
22:02:28.907908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c67d6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c67d6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c67d6bb0>]}
22:02:29.106844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:02:29.107294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:02:29.132686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c6743340>]}
22:02:29.178894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c87988b0>]}
22:02:29.179402 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:02:29.187465 [info ] [MainThread]: 
22:02:29.188070 [debug] [MainThread]: Acquiring new synapse connection "master"
22:02:29.189301 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:02:29.198211 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:02:29.198412 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:02:29.198557 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:02:29.198712 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:29.495833 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:29.523921 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
22:02:29.525873 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:02:29.547320 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:02:29.553363 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:02:29.553977 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:02:29.555760 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:02:29.555964 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:02:29.556091 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:02:29.556229 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:29.554188 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:02:29.557732 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:02:29.557909 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:29.658488 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:29.672201 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:29.696964 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:02:29.703994 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:02:29.723368 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:02:29.723735 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:02:29.882557 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:02:29.891833 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:02:43.870495 [debug] [MainThread]: On master: COMMIT
22:02:43.871196 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:02:43.871532 [info ] [MainThread]: 
22:02:43.875218 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Invoice_FT
22:02:43.875885 [info ] [Thread-1  ]: 1 of 6 START table model dbo.AH_Invoice_FT...................................... [RUN]
22:02:43.876389 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Invoice_FT"
22:02:43.876561 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Invoice_FT
22:02:43.876718 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Invoice_FT
22:02:43.875565 [debug] [Thread-3  ]: Began running node model.Shawn.AH_ListingActions_FT
22:02:43.880289 [info ] [Thread-3  ]: 3 of 6 START table model dbo.AH_ListingActions_FT............................... [RUN]
22:02:43.880766 [debug] [Thread-3  ]: Acquiring new synapse connection "model.Shawn.AH_ListingActions_FT"
22:02:43.880925 [debug] [Thread-3  ]: Began compiling node model.Shawn.AH_ListingActions_FT
22:02:43.881058 [debug] [Thread-3  ]: Compiling model.Shawn.AH_ListingActions_FT
22:02:43.875644 [debug] [Thread-4  ]: Began running node model.Shawn.AH_ListingPaymentCharge_FT
22:02:43.883964 [info ] [Thread-4  ]: 4 of 6 START table model dbo.AH_ListingPaymentCharge_FT......................... [RUN]
22:02:43.884411 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_ListingPaymentCharge_FT"
22:02:43.884566 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_ListingPaymentCharge_FT
22:02:43.884696 [debug] [Thread-4  ]: Compiling model.Shawn.AH_ListingPaymentCharge_FT
22:02:43.875462 [debug] [Thread-2  ]: Began running node model.Shawn.AH_LineItems_FT
22:02:43.887474 [info ] [Thread-2  ]: 2 of 6 START table model dbo.AH_LineItems_FT.................................... [RUN]
22:02:43.887886 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_LineItems_FT"
22:02:43.888036 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_LineItems_FT
22:02:43.888161 [debug] [Thread-2  ]: Compiling model.Shawn.AH_LineItems_FT
22:02:43.879961 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Invoice_FT"
22:02:43.891158 [debug] [Thread-1  ]: finished collecting timing info
22:02:43.891333 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Invoice_FT
22:02:43.883676 [debug] [Thread-3  ]: Writing injected SQL for node "model.Shawn.AH_ListingActions_FT"
22:02:43.887189 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
22:02:43.890633 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_LineItems_FT"
22:02:43.900255 [debug] [Thread-4  ]: finished collecting timing info
22:02:43.900710 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_ListingPaymentCharge_FT
22:02:43.900605 [debug] [Thread-3  ]: finished collecting timing info
22:02:43.927762 [debug] [Thread-3  ]: Began executing node model.Shawn.AH_ListingActions_FT
22:02:43.900456 [debug] [Thread-2  ]: finished collecting timing info
22:02:43.930830 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_LineItems_FT
22:02:44.034761 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_ListingPaymentCharge_FT"
22:02:44.036640 [debug] [Thread-3  ]: Writing runtime SQL for node "model.Shawn.AH_ListingActions_FT"
22:02:44.042334 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
22:02:44.042515 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
  
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingActions_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
        FTstg.[ListingActionID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ActionDTTM],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Amount],
		FTstg.[ProxyAmount],
		FTstg.[QTY],
		FTstg.[Reason],
		FTstg.[Status],
		FTstg.[HasUserEntered],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_ListingActions_FT_tmp as FTtmp 
    join stg.AH_ListingActions_FT_stg as FTstg 
    on FTstg.ListingActionID=FTtmp.ListingActionID
)
,
insertData as (
    select 
       	[ListingActionID],
        [Buyer_Skey],
        [ListingID],
        [ActionDTTM],
        [Description],
        [LastUpdatedUser],
        [Amount],
        [ProxyAmount],
        [QTY],
        [Reason],
        [Status],
        [HasUserEntered],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_ListingActions_FT_tmp
    where ListingActionID not in (select  ListingActionID from stg.AH_ListingActions_FT_stg)
)
SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[ListingActionID],
	[Buyer_Skey],
	[ListingID],
	[ActionDTTM],
	[Description],
	[LastUpdatedUser],
	[Amount],
	[ProxyAmount],
	[QTY],
	[Reason],
	[Status],
	[HasUserEntered],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_ListingActions_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingActions_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingActions_FT__dbt_tmp_temp_view"
    end



22:02:44.042690 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:02:44.042845 [debug] [Thread-3  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:44.041569 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Invoice_FT"
22:02:44.039435 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_LineItems_FT"
22:02:44.043930 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
22:02:44.044269 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
  
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Invoice_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Invoice_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
        FTstg.[InvoiceID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Status],
		FTstg.[CreatedDTTM],
		FTstg.[FulfilledDTTM],
		FTstg.[Comment],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Type],
		FTstg.[ShippingAmount],
		FTstg.[Subtotal],
		FTstg.[Total],
		FTstg.[ShippingFirstName],
		FTstg.[ShippingLastName],
		FTstg.[ShippingStreet1],
		FTstg.[ShippingStreet2],
		FTstg.[ShippingCity],
		FTstg.[ShippingState],
		FTstg.[ShippingPostalCode],
		FTstg.[ShippingCountry],
		FTstg.[BillingFIrstName],
		FTstg.[BillingLastName],
		FTstg.[BillingStreet1],
		FTstg.[BillingStreet2],
		FTstg.[BillingCity],
		FTstg.[BillingState],
		FTstg.[BillingPostalCode],
		FTstg.[BillingCountry],
		FTstg.[SalesTax],
		FTstg.[PaidDTTM],
		FTstg.[IsPayerLocked],
		FTstg.[HasShipped],
		FTstg.[ShippingDetails],
		FTstg.[BuyerPremiumPct],
		FTstg.[BuyerPremiumAmount],
		FTstg.[IsArchived]
    from stg.AH_Invoices_FT_tmp as FTtmp 
    join stg.AH_Invoices_FT_stg as FTstg 
    on FTstg.InvoiceID=FTtmp.InvoiceID
),
insertData as (
    select 
        [InvoiceID],
        [Consignor_Skey],
        [Buyer_Skey],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Status],
        [CreatedDTTM],
        [FulfilledDTTM],
        [Comment],
        [LastUpdatedUser],
        [Currency],
        [Type],
        [ShippingAmount],
        [Subtotal],
        [Total],
        [ShippingFirstName],
        [ShippingLastName],
        [ShippingStreet1],
        [ShippingStreet2],
        [ShippingCity],
        [ShippingState],
        [ShippingPostalCode],
        [ShippingCountry],
        [BillingFIrstName],
        [BillingLastName],
        [BillingStreet1],
        [BillingStreet2],
        [BillingCity],
        [BillingState],
        [BillingPostalCode],
        [BillingCountry],
        [SalesTax],
        [PaidDTTM],
        [IsPayerLocked],
        [HasShipped],
        [ShippingDetails],
        [BuyerPremiumPct],
        [BuyerPremiumAmount],
        [IsArchived]
    from stg.AH_Invoices_FT_tmp
    where InvoiceID not in (select  InvoiceID from stg.AH_Invoices_FT_stg)
)
SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from updateData

union all

SELECT
	[InvoiceID],
	[Consignor_Skey],
	[Buyer_Skey],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Status],
	[CreatedDTTM],
	[FulfilledDTTM],
	[Comment],
	[LastUpdatedUser],
	[Currency],
	[Type],
	[ShippingAmount],
	[Subtotal],
	[Total],
	[ShippingFirstName],
	[ShippingLastName],
	[ShippingStreet1],
	[ShippingStreet2],
	[ShippingCity],
	[ShippingState],
	[ShippingPostalCode],
	[ShippingCountry],
	[BillingFIrstName],
	[BillingLastName],
	[BillingStreet1],
	[BillingStreet2],
	[BillingCity],
	[BillingState],
	[BillingPostalCode],
	[BillingCountry],
	[SalesTax],
	[PaidDTTM],
	[IsPayerLocked],
	[HasShipped],
	[ShippingDetails],
	[BuyerPremiumPct],
	[BuyerPremiumAmount],
	[IsArchived]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Invoice_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Invoice_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Invoice_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Invoice_FT__dbt_tmp_temp_view"
    end



22:02:44.044409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:02:44.044552 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:44.044171 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
22:02:44.046243 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
  
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_LineItems_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_LineItems_FT__dbt_tmp_temp_view as
    

with updateData as (
    select 
     	FTstg.[LineItemsID],
		FTtmp.[Consignor_Skey],
		FTtmp.[Buyer_Skey],
		FTstg.[InvoiceID],
		FTstg.[ListingID],
		FTstg.[Description],
		FTstg.[LastUpdatedUser],
		FTstg.[Currency],
		FTstg.[Status],
		FTstg.[Type],
		FTstg.[TotalAmount],
		FTstg.[QTY],
		FTstg.[PerUnitAmount],
		FTstg.[IsTaxable],
		FTstg.[IsArchived],
		FTstg.[Relistiteration],
		FTstg.[HasBuyerPremiumApplies],
		FTstg.[IsPayerArchived],
		FTstg.[DateStamp],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_LineItems_FT_tmp as FTtmp 
    join stg.AH_LineItems_FT_stg as FTstg 
    on FTstg.LineItemsID=FTtmp.LineItemsID
),
insertData as (
    select 
        [LineItemsID],
        [Consignor_Skey],
        [Buyer_Skey],
        [InvoiceID],
        [ListingID],
        [Description],
        [LastUpdatedUser],
        [Currency],
        [Status],
        [Type],
        [TotalAmount],
        [QTY],
        [PerUnitAmount],
        [IsTaxable],
        [IsArchived],
        [Relistiteration],
        [HasBuyerPremiumApplies],
        [IsPayerArchived],
        [DateStamp],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_LineItems_FT_tmp
    where LineItemsID not in (select  LineItemsID from stg.AH_LineItems_FT_stg)
)
SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[LineItemsID],
	[Consignor_Skey],
	[Buyer_Skey],
	[InvoiceID],
	[ListingID],
	[Description],
	[LastUpdatedUser],
	[Currency],
	[Status],
	[Type],
	[TotalAmount],
	[QTY],
	[PerUnitAmount],
	[IsTaxable],
	[IsArchived],
	[Relistiteration],
	[HasBuyerPremiumApplies],
	[IsPayerArchived],
	[DateStamp],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_LineItems_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_LineItems_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_LineItems_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_LineItems_FT__dbt_tmp_temp_view"
    end



22:02:44.046412 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:02:44.046664 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:44.046905 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
22:02:44.047690 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
  
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[ListingPaymentChargeID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[ChargeAmount],
		FTstg.[TotalBid],
		FTstg.[BidHoldPercentage],
		FTstg.[MaximumBidCharge],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp as FTtmp 
    join stg.AH_ListingPaymentCharge_FT_stg as FTstg 
    on FTstg.ListingPaymentChargeID=FTtmp.ListingPaymentChargeID
)
,
insertData as (
    select 
        [ListingPaymentChargeID],
        [Buyer_Skey],
        [ListingID],
        [ChargeAmount],
        [TotalBid],
        [BidHoldPercentage],
        [MaximumBidCharge],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_ListingPaymentCharge_FT_tmp
    where ListingPaymentChargeID not in (select  ListingPaymentChargeID from stg.AH_ListingPaymentCharge_FT_stg)
)
SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[ListingPaymentChargeID],
	[Buyer_Skey],
	[ListingID],
	[ChargeAmount],
	[TotalBid],
	[BidHoldPercentage],
	[MaximumBidCharge],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_ListingPaymentCharge_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp_temp_view"
    end



22:02:44.048093 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:02:44.048446 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:44.152183 [debug] [Thread-3  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:44.169239 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:44.176721 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:44.177164 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:49.567643 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.52 seconds
22:02:49.583839 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
22:02:49.584142 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo"."AH_ListingPaymentCharge_FT" to AH_ListingPaymentCharge_FT__dbt_backup
22:02:49.626477 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:49.638982 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
22:02:49.639300 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: rename object "dbo"."AH_ListingPaymentCharge_FT__dbt_tmp" to AH_ListingPaymentCharge_FT
22:02:49.692348 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.05 seconds
22:02:49.702861 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: COMMIT
22:02:49.709123 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingPaymentCharge_FT".
22:02:49.709390 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_ListingPaymentCharge_FT: 
    
  if object_id ('"dbo"."AH_ListingPaymentCharge_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingPaymentCharge_FT__dbt_backup"
    end

22:02:50.027396 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 5.98 seconds
22:02:50.039974 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
22:02:50.040326 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo"."AH_LineItems_FT" to AH_LineItems_FT__dbt_backup
22:02:50.071539 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:50.084148 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
22:02:50.084498 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: rename object "dbo"."AH_LineItems_FT__dbt_tmp" to AH_LineItems_FT
22:02:50.112968 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:50.114843 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: COMMIT
22:02:50.118759 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_LineItems_FT".
22:02:50.118994 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_LineItems_FT: 
    
  if object_id ('"dbo"."AH_LineItems_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_LineItems_FT__dbt_backup"
    end

22:02:50.222089 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.18 seconds
22:02:50.235716 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
22:02:50.236046 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo"."AH_Invoice_FT" to AH_Invoice_FT__dbt_backup
22:02:50.265910 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:50.278352 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
22:02:50.278704 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: rename object "dbo"."AH_Invoice_FT__dbt_tmp" to AH_Invoice_FT
22:02:50.316222 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:02:50.318059 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: COMMIT
22:02:50.321929 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Invoice_FT".
22:02:50.322151 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Invoice_FT: 
    
  if object_id ('"dbo"."AH_Invoice_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Invoice_FT__dbt_backup"
    end

22:02:50.503896 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.79 seconds
22:02:50.515923 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.40 seconds
22:02:50.591674 [debug] [Thread-4  ]: finished collecting timing info
22:02:50.592151 [debug] [Thread-4  ]: On model.Shawn.AH_ListingPaymentCharge_FT: Close
22:02:50.592965 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c43bf580>]}
22:02:50.593459 [info ] [Thread-4  ]: 4 of 6 OK created table model dbo.AH_ListingPaymentCharge_FT.................... [[32mOK[0m in 6.71s]
22:02:50.593860 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_ListingPaymentCharge_FT
22:02:50.594053 [debug] [Thread-4  ]: Began running node model.Shawn.AH_SubmittedListingPayment_FT
22:02:50.594395 [info ] [Thread-4  ]: 5 of 6 START table model dbo.AH_SubmittedListingPayment_FT...................... [RUN]
22:02:50.594864 [debug] [Thread-4  ]: Acquiring new synapse connection "model.Shawn.AH_SubmittedListingPayment_FT"
22:02:50.602360 [debug] [Thread-4  ]: Began compiling node model.Shawn.AH_SubmittedListingPayment_FT
22:02:50.602575 [debug] [Thread-4  ]: Compiling model.Shawn.AH_SubmittedListingPayment_FT
22:02:50.605465 [debug] [Thread-4  ]: Writing injected SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
22:02:50.602189 [debug] [Thread-2  ]: finished collecting timing info
22:02:50.605894 [debug] [Thread-2  ]: On model.Shawn.AH_LineItems_FT: Close
22:02:50.606507 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c60aaf70>]}
22:02:50.607165 [info ] [Thread-2  ]: 2 of 6 OK created table model dbo.AH_LineItems_FT............................... [[32mOK[0m in 6.72s]
22:02:50.607514 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_LineItems_FT
22:02:50.606839 [debug] [Thread-4  ]: finished collecting timing info
22:02:50.607948 [debug] [Thread-4  ]: Began executing node model.Shawn.AH_SubmittedListingPayment_FT
22:02:50.607700 [debug] [Thread-2  ]: Began running node model.Shawn.AH_Watches_FT
22:02:50.615985 [info ] [Thread-2  ]: 6 of 6 START table model dbo.AH_Watches_FT...................................... [RUN]
22:02:50.616586 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.AH_Watches_FT"
22:02:50.616763 [debug] [Thread-2  ]: Began compiling node model.Shawn.AH_Watches_FT
22:02:50.616904 [debug] [Thread-2  ]: Compiling model.Shawn.AH_Watches_FT
22:02:50.619908 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.AH_Watches_FT"
22:02:50.632035 [debug] [Thread-2  ]: finished collecting timing info
22:02:50.632304 [debug] [Thread-2  ]: Began executing node model.Shawn.AH_Watches_FT
22:02:50.648004 [debug] [Thread-4  ]: Writing runtime SQL for node "model.Shawn.AH_SubmittedListingPayment_FT"
22:02:50.656077 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
22:02:50.656340 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
  
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[SubmittedListingPaymentID],
		FTtmp.[Consignor_Skey],
		FTstg.[ListingID],
		FTstg.[Amount],
		FTstg.[HasProPhotography],
		FTstg.[HasProMarketing],
		FTstg.[TransactionID],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp as FTtmp 
    join stg.AH_SubmittedListingPayment_FT_stg as FTstg 
    on FTstg.SubmittedListingPaymentID=FTtmp.SubmittedListingPaymentID
)
,
insertData as (
    select 
        [SubmittedListingPaymentID],
        [Consignor_Skey],
        [ListingID],
        [Amount],
        [HasProPhotography],
        [HasProMarketing],
        [TransactionID],
        [CreatedDate],
        [UpdatedDate]
    from stg.AH_SubmittedListingPayment_FT_tmp
    where SubmittedListingPaymentID not in (select  SubmittedListingPaymentID from stg.AH_SubmittedListingPayment_FT_stg)
)
SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from updateData

union all

SELECT
	[SubmittedListingPaymentID],
	[Consignor_Skey],
	[ListingID],
	[Amount],
	[HasProPhotography],
	[HasProMarketing],
	[TransactionID],
	[CreatedDate],
	[UpdatedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_SubmittedListingPayment_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp_temp_view"
    end



22:02:50.656466 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
22:02:50.656616 [debug] [Thread-4  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:50.657416 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.34 seconds
22:02:50.673273 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.AH_Watches_FT"
22:02:50.675051 [debug] [Thread-1  ]: finished collecting timing info
22:02:50.675620 [debug] [Thread-1  ]: On model.Shawn.AH_Invoice_FT: Close
22:02:50.676335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c4367ac0>]}
22:02:50.676693 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
22:02:50.677655 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
  
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Watches_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Watches_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
		FTstg.[WatchID],
		FTtmp.[Buyer_Skey],
		FTstg.[ListingID],
		FTstg.[LastUpdatedUser],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate]
    from stg.AH_Watches_FT_tmp as FTtmp 
    join stg.AH_Watches_FT_stg as FTstg 
    on FTstg.WatchID=FTtmp.WatchID
)
,
insertData as (
    select 
        [WatchID],
        [Buyer_Skey],
        [ListingID],
        [LastUpdatedUser],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate]
    from stg.AH_Watches_FT_tmp
    where WatchID not in (select  WatchID from stg.AH_Watches_FT_stg)
)
SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from updateData

union all

SELECT
	[WatchID],
	[Buyer_Skey],
	[ListingID],
	[LastUpdatedUser],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Watches_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Watches_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Watches_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Watches_FT__dbt_tmp_temp_view"
    end



22:02:50.677813 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:02:50.677966 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:02:50.677401 [info ] [Thread-1  ]: 1 of 6 OK created table model dbo.AH_Invoice_FT................................. [[32mOK[0m in 6.80s]
22:02:50.678870 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Invoice_FT
22:02:50.758388 [debug] [Thread-4  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:50.771550 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:02:50.828530 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 6.79 seconds
22:02:50.840680 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
22:02:50.841030 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo"."AH_ListingActions_FT" to AH_ListingActions_FT__dbt_backup
22:02:50.871546 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:50.883016 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
22:02:50.883326 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: rename object "dbo"."AH_ListingActions_FT__dbt_tmp" to AH_ListingActions_FT
22:02:50.910288 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:50.912166 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: COMMIT
22:02:50.916105 [debug] [Thread-3  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_ListingActions_FT".
22:02:50.916351 [debug] [Thread-3  ]: SQLServer adapter: On model.Shawn.AH_ListingActions_FT: 
    
  if object_id ('"dbo"."AH_ListingActions_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_ListingActions_FT__dbt_backup"
    end

22:02:51.420666 [debug] [Thread-3  ]: SQLServer adapter: SQL status: OK in 0.50 seconds
22:02:51.431193 [debug] [Thread-3  ]: finished collecting timing info
22:02:51.431595 [debug] [Thread-3  ]: On model.Shawn.AH_ListingActions_FT: Close
22:02:51.432351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c43a1af0>]}
22:02:51.432819 [info ] [Thread-3  ]: 3 of 6 OK created table model dbo.AH_ListingActions_FT.......................... [[32mOK[0m in 7.55s]
22:02:51.433194 [debug] [Thread-3  ]: Finished running node model.Shawn.AH_ListingActions_FT
22:02:55.695445 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 5.04 seconds
22:02:55.707988 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
22:02:55.708339 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo"."AH_SubmittedListingPayment_FT" to AH_SubmittedListingPayment_FT__dbt_backup
22:02:55.739420 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:55.750929 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
22:02:55.751284 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: rename object "dbo"."AH_SubmittedListingPayment_FT__dbt_tmp" to AH_SubmittedListingPayment_FT
22:02:55.780053 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:02:55.781971 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT: COMMIT
22:02:55.785784 [debug] [Thread-4  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_SubmittedListingPayment_FT".
22:02:55.786018 [debug] [Thread-4  ]: SQLServer adapter: On model.Shawn.AH_SubmittedListingPayment_FT: 
    
  if object_id ('"dbo"."AH_SubmittedListingPayment_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_SubmittedListingPayment_FT__dbt_backup"
    end

22:02:56.039397 [debug] [Thread-4  ]: SQLServer adapter: SQL status: OK in 0.25 seconds
22:02:56.051027 [debug] [Thread-4  ]: finished collecting timing info
22:02:56.051407 [debug] [Thread-4  ]: On model.Shawn.AH_SubmittedListingPayment_FT: Close
22:02:56.052128 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c4367b20>]}
22:02:56.052598 [info ] [Thread-4  ]: 5 of 6 OK created table model dbo.AH_SubmittedListingPayment_FT................. [[32mOK[0m in 5.46s]
22:02:56.053148 [debug] [Thread-4  ]: Finished running node model.Shawn.AH_SubmittedListingPayment_FT
22:03:01.190903 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 10.51 seconds
22:03:01.203051 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
22:03:01.203434 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo"."AH_Watches_FT" to AH_Watches_FT__dbt_backup
22:03:01.243982 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:03:01.255849 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
22:03:01.256217 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: rename object "dbo"."AH_Watches_FT__dbt_tmp" to AH_Watches_FT
22:03:01.286316 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:03:01.288316 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT: COMMIT
22:03:01.292528 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Watches_FT".
22:03:01.292848 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.AH_Watches_FT: 
    
  if object_id ('"dbo"."AH_Watches_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Watches_FT__dbt_backup"
    end

22:03:01.491237 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.20 seconds
22:03:01.503009 [debug] [Thread-2  ]: finished collecting timing info
22:03:01.503473 [debug] [Thread-2  ]: On model.Shawn.AH_Watches_FT: Close
22:03:01.504268 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cfa5270-615d-46e0-b202-eb6024cbfc1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c4388190>]}
22:03:01.504776 [info ] [Thread-2  ]: 6 of 6 OK created table model dbo.AH_Watches_FT................................. [[32mOK[0m in 10.89s]
22:03:01.505191 [debug] [Thread-2  ]: Finished running node model.Shawn.AH_Watches_FT
22:03:01.506839 [debug] [MainThread]: Acquiring new synapse connection "master"
22:03:01.507169 [debug] [MainThread]: On master: COMMIT
22:03:01.507561 [info ] [MainThread]: 
22:03:01.507836 [info ] [MainThread]: Finished running 6 table models in 32.32s.
22:03:01.508039 [debug] [MainThread]: Connection 'master' was properly closed.
22:03:01.508148 [debug] [MainThread]: Connection 'model.Shawn.AH_Invoice_FT' was properly closed.
22:03:01.508247 [debug] [MainThread]: Connection 'model.Shawn.AH_Watches_FT' was properly closed.
22:03:01.508340 [debug] [MainThread]: Connection 'model.Shawn.AH_ListingActions_FT' was properly closed.
22:03:01.508432 [debug] [MainThread]: Connection 'model.Shawn.AH_SubmittedListingPayment_FT' was properly closed.
22:03:01.537258 [info ] [MainThread]: 
22:03:01.537671 [info ] [MainThread]: [32mCompleted successfully[0m
22:03:01.537979 [info ] [MainThread]: 
22:03:01.538177 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
22:03:01.538491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c8798430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c87c7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83c4440910>]}


============================== 2022-09-14 22:03:03.878221 | ed091a77-ce89-4cc7-a368-9a1d41a027c7 ==============================
22:03:03.878221 [info ] [MainThread]: Running with dbt=1.0.0
22:03:03.883224 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_1'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:03:03.883508 [debug] [MainThread]: Tracking: tracking
22:03:03.883854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c3fa4f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c3fa4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c3fa4d00>]}
22:03:04.089658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:03:04.090082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:03:04.117591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed091a77-ce89-4cc7-a368-9a1d41a027c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c3f11340>]}
22:03:04.167341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed091a77-ce89-4cc7-a368-9a1d41a027c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c5f60a60>]}
22:03:04.167915 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:03:04.176066 [info ] [MainThread]: 
22:03:04.176827 [debug] [MainThread]: Acquiring new synapse connection "master"
22:03:04.178016 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:03:04.187232 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:03:04.187566 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:03:04.187714 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:03:04.187875 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:04.470648 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:04.506173 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
22:03:04.508431 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:03:04.530917 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:03:04.537619 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:03:04.538169 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:03:04.540306 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:03:04.540517 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:03:04.540643 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:03:04.540779 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:04.538584 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:03:04.542073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:03:04.542580 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:04.648502 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:04.649182 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:04.712131 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
22:03:04.713213 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
22:03:04.769728 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:03:04.770153 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:03:04.906841 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:03:04.915846 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:03:19.241982 [debug] [MainThread]: On master: COMMIT
22:03:19.242715 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:03:19.243066 [info ] [MainThread]: 
22:03:19.246772 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_FieldIDs
22:03:19.247285 [info ] [Thread-1  ]: 1 of 2 START table model stg.SZ_AH_Properties_FieldIDs.......................... [RUN]
22:03:19.247806 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs"
22:03:19.247985 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_FieldIDs
22:03:19.247024 [debug] [Thread-2  ]: Began running node model.Shawn.SZ_AH_Properties_FieldType
22:03:19.248381 [info ] [Thread-2  ]: 2 of 2 START table model stg.SZ_AH_Properties_FieldType......................... [RUN]
22:03:19.248797 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_FieldType"
22:03:19.248946 [debug] [Thread-2  ]: Began compiling node model.Shawn.SZ_AH_Properties_FieldType
22:03:19.249087 [debug] [Thread-2  ]: Compiling model.Shawn.SZ_AH_Properties_FieldType
22:03:19.248143 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_FieldIDs
22:03:19.254621 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_FieldIDs"
22:03:19.251951 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_FieldType"
22:03:19.255234 [debug] [Thread-2  ]: finished collecting timing info
22:03:19.255605 [debug] [Thread-2  ]: Began executing node model.Shawn.SZ_AH_Properties_FieldType
22:03:19.255489 [debug] [Thread-1  ]: finished collecting timing info
22:03:19.263856 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_FieldIDs
22:03:19.434104 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_FieldIDs"
22:03:19.440294 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
22:03:19.440493 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: 
  
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view as
    

select ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) AS Sequence,
            cf.name, 
            cf.id, 
            count(*) as cnt
        from stg.AH_Listingproperties_FinalView lp 
            inner join stg.AH_CustomFields_FinalView cf 
            on lp.CustomFieldID = cf.id
        group by cf.Name, cf.id
    ');

  CREATE TABLE "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp_temp_view"
    end



22:03:19.440618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:03:19.440761 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:19.439577 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_FieldType"
22:03:19.442355 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
22:03:19.442532 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: 
  
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldType__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_FieldType__dbt_tmp_temp_view as
    

select ''BoolNativeValue'' as column_name, ''bit'' as data_type union all
select ''StringNativeValue'' as column_name, ''nvarchar(4000)'' as data_type union all
select ''IntNativeValue'' as column_name, ''int'' as data_type union all
select ''DecimalNativeValue'' as column_name, ''decimal(10,2)'' as data_type union all
select ''DateTimeNativeValue'' as column_name, ''datetime'' as data_type union all
select ''EnumNativeValue'' as column_name, ''nvarchar(200)'' as data_type
    ');

  CREATE TABLE "stg"."SZ_AH_Properties_FieldType__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_FieldType__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_FieldType__dbt_tmp_temp_view"
    end



22:03:19.442695 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:03:19.442830 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:19.571908 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:19.581737 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:21.532268 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 2.09 seconds
22:03:21.614271 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
22:03:21.614653 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: rename object "stg"."SZ_AH_Properties_FieldType" to SZ_AH_Properties_FieldType__dbt_backup
22:03:21.686660 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:03:21.697998 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
22:03:21.698375 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: rename object "stg"."SZ_AH_Properties_FieldType__dbt_tmp" to SZ_AH_Properties_FieldType
22:03:21.729315 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:03:21.741865 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_FieldType: COMMIT
22:03:21.748682 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldType".
22:03:21.749020 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldType: 
    
  if object_id ('"stg"."SZ_AH_Properties_FieldType__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldType__dbt_backup"
    end

22:03:22.004648 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
22:03:22.015186 [debug] [Thread-2  ]: finished collecting timing info
22:03:22.015629 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_FieldType: Close
22:03:22.016416 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed091a77-ce89-4cc7-a368-9a1d41a027c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c1be06d0>]}
22:03:22.016913 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.SZ_AH_Properties_FieldType.................... [[32mOK[0m in 2.77s]
22:03:22.017297 [debug] [Thread-2  ]: Finished running node model.Shawn.SZ_AH_Properties_FieldType
22:03:22.244883 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 2.80 seconds
22:03:22.257569 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
22:03:22.257931 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: rename object "stg"."SZ_AH_Properties_FieldIDs" to SZ_AH_Properties_FieldIDs__dbt_backup
22:03:22.292184 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:03:22.304562 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
22:03:22.304896 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: rename object "stg"."SZ_AH_Properties_FieldIDs__dbt_tmp" to SZ_AH_Properties_FieldIDs
22:03:22.336474 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:03:22.338430 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_FieldIDs: COMMIT
22:03:22.342469 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_FieldIDs".
22:03:22.342746 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_FieldIDs: 
    
  if object_id ('"stg"."SZ_AH_Properties_FieldIDs__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_FieldIDs__dbt_backup"
    end

22:03:22.548542 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.21 seconds
22:03:22.559594 [debug] [Thread-1  ]: finished collecting timing info
22:03:22.560008 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_FieldIDs: Close
22:03:22.560775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed091a77-ce89-4cc7-a368-9a1d41a027c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c034cf40>]}
22:03:22.561301 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.SZ_AH_Properties_FieldIDs..................... [[32mOK[0m in 3.31s]
22:03:22.561688 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_FieldIDs
22:03:22.563097 [debug] [MainThread]: Acquiring new synapse connection "master"
22:03:22.563403 [debug] [MainThread]: On master: COMMIT
22:03:22.563749 [info ] [MainThread]: 
22:03:22.564013 [info ] [MainThread]: Finished running 2 table models in 18.39s.
22:03:22.564221 [debug] [MainThread]: Connection 'master' was properly closed.
22:03:22.564329 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_FieldIDs' was properly closed.
22:03:22.564430 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_FieldType' was properly closed.
22:03:22.591977 [info ] [MainThread]: 
22:03:22.592399 [info ] [MainThread]: [32mCompleted successfully[0m
22:03:22.592705 [info ] [MainThread]: 
22:03:22.592897 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
22:03:22.593205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c5f60490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c4a5d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4c1c12e80>]}


============================== 2022-09-14 22:03:24.883509 | 85c83208-8de2-499d-be5c-615fb52f31de ==============================
22:03:24.883509 [info ] [MainThread]: Running with dbt=1.0.0
22:03:24.887232 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_2'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:03:24.887472 [debug] [MainThread]: Tracking: tracking
22:03:24.887803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6ddafd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6ddafdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6ddafe20>]}
22:03:25.092009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:03:25.092399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:03:25.119264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85c83208-8de2-499d-be5c-615fb52f31de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6dd1c2b0>]}
22:03:25.168110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85c83208-8de2-499d-be5c-615fb52f31de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6fd6e9d0>]}
22:03:25.168703 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:03:25.176856 [info ] [MainThread]: 
22:03:25.177590 [debug] [MainThread]: Acquiring new synapse connection "master"
22:03:25.178713 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:03:25.187967 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:03:25.188299 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:03:25.188445 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:03:25.188607 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:25.453609 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:25.482303 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.29 seconds
22:03:25.484451 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:03:25.506233 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:03:25.513249 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:03:25.513694 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:03:25.515605 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:03:25.515829 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:03:25.515955 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:03:25.516094 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:25.514005 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:03:25.517575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:03:25.517764 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:25.621658 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:25.624747 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:25.654655 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:03:25.660372 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:03:25.680588 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:03:25.682293 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:03:25.847648 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:03:25.859826 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:03:39.660404 [debug] [MainThread]: On master: COMMIT
22:03:39.661085 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:03:39.661418 [info ] [MainThread]: 
22:03:39.664518 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
22:03:39.664897 [info ] [Thread-1  ]: 1 of 1 START table model stg.SZ_AH_Properties_Value_ColumnMapping............... [RUN]
22:03:39.665376 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
22:03:39.665553 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
22:03:39.665708 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_Value_ColumnMapping
22:03:39.672592 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
22:03:39.672810 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
    
    
SELECT distinct customfieldid FROM stg.AH_Listingproperties_FinalView where  customfieldid is not null
    

  
22:03:39.672934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:03:39.673076 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:03:39.808581 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:03:40.067346 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
22:03:40.070420 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
22:03:40.071409 [debug] [Thread-1  ]: finished collecting timing info
22:03:40.071631 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
22:03:40.163513 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_Value_ColumnMapping"
22:03:40.164549 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
22:03:40.164778 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
  
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view as
    





    

    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161245,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',16575279,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2533219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310753,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3723813,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673475,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14959150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161205,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673478,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161242,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250225,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161202,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9895950,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3744978,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161222,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21259499,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21806654,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658044,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161214,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673487,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673481,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13549467,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161732,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897193,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161231,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161211,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673484,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102056,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161234,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045187,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161208,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161271,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840228,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161237,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3760788,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810052,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26254668,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161243,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3737940,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673473,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19353344,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310748,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289629,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161217,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161240,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161008,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161014,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310751,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289626,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673490,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3901735,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7052946,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161220,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4507814,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673479,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161203,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6529375,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',5282840,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161209,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',14589345,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',9888915,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673482,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161246,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19360781,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694977,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250223,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367903,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',10045185,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161226,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673476,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161206,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161020,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673485,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3716724,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161235,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161736,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810050,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',6557150,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161238,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673488,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',4016506,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2080452,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161733,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161275,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161232,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431196,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161212,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',633102,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161241,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19310752,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673477,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161221,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21833162,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',840229,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161244,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673474,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161204,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161012,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2694972,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161218,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3752016,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673483,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',13724070,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161247,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19338647,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1043518,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',1250224,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',23362439,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19367904,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',25897195,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161227,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161207,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',11102055,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',17214902,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673486,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',7635382,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673480,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3730851,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161230,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',26431194,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161210,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161018,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',3708441,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161216,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161239,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161233,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161734,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19289625,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',673489,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161219,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161213,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',19346144,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',15658043,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161737,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161236,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',810051,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',2545215,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',161010,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
        select CustomFieldID as customfieldid,
               ValueColumn as value_columnname
        from 
            (select CustomFieldID, 
                ValueColumn, 
                ValueCount,
                ROW_NUMBER() over (order by ValueCount desc) as rn
            from 
                (select CustomFieldID, 
                        count(BoolNativeValue) as BoolNativeValue,
                        count(StringNativeValue) as StringNativeValue,
                        count(IntNativeValue) as IntNativeValue,
                        count(DecimalNativeValue) as DecimalNativeValue,
                        count(DateTimeNativeValue) as DateTimeNativeValue,
                        count(EnumNativeValue) as EnumNativeValue
                    from stg.AH_Listingproperties_FinalView 
                    where CustomFieldID = concat('''',21817611,'''')
                    group by CustomFieldID) pvt 
                UNPIVOT
                (ValueCount for ValueColumn in (BoolNativeValue,StringNativeValue,IntNativeValue,DecimalNativeValue,DateTimeNativeValue,EnumNativeValue) ) as unpvt
            ) t
        where rn = 1

        union all
    
    select ''''  as customfieldid, '''' as value_columnname  where 1=2

    ');

  CREATE TABLE "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp_temp_view"
    end



22:04:16.142796 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 35.98 seconds
22:04:16.160402 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
22:04:16.160770 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: rename object "stg"."SZ_AH_Properties_Value_ColumnMapping" to SZ_AH_Properties_Value_ColumnMapping__dbt_backup
22:04:16.233258 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.07 seconds
22:04:16.246394 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
22:04:16.246783 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: rename object "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_tmp" to SZ_AH_Properties_Value_ColumnMapping
22:04:16.278578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:04:16.290413 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: COMMIT
22:04:16.297288 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Value_ColumnMapping".
22:04:16.297643 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: 
    
  if object_id ('"stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_Value_ColumnMapping__dbt_backup"
    end

22:04:16.554359 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.26 seconds
22:04:16.637858 [debug] [Thread-1  ]: finished collecting timing info
22:04:16.638294 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Value_ColumnMapping: Close
22:04:16.639120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c83208-8de2-499d-be5c-615fb52f31de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6c17b2b0>]}
22:04:16.639641 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.SZ_AH_Properties_Value_ColumnMapping.......... [[32mOK[0m in 36.97s]
22:04:16.640037 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_Value_ColumnMapping
22:04:16.641295 [debug] [MainThread]: Acquiring new synapse connection "master"
22:04:16.641597 [debug] [MainThread]: On master: COMMIT
22:04:16.641938 [info ] [MainThread]: 
22:04:16.642195 [info ] [MainThread]: Finished running 1 table model in 51.46s.
22:04:16.642397 [debug] [MainThread]: Connection 'master' was properly closed.
22:04:16.642509 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_Value_ColumnMapping' was properly closed.
22:04:16.642652 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
22:04:16.671781 [info ] [MainThread]: 
22:04:16.672182 [info ] [MainThread]: [32mCompleted successfully[0m
22:04:16.672542 [info ] [MainThread]: 
22:04:16.672737 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:04:16.673054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6fd6e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6dd6b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6c22fd00>]}


============================== 2022-09-14 22:04:18.964755 | 2fe0f9ff-5a87-41cc-bdd5-e543a5b59cf7 ==============================
22:04:18.964755 [info ] [MainThread]: Running with dbt=1.0.0
22:04:18.970834 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_3'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:04:18.971165 [debug] [MainThread]: Tracking: tracking
22:04:18.971520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3460edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3460ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3460ee80>]}
22:04:19.159219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:04:19.159600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:04:19.185139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fe0f9ff-5a87-41cc-bdd5-e543a5b59cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3457d310>]}
22:04:19.231635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fe0f9ff-5a87-41cc-bdd5-e543a5b59cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc36611a30>]}
22:04:19.232154 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:04:19.239940 [info ] [MainThread]: 
22:04:19.240638 [debug] [MainThread]: Acquiring new synapse connection "master"
22:04:19.241779 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:04:19.250818 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:04:19.251118 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:04:19.251263 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:04:19.251414 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:04:19.575878 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:04:19.608132 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.36 seconds
22:04:19.610272 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:04:19.631876 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:04:19.637656 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:04:19.638169 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:04:19.639826 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:04:19.640011 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:04:19.640136 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:04:19.640274 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:04:19.638359 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:04:19.641820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:04:19.641998 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:04:19.762315 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:04:19.762956 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:04:19.798821 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:04:19.799271 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:04:19.825371 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:04:19.828204 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:04:19.978776 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:04:19.987816 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:04:33.772009 [debug] [MainThread]: On master: COMMIT
22:04:33.772718 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:04:33.773052 [info ] [MainThread]: 
22:04:33.776684 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_AllProperties_One_Column
22:04:33.777182 [info ] [Thread-1  ]: 1 of 2 START table model stg.SZ_AH_AllProperties_One_Column..................... [RUN]
22:04:33.777682 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column"
22:04:33.777857 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_AllProperties_One_Column
22:04:33.778014 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_AllProperties_One_Column
22:04:33.776926 [debug] [Thread-2  ]: Began running node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
22:04:33.784273 [info ] [Thread-2  ]: 2 of 2 START table model stg.SZ_AH_Properties_CustomFields_Lookup............... [RUN]
22:04:33.784767 [debug] [Thread-2  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
22:04:33.784926 [debug] [Thread-2  ]: Began compiling node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
22:04:33.785062 [debug] [Thread-2  ]: Compiling model.Shawn.SZ_AH_Properties_CustomFields_Lookup
22:04:33.787541 [debug] [Thread-2  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
22:04:33.790713 [debug] [Thread-2  ]: finished collecting timing info
22:04:33.790889 [debug] [Thread-2  ]: Began executing node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
22:04:33.790221 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:33.799814 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
    SELECT id FROM stg.SZ_AH_Properties_FieldIDs 

  
22:04:33.800011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:04:33.800160 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:04:33.890600 [debug] [Thread-2  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_CustomFields_Lookup"
22:04:33.891376 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
22:04:33.891583 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: 
  
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view as
    
select 
    a.*, 
    c.name,
    b.data_type,
           case when b.data_type = ''nvarchar(4000)'' then c.name + '' nvarchar(4000)''
                when b.data_type = ''nvarchar(200)'' then c.name + '' nvarchar(200)''
                when b.data_type = ''decimal(10,2)'' then c.name + '' decimal(11,2)''
                when b.data_type = ''bit'' then c.name + '' bit''
                when b.data_type = ''int'' then c.name + '' bigint''
                when b.data_type = ''datetime'' then c.name + '' datetime''
           end  as col_definition_str,       
           case when b.data_type = ''nvarchar(4000)'' then ''cast('' + c.name + '' as nvarchar(4000)) as '' + c.name 
                when b.data_type = ''nvarchar(200)'' then ''cast('' + c.name + '' as nvarchar(200)) as '' + c.name 
                when b.data_type = ''decimal(10,2)'' then ''cast(cast('' + c.name + '' as nvarchar(10)) as decimal(11,2)) as '' + c.name
                when b.data_type = ''bit'' then ''cast(cast('' + c.name + '' as nvarchar(1)) as bit) as '' + c.name 
                when b.data_type = ''int'' then ''cast(cast('' + c.name + '' as nvarchar(9)) as bigint) as '' + c.name 
                when b.data_type = ''datetime'' then ''cast(cast('' + c.name + '' as nvarchar(23)) as datetime) as '' + c.name 
            end  as col_type_cast
from stg.SZ_AH_Properties_Value_ColumnMapping a
            left join stg.SZ_AH_Properties_FieldType b 
                on a.value_columnname = b.column_name
            left join stg.SZ_AH_Properties_FieldIDs c
                on a.customfieldid = c.id
where a.customfieldid not in (9895950, 9888915, 6529375) -- remove duplicates
    ');

  CREATE TABLE "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp_temp_view"
    end



22:04:33.891720 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:04:33.891868 [debug] [Thread-2  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:04:33.908786 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:04:34.012804 [debug] [Thread-2  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:04:34.027513 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.23 seconds
22:04:34.030783 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:34.031106 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2694972
        
  
22:04:35.225189 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 1.19 seconds
22:04:35.226896 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.227073 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3723813
        
  
22:04:35.345037 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:35.346884 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.347092 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3752016
        
  
22:04:35.472727 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:35.474473 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.474749 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 4507814
        
  
22:04:35.587716 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:35.589608 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.589870 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 7052946
        
  
22:04:35.700961 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:35.702908 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.703170 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 10045185
        
  
22:04:35.811923 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:35.813905 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.814200 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 13549467
        
  
22:04:35.928132 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:35.930134 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:35.930418 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14959150
        
  
22:04:36.045834 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:36.047688 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.047965 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 17214902
        
  
22:04:36.158756 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:36.160729 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.160998 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310748
        
  
22:04:36.396593 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
22:04:36.398778 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.398976 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19338647
        
  
22:04:36.508898 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:36.510874 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.511148 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367902
        
  
22:04:36.619903 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:36.621777 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.622053 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21806654
        
  
22:04:36.756016 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:36.757906 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.758162 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897193
        
  
22:04:36.873024 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:36.875033 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.875351 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26431194
        
  
22:04:36.990401 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:36.992379 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:36.992664 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161008
        
  
22:04:37.099507 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:37.101477 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.101759 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161016
        
  
22:04:37.231333 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:37.233104 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.233338 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161203
        
  
22:04:37.348134 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:37.350129 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.350410 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161207
        
  
22:04:37.461543 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:37.463429 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.463674 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161211
        
  
22:04:37.574224 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:37.576198 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.577496 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161215
        
  
22:04:37.697968 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:37.699848 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.700108 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161219
        
  
22:04:37.819306 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:37.821370 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.821606 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161223
        
  
22:04:37.937052 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:37.938982 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:37.939233 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161227
        
  
22:04:38.067126 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:38.069027 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.069298 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161231
        
  
22:04:38.186208 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:38.188162 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.188583 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161235
        
  
22:04:38.312901 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:38.314596 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.314800 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161239
        
  
22:04:38.427414 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:38.429404 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.429694 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161243
        
  
22:04:38.537942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:38.539914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.540189 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161247
        
  
22:04:38.699094 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:04:38.701048 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.701339 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161733
        
  
22:04:38.811882 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:38.813872 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.814132 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161737
        
  
22:04:38.928571 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:38.930476 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:38.930821 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673475
        
  
22:04:39.058158 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:39.060338 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.060632 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673479
        
  
22:04:39.173459 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:39.175522 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.175790 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673483
        
  
22:04:39.294929 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:39.296840 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.297127 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673487
        
  
22:04:39.536263 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
22:04:39.537956 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.538146 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810050
        
  
22:04:39.645734 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:39.647758 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.648029 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 840229
        
  
22:04:39.757726 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:39.759576 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.759821 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250225
        
  
22:04:39.870720 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:39.872656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:39.872946 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2694977
        
  
22:04:40.010858 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:04:40.012786 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.013053 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3730851
        
  
22:04:40.121921 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:40.123837 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.124089 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3760788
        
  
22:04:40.231852 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:40.233621 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.233879 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 5282840
        
  
22:04:40.260108 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 6.37 seconds
22:04:40.276679 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
22:04:40.277029 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: rename object "stg"."SZ_AH_Properties_CustomFields_Lookup" to SZ_AH_Properties_CustomFields_Lookup__dbt_backup
22:04:40.316326 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:04:40.328271 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
22:04:40.328632 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: rename object "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_tmp" to SZ_AH_Properties_CustomFields_Lookup
22:04:40.337815 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:40.339671 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.339963 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 7635382
        
  
22:04:40.359148 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:04:40.371727 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: COMMIT
22:04:40.378310 [debug] [Thread-2  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_CustomFields_Lookup".
22:04:40.378664 [debug] [Thread-2  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: 
    
  if object_id ('"stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_Properties_CustomFields_Lookup__dbt_backup"
    end

22:04:40.455378 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:40.457304 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.457573 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 10045187
        
  
22:04:40.561581 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:40.563504 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.563758 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 13724070
        
  
22:04:40.666254 [debug] [Thread-2  ]: SQLServer adapter: SQL status: OK in 0.29 seconds
22:04:40.678141 [debug] [Thread-2  ]: finished collecting timing info
22:04:40.678599 [debug] [Thread-2  ]: On model.Shawn.SZ_AH_Properties_CustomFields_Lookup: Close
22:04:40.679409 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe0f9ff-5a87-41cc-bdd5-e543a5b59cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc3220f070>]}
22:04:40.679913 [info ] [Thread-2  ]: 2 of 2 OK created table model stg.SZ_AH_Properties_CustomFields_Lookup.......... [[32mOK[0m in 6.89s]
22:04:40.680310 [debug] [Thread-2  ]: Finished running node model.Shawn.SZ_AH_Properties_CustomFields_Lookup
22:04:40.681120 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:40.682516 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.682726 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 15658043
        
  
22:04:40.792122 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:40.794231 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.794491 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289625
        
  
22:04:40.898330 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:40.900146 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:40.900390 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310751
        
  
22:04:41.022036 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:41.023970 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.024257 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19346144
        
  
22:04:41.133899 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.135900 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.136171 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367903
        
  
22:04:41.242125 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.244084 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.244353 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21817611
        
  
22:04:41.353776 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.355712 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.355978 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897194
        
  
22:04:41.470878 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.473905 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.474181 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26431196
        
  
22:04:41.580457 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.582426 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.582731 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161010
        
  
22:04:41.687863 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:41.689664 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.689906 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161018
        
  
22:04:41.795157 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.797149 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.797438 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161204
        
  
22:04:41.903863 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:41.905788 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:41.906050 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161208
        
  
22:04:42.017486 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:42.019341 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.019603 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161212
        
  
22:04:42.126775 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:42.128719 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.128994 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161216
        
  
22:04:42.239180 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:42.240960 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.241220 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161220
        
  
22:04:42.363307 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:42.365172 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.365433 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161224
        
  
22:04:42.585135 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.22 seconds
22:04:42.586980 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.587172 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161228
        
  
22:04:42.747547 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:04:42.749397 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.749644 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161232
        
  
22:04:42.856004 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:42.857926 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.858175 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161236
        
  
22:04:42.964979 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:42.966766 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:42.967033 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161240
        
  
22:04:43.077437 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.079224 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.079468 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161244
        
  
22:04:43.187393 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.189457 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.189728 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161271
        
  
22:04:43.307264 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:43.309573 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.309887 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161734
        
  
22:04:43.432158 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:43.433923 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.434194 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 633102
        
  
22:04:43.539690 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.541602 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.541864 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673476
        
  
22:04:43.650882 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.652845 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.653121 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673480
        
  
22:04:43.759495 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.761439 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.761719 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673484
        
  
22:04:43.869817 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.871754 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.872021 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673488
        
  
22:04:43.979184 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:43.981070 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:43.981335 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810051
        
  
22:04:44.087043 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:44.088873 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.089127 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1043518
        
  
22:04:44.194710 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:44.196639 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.196926 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2080452
        
  
22:04:44.305282 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:44.307256 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.307539 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3708441
        
  
22:04:44.429161 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:44.431071 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.431487 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3737940
        
  
22:04:44.541513 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:44.543829 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.544079 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3901735
        
  
22:04:44.647895 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:44.649839 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.650121 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 6529375
        
  
22:04:44.759068 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:44.761018 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.761309 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 9888915
        
  
22:04:44.865435 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:44.867405 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.867669 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 11102055
        
  
22:04:44.975923 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:44.977805 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:44.978077 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14589344
        
  
22:04:45.082955 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:45.084892 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.085165 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 15658044
        
  
22:04:45.196041 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:45.197788 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.198046 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289626
        
  
22:04:45.305757 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:45.307760 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.308039 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310752
        
  
22:04:45.415366 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:45.417256 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.417496 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19353344
        
  
22:04:45.541633 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:45.543446 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.543702 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19367904
        
  
22:04:45.651364 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:45.653208 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.653444 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21833162
        
  
22:04:45.759892 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:45.762223 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.762510 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 25897195
        
  
22:04:45.869856 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:45.871803 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.872065 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161012
        
  
22:04:45.993513 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:45.995489 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:45.995960 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161020
        
  
22:04:46.103400 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:46.105396 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.105706 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161205
        
  
22:04:46.214498 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:46.216580 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.216868 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161209
        
  
22:04:46.321332 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:46.323174 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.323383 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161213
        
  
22:04:46.430244 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:46.432219 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.432493 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161217
        
  
22:04:46.541303 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:46.543201 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.543421 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161221
        
  
22:04:46.659143 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:46.661108 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.661369 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161225
        
  
22:04:46.771621 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:46.773586 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.773845 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161229
        
  
22:04:46.885066 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:46.887044 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.887301 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161233
        
  
22:04:46.992143 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:46.994414 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:46.994703 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161237
        
  
22:04:47.103159 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.105041 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.105280 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161241
        
  
22:04:47.212968 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.214908 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.215188 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161245
        
  
22:04:47.318908 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.10 seconds
22:04:47.321842 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.322105 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161275
        
  
22:04:47.429264 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.431194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.431444 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161735
        
  
22:04:47.539561 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.541467 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.541715 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673473
        
  
22:04:47.647468 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.649350 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.649596 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673477
        
  
22:04:47.776622 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:47.778365 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.778661 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673481
        
  
22:04:47.889163 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.891125 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.891400 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673485
        
  
22:04:47.997648 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:47.999403 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:47.999644 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673489
        
  
22:04:48.106452 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.108331 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.108565 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 810052
        
  
22:04:48.215488 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.217914 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.218189 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250223
        
  
22:04:48.330576 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.332381 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.332558 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2533219
        
  
22:04:48.440685 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.442500 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.442795 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3716724
        
  
22:04:48.552515 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.554345 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.554622 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 3744978
        
  
22:04:48.667109 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.669024 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.669279 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 4016506
        
  
22:04:48.779995 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.781902 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.782172 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 6557150
        
  
22:04:48.890942 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:48.892909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:48.893173 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 9895950
        
  
22:04:49.001014 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.002961 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.003209 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 11102056
        
  
22:04:49.116624 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.118386 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.118637 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 14589345
        
  
22:04:49.228115 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.230047 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.230298 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 16575279
        
  
22:04:49.361406 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:49.363289 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.363516 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19289629
        
  
22:04:49.469034 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.471377 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.471668 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19310753
        
  
22:04:49.578452 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.580438 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.580690 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 19360781
        
  
22:04:49.693293 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.695282 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.695566 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 21259499
        
  
22:04:49.807260 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.809009 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.809255 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 23362439
        
  
22:04:49.918005 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:49.919951 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:49.920237 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 26254668
        
  
22:04:50.026467 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:50.028375 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.028613 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161014
        
  
22:04:50.135092 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:50.136980 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.137219 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161202
        
  
22:04:50.243776 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:50.245656 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.245907 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161206
        
  
22:04:50.362359 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:50.364691 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.364936 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161210
        
  
22:04:50.474081 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:50.475975 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.476225 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161214
        
  
22:04:50.605410 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:50.607374 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.607634 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161218
        
  
22:04:50.721390 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:50.723660 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.723926 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161222
        
  
22:04:50.860410 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:04:50.862332 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.862635 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161226
        
  
22:04:50.973751 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:50.975714 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:50.975954 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161230
        
  
22:04:51.084288 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.086061 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.086310 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161234
        
  
22:04:51.197080 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.198879 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.199129 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161238
        
  
22:04:51.324050 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:04:51.325713 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.325893 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161242
        
  
22:04:51.435372 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.437256 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.437508 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161246
        
  
22:04:51.546566 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.548446 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.548715 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161732
        
  
22:04:51.658860 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.660617 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.660862 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 161736
        
  
22:04:51.769231 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.771189 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.771456 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673474
        
  
22:04:51.882274 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.884194 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.884444 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673478
        
  
22:04:51.990852 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:51.992909 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:51.993145 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673482
        
  
22:04:52.100787 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:52.102590 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:52.102855 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673486
        
  
22:04:52.212910 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:52.214700 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:52.214947 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 673490
        
  
22:04:52.324010 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:52.326278 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:52.326519 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 840228
        
  
22:04:52.452674 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:04:52.454323 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:52.454501 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 1250224
        
  
22:04:52.565373 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:52.567305 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:52.567549 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
            select value_columnname from stg.SZ_AH_Properties_Value_ColumnMapping where customfieldid = 2545215
        
  
22:04:52.680457 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.11 seconds
22:04:52.682470 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_AllProperties_One_Column"
22:04:52.683125 [debug] [Thread-1  ]: finished collecting timing info
22:04:52.683318 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_AllProperties_One_Column
22:04:52.743541 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_AllProperties_One_Column"
22:04:52.744351 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:04:52.744576 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
  
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"','U') is not null
    begin
    drop table "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"
    end


   EXEC('create view stg.SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view as
    





    

    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694972

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3723813

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3752016

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4507814

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7052946

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045185

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13549467

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14959150

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 17214902

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310748

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19338647

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367902

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21806654

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897193

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DateTimeNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431194

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161008

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161016

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161203

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161207

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161211

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161215

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161219

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161223

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161227

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161231

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161235

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161239

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161243

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161247

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161733

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161737

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673475

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673479

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673483

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673487

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810050

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840229

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250225

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2694977

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3730851

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3760788

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 5282840

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 7635382

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 10045187

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 13724070

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658043

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289625

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310751

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19346144

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367903

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21817611

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897194

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26431196

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161010

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161018

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161204

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161208

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161212

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161216

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161220

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161224

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161228

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161232

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161236

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161240

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161244

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161271

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161734

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 633102

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673476

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673480

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673484

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673488

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810051

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1043518

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2080452

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3708441

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3737940

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3901735

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6529375

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9888915

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102055

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589344

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 15658044

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289626

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310752

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19353344

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19367904

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21833162

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 25897195

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161012

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161020

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161205

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161209

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161213

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161217

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161221

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161225

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161229

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161233

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161237

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161241

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161245

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161275

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161735

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673473

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673477

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673481

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673485

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673489

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 810052

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250223

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2533219

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3716724

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 3744978

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 4016506

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 6557150

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 9895950

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 11102056

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 14589345

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 16575279

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19289629

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19310753

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 19360781

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 21259499

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 23362439

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(DecimalNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 26254668

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161014

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(EnumNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161202

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161206

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161210

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161214

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161218

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161222

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161226

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161230

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161234

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161238

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161242

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161246

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161732

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 161736

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673474

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673478

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(BoolNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673482

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673486

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 673490

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(IntNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 840228

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 1250224

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
        
        
        
        select 
            a.listingid,
            a.customfieldid,
            b.name as customfieldname,
            a.customfield_valuecolumn as customfieldvalue
        from (
            select listingid as listingid,
               CustomFieldID as customfieldid,
               cast(StringNativeValue as nvarchar(4000)) as customfield_valuecolumn
            from 
                stg.AH_Listingproperties_FinalView 
            where 
                CustomFieldID = 2545215

        ) a 
        inner join stg.SZ_AH_Properties_FieldIDs b  -- better parameterize this
        on a.customfieldid = b.id
        union all
    
    select 
        '''' as listingid, '''' as customfieldid, '''' as customfieldname, '''' as customfieldvalue 
    where 2=1

    ');

  CREATE TABLE "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp_temp_view"
    end



22:05:44.779816 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 52.03 seconds
22:05:44.793025 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:05:44.793379 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: rename object "stg"."SZ_AH_AllProperties_One_Column" to SZ_AH_AllProperties_One_Column__dbt_backup
22:05:45.066708 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.27 seconds
22:05:45.078865 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:05:45.079251 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: rename object "stg"."SZ_AH_AllProperties_One_Column__dbt_tmp" to SZ_AH_AllProperties_One_Column
22:05:45.115077 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:05:45.117052 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_AllProperties_One_Column: COMMIT
22:05:45.121039 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_AllProperties_One_Column".
22:05:45.121270 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_AllProperties_One_Column: 
    
  if object_id ('"stg"."SZ_AH_AllProperties_One_Column__dbt_backup"','U') is not null
    begin
    drop table "stg"."SZ_AH_AllProperties_One_Column__dbt_backup"
    end

22:05:45.722080 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.60 seconds
22:05:45.733142 [debug] [Thread-1  ]: finished collecting timing info
22:05:45.733556 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_AllProperties_One_Column: Close
22:05:45.734328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fe0f9ff-5a87-41cc-bdd5-e543a5b59cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc301a9040>]}
22:05:45.734869 [info ] [Thread-1  ]: 1 of 2 OK created table model stg.SZ_AH_AllProperties_One_Column................ [[32mOK[0m in 71.96s]
22:05:45.735275 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_AllProperties_One_Column
22:05:45.736717 [debug] [MainThread]: Acquiring new synapse connection "master"
22:05:45.737033 [debug] [MainThread]: On master: COMMIT
22:05:45.737422 [info ] [MainThread]: 
22:05:45.737708 [info ] [MainThread]: Finished running 2 table models in 86.50s.
22:05:45.737919 [debug] [MainThread]: Connection 'master' was properly closed.
22:05:45.738029 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_CustomFields_Lookup' was properly closed.
22:05:45.738130 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_AllProperties_One_Column' was properly closed.
22:05:45.767639 [info ] [MainThread]: 
22:05:45.768053 [info ] [MainThread]: [32mCompleted successfully[0m
22:05:45.768356 [info ] [MainThread]: 
22:05:45.768550 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
22:05:45.768860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc345ac160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc36611550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc32236e50>]}


============================== 2022-09-14 22:05:48.085234 | 17b4e28b-925e-4925-8e7d-a326e3982041 ==============================
22:05:48.085234 [info ] [MainThread]: Running with dbt=1.0.0
22:05:48.086814 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step7_4'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:05:48.090622 [debug] [MainThread]: Tracking: tracking
22:05:48.091026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41eecfcf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41eecfcfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41eecfcbb0>]}
22:05:48.278879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:05:48.279265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:05:48.305363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b4e28b-925e-4925-8e7d-a326e3982041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41eec6a340>]}
22:05:48.353412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b4e28b-925e-4925-8e7d-a326e3982041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f0cbe8b0>]}
22:05:48.353956 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:05:48.361638 [info ] [MainThread]: 
22:05:48.362346 [debug] [MainThread]: Acquiring new synapse connection "master"
22:05:48.363445 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:05:48.372351 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:05:48.372564 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:05:48.372697 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:05:48.372848 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:05:48.670061 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:05:48.700547 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
22:05:48.702815 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:05:48.724578 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:05:48.731168 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:05:48.731631 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:05:48.734075 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:05:48.734305 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:05:48.734430 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:05:48.734619 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:05:48.731944 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:05:48.735937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:05:48.736130 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:05:48.852081 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:05:48.853220 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:05:48.889492 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:05:48.890048 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.16 seconds
22:05:48.914436 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:05:48.916459 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:05:49.073915 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:05:49.083684 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:06:02.799206 [debug] [MainThread]: On master: COMMIT
22:06:02.799884 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:06:02.800202 [info ] [MainThread]: 
22:06:02.803822 [debug] [Thread-1  ]: Began running node model.Shawn.SZ_AH_Properties_Pivot
22:06:02.804204 [info ] [Thread-1  ]: 1 of 1 START table model dbo.SZ_AH_Properties_Pivot............................. [RUN]
22:06:02.804713 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.SZ_AH_Properties_Pivot"
22:06:02.804882 [debug] [Thread-1  ]: Began compiling node model.Shawn.SZ_AH_Properties_Pivot
22:06:02.805035 [debug] [Thread-1  ]: Compiling model.Shawn.SZ_AH_Properties_Pivot
22:06:02.814274 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
22:06:02.814569 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
    select name from stg.SZ_AH_Properties_CustomFields_Lookup where name != 'listingid'

  
22:06:02.814712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:06:02.814862 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:02.969295 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:03.539353 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.72 seconds
22:06:03.556819 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
22:06:03.557203 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
    select col_type_cast  from stg.SZ_AH_Properties_CustomFields_Lookup

  
22:06:03.648005 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.09 seconds
22:06:03.666756 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.SZ_AH_Properties_Pivot"
22:06:03.667542 [debug] [Thread-1  ]: finished collecting timing info
22:06:03.667802 [debug] [Thread-1  ]: Began executing node model.Shawn.SZ_AH_Properties_Pivot
22:06:03.721994 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.SZ_AH_Properties_Pivot"
22:06:03.722756 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
22:06:03.722964 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
  
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."SZ_AH_Properties_Pivot__dbt_tmp"
    end


   EXEC('create view dbo.SZ_AH_Properties_Pivot__dbt_tmp_temp_view as
    









    

    

 







    
    

 

WITH pivot_data_input AS
(
    SELECT 
        listingid, -- Grouping Column
        customfieldname, -- Spreading Column
        customfieldvalue -- Aggregate Column
    FROM [stg].[SZ_AH_AllProperties_One_Column] 
        -- [TEST] where listingid = 10023682
),
pivoted_data AS
(
    SELECT 
        listingid, [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [CCID], [OdometerUnits], [DealerName], [Mileage], [MagicBoxSection6], [ReserveReviewEmailDate], [LeadSource], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [Taxonomy], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [HasProPhotography], [HideListing], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [Utm_Source_Listing_Submission], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OriginalEngineText], [HasProMarketing], [CarfaxPassFail], [Specialist_Section_Notes], [Era], [IsPaid], [AddressLine2], [PremiumListing], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [NoReserveCheck], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior], [OriginalEngine], [Commission], [MagicBoxSection1], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [VehicleStoryDescriptionExterior2], [VehicleColor], [MaxReserve], [VehicleStoryOpeningStatement], [Year], [IsApproved], [Specialist_Section_Comp4_Info], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [VehicleStoryDescriptionUndercarriagePictures], [Model], [Copy_Writer_Feedback], [BuyItNowUsed], [UserComments], [BuyItNow], [Dealer], [MileageAccurate], [EstimatedMarketValue], [StateProvinceRegion], [Acct_Rep], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [Utm_Campaign_Listing_Submission], [Zip], [Specialist_Section_Comp3_Info], [IsTaxable], [Transmission], [HasMagicBox], [HasDealerFee], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [ReservePrice], [BeenListedText], [VIN], [VehicleStoryDescriptionExteriorPictures], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [SchedulingComplete], [PhotoPlanId], [EngineSize], [Acct_Rep_Name], [WhereDidYouHearAboutUsListingReferral], [CounterReserve], [CurrentIssues], [TransactionId], [MakeOfferAvailable], [VehicleStoryDescriptionEngineTransmission], [Decade], [VehicleStory], [Acct_Rep_Email], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [VehicleTitle], [VehicleStoryDescriptionExterior2Pictures], [CommissionOverrideReason], [VehicleStoryDescriptionInterior2Pictures], [Comped], [Address], [MagicBoxSection5], [FixedPrice], [ListingNotes], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [IsEdited], [AnythingElseWeShouldKnow], [Photo_Plan], [MagicBoxSection3], [ListingProgress], [IsPromoVehicle], [TransmissionText], [ServiceRecords], [MagicBoxSection2], [SpinCarLink], [ExpertVideoReview], [MarketValue], [LastServiceInformation], [IsFeaturedVehicle], [PaintWork], [Specialist], [CityCL], [PaintWorkText], [ReservePriceCL], [CarTitleInYourName], [WhereDidYouHearAboutUsListing], [CountryOfOrigin], [PackageTransactionId], [SnapprPackage], [StartingBid], [MakeOfferAllowed], [CountryCL], [WGL_Public_Report], [HaveAllPhotos], [HowLongOwned], [Specialist_Section_Comp4_Price], [Make], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [DealerFees], [DealerURL], [Utm_Medium_Listing_Submission], [BeenModified]
    FROM pivot_data_input
    PIVOT (
        max(customfieldvalue) for customfieldname in ( [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [CCID], [OdometerUnits], [DealerName], [Mileage], [MagicBoxSection6], [ReserveReviewEmailDate], [LeadSource], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [Taxonomy], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [HasProPhotography], [HideListing], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [Utm_Source_Listing_Submission], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OriginalEngineText], [HasProMarketing], [CarfaxPassFail], [Specialist_Section_Notes], [Era], [IsPaid], [AddressLine2], [PremiumListing], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [NoReserveCheck], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior], [OriginalEngine], [Commission], [MagicBoxSection1], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [VehicleStoryDescriptionExterior2], [VehicleColor], [MaxReserve], [VehicleStoryOpeningStatement], [Year], [IsApproved], [Specialist_Section_Comp4_Info], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [VehicleStoryDescriptionUndercarriagePictures], [Model], [Copy_Writer_Feedback], [BuyItNowUsed], [UserComments], [BuyItNow], [Dealer], [MileageAccurate], [EstimatedMarketValue], [StateProvinceRegion], [Acct_Rep], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [Utm_Campaign_Listing_Submission], [Zip], [Specialist_Section_Comp3_Info], [IsTaxable], [Transmission], [HasMagicBox], [HasDealerFee], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [ReservePrice], [BeenListedText], [VIN], [VehicleStoryDescriptionExteriorPictures], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [SchedulingComplete], [PhotoPlanId], [EngineSize], [Acct_Rep_Name], [WhereDidYouHearAboutUsListingReferral], [CounterReserve], [CurrentIssues], [TransactionId], [MakeOfferAvailable], [VehicleStoryDescriptionEngineTransmission], [Decade], [VehicleStory], [Acct_Rep_Email], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [VehicleTitle], [VehicleStoryDescriptionExterior2Pictures], [CommissionOverrideReason], [VehicleStoryDescriptionInterior2Pictures], [Comped], [Address], [MagicBoxSection5], [FixedPrice], [ListingNotes], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [IsEdited], [AnythingElseWeShouldKnow], [Photo_Plan], [MagicBoxSection3], [ListingProgress], [IsPromoVehicle], [TransmissionText], [ServiceRecords], [MagicBoxSection2], [SpinCarLink], [ExpertVideoReview], [MarketValue], [LastServiceInformation], [IsFeaturedVehicle], [PaintWork], [Specialist], [CityCL], [PaintWorkText], [ReservePriceCL], [CarTitleInYourName], [WhereDidYouHearAboutUsListing], [CountryOfOrigin], [PackageTransactionId], [SnapprPackage], [StartingBid], [MakeOfferAllowed], [CountryCL], [WGL_Public_Report], [HaveAllPhotos], [HowLongOwned], [Specialist_Section_Comp4_Price], [Make], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [DealerFees], [DealerURL], [Utm_Medium_Listing_Submission], [BeenModified])
    )as pvt
)


select 
    listingid, [LockUsername], [Curated], [VehicleStoryOpeningStatementPictures], [CCID], [OdometerUnits], [DealerName], [Mileage], [MagicBoxSection6], [ReserveReviewEmailDate], [LeadSource], [Specialist_Section_Comp2_Info], [CarfaxPassFailError], [Taxonomy], [VehicleStoryDescriptionInterior2], [VehicleStoryDescriptionInteriorPictures], [HasProPhotography], [HideListing], [TargetReserve], [PersonalMileage], [VehicleStoryDescriptionUndercarriage], [CarfaxLink], [Utm_Source_Listing_Submission], [Copy_Writer_Status], [VehicleStoryDescriptionCarFaxPictures], [OriginalEngineText], [HasProMarketing], [CarfaxPassFail], [Specialist_Section_Notes], [Era], [IsPaid], [AddressLine2], [PremiumListing], [MagicBoxSection4], [Specialist_Section_Comp2_Price], [NoReserveCheck], [BeenListed], [Copy_Writer], [VehicleStoryDescriptionExterior], [OriginalEngine], [Commission], [MagicBoxSection1], [Specialist_Section_Comp1_Info], [CaliforniaSmogCheck], [Modifications], [ListingState], [VehicleStoryDescriptionExterior2], [VehicleColor], [MaxReserve], [VehicleStoryOpeningStatement], [Year], [IsApproved], [Specialist_Section_Comp4_Info], [VehicleStoryDescriptionCarFax], [Acct_Rep_Phone], [VehicleStoryDescriptionUndercarriagePictures], [Model], [Copy_Writer_Feedback], [BuyItNowUsed], [UserComments], [BuyItNow], [Dealer], [MileageAccurate], [EstimatedMarketValue], [StateProvinceRegion], [Acct_Rep], [DraftEmailNotificationSent], [Specialist_Section_Comp5_Info], [Utm_Campaign_Listing_Submission], [Zip], [Specialist_Section_Comp3_Info], [IsTaxable], [Transmission], [HasMagicBox], [HasDealerFee], [UI_ListingStateHold], [Specialist_Section_Comp5_Price], [ReservePrice], [BeenListedText], [VIN], [VehicleStoryDescriptionExteriorPictures], [MakeWholeAmount], [Photo_Plan_Status], [VehicleStoryDescriptionInterior], [SchedulingComplete], [PhotoPlanId], [EngineSize], [Acct_Rep_Name], [WhereDidYouHearAboutUsListingReferral], [CounterReserve], [CurrentIssues], [TransactionId], [MakeOfferAvailable], [VehicleStoryDescriptionEngineTransmission], [Decade], [VehicleStory], [Acct_Rep_Email], [WhereDidYouHearAboutUsListingOther], [Specialist_Section_Original_Reserve], [VehicleTitle], [VehicleStoryDescriptionExterior2Pictures], [CommissionOverrideReason], [VehicleStoryDescriptionInterior2Pictures], [Comped], [Address], [MagicBoxSection5], [FixedPrice], [ListingNotes], [Rust], [VehicleStoryDescriptionEngineTransmissionPictures], [IsEdited], [AnythingElseWeShouldKnow], [Photo_Plan], [MagicBoxSection3], [ListingProgress], [IsPromoVehicle], [TransmissionText], [ServiceRecords], [MagicBoxSection2], [SpinCarLink], [ExpertVideoReview], [MarketValue], [LastServiceInformation], [IsFeaturedVehicle], [PaintWork], [Specialist], [CityCL], [PaintWorkText], [ReservePriceCL], [CarTitleInYourName], [WhereDidYouHearAboutUsListing], [CountryOfOrigin], [PackageTransactionId], [SnapprPackage], [StartingBid], [MakeOfferAllowed], [CountryCL], [WGL_Public_Report], [HaveAllPhotos], [HowLongOwned], [Specialist_Section_Comp4_Price], [Make], [Specialist_Section_Comp1_Price], [Specialist_Section_Comp3_Price], [DealerFees], [DealerURL], [Utm_Medium_Listing_Submission], [BeenModified]
from pivoted_data
    ');

  CREATE TABLE "dbo"."SZ_AH_Properties_Pivot__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.SZ_AH_Properties_Pivot__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."SZ_AH_Properties_Pivot__dbt_tmp_temp_view"
    end



22:06:09.942905 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 6.22 seconds
22:06:09.960116 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
22:06:09.960450 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: rename object "dbo"."SZ_AH_Properties_Pivot" to SZ_AH_Properties_Pivot__dbt_backup
22:06:10.087956 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.13 seconds
22:06:10.099974 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
22:06:10.100313 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: rename object "dbo"."SZ_AH_Properties_Pivot__dbt_tmp" to SZ_AH_Properties_Pivot
22:06:10.133195 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:06:10.145024 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Pivot: COMMIT
22:06:10.151833 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.SZ_AH_Properties_Pivot".
22:06:10.152189 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.SZ_AH_Properties_Pivot: 
    
  if object_id ('"dbo"."SZ_AH_Properties_Pivot__dbt_backup"','U') is not null
    begin
    drop table "dbo"."SZ_AH_Properties_Pivot__dbt_backup"
    end

22:06:10.557744 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.41 seconds
22:06:10.569321 [debug] [Thread-1  ]: finished collecting timing info
22:06:10.569743 [debug] [Thread-1  ]: On model.Shawn.SZ_AH_Properties_Pivot: Close
22:06:10.570578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b4e28b-925e-4925-8e7d-a326e3982041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ec8d3fd0>]}
22:06:10.571091 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.SZ_AH_Properties_Pivot........................ [[32mOK[0m in 7.77s]
22:06:10.571485 [debug] [Thread-1  ]: Finished running node model.Shawn.SZ_AH_Properties_Pivot
22:06:10.572812 [debug] [MainThread]: Acquiring new synapse connection "master"
22:06:10.573112 [debug] [MainThread]: On master: COMMIT
22:06:10.573446 [info ] [MainThread]: 
22:06:10.573704 [info ] [MainThread]: Finished running 1 table model in 22.21s.
22:06:10.573903 [debug] [MainThread]: Connection 'master' was properly closed.
22:06:10.574010 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
22:06:10.574108 [debug] [MainThread]: Connection 'model.Shawn.SZ_AH_Properties_Pivot' was properly closed.
22:06:10.602222 [info ] [MainThread]: 
22:06:10.602640 [info ] [MainThread]: [32mCompleted successfully[0m
22:06:10.602954 [info ] [MainThread]: 
22:06:10.603195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:06:10.603516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41f0cbe430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41eecb8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f41ec97ed90>]}


============================== 2022-09-14 22:06:12.900258 | 91015f54-6cc9-4289-b38f-663c2d878702 ==============================
22:06:12.900258 [info ] [MainThread]: Running with dbt=1.0.0
22:06:12.906889 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_1_DM'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:06:12.907197 [debug] [MainThread]: Tracking: tracking
22:06:12.907546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aee11dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aee11e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aee11e80>]}
22:06:13.111443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:06:13.111857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:06:13.138945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91015f54-6cc9-4289-b38f-663c2d878702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aed7d310>]}
22:06:13.194948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91015f54-6cc9-4289-b38f-663c2d878702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aeb21a30>]}
22:06:13.195541 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:06:13.206035 [info ] [MainThread]: 
22:06:13.206765 [debug] [MainThread]: Acquiring new synapse connection "master"
22:06:13.207863 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:06:13.216900 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:06:13.217201 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:06:13.217338 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:13.217492 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:13.514136 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:13.543358 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.33 seconds
22:06:13.545498 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:06:13.567032 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:06:13.573105 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:06:13.573548 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:06:13.575447 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:06:13.575658 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:06:13.575788 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:13.575927 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:13.573864 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:06:13.577454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:06:13.577638 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:13.694970 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:13.697833 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:13.729568 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:06:13.730163 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:06:13.756840 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:06:13.759656 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:06:13.917936 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:06:13.927719 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:06:27.722491 [debug] [MainThread]: On master: COMMIT
22:06:27.723224 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:06:27.723575 [info ] [MainThread]: 
22:06:27.727213 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Cars_DM
22:06:27.727768 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Cars_DM......................................... [RUN]
22:06:27.728294 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Cars_DM"
22:06:27.728466 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Cars_DM
22:06:27.728617 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Cars_DM
22:06:27.731490 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Cars_DM"
22:06:27.731984 [debug] [Thread-1  ]: finished collecting timing info
22:06:27.732155 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Cars_DM
22:06:27.784896 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Cars_DM"
22:06:27.785627 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
22:06:27.785833 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
  
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Cars_DM__dbt_tmp"
    end


   EXEC('create view dbo.AH_Cars_DM__dbt_tmp_temp_view as
    
with DMStg as (
    SELECT
        HASHBYTES(''SHA2_256'',
            CONCAT(
                COALESCE(CAST(lpp.[ListingId] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[VIN] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Year] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Make] AS VARCHAR(200)), ''''), ''|'',
                COALESCE(CAST(lpp.[Model] AS VARCHAR(200)), '''')
            )
        ) as [Car_Skey],
		lpp.[ListingId] AS [ListingID],
		lpp.[VIN],
		lpp.[Year],
		lpp.[Make],
		lpp.[Model],
		lpp.[VehicleColor],
		lpp.[EngineSize],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate]
    from dbo.SZ_AH_Properties_Pivot as lpp
    inner join [stg].[AH_Listings_FinalView] as l 
    on lpp.ListingID=l.ID
)
select 
	[ListingID],	
    [Car_Skey],
	[VIN],
	[Year],
	[Make],
	[Model],
	[VehicleColor],
	[EngineSize],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate]
from DMStg
    ');

  CREATE TABLE "dbo"."AH_Cars_DM__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Cars_DM__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Cars_DM__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Cars_DM__dbt_tmp_temp_view"
    end



22:06:27.786151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:06:27.786312 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:27.915115 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:33.525800 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 5.74 seconds
22:06:33.542372 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
22:06:33.542785 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo"."AH_Cars_DM" to AH_Cars_DM__dbt_backup
22:06:33.574774 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:06:33.586760 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
22:06:33.587141 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: rename object "dbo"."AH_Cars_DM__dbt_tmp" to AH_Cars_DM
22:06:33.617760 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:06:33.629606 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: COMMIT
22:06:33.636493 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Cars_DM".
22:06:33.636855 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Cars_DM: 
    
  if object_id ('"dbo"."AH_Cars_DM__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Cars_DM__dbt_backup"
    end

22:06:33.879477 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.24 seconds
22:06:33.890428 [debug] [Thread-1  ]: finished collecting timing info
22:06:33.890875 [debug] [Thread-1  ]: On model.Shawn.AH_Cars_DM: Close
22:06:33.891647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91015f54-6cc9-4289-b38f-663c2d878702', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ac9e8b80>]}
22:06:33.892132 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Cars_DM.................................... [[32mOK[0m in 6.16s]
22:06:33.892522 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Cars_DM
22:06:33.893842 [debug] [MainThread]: Acquiring new synapse connection "master"
22:06:33.894157 [debug] [MainThread]: On master: COMMIT
22:06:33.894499 [info ] [MainThread]: 
22:06:33.894804 [info ] [MainThread]: Finished running 1 table model in 20.69s.
22:06:33.895009 [debug] [MainThread]: Connection 'master' was properly closed.
22:06:33.895122 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
22:06:33.895221 [debug] [MainThread]: Connection 'model.Shawn.AH_Cars_DM' was properly closed.
22:06:33.924001 [info ] [MainThread]: 
22:06:33.924450 [info ] [MainThread]: [32mCompleted successfully[0m
22:06:33.924763 [info ] [MainThread]: 
22:06:33.924959 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:06:33.925282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aedaf400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08af8c8100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aca38d90>]}


============================== 2022-09-14 22:06:36.334711 | 74fb55ff-1265-4003-89e9-e7c400620217 ==============================
22:06:36.334711 [info ] [MainThread]: Running with dbt=1.0.0
22:06:36.335443 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_2_FT_stg'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:06:36.335704 [debug] [MainThread]: Tracking: tracking
22:06:36.336070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db9376fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db9376bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db9376d60>]}
22:06:36.543664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:06:36.544095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:06:36.571153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74fb55ff-1265-4003-89e9-e7c400620217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db92e33a0>]}
22:06:36.621511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74fb55ff-1265-4003-89e9-e7c400620217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db9088910>]}
22:06:36.622108 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:06:36.630436 [info ] [MainThread]: 
22:06:36.631249 [debug] [MainThread]: Acquiring new synapse connection "master"
22:06:36.632377 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:06:36.641591 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:06:36.641956 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:06:36.642106 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:36.642269 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:36.909859 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:36.939719 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.30 seconds
22:06:36.942110 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:06:36.964915 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:06:36.971099 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:06:36.971557 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:06:36.973514 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:06:36.973748 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:06:36.973880 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:36.974021 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:36.971889 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:06:36.975387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:06:36.975897 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:37.083290 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:37.084706 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:37.118968 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.15 seconds
22:06:37.120090 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.14 seconds
22:06:37.148829 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:06:37.149901 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:06:37.310086 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:06:37.319691 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:06:51.149661 [debug] [MainThread]: On master: COMMIT
22:06:51.150332 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:06:51.150698 [info ] [MainThread]: 
22:06:51.153845 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_stg
22:06:51.154204 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_Listings_FT_stg................................. [RUN]
22:06:51.154704 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_stg"
22:06:51.154875 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_stg
22:06:51.155028 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_stg
22:06:51.158118 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_stg"
22:06:51.158644 [debug] [Thread-1  ]: finished collecting timing info
22:06:51.158821 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_stg
22:06:51.248423 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_stg"
22:06:51.249156 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
22:06:51.249366 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
  
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_stg__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_FT_stg__dbt_tmp_temp_view as
    
SELECT
		l.[ID] AS [ListingID],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		lt.[Name] AS [ListingType],
		l.[CreatedOn] AS [CreatedDate],
		l.[UpdatedOn] AS [UpdatedDate],
		l.[DeletedOn] AS [DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		lp.[VehicleStoryOpeningStatement],
		lp.[VehicleStoryDescriptionCarFax],
		lp.[Acct_Rep_Phone],
		lp.[HasMagicBox],
		lp.[HasDealerFee],
		lp.[VehicleStory],
		lp.[CarfaxPassFailError],
		lp.[LeadSource],
		lp.[VehicleStoryDescriptionInterior2Pictures],
		lp.[Decade],
		lp.[PaintWork],
		lp.[Specialist_Section_Comp2_Info],
		lp.[Curated],
		lp.[VehicleStoryDescriptionUndercarriagePictures],
		lp.[IsFeaturedVehicle],
		lp.[VehicleStoryOpeningStatementPictures],
		lp.[Copy_Writer_Status],
		lp.[FixedPrice],
		lp.[LockUsername],
		lp.[NoReserveCheck],
		lp.[VehicleStoryDescriptionCarFaxPictures],
		lp.[BeenListed],
		lp.[Acct_Rep],
		lp.[MagicBoxSection4],
		lp.[Copy_Writer],
		lp.[Taxonomy],
		lp.[PersonalMileage],
		lp.[Specialist_Section_Comp2_Price],
		lp.[VehicleStoryDescriptionInterior2],
		lp.[VehicleStoryDescriptionUndercarriage],
		lp.[VehicleStoryDescriptionInteriorPictures],
		lp.[Acct_Rep_Name],
		lp.[CarfaxLink],
		lp.[HideListing],
		lp.[CurrentIssues],
		lp.[TargetReserve],
		lp.[TransactionId],
		lp.[Specialist],
		lp.[BuyItNow],
		lp.[VehicleStoryDescriptionEngineTransmission],
		lp.[CountryOfOrigin],
		lp.[CommissionOverrideReason],
		lp.[WhereDidYouHearAboutUsListingReferral],
		lp.[CaliforniaSmogCheck],
		lp.[Modifications],
		lp.[Zip],
		lp.[ListingState],
		lp.[AnythingElseWeShouldKnow],
		lp.[VehicleTitle],
		lp.[Specialist_Section_Notes],
		lp.[VehicleStoryDescriptionExterior2],
		lp.[Photo_Plan],
		lp.[VehicleStoryDescriptionExterior2Pictures],
		lp.[Era],
		lp.[Commission],
		lp.[MakeOfferAvailable],
		lp.[IsEdited],
		lp.[WhereDidYouHearAboutUsListingOther],
		lp.[MagicBoxSection1],
		lp.[VehicleStoryDescriptionExteriorPictures],
		lp.[Specialist_Section_Original_Reserve],
		lp.[Specialist_Section_Comp1_Info],
		lp.[UI_ListingStateHold],
		lp.[AddressLine2],
		lp.[Specialist_Section_Comp5_Price],
		lp.[WGL_Public_Report],
		lp.[PremiumListing],
		lp.[ReservePrice],
		lp.[DealerURL],
		lp.[IsPaid],
		lp.[OriginalEngineText],
		lp.[HasProMarketing],
		lp.[PhotoPlanId],
		lp.[TransmissionText],
		lp.[MakeOfferAllowed],
		lp.[SchedulingComplete],
		lp.[ServiceRecords],
		lp.[CountryCL],
		lp.[OdometerUnits],
		lp.[BuyItNowUsed],
		lp.[MagicBoxSection3],
		lp.[SnapprPackage],
		lp.[CarfaxPassFail],
		lp.[CCID],
		lp.[StateProvinceRegion],
		lp.[DealerName],
		lp.[ListingProgress],
		lp.[StartingBid],
		lp.[EstimatedMarketValue],
		lp.[Mileage],
		lp.[IsPromoVehicle],
		lp.[MagicBoxSection2],
		lp.[SpinCarLink],
		lp.[MagicBoxSection5],
		lp.[Photo_Plan_Status],
		lp.[Address],
		lp.[HaveAllPhotos],
		lp.[MagicBoxSection6],
		lp.[OriginalEngine],
		lp.[VehicleStoryDescriptionInterior],
		lp.[UserComments],
		lp.[CarTitleInYourName],
		lp.[MarketValue],
		lp.[PackageTransactionId],
		lp.[Specialist_Section_Comp1_Price],
		lp.[Rust],
		lp.[MakeWholeAmount],
		lp.[Specialist_Section_Comp3_Price],
		lp.[VehicleStoryDescriptionEngineTransmissionPictures],
		lp.[WhereDidYouHearAboutUsListing],
		lp.[HasProPhotography],
		lp.[IsApproved],
		lp.[ListingNotes],
		lp.[Specialist_Section_Comp4_Info],
		lp.[HowLongOwned],
		lp.[DraftEmailNotificationSent],
		lp.[Copy_Writer_Feedback],
		lp.[ExpertVideoReview],
		lp.[Specialist_Section_Comp5_Info],
		lp.[Comped],
		lp.[BeenListedText],
		lp.[IsTaxable],
		lp.[Transmission],
		lp.[BeenModified],
		lp.[Specialist_Section_Comp3_Info],
		lp.[CityCL],
		lp.[PaintWorkText],
		lp.[Dealer],
		lp.[ReservePriceCL],
		lp.[MileageAccurate],
		lp.[Acct_Rep_Email],
		lp.[LastServiceInformation],
		lp.[DealerFees],
		lp.[Specialist_Section_Comp4_Price],
		lp.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FinalView] l
left join dbo.SZ_AH_Properties_Pivot lp on l.ID=lp.ListingID
left join [stg].[AH_ListingTypes_FinalView] lt on l.ListingTypeID=lt.ID
    ');

  CREATE TABLE "stg"."AH_Listings_FT_stg__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_FT_stg__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_stg__dbt_tmp_temp_view"
    end



22:06:51.249511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:06:51.249663 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:51.383922 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:55.181578 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.93 seconds
22:06:55.197460 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
22:06:55.197763 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "stg"."AH_Listings_FT_stg" to AH_Listings_FT_stg__dbt_backup
22:06:55.319353 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.12 seconds
22:06:55.331126 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
22:06:55.331489 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: rename object "stg"."AH_Listings_FT_stg__dbt_tmp" to AH_Listings_FT_stg
22:06:55.364516 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:06:55.376032 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: COMMIT
22:06:55.382458 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_stg".
22:06:55.382763 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_stg: 
    
  if object_id ('"stg"."AH_Listings_FT_stg__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_stg__dbt_backup"
    end

22:06:55.659206 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.28 seconds
22:06:55.737146 [debug] [Thread-1  ]: finished collecting timing info
22:06:55.737590 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_stg: Close
22:06:55.738371 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74fb55ff-1265-4003-89e9-e7c400620217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db2f90bb0>]}
22:06:55.738912 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_Listings_FT_stg............................ [[32mOK[0m in 4.58s]
22:06:55.739339 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_stg
22:06:55.740610 [debug] [MainThread]: Acquiring new synapse connection "master"
22:06:55.740914 [debug] [MainThread]: On master: COMMIT
22:06:55.741264 [info ] [MainThread]: 
22:06:55.741529 [info ] [MainThread]: Finished running 1 table model in 19.11s.
22:06:55.741734 [debug] [MainThread]: Connection 'master' was properly closed.
22:06:55.741842 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_stg' was properly closed.
22:06:55.741942 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
22:06:55.769954 [info ] [MainThread]: 
22:06:55.770399 [info ] [MainThread]: [32mCompleted successfully[0m
22:06:55.770785 [info ] [MainThread]: 
22:06:55.770988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:06:55.771301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db9088490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dbb368cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2db2ff2df0>]}


============================== 2022-09-14 22:06:58.148135 | 92abf45e-8f65-4f64-8f94-8e444b17b725 ==============================
22:06:58.148135 [info ] [MainThread]: Running with dbt=1.0.0
22:06:58.154934 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_3_FT_tmp'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:06:58.155259 [debug] [MainThread]: Tracking: tracking
22:06:58.155620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faceec17d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faceec17dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faceec17e20>]}
22:06:58.358412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:06:58.358944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:06:58.386363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92abf45e-8f65-4f64-8f94-8e444b17b725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faceeb832b0>]}
22:06:58.434763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92abf45e-8f65-4f64-8f94-8e444b17b725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf0bd39d0>]}
22:06:58.435338 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:06:58.443511 [info ] [MainThread]: 
22:06:58.444271 [debug] [MainThread]: Acquiring new synapse connection "master"
22:06:58.445400 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:06:58.454561 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:06:58.454897 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:06:58.455051 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:58.455204 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:58.748027 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:58.778578 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.32 seconds
22:06:58.780548 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:06:58.801801 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:06:58.807960 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:06:58.808419 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:06:58.810289 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:06:58.810497 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:06:58.810668 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:06:58.810813 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:58.808739 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:06:58.812338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:06:58.812508 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:06:58.948654 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:58.952097 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:06:58.989845 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.18 seconds
22:06:59.018326 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.21 seconds
22:06:59.054331 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:06:59.127131 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:06:59.171544 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:06:59.183241 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:07:13.445549 [debug] [MainThread]: On master: COMMIT
22:07:13.446216 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:07:13.446567 [info ] [MainThread]: 
22:07:13.450193 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT_tmp
22:07:13.450606 [info ] [Thread-1  ]: 1 of 1 START table model stg.AH_Listings_FT_tmp................................. [RUN]
22:07:13.451130 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT_tmp"
22:07:13.451303 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT_tmp
22:07:13.451457 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT_tmp
22:07:13.454701 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT_tmp"
22:07:13.455227 [debug] [Thread-1  ]: finished collecting timing info
22:07:13.455403 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT_tmp
22:07:13.545819 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT_tmp"
22:07:13.546585 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
22:07:13.546799 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
  
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_tmp__dbt_tmp"
    end


   EXEC('create view stg.AH_Listings_FT_tmp__dbt_tmp_temp_view as
    
SELECT
		l.[ListingID],
		condm.[Consignor_SKey],
		cardm.[Car_Skey],
		l.[OwnerID],
		l.[PrimaryCategoryId],
		l.[CurrencyID],
		l.[ListingTypeID],
		l.[ListingType],
		l.[CreatedDate],
		l.[UpdatedDate],
		l.[DeletedDate],
		l.[Title],
		l.[OriginalRelistCount],
		l.[Hits],
		l.[EndDTTM],
		l.[StartDTTM],
		l.[Subtitle],
		l.[Location],
		l.[Status],
		l.[CurrentPrice],
		l.[LastUpdatedUser],
		l.[Duration],
		l.[Version],
		l.[Increment],
		l.[OriginalPrice],
		l.[AutoRelistRemaining],
		l.[CurrentQuantity],
		l.[OriginalQuantity],
		l.[RelistIteration],
		l.[PrimaryImageURI],
		l.[AcceptedActionCount],
		l.[OwnerUserName],
		l.[CurrentListingActionId],
		l.[CurrentListingActionUserName],
		l.[OfferCount],
		l.[VehicleStoryOpeningStatement],
		l.[VehicleStoryDescriptionCarFax],
		l.[Acct_Rep_Phone],
		l.[HasMagicBox],
		l.[HasDealerFee],
		l.[VehicleStory],
		l.[CarfaxPassFailError],
		l.[LeadSource],
		l.[VehicleStoryDescriptionInterior2Pictures],
		l.[Decade],
		l.[PaintWork],
		l.[Specialist_Section_Comp2_Info],
		l.[Curated],
		l.[VehicleStoryDescriptionUndercarriagePictures],
		l.[IsFeaturedVehicle],
		l.[VehicleStoryOpeningStatementPictures],
		l.[Copy_Writer_Status],
		l.[FixedPrice],
		l.[LockUsername],
		l.[NoReserveCheck],
		l.[VehicleStoryDescriptionCarFaxPictures],
		l.[BeenListed],
		l.[Acct_Rep],
		l.[MagicBoxSection4],
		l.[Copy_Writer],
		l.[Taxonomy],
		l.[PersonalMileage],
		l.[Specialist_Section_Comp2_Price],
		l.[VehicleStoryDescriptionInterior2],
		l.[VehicleStoryDescriptionUndercarriage],
		l.[VehicleStoryDescriptionInteriorPictures],
		l.[Acct_Rep_Name],
		l.[CarfaxLink],
		l.[HideListing],
		l.[CurrentIssues],
		l.[TargetReserve],
		l.[TransactionId],
		l.[Specialist],
		l.[BuyItNow],
		l.[VehicleStoryDescriptionEngineTransmission],
		l.[CountryOfOrigin],
		l.[CommissionOverrideReason],
		l.[WhereDidYouHearAboutUsListingReferral],
		l.[CaliforniaSmogCheck],
		l.[Modifications],
		l.[Zip],
		l.[ListingState],
		l.[AnythingElseWeShouldKnow],
		l.[VehicleTitle],
		l.[Specialist_Section_Notes],
		l.[VehicleStoryDescriptionExterior2],
		l.[Photo_Plan],
		l.[VehicleStoryDescriptionExterior2Pictures],
		l.[Era],
		l.[Commission],
		l.[MakeOfferAvailable],
		l.[IsEdited],
		l.[WhereDidYouHearAboutUsListingOther],
		l.[MagicBoxSection1],
		l.[VehicleStoryDescriptionExteriorPictures],
		l.[Specialist_Section_Original_Reserve],
		l.[Specialist_Section_Comp1_Info],
		l.[UI_ListingStateHold],
		l.[AddressLine2],
		l.[Specialist_Section_Comp5_Price],
		l.[WGL_Public_Report],
		l.[PremiumListing],
		l.[ReservePrice],
		l.[DealerURL],
		l.[IsPaid],
		l.[OriginalEngineText],
		l.[HasProMarketing],
		l.[PhotoPlanId],
		l.[TransmissionText],
		l.[MakeOfferAllowed],
		l.[SchedulingComplete],
		l.[ServiceRecords],
		l.[CountryCL],
		l.[OdometerUnits],
		l.[BuyItNowUsed],
		l.[MagicBoxSection3],
		l.[SnapprPackage],
		l.[CarfaxPassFail],
		l.[CCID],
		l.[StateProvinceRegion],
		l.[DealerName],
		l.[ListingProgress],
		l.[StartingBid],
		l.[EstimatedMarketValue],
		l.[Mileage],
		l.[IsPromoVehicle],
		l.[MagicBoxSection2],
		l.[SpinCarLink],
		l.[MagicBoxSection5],
		l.[Photo_Plan_Status],
		l.[Address],
		l.[HaveAllPhotos],
		l.[MagicBoxSection6],
		l.[OriginalEngine],
		l.[VehicleStoryDescriptionInterior],
		l.[UserComments],
		l.[CarTitleInYourName],
		l.[MarketValue],
		l.[PackageTransactionId],
		l.[Specialist_Section_Comp1_Price],
		l.[Rust],
		l.[MakeWholeAmount],
		l.[Specialist_Section_Comp3_Price],
		l.[VehicleStoryDescriptionEngineTransmissionPictures],
		l.[WhereDidYouHearAboutUsListing],
		l.[HasProPhotography],
		l.[IsApproved],
		l.[ListingNotes],
		l.[Specialist_Section_Comp4_Info],
		l.[HowLongOwned],
		l.[DraftEmailNotificationSent],
		l.[Copy_Writer_Feedback],
		l.[ExpertVideoReview],
		l.[Specialist_Section_Comp5_Info],
		l.[Comped],
		l.[BeenListedText],
		l.[IsTaxable],
		l.[Transmission],
		l.[BeenModified],
		l.[Specialist_Section_Comp3_Info],
		l.[CityCL],
		l.[PaintWorkText],
		l.[Dealer],
		l.[ReservePriceCL],
		l.[MileageAccurate],
		l.[Acct_Rep_Email],
		l.[LastServiceInformation],
		l.[DealerFees],
		l.[Specialist_Section_Comp4_Price],
		l.[VehicleStoryDescriptionExterior]
from [stg].[AH_Listings_FT_stg] l
left join [dbo].[AH_Cars_DM] cardm on l.ListingID=cardm.ListingID
left join [dbo].[AH_Consignors_DM] condm on l.OwnerID=condm.UserID
    ');

  CREATE TABLE "stg"."AH_Listings_FT_tmp__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM stg.AH_Listings_FT_tmp__dbt_tmp_temp_view)

   
  
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "stg"."AH_Listings_FT_tmp__dbt_tmp_temp_view"
    end



22:07:13.546941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:07:13.547097 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:07:13.687443 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:07:20.634464 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 7.09 seconds
22:07:20.651044 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
22:07:20.651399 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "stg"."AH_Listings_FT_tmp" to AH_Listings_FT_tmp__dbt_backup
22:07:20.695449 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:07:20.768262 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
22:07:20.768628 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: rename object "stg"."AH_Listings_FT_tmp__dbt_tmp" to AH_Listings_FT_tmp
22:07:20.801441 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:07:20.812298 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: COMMIT
22:07:20.818462 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT_tmp".
22:07:20.818761 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT_tmp: 
    
  if object_id ('"stg"."AH_Listings_FT_tmp__dbt_backup"','U') is not null
    begin
    drop table "stg"."AH_Listings_FT_tmp__dbt_backup"
    end

22:07:21.206280 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.39 seconds
22:07:21.217649 [debug] [Thread-1  ]: finished collecting timing info
22:07:21.217986 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT_tmp: Close
22:07:21.218701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92abf45e-8f65-4f64-8f94-8e444b17b725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faceeb38b50>]}
22:07:21.219155 [info ] [Thread-1  ]: 1 of 1 OK created table model stg.AH_Listings_FT_tmp............................ [[32mOK[0m in 7.77s]
22:07:21.219526 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT_tmp
22:07:21.220707 [debug] [MainThread]: Acquiring new synapse connection "master"
22:07:21.220998 [debug] [MainThread]: On master: COMMIT
22:07:21.221303 [info ] [MainThread]: 
22:07:21.221553 [info ] [MainThread]: Finished running 1 table model in 22.78s.
22:07:21.221764 [debug] [MainThread]: Connection 'master' was properly closed.
22:07:21.221873 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT_tmp' was properly closed.
22:07:21.221974 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
22:07:21.248096 [info ] [MainThread]: 
22:07:21.248477 [info ] [MainThread]: [32mCompleted successfully[0m
22:07:21.248762 [info ] [MainThread]: 
22:07:21.248954 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:07:21.249249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facf0bd3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facee4feac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facec896d00>]}


============================== 2022-09-14 22:07:23.461476 | c755cfe4-a212-4300-b290-8fc73d824ab9 ==============================
22:07:23.461476 [info ] [MainThread]: Running with dbt=1.0.0
22:07:23.466823 [debug] [MainThread]: running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=None, defer=None, event_buffer_size=None, exclude=None, fail_fast=None, full_refresh=False, log_cache_events=False, log_format=None, partial_parse=None, printer_width=None, profile=None, profiles_dir='/root/.dbt', project_dir='/home/azureuser/shawn_dbt/AH', record_timing_info=None, rpc_method='run', select=['step8_4_FT'], selector_name=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='run', write_json=None)
22:07:23.467106 [debug] [MainThread]: Tracking: tracking
22:07:23.467431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebd3ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebd3ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebd3e3d0>]}
22:07:23.655393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:07:23.655781 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:07:23.681207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c755cfe4-a212-4300-b290-8fc73d824ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebcab400>]}
22:07:23.725271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c755cfe4-a212-4300-b290-8fc73d824ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94eba57970>]}
22:07:23.725773 [info ] [MainThread]: Found 343 models, 0 tests, 101 snapshots, 0 analyses, 213 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
22:07:23.732842 [info ] [MainThread]: 
22:07:23.733420 [debug] [MainThread]: Acquiring new synapse connection "master"
22:07:23.734386 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD"
22:07:23.743288 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD".
22:07:23.743497 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD: select  name as [schema]
    from sys.schemas
  
22:07:23.743634 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:07:23.743786 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:07:24.181685 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:07:24.210582 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.47 seconds
22:07:24.212556 [debug] [ThreadPool]: On list_BJAC_DW_PROD: Close
22:07:24.233358 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_stg"
22:07:24.239250 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_stg".
22:07:24.239637 [debug] [ThreadPool]: Acquiring new synapse connection "list_BJAC_DW_PROD_dbo"
22:07:24.241409 [debug] [ThreadPool]: SQLServer adapter: Using synapse connection "list_BJAC_DW_PROD_dbo".
22:07:24.241598 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_dbo: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'dbo'
      and table_catalog like 'BJAC_DW_PROD'
  
22:07:24.241723 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:07:24.241856 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:07:24.239900 [debug] [ThreadPool]: SQLServer adapter: On list_BJAC_DW_PROD_stg: select
      table_catalog as [database],
      table_name as [name],
      table_schema as [schema],
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type

    from information_schema.tables
    where table_schema like 'stg'
      and table_catalog like 'BJAC_DW_PROD'
  
22:07:24.243380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:07:24.243551 [debug] [ThreadPool]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:07:24.377586 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:07:24.381293 [debug] [ThreadPool]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:07:24.409111 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
22:07:24.413967 [debug] [ThreadPool]: SQLServer adapter: SQL status: OK in 0.17 seconds
22:07:24.434371 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: ROLLBACK
22:07:24.435988 [debug] [ThreadPool]: On list_BJAC_DW_PROD_dbo: Close
22:07:24.587083 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: ROLLBACK
22:07:24.599832 [debug] [ThreadPool]: On list_BJAC_DW_PROD_stg: Close
22:07:38.346876 [debug] [MainThread]: On master: COMMIT
22:07:38.347566 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
22:07:38.347903 [info ] [MainThread]: 
22:07:38.351529 [debug] [Thread-1  ]: Began running node model.Shawn.AH_Listings_FT
22:07:38.351930 [info ] [Thread-1  ]: 1 of 1 START table model dbo.AH_Listings_FT..................................... [RUN]
22:07:38.352443 [debug] [Thread-1  ]: Acquiring new synapse connection "model.Shawn.AH_Listings_FT"
22:07:38.352615 [debug] [Thread-1  ]: Began compiling node model.Shawn.AH_Listings_FT
22:07:38.352774 [debug] [Thread-1  ]: Compiling model.Shawn.AH_Listings_FT
22:07:38.357964 [debug] [Thread-1  ]: Writing injected SQL for node "model.Shawn.AH_Listings_FT"
22:07:38.358527 [debug] [Thread-1  ]: finished collecting timing info
22:07:38.358755 [debug] [Thread-1  ]: Began executing node model.Shawn.AH_Listings_FT
22:07:38.412099 [debug] [Thread-1  ]: Writing runtime SQL for node "model.Shawn.AH_Listings_FT"
22:07:38.412809 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
22:07:38.413009 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
  
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end


   
    
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp"','U') is not null
    begin
    drop table "dbo"."AH_Listings_FT__dbt_tmp"
    end


   EXEC('create view dbo.AH_Listings_FT__dbt_tmp_temp_view as
    
with updateData as (
    select 
    	FTstg.[ListingID],
		FTtmp.[Consignor_SKey],
		FTtmp.[Car_Skey],
		FTstg.[PrimaryCategoryId],
		FTstg.[CurrencyID],
		FTstg.[ListingTypeID],
		FTstg.[ListingType],
		FTstg.[CreatedDate],
		FTstg.[UpdatedDate],
		FTstg.[DeletedDate],
		FTstg.[Title],
		FTstg.[OriginalRelistCount],
		FTstg.[Hits],
		FTstg.[EndDTTM],
		FTstg.[StartDTTM],
		FTstg.[Subtitle],
		FTstg.[Location],
		FTstg.[Status],
		FTstg.[CurrentPrice],
		FTstg.[LastUpdatedUser],
		FTstg.[Duration],
		FTstg.[Version],
		FTstg.[Increment],
		FTstg.[OriginalPrice],
		FTstg.[AutoRelistRemaining],
		FTstg.[CurrentQuantity],
		FTstg.[OriginalQuantity],
		FTstg.[RelistIteration],
		FTstg.[PrimaryImageURI],
		FTstg.[AcceptedActionCount],
		FTstg.[OwnerUserName],
		FTstg.[CurrentListingActionId],
		FTstg.[CurrentListingActionUserName],
		FTstg.[OfferCount],
		FTstg.[VehicleStoryOpeningStatement],
		FTstg.[VehicleStoryDescriptionCarFax],
		FTstg.[Acct_Rep_Phone],
		FTstg.[HasMagicBox],
		FTstg.[HasDealerFee],
		FTstg.[VehicleStory],
		FTstg.[CarfaxPassFailError],
		FTstg.[LeadSource],
		FTstg.[VehicleStoryDescriptionInterior2Pictures],
		FTstg.[Decade],
		FTstg.[PaintWork],
		FTstg.[Specialist_Section_Comp2_Info],
		FTstg.[Curated],
		FTstg.[VehicleStoryDescriptionUndercarriagePictures],
		FTstg.[IsFeaturedVehicle],
		FTstg.[VehicleStoryOpeningStatementPictures],
		FTstg.[Copy_Writer_Status],
		FTstg.[FixedPrice],
		FTstg.[LockUsername],
		FTstg.[NoReserveCheck],
		FTstg.[VehicleStoryDescriptionCarFaxPictures],
		FTstg.[BeenListed],
		FTstg.[Acct_Rep],
		FTstg.[MagicBoxSection4],
		FTstg.[Copy_Writer],
		FTstg.[Taxonomy],
		FTstg.[PersonalMileage],
		FTstg.[Specialist_Section_Comp2_Price],
		FTstg.[VehicleStoryDescriptionInterior2],
		FTstg.[VehicleStoryDescriptionUndercarriage],
		FTstg.[VehicleStoryDescriptionInteriorPictures],
		FTstg.[Acct_Rep_Name],
		FTstg.[CarfaxLink],
		FTstg.[HideListing],
		FTstg.[CurrentIssues],
		FTstg.[TargetReserve],
		FTstg.[TransactionId],
		FTstg.[Specialist],
		FTstg.[BuyItNow],
		FTstg.[VehicleStoryDescriptionEngineTransmission],
		FTstg.[CountryOfOrigin],
		FTstg.[CommissionOverrideReason],
		FTstg.[WhereDidYouHearAboutUsListingReferral],
		FTstg.[CaliforniaSmogCheck],
		FTstg.[Modifications],
		FTstg.[Zip],
		FTstg.[ListingState],
		FTstg.[AnythingElseWeShouldKnow],
		FTstg.[VehicleTitle],
		FTstg.[Specialist_Section_Notes],
		FTstg.[VehicleStoryDescriptionExterior2],
		FTstg.[Photo_Plan],
		FTstg.[VehicleStoryDescriptionExterior2Pictures],
		FTstg.[Era],
		FTstg.[Commission],
		FTstg.[MakeOfferAvailable],
		FTstg.[IsEdited],
		FTstg.[WhereDidYouHearAboutUsListingOther],
		FTstg.[MagicBoxSection1],
		FTstg.[VehicleStoryDescriptionExteriorPictures],
		FTstg.[Specialist_Section_Original_Reserve],
		FTstg.[Specialist_Section_Comp1_Info],
		FTstg.[UI_ListingStateHold],
		FTstg.[AddressLine2],
		FTstg.[Specialist_Section_Comp5_Price],
		FTstg.[WGL_Public_Report],
		FTstg.[PremiumListing],
		FTstg.[ReservePrice],
		FTstg.[DealerURL],
		FTstg.[IsPaid],
		FTstg.[OriginalEngineText],
		FTstg.[HasProMarketing],
		FTstg.[PhotoPlanId],
		FTstg.[TransmissionText],
		FTstg.[MakeOfferAllowed],
		FTstg.[SchedulingComplete],
		FTstg.[ServiceRecords],
		FTstg.[CountryCL],
		FTstg.[OdometerUnits],
		FTstg.[BuyItNowUsed],
		FTstg.[MagicBoxSection3],
		FTstg.[SnapprPackage],
		FTstg.[CarfaxPassFail],
		FTstg.[CCID],
		FTstg.[StateProvinceRegion],
		FTstg.[DealerName],
		FTstg.[ListingProgress],
		FTstg.[StartingBid],
		FTstg.[EstimatedMarketValue],
		FTstg.[Mileage],
		FTstg.[IsPromoVehicle],
		FTstg.[MagicBoxSection2],
		FTstg.[SpinCarLink],
		FTstg.[MagicBoxSection5],
		FTstg.[Photo_Plan_Status],
		FTstg.[Address],
		FTstg.[HaveAllPhotos],
		FTstg.[MagicBoxSection6],
		FTstg.[OriginalEngine],
		FTstg.[VehicleStoryDescriptionInterior],
		FTstg.[UserComments],
		FTstg.[CarTitleInYourName],
		FTstg.[MarketValue],
		FTstg.[PackageTransactionId],
		FTstg.[Specialist_Section_Comp1_Price],
		FTstg.[Rust],
		FTstg.[MakeWholeAmount],
		FTstg.[Specialist_Section_Comp3_Price],
		FTstg.[VehicleStoryDescriptionEngineTransmissionPictures],
		FTstg.[WhereDidYouHearAboutUsListing],
		FTstg.[HasProPhotography],
		FTstg.[IsApproved],
		FTstg.[ListingNotes],
		FTstg.[Specialist_Section_Comp4_Info],
		FTstg.[HowLongOwned],
		FTstg.[DraftEmailNotificationSent],
		FTstg.[Copy_Writer_Feedback],
		FTstg.[ExpertVideoReview],
		FTstg.[Specialist_Section_Comp5_Info],
		FTstg.[Comped],
		FTstg.[BeenListedText],
		FTstg.[IsTaxable],
		FTstg.[Transmission],
		FTstg.[BeenModified],
		FTstg.[Specialist_Section_Comp3_Info],
		FTstg.[CityCL],
		FTstg.[PaintWorkText],
		FTstg.[Dealer],
		FTstg.[ReservePriceCL],
		FTstg.[MileageAccurate],
		FTstg.[Acct_Rep_Email],
		FTstg.[LastServiceInformation],
		FTstg.[DealerFees],
		FTstg.[Specialist_Section_Comp4_Price],
		FTstg.[VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp as FTtmp 
    join stg.AH_Listings_FT_stg as FTstg 
    on FTstg.ListingID=FTtmp.ListingID
)
,
insertData as (
    select 
        [ListingID],
        [Consignor_SKey],
        [Car_Skey],
        [PrimaryCategoryId],
        [CurrencyID],
        [ListingTypeID],
        [ListingType],
        [CreatedDate],
        [UpdatedDate],
        [DeletedDate],
        [Title],
        [OriginalRelistCount],
        [Hits],
        [EndDTTM],
        [StartDTTM],
        [Subtitle],
        [Location],
        [Status],
        [CurrentPrice],
        [LastUpdatedUser],
        [Duration],
        [Version],
        [Increment],
        [OriginalPrice],
        [AutoRelistRemaining],
        [CurrentQuantity],
        [OriginalQuantity],
        [RelistIteration],
        [PrimaryImageURI],
        [AcceptedActionCount],
        [OwnerUserName],
        [CurrentListingActionId],
        [CurrentListingActionUserName],
        [OfferCount],
        [VehicleStoryOpeningStatement],
        [VehicleStoryDescriptionCarFax],
        [Acct_Rep_Phone],
        [HasMagicBox],
        [HasDealerFee],
        [VehicleStory],
        [CarfaxPassFailError],
        [LeadSource],
        [VehicleStoryDescriptionInterior2Pictures],
        [Decade],
        [PaintWork],
        [Specialist_Section_Comp2_Info],
        [Curated],
        [VehicleStoryDescriptionUndercarriagePictures],
        [IsFeaturedVehicle],
        [VehicleStoryOpeningStatementPictures],
        [Copy_Writer_Status],
        [FixedPrice],
        [LockUsername],
        [NoReserveCheck],
        [VehicleStoryDescriptionCarFaxPictures],
        [BeenListed],
        [Acct_Rep],
        [MagicBoxSection4],
        [Copy_Writer],
        [Taxonomy],
        [PersonalMileage],
        [Specialist_Section_Comp2_Price],
        [VehicleStoryDescriptionInterior2],
        [VehicleStoryDescriptionUndercarriage],
        [VehicleStoryDescriptionInteriorPictures],
        [Acct_Rep_Name],
        [CarfaxLink],
        [HideListing],
        [CurrentIssues],
        [TargetReserve],
        [TransactionId],
        [Specialist],
        [BuyItNow],
        [VehicleStoryDescriptionEngineTransmission],
        [CountryOfOrigin],
        [CommissionOverrideReason],
        [WhereDidYouHearAboutUsListingReferral],
        [CaliforniaSmogCheck],
        [Modifications],
        [Zip],
        [ListingState],
        [AnythingElseWeShouldKnow],
        [VehicleTitle],
        [Specialist_Section_Notes],
        [VehicleStoryDescriptionExterior2],
        [Photo_Plan],
        [VehicleStoryDescriptionExterior2Pictures],
        [Era],
        [Commission],
        [MakeOfferAvailable],
        [IsEdited],
        [WhereDidYouHearAboutUsListingOther],
        [MagicBoxSection1],
        [VehicleStoryDescriptionExteriorPictures],
        [Specialist_Section_Original_Reserve],
        [Specialist_Section_Comp1_Info],
        [UI_ListingStateHold],
        [AddressLine2],
        [Specialist_Section_Comp5_Price],
        [WGL_Public_Report],
        [PremiumListing],
        [ReservePrice],
        [DealerURL],
        [IsPaid],
        [OriginalEngineText],
        [HasProMarketing],
        [PhotoPlanId],
        [TransmissionText],
        [MakeOfferAllowed],
        [SchedulingComplete],
        [ServiceRecords],
        [CountryCL],
        [OdometerUnits],
        [BuyItNowUsed],
        [MagicBoxSection3],
        [SnapprPackage],
        [CarfaxPassFail],
        [CCID],
        [StateProvinceRegion],
        [DealerName],
        [ListingProgress],
        [StartingBid],
        [EstimatedMarketValue],
        [Mileage],
        [IsPromoVehicle],
        [MagicBoxSection2],
        [SpinCarLink],
        [MagicBoxSection5],
        [Photo_Plan_Status],
        [Address],
        [HaveAllPhotos],
        [MagicBoxSection6],
        [OriginalEngine],
        [VehicleStoryDescriptionInterior],
        [UserComments],
        [CarTitleInYourName],
        [MarketValue],
        [PackageTransactionId],
        [Specialist_Section_Comp1_Price],
        [Rust],
        [MakeWholeAmount],
        [Specialist_Section_Comp3_Price],
        [VehicleStoryDescriptionEngineTransmissionPictures],
        [WhereDidYouHearAboutUsListing],
        [HasProPhotography],
        [IsApproved],
        [ListingNotes],
        [Specialist_Section_Comp4_Info],
        [HowLongOwned],
        [DraftEmailNotificationSent],
        [Copy_Writer_Feedback],
        [ExpertVideoReview],
        [Specialist_Section_Comp5_Info],
        [Comped],
        [BeenListedText],
        [IsTaxable],
        [Transmission],
        [BeenModified],
        [Specialist_Section_Comp3_Info],
        [CityCL],
        [PaintWorkText],
        [Dealer],
        [ReservePriceCL],
        [MileageAccurate],
        [Acct_Rep_Email],
        [LastServiceInformation],
        [DealerFees],
        [Specialist_Section_Comp4_Price],
        [VehicleStoryDescriptionExterior]
    from stg.AH_Listings_FT_tmp
    where ListingID not in (select  ListingID from stg.AH_Listings_FT_stg)
)
SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from updateData

union all

SELECT
	[ListingID],
	[Consignor_SKey],
	[Car_Skey],
	[PrimaryCategoryId],
	[CurrencyID],
	[ListingTypeID],
	[ListingType],
	[CreatedDate],
	[UpdatedDate],
	[DeletedDate],
	[Title],
	[OriginalRelistCount],
	[Hits],
	[EndDTTM],
	[StartDTTM],
	[Subtitle],
	[Location],
	[Status],
	[CurrentPrice],
	[LastUpdatedUser],
	[Duration],
	[Version],
	[Increment],
	[OriginalPrice],
	[AutoRelistRemaining],
	[CurrentQuantity],
	[OriginalQuantity],
	[RelistIteration],
	[PrimaryImageURI],
	[AcceptedActionCount],
	[OwnerUserName],
	[CurrentListingActionId],
	[CurrentListingActionUserName],
	[OfferCount],
	[VehicleStoryOpeningStatement],
	[VehicleStoryDescriptionCarFax],
	[Acct_Rep_Phone],
	[HasMagicBox],
	[HasDealerFee],
	[VehicleStory],
	[CarfaxPassFailError],
	[LeadSource],
	[VehicleStoryDescriptionInterior2Pictures],
	[Decade],
	[PaintWork],
	[Specialist_Section_Comp2_Info],
	[Curated],
	[VehicleStoryDescriptionUndercarriagePictures],
	[IsFeaturedVehicle],
	[VehicleStoryOpeningStatementPictures],
	[Copy_Writer_Status],
	[FixedPrice],
	[LockUsername],
	[NoReserveCheck],
	[VehicleStoryDescriptionCarFaxPictures],
	[BeenListed],
	[Acct_Rep],
	[MagicBoxSection4],
	[Copy_Writer],
	[Taxonomy],
	[PersonalMileage],
	[Specialist_Section_Comp2_Price],
	[VehicleStoryDescriptionInterior2],
	[VehicleStoryDescriptionUndercarriage],
	[VehicleStoryDescriptionInteriorPictures],
	[Acct_Rep_Name],
	[CarfaxLink],
	[HideListing],
	[CurrentIssues],
	[TargetReserve],
	[TransactionId],
	[Specialist],
	[BuyItNow],
	[VehicleStoryDescriptionEngineTransmission],
	[CountryOfOrigin],
	[CommissionOverrideReason],
	[WhereDidYouHearAboutUsListingReferral],
	[CaliforniaSmogCheck],
	[Modifications],
	[Zip],
	[ListingState],
	[AnythingElseWeShouldKnow],
	[VehicleTitle],
	[Specialist_Section_Notes],
	[VehicleStoryDescriptionExterior2],
	[Photo_Plan],
	[VehicleStoryDescriptionExterior2Pictures],
	[Era],
	[Commission],
	[MakeOfferAvailable],
	[IsEdited],
	[WhereDidYouHearAboutUsListingOther],
	[MagicBoxSection1],
	[VehicleStoryDescriptionExteriorPictures],
	[Specialist_Section_Original_Reserve],
	[Specialist_Section_Comp1_Info],
	[UI_ListingStateHold],
	[AddressLine2],
	[Specialist_Section_Comp5_Price],
	[WGL_Public_Report],
	[PremiumListing],
	[ReservePrice],
	[DealerURL],
	[IsPaid],
	[OriginalEngineText],
	[HasProMarketing],
	[PhotoPlanId],
	[TransmissionText],
	[MakeOfferAllowed],
	[SchedulingComplete],
	[ServiceRecords],
	[CountryCL],
	[OdometerUnits],
	[BuyItNowUsed],
	[MagicBoxSection3],
	[SnapprPackage],
	[CarfaxPassFail],
	[CCID],
	[StateProvinceRegion],
	[DealerName],
	[ListingProgress],
	[StartingBid],
	[EstimatedMarketValue],
	[Mileage],
	[IsPromoVehicle],
	[MagicBoxSection2],
	[SpinCarLink],
	[MagicBoxSection5],
	[Photo_Plan_Status],
	[Address],
	[HaveAllPhotos],
	[MagicBoxSection6],
	[OriginalEngine],
	[VehicleStoryDescriptionInterior],
	[UserComments],
	[CarTitleInYourName],
	[MarketValue],
	[PackageTransactionId],
	[Specialist_Section_Comp1_Price],
	[Rust],
	[MakeWholeAmount],
	[Specialist_Section_Comp3_Price],
	[VehicleStoryDescriptionEngineTransmissionPictures],
	[WhereDidYouHearAboutUsListing],
	[HasProPhotography],
	[IsApproved],
	[ListingNotes],
	[Specialist_Section_Comp4_Info],
	[HowLongOwned],
	[DraftEmailNotificationSent],
	[Copy_Writer_Feedback],
	[ExpertVideoReview],
	[Specialist_Section_Comp5_Info],
	[Comped],
	[BeenListedText],
	[IsTaxable],
	[Transmission],
	[BeenModified],
	[Specialist_Section_Comp3_Info],
	[CityCL],
	[PaintWorkText],
	[Dealer],
	[ReservePriceCL],
	[MileageAccurate],
	[Acct_Rep_Email],
	[LastServiceInformation],
	[DealerFees],
	[Specialist_Section_Comp4_Price],
	[VehicleStoryDescriptionExterior]
from insertData
    ');

  CREATE TABLE "dbo"."AH_Listings_FT__dbt_tmp"
    WITH(
      DISTRIBUTION = ROUND_ROBIN,
      CLUSTERED COLUMNSTORE INDEX
      )
    AS (SELECT * FROM dbo.AH_Listings_FT__dbt_tmp_temp_view)

   
  
  if object_id ('"dbo"."AH_Listings_FT__dbt_tmp_temp_view"','V') is not null
    begin
    drop view "dbo"."AH_Listings_FT__dbt_tmp_temp_view"
    end



22:07:38.413184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:07:38.413344 [debug] [Thread-1  ]: SQLServer adapter: Using connection string: DRIVER={ODBC Driver 18 for SQL Server};SERVER=synapsebj.sql.azuresynapse.net,1433;Database=BJAC_DW_PROD;UID={beamdataconsultants};PWD=***;Application Name=dbt-synapse/1.1.0
22:07:38.576083 [debug] [Thread-1  ]: SQLServer adapter: Connected to db: BJAC_DW_PROD
22:07:42.048396 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 3.64 seconds
22:07:42.065321 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
22:07:42.065682 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo"."AH_Listings_FT" to AH_Listings_FT__dbt_backup
22:07:42.109611 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.04 seconds
22:07:42.121917 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
22:07:42.122259 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: rename object "dbo"."AH_Listings_FT__dbt_tmp" to AH_Listings_FT
22:07:42.154399 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.03 seconds
22:07:42.165515 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: COMMIT
22:07:42.171978 [debug] [Thread-1  ]: SQLServer adapter: Using synapse connection "model.Shawn.AH_Listings_FT".
22:07:42.172320 [debug] [Thread-1  ]: SQLServer adapter: On model.Shawn.AH_Listings_FT: 
    
  if object_id ('"dbo"."AH_Listings_FT__dbt_backup"','U') is not null
    begin
    drop table "dbo"."AH_Listings_FT__dbt_backup"
    end

22:07:42.491888 [debug] [Thread-1  ]: SQLServer adapter: SQL status: OK in 0.32 seconds
22:07:42.574301 [debug] [Thread-1  ]: finished collecting timing info
22:07:42.574787 [debug] [Thread-1  ]: On model.Shawn.AH_Listings_FT: Close
22:07:42.575638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c755cfe4-a212-4300-b290-8fc73d824ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e9941c70>]}
22:07:42.576167 [info ] [Thread-1  ]: 1 of 1 OK created table model dbo.AH_Listings_FT................................ [[32mOK[0m in 4.22s]
22:07:42.576583 [debug] [Thread-1  ]: Finished running node model.Shawn.AH_Listings_FT
22:07:42.577956 [debug] [MainThread]: Acquiring new synapse connection "master"
22:07:42.578272 [debug] [MainThread]: On master: COMMIT
22:07:42.578658 [info ] [MainThread]: 
22:07:42.578938 [info ] [MainThread]: Finished running 1 table model in 18.85s.
22:07:42.579148 [debug] [MainThread]: Connection 'master' was properly closed.
22:07:42.579260 [debug] [MainThread]: Connection 'model.Shawn.AH_Listings_FT' was properly closed.
22:07:42.579364 [debug] [MainThread]: Connection 'list_BJAC_DW_PROD_dbo' was properly closed.
22:07:42.607872 [info ] [MainThread]: 
22:07:42.608316 [info ] [MainThread]: [32mCompleted successfully[0m
22:07:42.608637 [info ] [MainThread]: 
22:07:42.608838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
22:07:42.609155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebcf39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94eba571c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e99a9e50>]}
